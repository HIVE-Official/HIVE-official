import{j as e}from"./jsx-runtime-B9GTzLod.js";import{r as l}from"./index-BMjrbHXN.js";import{H as y,a as f,b as S,c as h,B as c}from"./button-CuCpvKae.js";import{I as D}from"./input-CXuKwzfo.js";import{L as k}from"./label-CGegogBt.js";import{B as O}from"./badge-CebFJquh.js";import{A as g,a as N,b as w}from"./avatar-DPA-6xOy.js";import{H as _}from"./hive-progress-DZ1m0jQ4.js";import{S as E}from"./separator-BGC3bnQ8.js";import{A as P,a as M}from"./alert-PC6ua8Li.js";import{D as b}from"./database-BscHc6YP.js";import{A as L}from"./activity-BpE6NZRo.js";import{W as R}from"./wifi-ZVXlguYO.js";import{W as U}from"./wifi-off-D7b6UPZc.js";import{R as A}from"./refresh-cw-SbqVByDa.js";import{C as F}from"./circle-x-BW9_cSEs.js";import{C as H}from"./circle-check-big-fUBFJcwM.js";import{B as z}from"./bell-DcMkR9fh.js";import{C as B}from"./circle-alert-D27CINV1.js";import{S as V}from"./settings-Cw08DGvz.js";import{L as q}from"./loader-circle-C0fUCed1.js";import{H as K}from"./heart-BuGzDzw2.js";import{M as W}from"./message-circle-CnQJGxxu.js";import{S as G}from"./share-2-DREqtcC9.js";import{B as Y}from"./bookmark-B4q7zV9u.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./framer-motion-proxy-DUdIJl-L.js";import"./button-enhanced-5mvuuZ4M.js";import"./input-enhanced-QtmCFtkG.js";import"./filter-props-D0Yg0xnz.js";import"./createLucideIcon-DtX30ipI.js";const Re={title:"18-Advanced Systems/State Management & Data Flow",parameters:{layout:"fullscreen",docs:{description:{component:`# HIVE Advanced State Management System

Production-ready state management patterns, data synchronization, and real-time features
for the HIVE platform. Demonstrates advanced React patterns, optimistic updates,
conflict resolution, offline support, and complex data flows.

## Advanced Features:
- **Real-time Synchronization**: Live data updates with conflict resolution
- **Optimistic Updates**: Instant UI feedback with rollback capabilities
- **Offline Support**: Queue operations and sync when reconnected
- **Context-based Architecture**: Scalable state management patterns
- **Advanced Error Handling**: Comprehensive error states and recovery
- **Performance Optimization**: Memoization, lazy loading, virtual scrolling
- **Complex Data Flows**: Multi-step operations with transaction support
- **Real-time Notifications**: Live updates and presence indicators`,story:"Advanced state management patterns and real-time data synchronization for HIVE"}}}},p={user:{profile:null,preferences:{theme:"dark",notifications:!0,realTimeUpdates:!0,autoSync:!0},activity:{dailyActiveTime:0,weeklyPosts:0,monthlyConnections:0},connections:[],status:"idle",error:null,lastSync:null},spaces:{spaces:[],activeSpace:null,members:{},posts:{},status:"idle",pagination:{},filters:{type:"all",sortBy:"activity",search:""}},feed:{posts:[],status:"idle",hasMore:!0,optimisticUpdates:[],lastRefresh:null},notifications:{notifications:[],unreadCount:0,realTimeConnection:"disconnected",preferences:{inApp:!0,email:!0,push:!1}},sync:{isOnline:!0,syncStatus:"idle",queuedOperations:[],conflictedItems:[],lastSyncAttempt:null,retryCount:0},ui:{activeTab:"feed",sidebarOpen:!0,modals:{},toasts:[],loading:{},theme:"dark",viewport:"desktop"}};function $(s,t){switch(t.type){case"SET_USER":return{...s,user:{...s.user,profile:t.payload,status:"idle",lastSync:Date.now()}};case"UPDATE_USER_PROFILE":return s.user.profile?{...s,user:{...s.user,profile:{...s.user.profile,...t.payload}}}:s;case"SET_SPACES":return{...s,spaces:{...s.spaces,spaces:t.payload,status:"idle"}};case"ADD_SPACE":return{...s,spaces:{...s.spaces,spaces:[...s.spaces.spaces,t.payload]}};case"SET_FEED_POSTS":return{...s,feed:{...s.feed,posts:t.payload,status:"idle",lastRefresh:Date.now()}};case"ADD_POST_OPTIMISTIC":return{...s,feed:{...s.feed,posts:[t.payload,...s.feed.posts],optimisticUpdates:[...s.feed.optimisticUpdates,{id:t.payload.id,type:"create",entity:"post",data:t.payload,timestamp:Date.now(),status:"pending"}]}};case"CONFIRM_POST":return{...s,feed:{...s.feed,posts:s.feed.posts.map(a=>a.id===t.payload.tempId?{...t.payload.confirmedPost,isOptimistic:!1}:a),optimisticUpdates:s.feed.optimisticUpdates.map(a=>a.data.id===t.payload.tempId?{...a,status:"confirmed"}:a)}};case"ROLLBACK_OPTIMISTIC":return{...s,feed:{...s.feed,posts:s.feed.posts.filter(a=>a.id!==t.payload),optimisticUpdates:s.feed.optimisticUpdates.map(a=>a.data.id===t.payload?{...a,status:"failed"}:a)}};case"SET_ONLINE_STATUS":return{...s,sync:{...s.sync,isOnline:t.payload,syncStatus:t.payload?"idle":"offline"}};case"SET_SYNC_STATUS":return{...s,sync:{...s.sync,syncStatus:t.payload,lastSyncAttempt:Date.now()}};case"QUEUE_OPERATION":return{...s,sync:{...s.sync,queuedOperations:[...s.sync.queuedOperations,{...t.payload,id:Date.now().toString(),timestamp:Date.now(),retryCount:0}]}};case"ADD_NOTIFICATION":return{...s,notifications:{...s.notifications,notifications:[t.payload,...s.notifications.notifications],unreadCount:s.notifications.unreadCount+1}};case"MARK_NOTIFICATION_READ":return{...s,notifications:{...s.notifications,notifications:s.notifications.notifications.map(a=>a.id===t.payload?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.notifications.unreadCount-1)}};case"SET_LOADING":return{...s,ui:{...s.ui,loading:{...s.ui.loading,[t.payload.key]:t.payload.loading}}};case"ADD_TOAST":return{...s,ui:{...s.ui,toasts:[...s.ui.toasts,{...t.payload,id:Date.now().toString()}]}};case"REMOVE_TOAST":return{...s,ui:{...s.ui,toasts:s.ui.toasts.filter(a=>a.id!==t.payload)}};case"SET_ACTIVE_TAB":return{...s,ui:{...s.ui,activeTab:t.payload}};case"TOGGLE_MODAL":return{...s,ui:{...s.ui,modals:{...s.ui.modals,[t.payload.modal]:t.payload.open}}};case"ADD_CONFLICT":return{...s,sync:{...s.sync,conflictedItems:[...s.sync.conflictedItems,t.payload]}};case"RESOLVE_CONFLICT":return{...s,sync:{...s.sync,conflictedItems:s.sync.conflictedItems.filter(a=>a.id!==t.payload.id)}};default:return s}}const T=l.createContext(null),x=()=>{const s=l.useContext(T);if(!s)throw new Error("useAppState must be used within AppStateProvider");return s},Z=()=>{const{state:s,dispatch:t}=x(),a=l.useCallback(async n=>{const r=`temp-${Date.now()}`,o={...n,id:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),interactions:{likes:0,comments:0,shares:0,bookmarks:0},userInteracted:{liked:!1,commented:!1,shared:!1,bookmarked:!1},status:"pending",isOptimistic:!0};t({type:"ADD_POST_OPTIMISTIC",payload:o});try{if(await new Promise(m=>setTimeout(m,2e3)),Math.random()<.1)throw new Error("Network error");const d={...o,id:`post-${Date.now()}`,status:"published",isOptimistic:!1};t({type:"CONFIRM_POST",payload:{tempId:r,confirmedPost:d}}),t({type:"ADD_TOAST",payload:{type:"success",title:"Posted!",message:"Your post has been shared."}})}catch{t({type:"ROLLBACK_OPTIMISTIC",payload:r}),t({type:"ADD_TOAST",payload:{type:"error",title:"Post failed",message:"Failed to share your post. Try again?",actions:[{label:"Retry",action:()=>a(n)}]}})}},[t]);return{createPostOptimistic:a}},Q=()=>{const{state:s,dispatch:t}=x();return l.useEffect(()=>{const n=setInterval(()=>{if(Math.random()<.3){const r={id:Date.now().toString(),type:["like","comment","follow","space_invite"][Math.floor(Math.random()*4)],title:"New Activity",message:"Someone interacted with your content",isRead:!1,createdAt:new Date().toISOString()};t({type:"ADD_NOTIFICATION",payload:r})}},5e3);return()=>clearInterval(n)},[t]),{syncData:l.useCallback(async()=>{if(s.sync.isOnline){t({type:"SET_SYNC_STATUS",payload:"syncing"});try{for(const n of s.sync.queuedOperations)await new Promise(r=>setTimeout(r,500));t({type:"SET_SYNC_STATUS",payload:"idle"}),t({type:"ADD_TOAST",payload:{type:"success",title:"Synced",message:"All data is up to date."}})}catch{t({type:"SET_SYNC_STATUS",payload:"error"}),t({type:"ADD_TOAST",payload:{type:"error",title:"Sync failed",message:"Will retry automatically."}})}}},[s.sync.isOnline,s.sync.queuedOperations,t])}},J={id:"user-1",handle:"sarah.chen",displayName:"Sarah Chen",email:"sarah.chen@buffalo.edu",avatar:"/api/placeholder/80/80",bio:"CS Major â€¢ Building the future of campus community",major:"Computer Science",graduationYear:2025,dorm:"Ellicott Complex",joinedAt:"2024-08-15T00:00:00Z",stats:{spacesJoined:12,toolsCreated:3,connectionsCount:89,postsShared:47}},X=[{id:"space-1",name:"CS 115 Study Group",description:"Weekly study sessions for Computer Science fundamentals",type:"academic",memberCount:24,isPrivate:!1,avatar:"/api/placeholder/40/40",createdAt:"2024-09-01T00:00:00Z",lastActivity:new Date().toISOString(),tags:["cs","study","programming"]},{id:"space-2",name:"Ellicott Complex",description:"Dorm community for Ellicott residents",type:"dorm",memberCount:156,isPrivate:!0,avatar:"/api/placeholder/40/40",createdAt:"2024-08-20T00:00:00Z",lastActivity:new Date(Date.now()-36e5).toISOString(),tags:["dorm","community","ellicott"]}],ee=[{id:"post-1",authorId:"user-2",authorName:"Mike Johnson",authorAvatar:"/api/placeholder/40/40",content:"Anyone interested in forming a study group for the upcoming CS midterm? We could meet at Lockwood Library this weekend.",type:"text",spaceId:"space-1",spaceName:"CS 115 Study Group",createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:new Date(Date.now()-36e5).toISOString(),interactions:{likes:8,comments:12,shares:3,bookmarks:5},userInteracted:{liked:!1,commented:!0,shared:!1,bookmarked:!0},status:"published"},{id:"post-2",authorId:"user-3",authorName:"Lisa Zhang",authorAvatar:"/api/placeholder/40/40",content:"The laundry room on the 2nd floor is working again! ðŸŽ‰",type:"text",spaceId:"space-2",spaceName:"Ellicott Complex",createdAt:new Date(Date.now()-72e5).toISOString(),updatedAt:new Date(Date.now()-72e5).toISOString(),interactions:{likes:23,comments:6,shares:1,bookmarks:2},userInteracted:{liked:!0,commented:!1,shared:!1,bookmarked:!1},status:"published"}],se=({state:s})=>e.jsxs(y,{className:"bg-gray-900 border-gray-800",children:[e.jsx(f,{children:e.jsxs(S,{className:"text-white flex items-center",children:[e.jsx(L,{className:"mr-2 h-5 w-5"}),"System Status"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.sync.isOnline?e.jsx(R,{className:"h-4 w-4 text-green-500"}):e.jsx(U,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm text-white",children:s.sync.isOnline?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.sync.syncStatus==="syncing"?e.jsx(A,{className:"h-4 w-4 text-blue-500 animate-spin"}):s.sync.syncStatus==="error"?e.jsx(F,{className:"h-4 w-4 text-red-500"}):e.jsx(H,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-white capitalize",children:s.sync.syncStatus})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm text-white",children:[s.notifications.unreadCount," unread"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-white",children:[s.sync.queuedOperations.length," queued"]})]})]}),s.sync.conflictedItems.length>0&&e.jsxs(P,{className:"border-yellow-600 bg-yellow-900/20",children:[e.jsx(B,{className:"h-4 w-4 text-yellow-500"}),e.jsxs(M,{className:"text-yellow-200",children:[s.sync.conflictedItems.length," items need conflict resolution"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Optimistic Updates"}),e.jsx("span",{className:"text-white",children:s.feed.optimisticUpdates.length})]}),e.jsx(_,{value:s.feed.optimisticUpdates.length>0?s.feed.optimisticUpdates.filter(t=>t.status==="confirmed").length/s.feed.optimisticUpdates.length*100:100,className:"h-2"})]})]})]}),te=()=>{var d,m;const{state:s,dispatch:t}=x(),{createPostOptimistic:a}=Z(),[n,r]=l.useState(""),o=async()=>{!n.trim()||!s.user.profile||(await a({authorId:s.user.profile.id,authorName:s.user.profile.displayName,authorAvatar:s.user.profile.avatar,content:n,type:"text"}),r(""))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{className:"bg-gray-900 border-gray-800",children:[e.jsx(f,{children:e.jsx(S,{className:"text-white",children:"Share with your campus"})}),e.jsx(h,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(g,{className:"w-10 h-10",children:[e.jsx(N,{src:(d=s.user.profile)==null?void 0:d.avatar}),e.jsx(w,{className:"bg-gray-700 text-white",children:(m=s.user.profile)==null?void 0:m.displayName.split(" ").map(i=>i[0]).join("")})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(D,{value:n,onChange:i=>r(i.target.value),placeholder:"What's happening on campus?",className:"bg-gray-800 border-gray-700 text-white",onKeyPress:i=>i.key==="Enter"&&!i.shiftKey&&o()}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-white",children:"ðŸ“· Photo"}),e.jsx(c,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-white",children:"ðŸ“Š Poll"}),e.jsx(c,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-white",children:"ðŸ“ Location"})]}),e.jsx(c,{onClick:o,disabled:!n.trim(),className:"bg-yellow-500 hover:bg-yellow-600 text-black",children:"Share"})]})]})]})})]}),e.jsx("div",{className:"space-y-4",children:s.feed.posts.map(i=>e.jsx(y,{className:`bg-gray-900 border-gray-800 ${i.isOptimistic?"opacity-75 border-dashed":""}`,children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(g,{className:"w-10 h-10",children:[e.jsx(N,{src:i.authorAvatar}),e.jsx(w,{className:"bg-gray-700 text-white",children:i.authorName.split(" ").map(I=>I[0]).join("")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-white",children:i.authorName}),i.spaceName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-500",children:"in"}),e.jsx(O,{variant:"secondary",className:"bg-blue-900 text-blue-300 text-xs",children:i.spaceName})]}),e.jsx("span",{className:"text-gray-500 text-sm",children:new Date(i.createdAt).toLocaleTimeString()}),i.status==="pending"&&e.jsx(q,{className:"h-4 w-4 text-yellow-500 animate-spin"})]}),e.jsx("p",{className:"text-white mb-3",children:i.content}),e.jsxs("div",{className:"flex items-center space-x-6 text-gray-400",children:[e.jsxs("button",{className:`flex items-center space-x-1 hover:text-red-400 transition-colors ${i.userInteracted.liked?"text-red-400":""}`,children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:i.interactions.likes})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-400 transition-colors",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:i.interactions.comments})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-green-400 transition-colors",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:i.interactions.shares})]}),e.jsxs("button",{className:`flex items-center space-x-1 hover:text-yellow-400 transition-colors ${i.userInteracted.bookmarked?"text-yellow-400":""}`,children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:i.interactions.bookmarks})]})]})]})]})})},i.id))})]})},ae=()=>{const{state:s,dispatch:t}=x(),{syncData:a}=Q(),n=()=>{t({type:"SET_ONLINE_STATUS",payload:!s.sync.isOnline})},r=()=>{const o={id:Date.now().toString(),entity:"post",localVersion:{title:"Local Version",content:"Local content"},serverVersion:{title:"Server Version",content:"Server content"},conflictType:"update",timestamp:Date.now()};t({type:"ADD_CONFLICT",payload:o})};return e.jsxs(y,{className:"bg-gray-900 border-gray-800",children:[e.jsx(f,{children:e.jsxs(S,{className:"text-white flex items-center",children:[e.jsx(V,{className:"mr-2 h-5 w-5"}),"Sync Controls"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white",children:"Network Status"}),e.jsx(c,{size:"sm",onClick:n,variant:s.sync.isOnline?"default":"destructive",children:s.sync.isOnline?"Go Offline":"Go Online"})]}),e.jsx(E,{className:"bg-gray-700"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white",children:"Force Sync"}),e.jsx(c,{size:"sm",onClick:a,disabled:!s.sync.isOnline||s.sync.syncStatus==="syncing",className:"bg-blue-600 hover:bg-blue-700",children:s.sync.syncStatus==="syncing"?e.jsx(A,{className:"h-4 w-4 animate-spin"}):"Sync Now"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white",children:"Simulate Conflict"}),e.jsx(c,{size:"sm",onClick:r,variant:"outline",className:"border-yellow-600 text-yellow-500 hover:bg-yellow-900/20",children:"Create Conflict"})]}),s.sync.queuedOperations.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx(k,{className:"text-white text-sm",children:"Queued Operations"}),e.jsx("div",{className:"mt-2 space-y-2",children:s.sync.queuedOperations.map(o=>e.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-800 rounded p-2",children:[e.jsx("span",{className:"text-gray-300",children:o.type}),e.jsx(O,{variant:"secondary",className:"bg-gray-700 text-gray-300 text-xs",children:new Date(o.timestamp).toLocaleTimeString()})]},o.id))})]})]})]})},ie=()=>{const[s,t]=l.useReducer($,{...p,user:{...p.user,profile:J},spaces:{...p.spaces,spaces:X},feed:{...p.feed,posts:ee}});return e.jsx(T.Provider,{value:{state:s,dispatch:t},children:e.jsx("div",{className:"min-h-screen bg-black text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold text-white mb-4 flex items-center",children:[e.jsx(b,{className:"mr-4 h-10 w-10"}),"Advanced State Management System"]}),e.jsx("p",{className:"text-gray-400 text-lg max-w-4xl",children:"Production-ready state management with real-time synchronization, optimistic updates, offline support, and comprehensive error handling for the HIVE platform."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx(se,{state:s}),e.jsx(ae,{})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(te,{})})]})]})})})},u={render:()=>e.jsx(ie,{}),parameters:{docs:{description:{story:"Complete advanced state management system with real-time sync, optimistic updates, and offline support"}}}};var j,v,C;u.parameters={...u.parameters,docs:{...(j=u.parameters)==null?void 0:j.docs,source:{originalSource:`{
  render: () => <StateManagementSystem />,
  parameters: {
    docs: {
      description: {
        story: 'Complete advanced state management system with real-time sync, optimistic updates, and offline support'
      }
    }
  }
}`,...(C=(v=u.parameters)==null?void 0:v.docs)==null?void 0:C.source}}};const Ue=["AdvancedStateManagement"];export{u as AdvancedStateManagement,Ue as __namedExportsOrder,Re as default};

import type { Meta, StoryObj } from '@storybook/react';
import { useState } from 'react';
import { Button } from '../../atomic/atoms/button-enhanced';
import { cn } from '../../../lib/utils';

const meta = {
  component: () => null,
  title: 'Interfaces/Profile Interface',
  parameters: {
    layout: 'fullscreen',
    docs: {
      description: {
        component: `
# HIVE Profile Interface

The profile interface serves as a campus command center with utility-first design and progressive social disclosure.

## Philosophy
- **Utility-First**: Command center for campus life, not social media
- **Progressive Social**: Locked features hint at future without confusing
- **Campus Integration**: Deeply connected to student life cycles
- **Builder Identity**: Support tool creation and community building

## Bento Grid System
Modular card layout that adapts to student needs with 1x1, 2x1, and 2x2 cards.

## Campus Energy Adaptation
The interface adapts to campus energy states through card prominence and spacing.
        `,
      }
    }
  }
        tags: ['autodocs'],
} satisfies Meta;

export default meta;
type Story = StoryObj<typeof meta>;

// Profile Layout Component
const ProfileLayout = ({ children }: { children: React.ReactNode }) => (
  <div className="min-h-screen bg-background">
    {/* Header */}
    <div className="border-b border-border">
      <div className="max-w-6xl mx-auto px-4 py-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-4">
            <h1 className="text-2xl font-display font-bold text-accent">HIVE</h1>
            <nav className="flex space-x-6">
              <a href="#" className="text-sm hover:text-accent transition-colors">Profile</a>
              <a href="#" className="text-sm text-muted-foreground hover:text-accent transition-colors">Spaces</a>
              <a href="#" className="text-sm text-muted-foreground hover:text-accent transition-colors">Tools</a>
              <a href="#" className="text-sm text-muted-foreground hover:text-accent transition-colors">Feed</a>
            </nav>
          </div>
          <div className="flex items-center space-x-3">
            <Button variant="secondary" size="sm">Settings</Button>
            <div className="w-8 h-8 bg-accent rounded-full flex items-center justify-center">
              <span className="text-sm font-semibold text-accent-foreground">SK</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    {/* Content */}
    <div className="max-w-6xl mx-auto px-4 py-8">
      {children}
    </div>
  </div>
);

// Bento Card Component
const BentoCard = ({ 
  size = '1x1', 
  title, 
  children, 
  className,
  locked = false,
  onLockClick,
}: { 
  size?: '1x1' | '2x1' | '2x2';
  title: string;
  children: React.ReactNode;
  className?: string;
  locked?: boolean;
  onLockClick?: () => void;
}) => {
  const sizeClasses = {
    '1x1': 'col-span-1 row-span-1',
    '2x1': 'col-span-2 row-span-1',
    '2x2': 'col-span-2 row-span-2',
  };
  
  return (
    <div className={cn(
      "bg-surface border border-border rounded-lg p-6 transition-all duration-base",
      "hover:border-accent/50 hover:shadow-sm",
      sizeClasses[size],
      className
    )}>
      <div className="flex items-center justify-between mb-4">
        <h3 className="font-semibold">{title}</h3>
        {locked && (
          <button
            onClick={onLockClick}
            className="text-muted-foreground hover:text-accent transition-colors"
          >
            üîí
          </button>
        )}
      </div>
      {children}
    </div>
  );
};

// Mock Data
const mockProfile = {
  name: "Sarah Kim",
  handle: "@sarah.kim",
  avatar: "üë©‚Äçüíª",
  major: "Computer Science",
  year: "Junior",
  graduationYear: 2025,
  bio: "Building tools that help students connect and collaborate on campus.",
  stats: {
    spacesJoined: 8,
    toolsCreated: 3,
    ritualsCompleted: 12,
    profileViews: 247,
  }
};

const mockSpaces = [
  { id: 1, name: "CS Majors", category: "Academic", members: 247, role: "Member" },
  { id: 2, name: "Ellicott Complex", category: "Residential", members: 156, role: "Member" },
  { id: 3, name: "Study Groups", category: "Academic", members: 89, role: "Leader" },
  { id: 4, name: "Hack Club", category: "Organization", members: 134, role: "Member" },
];

const mockTools = [
  { id: 1, name: "Study Buddy", icon: "üìö", usage: 45, created: "2 weeks ago" },
  { id: 2, name: "Room Finder", icon: "üè†", usage: 89, created: "1 month ago" },
  { id: 3, name: "Meal Planner", icon: "üçΩÔ∏è", usage: 23, created: "3 days ago" },
];

const mockCalendar = [
  { time: "9:00 AM", event: "Data Structures Lecture", type: "academic" },
  { time: "2:00 PM", event: "CS Majors Study Group", type: "space" },
  { time: "4:00 PM", event: "Hack Club Meeting", type: "space" },
  { time: "6:00 PM", event: "Dinner with Friends", type: "personal" },
];

export const UtilityFirstProfile: Story = {
  render: () => (
    <ProfileLayout>
      <div className="grid grid-cols-4 gap-6 auto-rows-fr">
        {/* Avatar Card (1x1) */}
        <BentoCard size="1x1" title="Profile">
          <div className="text-center space-y-3">
            <div className="w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mx-auto text-2xl">
              {mockProfile.avatar}
            </div>
            <div>
              <h4 className="font-semibold">{mockProfile.name}</h4>
              <p className="text-sm text-muted-foreground">{mockProfile.handle}</p>
              <p className="text-xs text-muted-foreground mt-1">
                {mockProfile.major} ‚Ä¢ {mockProfile.year}
              </p>
            </div>
          </div>
        </BentoCard>
        
        {/* Calendar Card (2x1) */}
        <BentoCard size="2x1" title="Today's Schedule">
          <div className="space-y-3">
            {mockCalendar.map((item, i) => (
              <div key={`calendar-${item.time}-${i}`} className="flex items-center space-x-3">
                <div className="w-16 text-sm text-muted-foreground">
                  {item.time}
                </div>
                <div className="flex-1">
                  <p className="text-sm font-medium">{item.event}</p>
                </div>
                <div className={cn(
                  "w-2 h-2 rounded-full",
                  item.type === 'academic' && "bg-surface",
                  item.type === 'space' && "bg-accent",
                  item.type === 'personal' && "bg-surface"
                )} />
              </div>
            ))}
          </div>
        </BentoCard>
        
        {/* Ghost Mode Card (1x1) */}
        <BentoCard size="1x1" title="Privacy" locked>
          <div className="text-center space-y-3">
            <div className="text-2xl">üëª</div>
            <div>
              <p className="text-sm font-medium">Ghost Mode</p>
              <p className="text-xs text-muted-foreground">,
  Currently: Always private
              </p>
            </div>
            <div className="text-xs text-muted-foreground">
              Control your visibility
            </div>
          </div>
        </BentoCard>
        
        {/* Your Tools Card (2x2) */}
        <BentoCard size="2x2" title="Your Tools">
          <div className="space-y-4">
            <div className="grid grid-cols-3 gap-3">
              {mockTools.map((tool) => (
                <div key={tool.id} className="p-3 bg-background rounded-lg text-center space-y-2">
                  <div className="text-2xl">{tool.icon}</div>
                  <div>
                    <p className="text-sm font-medium">{tool.name}</p>
                    <p className="text-xs text-muted-foreground">{tool.usage} uses</p>
                  </div>
                </div>
              ))}
              
              {/* Empty slots */}
              {Array.from({ length: 6 }).map((_, i) => (
                <div key={`empty-slot-${i}`} className="p-3 border-2 border-dashed border-border rounded-lg text-center space-y-2">
                  <div className="text-2xl text-muted-foreground">+</div>
                  <p className="text-xs text-muted-foreground">Create Tool</p>
                </div>
              ))}
            </div>
            
            <div className="text-center">
              <Button variant="secondary" size="sm">
                Create New Tool
              </Button>
            </div>
          </div>
        </BentoCard>
        
        {/* Your Spaces Card (2x1) */}
        <BentoCard size="2x1" title="Your Spaces">
          <div className="space-y-3">
            <div className="grid grid-cols-2 gap-3">
              {mockSpaces.slice(0, 4).map((space) => (
                <div key={space.id} className="p-3 bg-background rounded-lg">
                  <div className="flex items-center justify-between">
                    <div>
                      <p className="text-sm font-medium">{space.name}</p>
                      <p className="text-xs text-muted-foreground">{space.members} members</p>
                    </div>
                    <div className="text-xs text-muted-foreground">
                      {space.role}
                    </div>
                  </div>
                </div>
              ))}
            </div>
            <div className="text-center">
              <Button variant="secondary" size="sm">
                Explore Spaces
              </Button>
            </div>
          </div>
        </BentoCard>
        
        {/* Activity Log Card (2x1) */}
        <BentoCard size="2x1" title="Activity" locked>
          <div className="space-y-3">
            <div className="flex items-center justify-between">
              <p className="text-sm font-medium">Recent Activity</p>
              <p className="text-xs text-muted-foreground">Private</p>
            </div>
            <div className="space-y-2">
              <div className="flex items-center space-x-2">
                <div className="w-2 h-2 bg-accent rounded-full" />
                <p className="text-sm">Created Room Finder tool</p>
                <p className="text-xs text-muted-foreground">2h ago</p>
              </div>
              <div className="flex items-center space-x-2">
                <div className="w-2 h-2 bg-accent rounded-full" />
                <p className="text-sm">Joined Study Groups space</p>
                <p className="text-xs text-muted-foreground">1d ago</p>
              </div>
              <div className="flex items-center space-x-2">
                <div className="w-2 h-2 bg-accent rounded-full" />
                <p className="text-sm">Completed First Light ritual</p>
                <p className="text-xs text-muted-foreground">3d ago</p>
              </div>
            </div>
          </div>
        </BentoCard>
      </div>
    </ProfileLayout>
  ),
};

export const ProgressiveSocialDisclosure: Story = {
  render: () => {
    const [showSocialHint, setShowSocialHint] = useState(false);
    
    return (
      <ProfileLayout>
        <div className="grid grid-cols-4 gap-6 auto-rows-fr">
          {/* Avatar Card with Social Hints */}
          <BentoCard size="1x1" title="Profile">
            <div className="text-center space-y-3">
              <div className="w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mx-auto text-2xl">
                {mockProfile.avatar}
              </div>
              <div>
                <h4 className="font-semibold">{mockProfile.name}</h4>
                <p className="text-sm text-muted-foreground">{mockProfile.handle}</p>
                <p className="text-xs text-muted-foreground mt-1">
                  {mockProfile.major} ‚Ä¢ {mockProfile.year}
                </p>
              </div>
              
              {/* Social Hints */}
              <div className="pt-2 border-t border-border">
                <div className="flex items-center justify-between text-xs">
                  <span className="text-muted-foreground">Profile Views:</span>
                  <span className="text-muted-foreground">Private üîí</span>
                </div>
                <button
                  onClick={() => setShowSocialHint(!showSocialHint)}
                  className="text-xs text-accent hover:underline mt-1"
                >
                  Make Public?
                </button>
              </div>
            </div>
          </BentoCard>
          
          {/* Social Preview Card */}
          <BentoCard size="1x1" title="Social Features" locked>
            <div className="text-center space-y-3">
              <div className="text-2xl">üë•</div>
              <div>
                <p className="text-sm font-medium">Coming Soon</p>
                <p className="text-xs text-muted-foreground">
                  Public profiles, connections, sharing
                </p>
              </div>
              <div className="text-xs text-muted-foreground">
                Build privately, share when ready
              </div>
            </div>
          </BentoCard>
          
          {/* Builder Stats Card (locked) */}
          <BentoCard size="2x1" title="Builder Stats" locked>
            <div className="grid grid-cols-3 gap-4">
              <div className="text-center">
                <div className="text-2xl font-bold text-muted-foreground">‚Ä¢‚Ä¢</div>
                <p className="text-sm font-medium">Tools Created</p>
                <p className="text-xs text-muted-foreground">üîí Locked</p>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-muted-foreground">‚Ä¢‚Ä¢‚Ä¢</div>
                <p className="text-sm font-medium">Students Helped</p>
                <p className="text-xs text-muted-foreground">üîí Locked</p>
              </div>
              <div className="text-center">
                <div className="text-2xl font-bold text-muted-foreground">‚Ä¢‚Ä¢</div>
                <p className="text-sm font-medium">Builder Rank</p>
                <p className="text-xs text-muted-foreground">üîí Locked</p>
              </div>
            </div>
            <div className="text-center mt-4">
              <p className="text-xs text-muted-foreground">
                Unlocks with public profile
              </p>
            </div>
          </BentoCard>
          
          {/* Tool Sharing (locked) */}
          <BentoCard size="2x2" title="Your Tools">
            <div className="space-y-4">
              <div className="grid grid-cols-3 gap-3">
                {mockTools.map((tool) => (
                  <div key={tool.id} className="p-3 bg-background rounded-lg text-center space-y-2">
                    <div className="text-2xl">{tool.icon}</div>
                    <div>
                      <p className="text-sm font-medium">{tool.name}</p>
                      <p className="text-xs text-muted-foreground">{tool.usage} uses</p>
                    </div>
                  </div>
                ))}
                
                {Array.from({ length: 6 }).map((_, i) => (
                  <div key={`create-tool-${i}`} className="p-3 border-2 border-dashed border-border rounded-lg text-center space-y-2">
                    <div className="text-2xl text-muted-foreground">+</div>
                    <p className="text-xs text-muted-foreground">Create Tool</p>
                  </div>
                ))}
              </div>
              
              {/* Locked Sharing Features */}
              <div className="border-t border-border pt-4">
                <div className="flex items-center justify-between text-xs">
                  <span className="text-muted-foreground">Tool Sharing:</span>
                  <span className="text-muted-foreground">Coming Soon üîí</span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-muted-foreground">Usage Analytics:</span>
                  <span className="text-muted-foreground">Private üîí</span>
                </div>
              </div>
            </div>
          </BentoCard>
          
          {/* Request Access Card */}
          <BentoCard size="1x1" title="Request Access">
            <div className="space-y-3">
              <div className="text-center">
                <div className="text-2xl">üéØ</div>
                <p className="text-sm font-medium">Exclusive Spaces</p>
              </div>
              <div className="space-y-2">
                <div className="text-xs">
                  <p className="font-medium">CS Honors</p>
                  <p className="text-muted-foreground">Requires 3.5+ GPA</p>
                </div>
                <div className="text-xs">
                  <p className="font-medium">Research Lab</p>
                  <p className="text-muted-foreground">Faculty approval needed</p>
                </div>
              </div>
              <Button variant="secondary" size="sm" className="w-full">
                Apply
              </Button>
            </div>
          </BentoCard>
        </div>
        
        {/* Social Hint Modal */}
        {showSocialHint && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div className="bg-surface p-6 rounded-lg max-w-md space-y-4">
              <h3 className="font-semibold">Public Profile Preview</h3>
              <div className="space-y-3">
                <p className="text-sm text-muted-foreground">
                  When you're ready, your public profile will show:
                </p>
                <ul className="text-sm space-y-1">
                  <li>‚Ä¢ Profile views and visitor analytics</li>
                  <li>‚Ä¢ Tool usage and impact metrics</li>
                  <li>‚Ä¢ Builder rank and reputation</li>
                  <li>‚Ä¢ Connection recommendations</li>
                </ul>
              </div>
              <div className="flex space-x-3">
                <Button variant="secondary" onClick={() => setShowSocialHint(false)}>
                  Maybe Later
                </Button>
                <Button onClick={() => setShowSocialHint(false)}>
                  Stay Private
                </Button>
              </div>
            </div>
          </div>
        )}
      </ProfileLayout>
    );
  }
};

export const CampusIntegration: Story = {
  render: () => (
    <ProfileLayout>
      <div className="grid grid-cols-4 gap-6 auto-rows-fr">
        {/* Enhanced Calendar with University Integration */}
        <BentoCard size="2x1" title="Campus Calendar">
          <div className="space-y-3">
            <div className="flex items-center justify-between">
              <h4 className="font-medium">Today</h4>
              <div className="flex items-center space-x-2">
                <div className="w-2 h-2 bg-surface rounded-full" />
                <span className="text-xs">Academic</span>
                <div className="w-2 h-2 bg-accent rounded-full" />
                <span className="text-xs">HIVE</span>
              </div>
            </div>
            
            {mockCalendar.map((item, i) => (
              <div key={`schedule-${item.time}-${i}`} className="flex items-center space-x-3">
                <div className="w-16 text-sm text-muted-foreground">
                  {item.time}
                </div>
                <div className="flex-1">
                  <p className="text-sm font-medium">{item.event}</p>
                  {item.type === 'academic' && (
                    <p className="text-xs text-muted-foreground">NSC 220</p>
                  )}
                </div>
                <div className={cn(
                  "w-2 h-2 rounded-full",
                  item.type === 'academic' && "bg-surface",
                  item.type === 'space' && "bg-accent",
                  item.type === 'personal' && "bg-surface"
                )} />
              </div>
            ))}
            
            {/* Share Availability (locked) */}
            <div className="pt-2 border-t border-border">
              <div className="flex items-center justify-between text-xs">
                <span className="text-muted-foreground">Share Availability:</span>
                <span className="text-muted-foreground">Coming Soon üîí</span>
              </div>
            </div>
          </div>
        </BentoCard>
        
        {/* Academic Spaces */}
        <BentoCard size="2x1" title="Academic Spaces">
          <div className="space-y-3">
            <div className="grid grid-cols-2 gap-3">
              <div className="p-3 bg-background rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium">CS Majors</p>
                    <p className="text-xs text-muted-foreground">247 students</p>
                  </div>
                  <div className="text-xs text-accent">Leader</div>
                </div>
              </div>
              <div className="p-3 bg-background rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium">Data Structures</p>
                    <p className="text-xs text-muted-foreground">89 students</p>
                  </div>
                  <div className="text-xs text-muted-foreground">Member</div>
                </div>
              </div>
              <div className="p-3 bg-background rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium">Study Groups</p>
                    <p className="text-xs text-muted-foreground">34 students</p>
                  </div>
                  <div className="text-xs text-muted-foreground">Member</div>
                </div>
              </div>
              <div className="p-3 bg-background rounded-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium">Class of 2025</p>
                    <p className="text-xs text-muted-foreground">1,247 students</p>
                  </div>
                  <div className="text-xs text-muted-foreground">Member</div>
                </div>
              </div>
            </div>
          </div>
        </BentoCard>
        
        {/* HiveLAB Card */}
        <BentoCard size="1x1" title="HiveLAB">
          <div className="text-center space-y-3">
            <div className="text-2xl">üî¨</div>
            <div>
              <p className="text-sm font-medium">Builder Access</p>
              <p className="text-xs text-muted-foreground">
                Create tools for your community
              </p>
            </div>
            <div className="text-xs text-muted-foreground">
              Tools created: 3
            </div>
            <Button variant="secondary" size="sm">
              Open Lab
            </Button>
          </div>
        </BentoCard>
        
        {/* Ritual Participation */}
        <BentoCard size="1x1" title="Rituals">
          <div className="text-center space-y-3">
            <div className="text-2xl">üïØÔ∏è</div>
            <div>
              <p className="text-sm font-medium">Campus Rituals</p>
              <p className="text-xs text-muted-foreground">
                Participated in 12 rituals
              </p>
            </div>
            <div className="space-y-1">
              <div className="flex items-center justify-between text-xs">
                <span>First Light</span>
                <span className="text-accent">‚úì</span>
              </div>
              <div className="flex items-center justify-between text-xs">
                <span>Torch Pass</span>
                <span className="text-accent">‚úì</span>
              </div>
              <div className="flex items-center justify-between text-xs">
                <span>Space Hunt</span>
                <span className="text-muted-foreground">‚óã</span>
              </div>
            </div>
          </div>
        </BentoCard>
      </div>
    </ProfileLayout>
  ),
};

export const CampusEnergyProfile: Story = {
  render: () => (
    <div className="space-y-8 p-6">
      <div className="space-y-4">
        <h2 className="text-2xl font-semibold">Campus Energy Profile Adaptation</h2>
        <p className="text-muted-foreground">
          How the profile interface adapts to different campus energy states.
        </p>
      </div>
      
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {/* High Energy */}
        <div className="space-y-4">
          <h3 className="font-semibold">High Energy Period</h3>
          <div className="bg-surface p-4 rounded-lg border-2 border-accent/50">
            <div className="space-y-3">
              <div className="flex items-center justify-between">
                <h4 className="font-bold">Your Tools</h4>
                <div className="animate-hive-gold-pulse">‚ö°</div>
              </div>
              <div className="grid grid-cols-2 gap-2">
                <div className="p-2 bg-accent/20 rounded text-center">
                  <div className="text-lg">üìö</div>
                  <p className="text-xs font-medium">Study Buddy</p>
                </div>
                <div className="p-2 border-2 border-dashed border-accent rounded text-center">
                  <div className="text-lg">+</div>
                  <p className="text-xs font-bold">Create!</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        {/* Focus Period */}
        <div className="space-y-4">
          <h3 className="font-semibold">Focus Period</h3>
          <div className="bg-surface p-4 rounded-lg">
            <div className="space-y-3">
              <div className="flex items-center justify-between">
                <h4 className="font-normal">Study Tools</h4>
                <div className="opacity-50">üìö</div>
              </div>
              <div className="grid grid-cols-2 gap-2">
                <div className="p-2 bg-background rounded text-center">
                  <div className="text-lg opacity-75">üìö</div>
                  <p className="text-xs">Study Buddy</p>
                </div>
                <div className="p-2 border border-dashed border-border rounded text-center">
                  <div className="text-lg opacity-50">+</div>
                  <p className="text-xs">Create</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        {/* Celebration */}
        <div className="space-y-4">
          <h3 className="font-semibold">Celebration Period</h3>
          <div className="bg-surface p-4 rounded-lg">
            <div className="space-y-3">
              <div className="flex items-center justify-between">
                <h4 className="font-bold">Achievements</h4>
                <div className="animate-hive-ritual-burst">üéâ</div>
              </div>
              <div className="grid grid-cols-2 gap-2">
                <div className="p-2 bg-accent/20 rounded text-center animate-hive-gold-glow">
                  <div className="text-lg">üèÜ</div>
                  <p className="text-xs font-bold">Builder!</p>
                </div>
                <div className="p-2 bg-accent/20 rounded text-center">
                  <div className="text-lg">‚ú®</div>
                  <p className="text-xs font-bold">Ritual Complete</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  ),
};
// Unified HiveUser type that bridges Firebase and our app requirements
export interface HiveUser {
  // Core properties (mapped from Firebase uid) id: string;
  email: string;
  
  // Display properties
  displayName?: string;
  photoURL?: string;
  
  // Auth properties
  token?: string;
  uid?: string; // Alias for id to maintain Firebase compatibility
  
  // Profile properties
  firstName?: string;
  lastName?: string;
  handle?: string;
  bio?: string;
  
  // Academic properties
  major?: string;
  graduationYear?: number;
  school?: string;
  
  // Metadata
  createdAt?: Date;
  updatedAt?: Date;
  lastLogin?: Date;
  
  // Settings
  isPublic?: boolean;
  builderOptIn?: boolean;
  onboardingCompleted?: boolean;
}

// Type guard to check if user has required properties
export function isHiveUser(user: unknown): user is HiveUser {
  return user && typeof user.id === 'string' && typeof user.email === 'string';
}

// Utility to map Firebase user to HiveUser
export function mapFirebaseUserToHiveUser(firebaseUser: Record<string, unknown>): HiveUser {
  return {
    id: firebaseUser.uid || firebaseUser.id,
    uid: firebaseUser.uid || firebaseUser.id, // Keep both for compatibility email: firebaseUser.email    displayName: firebaseUser.displayName || firebaseUser.name,
    photoURL: firebaseUser.photoURL || firebaseUser.profilePicture,
    token: firebaseUser.token || firebaseUser.accessToken,
    ...firebaseUser // Spread any additional properties
  };
}
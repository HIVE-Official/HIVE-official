import{j as o}from"./jsx-runtime-CDt2p4po.js";import{r as d,R as T,g as U}from"./index-GiUgBvb1.js";import{c as m}from"./utils-CytzSlOG.js";import{c as P}from"./index-BwobEAja.js";import{B as ee}from"./button-GqeBBbqz.js";import{c as I}from"./createLucideIcon-DlCdiEX6.js";/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=I("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=I("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=I("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),_=d.forwardRef(({className:t,...e},r)=>o.jsx("textarea",{className:m("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));_.displayName="Textarea";_.__docgenInfo={description:"",methods:[],displayName:"Textarea"};d.createContext(void 0);const L=({children:t,className:e})=>o.jsx("div",{className:m("relative overflow-hidden",e),children:o.jsx("div",{className:"h-full w-full overflow-auto",children:t})});L.__docgenInfo={description:"",methods:[],displayName:"ScrollArea",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};T.createContext({isOpen:!1,setIsOpen:()=>{}});T.createContext({isOpen:!1,setIsOpen:()=>{}});const V=T.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:m("relative z-50 grid w-full max-w-lg gap-4 border bg-background p-6 shadow-lg duration-200 sm:rounded-lg md:w-full",t),...e}));V.displayName="AlertDialogContent";V.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent"};const se=P("flex",{variants:{direction:{row:"flex-row",col:"flex-col"},align:{start:"items-start",center:"items-center",end:"items-end",stretch:"items-stretch"},justify:{start:"justify-start",center:"justify-center",end:"justify-end",between:"justify-between",around:"justify-around"},gap:{0:"gap-0",1:"gap-1",2:"gap-2",3:"gap-3",4:"gap-4",5:"gap-5",6:"gap-6",8:"gap-8",10:"gap-10",12:"gap-12"}},defaultVariants:{direction:"col",align:"stretch",justify:"start",gap:4}}),W=d.forwardRef(({className:t,direction:e,align:r,justify:n,gap:i,...c},p)=>o.jsx("div",{ref:p,className:m(se({direction:e,align:r,justify:n,gap:i}),t),...c}));W.displayName="Stack";W.__docgenInfo={description:"",methods:[],displayName:"Stack",composes:["VariantProps"]};const ie=P("font-display font-semibold tracking-tight",{variants:{level:{1:"text-h1",2:"text-h2",3:"text-lg font-medium",4:"text-base font-medium"}},defaultVariants:{level:2}}),z=d.forwardRef(({className:t,level:e,...r},n)=>{const i=`h${e||2}`;return o.jsx(i,{ref:n,className:m(ie({level:e}),t),...r})});z.displayName="Heading";const G=d.forwardRef(({className:t,...e},r)=>o.jsx("p",{ref:r,className:m("text-body",t),...e}));G.displayName="Text";const F=d.forwardRef(({className:t,...e},r)=>o.jsx("p",{ref:r,className:m("text-sm text-text-muted",t),...e}));F.displayName="Muted";z.__docgenInfo={description:"",methods:[],displayName:"Heading",composes:["VariantProps"]};G.__docgenInfo={description:"",methods:[],displayName:"Text"};F.__docgenInfo={description:"",methods:[],displayName:"Muted"};const oe=d.createContext({dragDropManager:void 0});function k(t,e,...r){if(ae()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let n;if(e===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;n=new Error(e.replace(/%s/g,function(){return r[i++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function ae(){return typeof process<"u"&&!0}var de=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,i,c;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!t(e[i],r[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(c=Object.keys(e),n=c.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,c[i]))return!1;for(i=n;i--!==0;){var p=c[i];if(!t(e[p],r[p]))return!1}return!0}return e!==e&&r!==r};const ce=U(de),C=typeof window<"u"?d.useLayoutEffect:d.useEffect;function le(t,e,r){const[n,i]=d.useState(()=>e(t)),c=d.useCallback(()=>{const p=e(t);ce(n,p)||(i(p),r&&r())},[n,t,r]);return C(c),[n,c]}function ue(t,e,r){const[n,i]=le(t,e,r);return C(function(){const p=t.getHandlerId();if(p!=null)return t.subscribeToStateChange(i,{handlerIds:[p]})},[t,i]),n}function pe(t,e,r){return ue(e,t||(()=>({})),()=>r.reconnect())}function fe(t,e){const r=[];return typeof t!="function"&&r.push(t),d.useMemo(()=>typeof t=="function"?t():t,r)}let O=!1;class ge{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}canDrop(){if(!this.targetId)return!1;k(!O,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return O=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{O=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function me(t,e,r){const n=r.getRegistry(),i=n.addTarget(t,e);return[i,()=>n.removeTarget(i)]}function he(t,e,r,n){let i;if(i!==void 0)return!!i;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const c=Object.keys(t),p=Object.keys(e);if(c.length!==p.length)return!1;const h=Object.prototype.hasOwnProperty.bind(e);for(let b=0;b<c.length;b++){const v=c[b];if(!h(v))return!1;const x=t[v],y=e[v];if(i=void 0,i===!1||i===void 0&&x!==y)return!1}return!0}function xe(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function ye(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function be(t){return(e=null,r=null)=>{if(!d.isValidElement(e)){const c=e;return t(c,r),c}const n=e;return ye(n),we(n,r?c=>t(c,r):t)}}function ve(t){const e={};return Object.keys(t).forEach(r=>{const n=t[r];if(r.endsWith("Ref"))e[r]=t[r];else{const i=be(n);e[r]=()=>i}}),e}function A(t,e){typeof t=="function"?t(e):t.current=e}function we(t,e){const r=t.ref;return k(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?d.cloneElement(t,{ref:n=>{A(r,n),A(e,n)}}):d.cloneElement(t,{ref:e})}class Te{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const r=this.dropTarget;if(this.handlerId){if(!r){this.lastConnectedDropTarget=r;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=r,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,r,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!he(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=ve({dropTarget:(r,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,xe(r)?this.dropTargetRef=r:this.dropTargetNode=r,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function M(){const{dragDropManager:t}=d.useContext(oe);return k(t!=null,"Expected drag drop context"),t}function ke(t){return d.useMemo(()=>t.hooks.dropTarget(),[t])}function Ce(t){const e=M(),r=d.useMemo(()=>new Te(e.getBackend()),[e]);return C(()=>(r.dropTargetOptions=t||null,r.reconnect(),()=>r.disconnectDropTarget()),[t]),r}function De(){const t=M();return d.useMemo(()=>new ge(t),[t])}function je(t){const{accept:e}=t;return d.useMemo(()=>(k(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class Ne{canDrop(){const e=this.spec,r=this.monitor;return e.canDrop?e.canDrop(r.getItem(),r):!0}hover(){const e=this.spec,r=this.monitor;e.hover&&e.hover(r.getItem(),r)}drop(){const e=this.spec,r=this.monitor;if(e.drop)return e.drop(r.getItem(),r)}constructor(e,r){this.spec=e,this.monitor=r}}function Oe(t,e){const r=d.useMemo(()=>new Ne(t,e),[e]);return d.useEffect(()=>{r.spec=t},[t]),r}function Ie(t,e,r){const n=M(),i=Oe(t,e),c=je(t);C(function(){const[h,b]=me(c,i,n);return e.receiveHandlerId(h),r.receiveHandlerId(h),b},[n,e,i,r,c.map(p=>p.toString()).join("|")])}function Me(t,e){const r=fe(t),n=De(),i=Ce(r.options);return Ie(r,n,i),[pe(r.collect,n,i),ke(i)]}const Re={desktop:{width:"100%",height:"100%",maxWidth:"none"},tablet:{width:"768px",height:"1024px",maxWidth:"768px"},mobile:{width:"375px",height:"667px",maxWidth:"375px"}},g=8,K=d.forwardRef(({tool:t,elements:e,selectedElementId:r,deviceMode:n,onElementSelect:i,onElementUpdate:c,onElementDelete:p,onElementDuplicate:h,onElementAdd:b,className:v},x)=>{var E;const[y,$]=d.useState(!0),[Se,qe]=d.useState(null),[D,w]=d.useState(null),j=d.useRef(null),B=d.useRef(x),[{isOver:R,canDrop:S},q]=Me(()=>({accept:"element",drop:(s,a)=>{const l=a.getClientOffset();if(!l||!j.current)return;const u=j.current.getBoundingClientRect(),f={x:Math.max(0,l.x-u.left),y:Math.max(0,l.y-u.top)};return{position:{x:Math.round(f.x/g)*g,y:Math.round(f.y/g)*g}}},collect:s=>({isOver:s.isOver(),canDrop:s.canDrop()})})),Y=d.useCallback(s=>{j.current=s,q(s),typeof x=="function"?x(s):x&&(x.current=s)},[q,x]),X=d.useCallback((s,a)=>{a.stopPropagation(),i(s)},[i]),Z=d.useCallback((s,a)=>{var u;a.stopPropagation();const l=t.elements.find(f=>f.id===s);l&&((u=e.get(l.elementId))==null||u.type)},[t.elements,e]);d.useCallback((s,a)=>{const l={x:Math.round(a.x/g)*g,y:Math.round(a.y/g)*g};c(s,{position:l})},[c]),d.useCallback((s,a)=>{var l;c(s,{position:{...(l=t.elements.find(u=>u.id===s))==null?void 0:l.position,width:a.width,height:a.height}})},[c,t.elements]);const J=d.useCallback(s=>{s.target===s.currentTarget&&(i(null),w(null))},[i]),H=d.useCallback((s,a)=>{s.preventDefault(),w({x:s.clientX,y:s.clientY,elementId:a||null})},[]);d.useCallback((s,a)=>{if(!(!a&&s!=="paste")){switch(s){case"duplicate":a&&h(a);break;case"delete":a&&p(a);break;case"lock":if(a){const l=t.elements.find(u=>u.id===a);c(a,{isLocked:!(l!=null&&l.isLocked)})}break;case"hide":if(a){const l=t.elements.find(u=>u.id===a);c(a,{isVisible:!(l!=null&&l.isVisible)})}break;case"reset":if(a){const l=t.elements.find(f=>f.id===a),u=l?e.get(l.elementId):null;l&&u&&c(a,{config:u.defaultConfig})}break}w(null)}},[t.elements,e,c,h,p]),T.useEffect(()=>{const s=a=>{if(r)switch(a.key){case"Delete":case"Backspace":a.preventDefault(),p(r);break;case"d":(a.ctrlKey||a.metaKey)&&(a.preventDefault(),h(r));break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":a.preventDefault();const l=t.elements.find(u=>u.id===r);if(l&&!l.isLocked){const u=a.shiftKey?g*4:g,f={...l.position};switch(a.key){case"ArrowUp":f.y=Math.max(0,f.y-u);break;case"ArrowDown":f.y+=u;break;case"ArrowLeft":f.x=Math.max(0,f.x-u);break;case"ArrowRight":f.x+=u;break}c(r,{position:f})}break}};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[r,t.elements,c,p,h]);const N=Re[n],Q=[...t.elements].sort((s,a)=>s.order-a.order);return o.jsxs("div",{className:m("flex-1 overflow-hidden bg-muted/30",v),ref:B,children:[o.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-background/95 backdrop-blur",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ee,{variant:y?"default":"ghost",size:"sm",onClick:()=>$(!y),children:o.jsx(te,{className:"h-4 w-4"})}),o.jsx("div",{className:"text-sm text-muted-foreground",children:n==="desktop"?"Desktop":n==="tablet"?"Tablet (768px)":"Mobile (375px)"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsxs("span",{children:[t.elements.length," elements"]}),r&&o.jsxs("span",{children:["â€¢ Selected: ",(E=t.elements.find(s=>s.id===r))==null?void 0:E.elementId]})]})]}),o.jsx(L,{className:"h-full",children:o.jsx("div",{className:"flex items-center justify-center min-h-full p-8",children:o.jsx("div",{className:m("relative bg-background border shadow-lg",n==="mobile"&&"rounded-[2.5rem] border-8 border-gray-800",n==="tablet"&&"rounded-xl",n==="desktop"&&"rounded-lg"),style:{width:N.width,height:n==="desktop"?"800px":N.height,maxWidth:N.maxWidth,minHeight:"600px"},children:o.jsxs("div",{ref:Y,className:m("relative w-full h-full overflow-hidden",n==="mobile"&&"rounded-[1.75rem]",n==="tablet"&&"rounded-lg",n==="desktop"&&"rounded-md",y&&"bg-grid-pattern",R&&S&&"bg-primary/5 border-primary border-dashed"),onClick:J,onContextMenu:s=>H(s),style:{backgroundImage:y?"radial-gradient(circle, #e5e7eb 1px, transparent 1px)":void 0,backgroundSize:y?`${g}px ${g}px`:void 0},children:[R&&S&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-primary/10 border-2 border-dashed border-primary rounded-md",children:o.jsx("div",{className:"text-primary font-medium",children:"Drop element here"})}),Q.map(s=>{const a=e.get(s.elementId);return!a||!s.isVisible?null:o.jsxs("div",{className:m("absolute",s.isLocked&&"pointer-events-none opacity-75"),style:{left:s.position.x,top:s.position.y,width:s.position.width||"auto",height:s.position.height||"auto",zIndex:s.order},onClick:l=>X(s.id,l),onDoubleClick:l=>Z(s.id,l),onContextMenu:l=>H(l,s.id),children:[o.jsx("div",{className:"w-full h-full bg-muted border border-dashed border-muted-foreground/50 rounded flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[o.jsx("div",{className:"font-medium",children:a.name}),o.jsx("div",{className:"text-xs",children:s.id})]})}),r===s.id&&o.jsxs("div",{className:"absolute inset-0 border-2 border-primary rounded pointer-events-none",children:[o.jsx("div",{className:"absolute -top-1 -left-1 w-2 h-2 bg-primary rounded-full"}),o.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-primary rounded-full"}),o.jsx("div",{className:"absolute -bottom-1 -left-1 w-2 h-2 bg-primary rounded-full"}),o.jsx("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-primary rounded-full"})]}),s.isLocked&&o.jsx("div",{className:"absolute -top-2 -right-2 bg-yellow-500 text-white rounded-full p-1",children:o.jsx(re,{className:"h-3 w-3"})})]},s.id)}),t.elements.length===0&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ne,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),o.jsx("h3",{className:"font-medium mb-2",children:"Start building your tool"}),o.jsx("p",{className:"text-sm",children:"Drag elements from the library or click to add them"})]})})]})})})}),D&&o.jsxs("div",{className:"fixed bg-background border rounded-md shadow-lg p-2 z-50",style:{left:D.x,top:D.y},children:[o.jsx("div",{className:"text-sm text-muted-foreground",children:"Context menu not implemented yet"}),o.jsx("button",{className:"text-xs text-primary hover:underline",onClick:()=>w(null),children:"Close"})]})]})});K.displayName="DesignCanvas";K.__docgenInfo={description:"",methods:[],displayName:"DesignCanvas",props:{tool:{required:!0,tsType:{name:"Tool"},description:""},elements:{required:!0,tsType:{name:"Map",elements:[{name:"string"},{name:"Element"}],raw:"Map<string, Element>"},description:""},selectedElementId:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},deviceMode:{required:!0,tsType:{name:"union",raw:"'desktop' | 'tablet' | 'mobile'",elements:[{name:"literal",value:"'desktop'"},{name:"literal",value:"'tablet'"},{name:"literal",value:"'mobile'"}]},description:""},onElementSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(elementId: string | null) => void",signature:{arguments:[{type:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},name:"elementId"}],return:{name:"void"}}},description:""},onElementUpdate:{required:!0,tsType:{name:"signature",type:"function",raw:"(elementId: string, updates: Partial<ElementInstance>) => void",signature:{arguments:[{type:{name:"string"},name:"elementId"},{type:{name:"Partial",elements:[{name:"ElementInstance"}],raw:"Partial<ElementInstance>"},name:"updates"}],return:{name:"void"}}},description:""},onElementDelete:{required:!0,tsType:{name:"signature",type:"function",raw:"(elementId: string) => void",signature:{arguments:[{type:{name:"string"},name:"elementId"}],return:{name:"void"}}},description:""},onElementDuplicate:{required:!0,tsType:{name:"signature",type:"function",raw:"(elementId: string) => void",signature:{arguments:[{type:{name:"string"},name:"elementId"}],return:{name:"void"}}},description:""},onElementAdd:{required:!0,tsType:{name:"signature",type:"function",raw:"(elementId: string, position: { x: number; y: number }) => void",signature:{arguments:[{type:{name:"string"},name:"elementId"},{type:{name:"signature",type:"object",raw:"{ x: number; y: number }",signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]}},name:"position"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{z as H,F as M,W as S,G as T};

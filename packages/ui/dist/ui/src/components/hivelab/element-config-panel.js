"use client";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
/**
 * HIVE Element Configuration Panel
 * Properties panel for editing element configurations
 */
import { useState, useCallback } from 'react';
import { Button } from '../../atomic/atoms/button-enhanced.js';
import { Input } from '../../ui/input';
import { Label } from '../../ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../ui/select';
import { motion, AnimatePresence } from 'framer-motion';
import { Settings, Palette, Layout, Plus, Trash2, ChevronDown, HelpCircle, Code, ToggleLeft, ToggleRight } from 'lucide-react';
// Color picker component
const ColorPicker = ({ value, onChange, label }) => {
    const predefinedColors = [
        '#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6',
        '#06b6d4', '#84cc16', '#f97316', '#ec4899', '#6b7280'
    ];
    return (_jsxs("div", { className: "space-y-2", children: [_jsx(Label, { className: "text-sm font-medium", children: label }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("input", { type: "color", value: value || '#3b82f6', onChange: (e) => onChange(e.target.value), className: "w-8 h-8 rounded border border-[var(--hive-border-default)] cursor-pointer" }), _jsx(Input, { type: "text", value: value || '', onChange: (e) => onChange(e.target.value), placeholder: "#3b82f6", className: "flex-1" })] }), _jsx("div", { className: "flex flex-wrap gap-1", children: predefinedColors.map((color) => (_jsx("button", { onClick: () => onChange(color), className: "w-6 h-6 rounded border-2 border-white shadow-sm hover:scale-110 transition-transform", style: { backgroundColor: color }, title: color }, color))) })] }));
};
// Enhanced collapsible section with progressive disclosure
const ConfigSection = ({ title, icon: Icon, children, defaultOpen = true, priority = 'common', description, mode = 'simple', hasAdvancedProperties = false }) => {
    const [isOpen, setIsOpen] = useState(defaultOpen);
    // Auto-collapse advanced sections in simple mode
    const shouldShow = mode === 'advanced' || priority !== 'advanced';
    const shouldAutoCollapse = mode === 'simple' && priority === 'advanced';
    return (_jsx(AnimatePresence, { children: shouldShow && (_jsxs(motion.div, { className: "border border-[var(--hive-border-default)] rounded-lg overflow-hidden", initial: { opacity: 0, height: 0 }, animate: { opacity: 1, height: 'auto' }, exit: { opacity: 0, height: 0 }, transition: { duration: 0.2 }, children: [_jsxs("button", { onClick: () => setIsOpen(!isOpen), className: "w-full flex items-center justify-between p-3 bg-[var(--hive-background-secondary)] hover:bg-[var(--hive-background-tertiary)] transition-colors group", children: [_jsxs("div", { className: "flex items-center space-x-2 flex-1", children: [_jsx(Icon, { className: "w-4 h-4 text-[var(--hive-text-secondary)]" }), _jsxs("div", { className: "flex-1 text-left", children: [_jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "font-medium text-[var(--hive-text-primary)]", children: title }), priority === 'advanced' && (_jsx("span", { className: "text-xs px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded-full", children: "Advanced" })), hasAdvancedProperties && mode === 'simple' && (_jsx("span", { className: "text-xs text-[var(--hive-text-tertiary)]", children: "+ more options in advanced mode" }))] }), description && (_jsx("p", { className: "text-xs text-[var(--hive-text-secondary)] mt-0.5", children: description }))] })] }), _jsx(motion.div, { animate: { rotate: isOpen ? 180 : 0 }, transition: { duration: 0.2 }, children: _jsx(ChevronDown, { className: "w-4 h-4 text-[var(--hive-text-secondary)]" }) })] }), _jsx(AnimatePresence, { children: isOpen && (_jsx(motion.div, { initial: { opacity: 0, height: 0 }, animate: { opacity: 1, height: 'auto' }, exit: { opacity: 0, height: 0 }, transition: { duration: 0.2 }, className: "overflow-hidden", children: _jsx("div", { className: "p-4 space-y-4", children: children }) })) })] })) }));
};
// Property field with help text and validation
const PropertyField = ({ label, help, required, children }) => {
    return (_jsxs("div", { className: "space-y-2", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs(Label, { className: "text-sm font-medium flex items-center space-x-1", children: [_jsx("span", { children: label }), required && _jsx("span", { className: "text-red-400", children: "*" })] }), help && (_jsxs("div", { className: "group relative", children: [_jsx(HelpCircle, { className: "w-3 h-3 text-[var(--hive-text-tertiary)] cursor-help" }), _jsx("div", { className: "absolute right-0 top-6 w-48 p-2 bg-[var(--hive-background-primary)] border border-[var(--hive-border-default)] rounded-lg shadow-lg text-xs text-[var(--hive-text-secondary)] opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10", children: help })] }))] }), children] }));
};
// Option editor for choice select
const OptionEditor = ({ options, onChange }) => {
    const addOption = () => {
        onChange([...options, { value: `option${options.length + 1}`, label: `Option ${options.length + 1}` }]);
    };
    const removeOption = (index) => {
        onChange(options.filter((_, i) => i !== index));
    };
    const updateOption = (index, field, value) => {
        const newOptions = [...options];
        newOptions[index] = { ...newOptions[index], [field]: value };
        onChange(newOptions);
    };
    return (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx(Label, { className: "text-sm font-medium", children: "Options" }), _jsxs(Button, { size: "sm", variant: "secondary", onClick: addOption, className: "h-8", children: [_jsx(Plus, { className: "w-3 h-3 mr-1" }), "Add"] })] }), options.map((option, index) => (_jsxs("div", { className: "flex items-center space-x-2 p-2 border border-[var(--hive-border-default)] rounded", children: [_jsx(Input, { placeholder: "Value", value: option.value, onChange: (e) => updateOption(index, 'value', e.target.value), className: "flex-1" }), _jsx(Input, { placeholder: "Label", value: option.label, onChange: (e) => updateOption(index, 'label', e.target.value), className: "flex-1" }), _jsx(CheckboxEnhanced, { checked: option.disabled || false, onCheckedChange: (checked) => updateOption(index, 'disabled', checked) }), _jsx("button", { onClick: () => removeOption(index), className: "text-red-500 hover:text-red-700 p-1", disabled: options.length <= 1, children: _jsx(Trash2, { className: "w-3 h-3" }) })] }, index)))] }));
};
export const ElementConfigPanel = ({ element, elementDefinition, onChange, onClose }) => {
    const [configMode, setConfigMode] = useState('simple');
    if (!element || !elementDefinition) {
        return (_jsx("div", { className: "w-80 border-l border-[var(--hive-border-default)] bg-[var(--hive-background-secondary)] p-4", children: _jsxs("div", { className: "text-center py-8", children: [_jsx(Settings, { className: "w-12 h-12 text-[var(--hive-text-tertiary)] mx-auto mb-4" }), _jsx("h3", { className: "font-medium text-[var(--hive-text-primary)] mb-2", children: "No Element Selected" }), _jsx("p", { className: "text-sm text-[var(--hive-text-secondary)]", children: "Select an element from the canvas to edit its properties" })] }) }));
    }
    const config = element.config;
    const updateConfig = useCallback((path, value) => {
        const keys = path.split('.');
        const newConfig = { ...config };
        let current = newConfig;
        for (let i = 0; i < keys.length - 1; i++) {
            if (!current[keys[i]]) {
                current[keys[i]] = {};
            }
            current = current[keys[i]];
        }
        current[keys[keys.length - 1]] = value;
        onChange(newConfig);
    }, [config, onChange]);
    return (_jsxs("div", { className: "w-80 border-l border-[var(--hive-border-default)] bg-[var(--hive-background-secondary)] overflow-y-auto", children: [_jsxs("div", { className: "p-4 border-b border-[var(--hive-border-default)]", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("h3", { className: "font-semibold text-[var(--hive-text-primary)]", children: "Element Properties" }), onClose && (_jsx("button", { onClick: onClose, className: "text-[var(--hive-text-secondary)] hover:text-[var(--hive-text-primary)]", children: "\u00D7" }))] }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("p", { className: "text-sm text-[var(--hive-text-secondary)]", children: elementDefinition.name }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "text-xs text-[var(--hive-text-tertiary)]", children: configMode === 'simple' ? 'Simple' : 'Advanced' }), _jsx("button", { onClick: () => setConfigMode(prev => prev === 'simple' ? 'advanced' : 'simple'), className: "p-1 rounded-md hover:bg-[var(--hive-background-tertiary)] transition-colors", title: `Switch to ${configMode === 'simple' ? 'advanced' : 'simple'} mode`, children: configMode === 'simple' ? (_jsx(ToggleLeft, { className: "w-4 h-4 text-[var(--hive-text-secondary)]" })) : (_jsx(ToggleRight, { className: "w-4 h-4 text-purple-400" })) })] })] }), _jsx(motion.div, { initial: { opacity: 0 }, animate: { opacity: 1 }, className: "mt-2 p-2 bg-[var(--hive-background-primary)]/20 rounded-md", children: _jsx("p", { className: "text-xs text-[var(--hive-text-tertiary)]", children: configMode === 'simple'
                                ? 'Essential properties for quick setup'
                                : 'Full control over all element properties' }) }, configMode)] }), _jsxs("div", { className: "p-4 space-y-4", children: [_jsxs(ConfigSection, { title: "Basic Properties", icon: Settings, priority: "essential", description: "Core settings that define how this element works", mode: configMode, children: [elementDefinition.type === 'textBlock' && (_jsx("div", { className: "space-y-3", children: _jsx(PropertyField, { label: "Text Content", help: "The text that will be displayed. Supports line breaks and basic formatting.", required: true, children: _jsx("textarea", { value: config.text || '', onChange: (e) => updateConfig('text', e.target.value), className: "w-full p-2 border border-[var(--hive-border-default)] rounded-md bg-[var(--hive-background-primary)] text-[var(--hive-text-primary)] resize-none focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500/50 transition-all", rows: 3, placeholder: "Enter text content..." }) }) })), elementDefinition.type === 'textInput' && (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "label", children: "Label" }), _jsx(Input, { id: "label", value: config.label || '', onChange: (e) => updateConfig('label', e.target.value), placeholder: "Enter label" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "placeholder", children: "Placeholder" }), _jsx(Input, { id: "placeholder", value: config.placeholder || '', onChange: (e) => updateConfig('placeholder', e.target.value), placeholder: "Enter placeholder text" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "type", children: "Input Type" }), _jsxs(Select, { value: config.type || 'text', onValueChange: (value) => updateConfig('type', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "text", children: "Text" }), _jsx(SelectItem, { value: "email", children: "Email" }), _jsx(SelectItem, { value: "password", children: "Password" }), _jsx(SelectItem, { value: "number", children: "Number" }), _jsx(SelectItem, { value: "tel", children: "Phone" }), _jsx(SelectItem, { value: "url", children: "URL" })] })] })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx(CheckboxEnhanced, { id: "required", checked: config.required || false, onCheckedChange: (checked) => updateConfig('required', checked) }), _jsx(Label, { htmlFor: "required", children: "Required" })] })] })), elementDefinition.type === 'button' && (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "text", children: "Button Text" }), _jsx(Input, { id: "text", value: config.text || '', onChange: (e) => updateConfig('text', e.target.value), placeholder: "Button text" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "variant", children: "Style" }), _jsxs(Select, { value: config.variant || 'primary', onValueChange: (value) => updateConfig('variant', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "primary", children: "Primary" }), _jsx(SelectItem, { value: "secondary", children: "Secondary" }), _jsx(SelectItem, { value: "outline", children: "Outline" }), _jsx(SelectItem, { value: "ghost", children: "Ghost" })] })] })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "size", children: "Size" }), _jsxs(Select, { value: config.size || 'md', onValueChange: (value) => updateConfig('size', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "sm", children: "Small" }), _jsx(SelectItem, { value: "md", children: "Medium" }), _jsx(SelectItem, { value: "lg", children: "Large" })] })] })] })] })), elementDefinition.type === 'imageBlock' && (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "src", children: "Image URL" }), _jsx(Input, { id: "src", value: config.src || '', onChange: (e) => updateConfig('src', e.target.value), placeholder: "https://example.com/image.jpg" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "alt", children: "Alt Text" }), _jsx(Input, { id: "alt", value: config.alt || '', onChange: (e) => updateConfig('alt', e.target.value), placeholder: "Describe the image" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "caption", children: "Caption" }), _jsx(Input, { id: "caption", value: config.caption || '', onChange: (e) => updateConfig('caption', e.target.value), placeholder: "Optional caption" })] })] })), elementDefinition.type === 'choiceSelect' && (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "label", children: "Label" }), _jsx(Input, { id: "label", value: config.label || '', onChange: (e) => updateConfig('label', e.target.value), placeholder: "Enter label" })] }), _jsx(OptionEditor, { options: config.options || [], onChange: (options) => updateConfig('options', options) }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx(CheckboxEnhanced, { id: "multiple", checked: config.multiple || false, onCheckedChange: (checked) => updateConfig('multiple', checked) }), _jsx(Label, { htmlFor: "multiple", children: "Allow Multiple Selection" })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx(CheckboxEnhanced, { id: "required", checked: config.required || false, onCheckedChange: (checked) => updateConfig('required', checked) }), _jsx(Label, { htmlFor: "required", children: "Required" })] })] })), elementDefinition.type === 'ratingStars' && (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "label", children: "Label" }), _jsx(Input, { id: "label", value: config.label || '', onChange: (e) => updateConfig('label', e.target.value), placeholder: "Enter label" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "maxRating", children: "Maximum Rating" }), _jsxs(Select, { value: String(config.maxRating || 5), onValueChange: (value) => updateConfig('maxRating', Number(value)), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "3", children: "3 Stars" }), _jsx(SelectItem, { value: "5", children: "5 Stars" }), _jsx(SelectItem, { value: "7", children: "7 Stars" }), _jsx(SelectItem, { value: "10", children: "10 Stars" })] })] })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "size", children: "Size" }), _jsxs(Select, { value: config.size || 'md', onValueChange: (value) => updateConfig('size', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "sm", children: "Small" }), _jsx(SelectItem, { value: "md", children: "Medium" }), _jsx(SelectItem, { value: "lg", children: "Large" })] })] })] }), _jsx(ColorPicker, { label: "Star Color", value: config.color || '#fbbf24', onChange: (color) => updateConfig('color', color) }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx(CheckboxEnhanced, { id: "allowHalf", checked: config.allowHalf || false, onCheckedChange: (checked) => updateConfig('allowHalf', checked) }), _jsx(Label, { htmlFor: "allowHalf", children: "Allow Half Stars" })] })] }))] }), _jsx(ConfigSection, { title: "Styling", icon: Palette, priority: configMode === 'simple' ? 'common' : 'common', description: "Visual appearance and formatting options", mode: configMode, hasAdvancedProperties: true, children: _jsxs("div", { className: "space-y-3", children: [config.style?.backgroundColor !== undefined && (_jsx(ColorPicker, { label: "Background Color", value: config.style?.backgroundColor || '', onChange: (color) => updateConfig('style.backgroundColor', color) })), config.style?.textColor !== undefined && (_jsx(ColorPicker, { label: "Text Color", value: config.style?.textColor || '', onChange: (color) => updateConfig('style.textColor', color) })), config.style?.fontSize !== undefined && (_jsxs("div", { children: [_jsx(Label, { htmlFor: "fontSize", children: "Font Size" }), _jsxs(Select, { value: config.style?.fontSize || 'base', onValueChange: (value) => updateConfig('style.fontSize', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "xs", children: "Extra Small" }), _jsx(SelectItem, { value: "sm", children: "Small" }), _jsx(SelectItem, { value: "base", children: "Base" }), _jsx(SelectItem, { value: "lg", children: "Large" }), _jsx(SelectItem, { value: "xl", children: "Extra Large" }), _jsx(SelectItem, { value: "2xl", children: "2X Large" })] })] })] })), config.style?.fontWeight !== undefined && (_jsxs("div", { children: [_jsx(Label, { htmlFor: "fontWeight", children: "Font Weight" }), _jsxs(Select, { value: config.style?.fontWeight || 'normal', onValueChange: (value) => updateConfig('style.fontWeight', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "normal", children: "Normal" }), _jsx(SelectItem, { value: "medium", children: "Medium" }), _jsx(SelectItem, { value: "semibold", children: "Semi Bold" }), _jsx(SelectItem, { value: "bold", children: "Bold" })] })] })] })), config.style?.textAlign !== undefined && (_jsxs("div", { children: [_jsx(Label, { htmlFor: "textAlign", children: "Text Alignment" }), _jsxs(Select, { value: config.style?.textAlign || 'left', onValueChange: (value) => updateConfig('style.textAlign', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "left", children: "Left" }), _jsx(SelectItem, { value: "center", children: "Center" }), _jsx(SelectItem, { value: "right", children: "Right" })] })] })] }))] }) }), _jsx(ConfigSection, { title: "Layout & Spacing", icon: Layout, priority: "common", description: "Control spacing and positioning", mode: configMode, children: _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx(Label, { htmlFor: "padding", children: "Padding" }), _jsx(Input, { type: "number", id: "padding", value: config.style?.padding || 0, onChange: (e) => updateConfig('style.padding', Number(e.target.value)), placeholder: "0", min: "0", max: "100" })] }), _jsxs("div", { children: [_jsx(Label, { htmlFor: "margin", children: "Margin" }), _jsx(Input, { type: "number", id: "margin", value: config.style?.margin || 0, onChange: (e) => updateConfig('style.margin', Number(e.target.value)), placeholder: "0", min: "0", max: "100" })] })] }) }), _jsx(ConfigSection, { title: "Advanced Properties", icon: Code, priority: "advanced", description: "Expert-level configuration options", mode: configMode, children: _jsxs("div", { className: "space-y-3", children: [_jsx(PropertyField, { label: "CSS Classes", help: "Additional CSS classes to apply to this element", children: _jsx(Input, { value: config.className || '', onChange: (e) => updateConfig('className', e.target.value), placeholder: "custom-class another-class", className: "font-mono text-sm" }) }), _jsx(PropertyField, { label: "Element ID", help: "Unique identifier for this element (useful for custom styling or JavaScript)", children: _jsx(Input, { value: config.id || '', onChange: (e) => updateConfig('id', e.target.value), placeholder: "my-element-id", className: "font-mono text-sm" }) }), (elementDefinition.type === 'textBlock' || elementDefinition.type === 'textInput') && (_jsx(PropertyField, { label: "Accessibility Label", help: "Descriptive text for screen readers (improves accessibility)", children: _jsx(Input, { value: config.ariaLabel || '', onChange: (e) => updateConfig('ariaLabel', e.target.value), placeholder: "Describe this element's purpose" }) })), _jsx(PropertyField, { label: "Conditional Display", help: "Show this element only when certain conditions are met", children: _jsxs(Select, { value: config.displayCondition || 'always', onValueChange: (value) => updateConfig('displayCondition', value), children: [_jsx(SelectTrigger, { children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "always", children: "Always Show" }), _jsx(SelectItem, { value: "logged-in", children: "Logged In Users Only" }), _jsx(SelectItem, { value: "mobile", children: "Mobile Devices Only" }), _jsx(SelectItem, { value: "desktop", children: "Desktop Only" })] })] }) })] }) })] })] }));
};
//# sourceMappingURL=element-config-panel.js.map
'use client';
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { motion } from '../framer-motion-proxy.js';
import { HiveCard } from '../hive-card.js';
import { HiveButton } from '../hive-button.js';
import { HiveBadge } from '../hive-badge.js';
import { TrendingUp, TrendingDown, Users, Zap, Clock, Target, BarChart3, Activity, BookOpen, Award, ChevronRight, Sparkles } from 'lucide-react';
import { cn } from '../../lib/utils.js';
// Mini chart component for trends
const MiniChart = ({ data, color, height = 40, trend }) => {
    const max = Math.max(...data);
    const min = Math.min(...data);
    const range = max - min || 1;
    const points = data.map((value, index) => {
        const x = (index / (data.length - 1)) * 100;
        const y = ((value - min) / range) * height;
        return `${x},${height - y}`;
    }).join(' ');
    const trendColor = trend === 'up' ? '#10B981' : trend === 'down' ? '#EF4444' : '#6B7280';
    return (_jsxs("div", { className: "relative w-full", style: { height }, children: [_jsxs("svg", { width: "100%", height: height, className: "absolute inset-0", viewBox: `0 0 100 ${height}`, preserveAspectRatio: "none", children: [_jsx("polyline", { fill: "none", stroke: color, strokeWidth: "2", points: points, className: "drop-shadow-sm" }), _jsx("defs", { children: _jsxs("linearGradient", { id: `gradient-${color}`, x1: "0%", y1: "0%", x2: "0%", y2: "100%", children: [_jsx("stop", { offset: "0%", stopColor: color, stopOpacity: "0.3" }), _jsx("stop", { offset: "100%", stopColor: color, stopOpacity: "0.1" })] }) }), _jsx("polygon", { points: `0,${height} ${points} 100,${height}`, fill: `url(#gradient-${color})` })] }), _jsx("div", { className: cn("absolute top-1 right-1 flex items-center gap-1 text-xs font-medium", trend === 'up' ? 'text-green-400' : trend === 'down' ? 'text-red-400' : 'text-gray-400'), children: trend === 'up' ? _jsx(TrendingUp, { className: "h-3 w-3" }) :
                    trend === 'down' ? _jsx(TrendingDown, { className: "h-3 w-3" }) :
                        _jsx(Activity, { className: "h-3 w-3" }) })] }));
};
// Metric card component
const MetricCard = ({ title, value, change, icon: Icon, color, trend, chartData, subtitle }) => (_jsxs(HiveCard, { className: "p-6 h-full", children: [_jsxs("div", { className: "flex items-start justify-between mb-4", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 rounded-lg", style: { backgroundColor: `${color}20` }, children: _jsx(Icon, { className: "h-5 w-5", style: { color } }) }), _jsxs("div", { children: [_jsx("h3", { className: "font-semibold text-[var(--hive-text-primary)] text-sm", children: title }), subtitle && (_jsx("p", { className: "text-xs text-gray-400", children: subtitle }))] })] }), change !== undefined && (_jsxs(HiveBadge, { variant: change >= 0 ? "active-tag" : "tool-tag", className: cn("text-xs", change >= 0
                        ? 'bg-green-500/20 text-green-400 border-green-500/30'
                        : 'bg-red-500/20 text-red-400 border-red-500/30'), children: [change >= 0 ? '+' : '', change, "%"] }))] }), _jsxs("div", { className: "flex items-end justify-between", children: [_jsx("div", { children: _jsx("div", { className: "text-2xl font-bold text-[var(--hive-text-primary)] mb-1", children: typeof value === 'number' ? value.toLocaleString() : value }) }), chartData && trend && (_jsx("div", { className: "w-16", children: _jsx(MiniChart, { data: chartData, color: color, trend: trend }) }))] })] }));
// Progress ring component
const ProgressRing = ({ progress, size = 60, strokeWidth = 6, color = '#10B981', children }) => {
    const radius = (size - strokeWidth) / 2;
    const circumference = radius * 2 * Math.PI;
    const strokeDasharray = circumference;
    const strokeDashoffset = circumference - (progress / 100) * circumference;
    return (_jsxs("div", { className: "relative inline-flex items-center justify-center", children: [_jsxs("svg", { width: size, height: size, className: "transform -rotate-90", children: [_jsx("circle", { cx: size / 2, cy: size / 2, r: radius, stroke: "var(--hive-border-default)", strokeWidth: strokeWidth, fill: "transparent" }), _jsx("circle", { cx: size / 2, cy: size / 2, r: radius, stroke: color, strokeWidth: strokeWidth, fill: "transparent", strokeDasharray: strokeDasharray, strokeDashoffset: strokeDashoffset, strokeLinecap: "round", className: "transition-all duration-300 ease-in-out" })] }), children && (_jsx("div", { className: "absolute inset-0 flex items-center justify-center", children: children }))] }));
};
export const EnhancedProfileAnalytics = ({ analytics, isLoading = false, timeRange = 'week', onTimeRangeChange, className }) => {
    const [selectedView, setSelectedView] = useState('overview');
    if (isLoading || !analytics) {
        return (_jsx(HiveCard, { className: cn('p-6', className), children: _jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-8 h-8 bg-gray-700 rounded-lg animate-pulse" }), _jsx("div", { className: "h-5 w-32 bg-gray-700 rounded animate-pulse" })] }), _jsx("div", { className: "w-20 h-8 bg-gray-700 rounded animate-pulse" })] }), _jsx("div", { className: "grid grid-cols-2 lg:grid-cols-4 gap-4", children: Array.from({ length: 4 }).map((_, i) => (_jsx("div", { className: "h-24 bg-gray-800/50 rounded-lg animate-pulse" }, i))) })] }) }));
    }
    // Calculate derived metrics
    const totalTimeSpent = analytics.weeklyActivity.reduce((sum, week) => sum + week.timeSpent, 0);
    const avgSpacesActive = Math.round(analytics.weeklyActivity.reduce((sum, week) => sum + week.spacesActive, 0) / analytics.weeklyActivity.length);
    const totalToolsUsed = analytics.weeklyActivity.reduce((sum, week) => sum + week.toolsUsed, 0);
    // Calculate trends
    const activityTrend = analytics.weeklyActivity.length >= 2
        ? analytics.weeklyActivity[analytics.weeklyActivity.length - 1].timeSpent >
            analytics.weeklyActivity[analytics.weeklyActivity.length - 2].timeSpent ? 'up' : 'down'
        : 'stable';
    const spacesTrend = analytics.weeklyActivity.length >= 2
        ? analytics.weeklyActivity[analytics.weeklyActivity.length - 1].spacesActive >
            analytics.weeklyActivity[analytics.weeklyActivity.length - 2].spacesActive ? 'up' : 'down'
        : 'stable';
    const toolsTrend = analytics.weeklyActivity.length >= 2
        ? analytics.weeklyActivity[analytics.weeklyActivity.length - 1].toolsUsed >
            analytics.weeklyActivity[analytics.weeklyActivity.length - 2].toolsUsed ? 'up' : 'down'
        : 'stable';
    return (_jsxs("div", { className: cn('space-y-6', className), children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 rounded-lg bg-[var(--hive-brand-secondary)]/20", children: _jsx(BarChart3, { className: "h-6 w-6 text-[var(--hive-brand-secondary)]" }) }), _jsxs("div", { children: [_jsx("h2", { className: "text-xl font-bold text-[var(--hive-text-primary)]", children: "Profile Analytics" }), _jsx("p", { className: "text-sm text-gray-400", children: "Your HIVE activity insights" })] })] }), _jsx("div", { className: "flex items-center gap-2", children: ['week', 'month', 'semester'].map((range) => (_jsx(HiveButton, { variant: timeRange === range ? 'primary' : 'ghost', size: "sm", onClick: () => onTimeRangeChange?.(range), className: "text-xs", children: range.charAt(0).toUpperCase() + range.slice(1) }, range))) })] }), _jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4", children: [_jsx(MetricCard, { title: "Total Time", value: `${totalTimeSpent}h`, change: 12, icon: Clock, color: "#10B981", trend: activityTrend, chartData: analytics.weeklyActivity.map(w => w.timeSpent), subtitle: "This week" }), _jsx(MetricCard, { title: "Active Spaces", value: avgSpacesActive, change: 5, icon: Users, color: "#3B82F6", trend: spacesTrend, chartData: analytics.weeklyActivity.map(w => w.spacesActive), subtitle: "Average per week" }), _jsx(MetricCard, { title: "Tools Used", value: totalToolsUsed, change: -3, icon: Zap, color: "#F59E0B", trend: toolsTrend, chartData: analytics.weeklyActivity.map(w => w.toolsUsed), subtitle: "Total this period" }), _jsx(MetricCard, { title: "Engagement", value: `${analytics.socialMetrics.engagementRate}%`, change: 8, icon: Target, color: "#8B5CF6", trend: "up", subtitle: "Community score" })] }), _jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6", children: [_jsxs(HiveCard, { className: "p-6", children: [_jsxs("div", { className: "flex items-center justify-between mb-6", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx(BookOpen, { className: "h-5 w-5 text-blue-400" }), _jsx("h3", { className: "text-lg font-semibold text-[var(--hive-text-primary)]", children: "Top Spaces" })] }), _jsxs(HiveButton, { variant: "ghost", size: "sm", children: ["View All ", _jsx(ChevronRight, { className: "h-4 w-4 ml-1" })] })] }), _jsx("div", { className: "space-y-4", children: analytics.topSpaces.slice(0, 3).map((space, index) => (_jsxs(motion.div, { initial: { opacity: 0, x: -20 }, animate: { opacity: 1, x: 0 }, transition: { delay: index * 0.1 }, className: "flex items-center justify-between p-3 rounded-lg bg-gray-800/30 border border-gray-700/50", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsxs("div", { className: cn("w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold", index === 0 ? 'bg-yellow-500/20 text-yellow-400' :
                                                        index === 1 ? 'bg-gray-500/20 text-gray-400' :
                                                            'bg-orange-500/20 text-orange-400'), children: ["#", index + 1] }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-[var(--hive-text-primary)]", children: space.name }), _jsxs("p", { className: "text-xs text-gray-400", children: [space.timeSpent, "h spent"] })] })] }), _jsx("div", { className: "flex items-center gap-3", children: _jsx(ProgressRing, { progress: space.engagement, size: 40, strokeWidth: 4, color: "#3B82F6", children: _jsxs("span", { className: "text-xs font-medium text-blue-400", children: [space.engagement, "%"] }) }) })] }, space.id))) })] }), _jsxs(HiveCard, { className: "p-6", children: [_jsxs("div", { className: "flex items-center justify-between mb-6", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx(Zap, { className: "h-5 w-5 text-yellow-400" }), _jsx("h3", { className: "text-lg font-semibold text-[var(--hive-text-primary)]", children: "Top Tools" })] }), _jsxs(HiveButton, { variant: "ghost", size: "sm", children: ["View All ", _jsx(ChevronRight, { className: "h-4 w-4 ml-1" })] })] }), _jsx("div", { className: "space-y-4", children: analytics.topTools.slice(0, 3).map((tool, index) => (_jsxs(motion.div, { initial: { opacity: 0, x: 20 }, animate: { opacity: 1, x: 0 }, transition: { delay: index * 0.1 }, className: "flex items-center justify-between p-3 rounded-lg bg-gray-800/30 border border-gray-700/50", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsxs("div", { className: cn("w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold", index === 0 ? 'bg-yellow-500/20 text-yellow-400' :
                                                        index === 1 ? 'bg-gray-500/20 text-gray-400' :
                                                            'bg-orange-500/20 text-orange-400'), children: ["#", index + 1] }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-[var(--hive-text-primary)]", children: tool.name }), _jsxs("p", { className: "text-xs text-gray-400", children: [tool.usageCount, " uses"] })] })] }), _jsx("div", { className: "flex items-center gap-3", children: _jsx(ProgressRing, { progress: tool.productivity, size: 40, strokeWidth: 4, color: "#10B981", children: _jsxs("span", { className: "text-xs font-medium text-green-400", children: [tool.productivity, "%"] }) }) })] }, tool.id))) })] })] }), _jsxs(HiveCard, { className: "p-6", children: [_jsxs("div", { className: "flex items-center gap-3 mb-6", children: [_jsx(Sparkles, { className: "h-5 w-5 text-purple-400" }), _jsx("h3", { className: "text-lg font-semibold text-[var(--hive-text-primary)]", children: "Social Impact" })] }), _jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-3 gap-6", children: [_jsxs("div", { className: "text-center", children: [_jsx("div", { className: "flex items-center justify-center mb-3", children: _jsx(ProgressRing, { progress: analytics.socialMetrics.connectionsGrowth, size: 80, strokeWidth: 6, color: "#3B82F6", children: _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "text-xl font-bold text-blue-400", children: analytics.socialMetrics.connectionsGrowth }), _jsx("div", { className: "text-xs text-gray-400", children: "Growth" })] }) }) }), _jsx("p", { className: "text-sm font-medium text-[var(--hive-text-primary)]", children: "Connections" }), _jsx("p", { className: "text-xs text-gray-400", children: "New connections this month" })] }), _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "flex items-center justify-center mb-3", children: _jsx(ProgressRing, { progress: analytics.socialMetrics.engagementRate, size: 80, strokeWidth: 6, color: "#10B981", children: _jsxs("div", { className: "text-center", children: [_jsxs("div", { className: "text-xl font-bold text-green-400", children: [analytics.socialMetrics.engagementRate, "%"] }), _jsx("div", { className: "text-xs text-gray-400", children: "Rate" })] }) }) }), _jsx("p", { className: "text-sm font-medium text-[var(--hive-text-primary)]", children: "Engagement" }), _jsx("p", { className: "text-xs text-gray-400", children: "Community participation" })] }), _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "flex items-center justify-center mb-3", children: _jsx(ProgressRing, { progress: analytics.socialMetrics.helpfulnessScore, size: 80, strokeWidth: 6, color: "#F59E0B", children: _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "text-xl font-bold text-yellow-400", children: analytics.socialMetrics.helpfulnessScore }), _jsx("div", { className: "text-xs text-gray-400", children: "Score" })] }) }) }), _jsx("p", { className: "text-sm font-medium text-[var(--hive-text-primary)]", children: "Helpfulness" }), _jsx("p", { className: "text-xs text-gray-400", children: "How helpful you are to others" })] })] })] }), _jsx(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, className: "p-6 rounded-xl bg-gradient-to-r from-purple-500/10 via-blue-500/10 to-green-500/10 border border-purple-500/20", children: _jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "p-3 rounded-lg bg-gradient-to-r from-purple-500/20 to-blue-500/20", children: _jsx(Award, { className: "h-6 w-6 text-purple-400" }) }), _jsxs("div", { className: "flex-1", children: [_jsx("h3", { className: "text-lg font-semibold text-[var(--hive-text-primary)] mb-1", children: "Keep up the great work!" }), _jsx("p", { className: "text-sm text-gray-300", children: "You're in the top 20% of active HIVE users this week. Your engagement and tool usage are helping build a stronger community." })] }), _jsx(HiveButton, { variant: "outline", size: "sm", children: "View Achievements" })] }) })] }));
};
export default EnhancedProfileAnalytics;
//# sourceMappingURL=enhanced-profile-analytics.js.map
[{"filePath":"/Users/laneyfraass/hive_ui/apps/web/fix-onboarding-steps.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/fix-typescript-errors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/instrumentation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/middleware-backup.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NextRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NextResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentEnvironment' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * BACKUP - Original middleware\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { currentEnvironment } from './src/lib/env';","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/middleware-simple.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":7,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Simplified Next.js middleware - Emergency fix for production\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\n\nexport async function middleware(request: NextRequest): Promise<NextResponse> {\n  // Allow everything through for now to fix the immediate issue\n  const response = NextResponse.next();\n\n  // Add basic security headers\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n  response.headers.set('X-Frame-Options', 'SAMEORIGIN');\n\n  return response;\n}\n\nexport const config = {\n  matcher: [\n    '/((?!_next/static|_next/image|favicon.ico).*)',\n  ],\n};","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/next-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/fix-rss-matching.js","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'initializeFirebase' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cleanupWrongEvents' is defined but never used. Allowed unused vars must match /^_/u.","line":40,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Fix RSS event matching - Create proper spaces and match events correctly\n * Run with: node apps/web/scripts/fix-rss-matching.js\n */\n\nrequire('dotenv').config({ path: './apps/web/.env.local' });\nconst admin = require('firebase-admin');\nconst _https = require('https');\n\n// Initialize Firebase Admin\n\nfunction initializeFirebase() {\n  try {\n    if (admin.apps?.length > 0) {\n      return admin.app();\n    }\n\n    let credential;\n    if (process.env.FIREBASE_CLIENT_EMAIL && process.env.FIREBASE_PRIVATE_KEY) {\n      credential = admin.credential.cert({\n        projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n        clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\n        privateKey: process.env.FIREBASE_PRIVATE_KEY.replace(/\\\\n/g, '\\n'),\n      });\n    }\n\n    const _app = admin.initializeApp({\n      credential,\n      projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    });\n    \n    return _app;\n  } catch (error) {\n    console.error('Failed to initialize Firebase:', error);\n    throw error;\n  }\n}\n\n// First, clean up the incorrectly matched events\nasync function cleanupWrongEvents(db) {\n  console.log('üßπ Cleaning up incorrectly matched events...');\n  \n  const spaceTypes = [\n    'student_organizations',\n    'fraternity_and_sorority', \n    'campus_living',\n    'university_organizations'\n  ];\n  \n  let deletedCount = 0;\n  \n  for (const spaceType of spaceTypes) {\n    const spacesSnapshot = await db\n      .collection('spaces')\n      .doc(spaceType)\n      .collection('spaces')\n      .get();\n    \n    for (const spaceDoc of spacesSnapshot.docs) {\n      // Delete all RSS events from these spaces since they're wrong\n      const eventsSnapshot = await db\n        .collection('spaces')\n        .doc(spaceType)\n        .collection('spaces')\n        .doc(spaceDoc.id)\n        .collection('events')\n        .where('isFromRSS', '==', true)\n        .get();\n      \n      for (const eventDoc of eventsSnapshot.docs) {\n        await eventDoc.ref.delete();\n        deletedCount++;\n      }\n    }\n  }\n  \n  console.log(`‚úÖ Deleted ${deletedCount} incorrectly matched events`);\n  return deletedCount;\n}\n\n// Commented out incomplete function - needs to be properly implemented if needed\n/*\n// Create or find space for organization\nasync function findOrCreateSpace(organizerName, organizerEmail, db) {\n  // Clean up the organizer name\n  const cleanName = organizerName\n    .replace(/UB Chapter/gi, '')\n    .replace(/at UB/gi, '')\n    .replace(/- Buffalo/gi, '')\n    .trim();\n  \n  // Determine space type based on organization name\n  \n  let spaceType = 'student_organizations'; // default\n  \n  if (cleanName.toLowerCase().includes('fraternity') || \n      cleanName.toLowerCase().includes('sorority') ||\n      cleanName.toLowerCase().includes('alpha') ||\n      cleanName.toLowerCase().includes('delta') ||\n      cleanName.toLowerCase().includes('sigma') ||\n      cleanName.toLowerCase().includes('phi') ||\n      cleanName.toLowerCase().includes('kappa')) {\n    spaceType = 'fraternity_and_sorority';\n  } else if (cleanName.toLowerCase().includes('residence') ||\n             cleanName.toLowerCase().includes('complex') ||\n             cleanName.toLowerCase().includes('hall') ||\n             cleanName.toLowerCase().includes('village')) {\n    spaceType = 'campus_living';\n  } else if (cleanName.toLowerCase().includes('student engagement') ||\n             cleanName.toLowerCase().includes('career') ||\n             cleanName.toLowerCase().includes('graduate school') ||\n             cleanName.toLowerCase().includes('accessibility')) {\n    spaceType = 'university_organizations';\n  }\n  \n  // Search for existing space with this name\n  \n  const searchName = cleanName.toLowerCase();\n  const spacesSnapshot = await db\n    .collection('spaces')\n    .doc(spaceType)\n    .collection('spaces')\n    .get();\n  \n  for (const doc of spacesSnapshot.docs) {\n    const data = doc.data();\n    const spaceName = (data.name || '').toLowerCase();\n    \n    // Check for match\n    if (spaceName === searchName || \n        spaceName.includes(searchName) || \n        searchName.includes(spaceName)) {\n      return {\n        id: doc.id,\n        type: spaceType,\n        name: data.name,\n        existing: true\n      };\n    }\n  }\n  \n  // Create new space if not found\n  \n  const spaceId = cleanName.toLowerCase().replace(/[^a-z0-9]/g, '_');\n  const newSpace = {\n    name: cleanName,\n    description: `Events and activities organized by ${cleanName}`,\n    email: organizerEmail,\n    type: 'organization',\n    isFromRSS: true,\n    createdAt: new Date(),\n    updatedAt: new Date(),\n    memberCount: 0,\n    isActive: true,\n    tags: []\n  };\n  \n  await db\n    .collection('spaces')\n    .doc(spaceType)\n    .collection('spaces')\n    .doc(`rss_${spaceId}`)\n    .set(newSpace);\n  \n  console.log(`‚ú® Created new space: ${cleanName} in ${spaceType}`);\n  \n  return {\n    id: `rss_${spaceId}`,\n    type: spaceType,\n    name: cleanName,\n    existing: false\n  };\n}\n\n// Fetch and parse RSS feed properly\n// async function fetchRSSFeed(url) {\n  return new Promise((resolve, reject) => {\n    https.get(url, {\n      headers: {\n        'User-Agent': 'HIVE Campus Integration/1.0',\n      }\n    }, (res) => {\n      let data = '';\n      res.on('data', (chunk) => data += chunk);\n      res.on('end', () => resolve(data));\n    }).on('error', reject);\n  });\n}\n\nfunction parseRSSItems(xmlContent) {\n  const items = [];\n  const itemMatches = xmlContent.match(/<item>([\\s\\S]*?)<\\/item>/gi) || [];\n  \n  for (const itemXml of itemMatches) {\n    const title = extractXMLTag(itemXml, 'title');\n    const description = extractXMLTag(itemXml, 'description');\n    const link = extractXMLTag(itemXml, 'link');\n    const pubDate = extractXMLTag(itemXml, 'pubDate');\n    const guid = extractXMLTag(itemXml, 'guid');\n    const author = extractXMLTag(itemXml, 'author'); // This has the organizer!\n    \n    if (title && author) {\n      // Parse author\n          // field: \"email (Organization Name)\"\n      const authorMatch = author.match(/([^\\s]+)\\s*\\((.*?)\\)/);\n      const organizerEmail = authorMatch ? authorMatch[1] : '';\n      const organizerName = authorMatch ? authorMatch[2] : 'Campus Organization';\n      \n      items.push({\n        title: cleanXMLContent(title),\n        description: description ? cleanXMLContent(description) : '',\n        link: link ? cleanXMLContent(link) : '',\n        pubDate: pubDate ? new Date(cleanXMLContent(pubDate)) : new Date(),\n        guid: guid ? cleanXMLContent(guid) : link,\n        organizerEmail: organizerEmail,\n        organizerName: organizerName\n      });\n    }\n  }\n  \n  return items;\n}\n\nfunction extractXMLTag(xml, tag) {\n  const regex = new RegExp(`<${tag}[^>]*>([\\\\s\\\\S]*?)</${tag}>`, 'i');\n  const match = xml.match(regex);\n  return match ? match[1] : '';\n}\n\nfunction cleanXMLContent(content) {\n  return content\n    .replace(/<!\\[CDATA\\[(.*?)\\]\\]>/gs, '$1')\n    .replace(/<[^>]*>/g, '')\n    .replace(/&nbsp;/g, ' ')\n    .replace(/&amp;/g, '&')\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&quot;/g, '\"')\n    .trim();\n}\n\nasync function fixRSSMatching() {\n  const _app = initializeFirebase();\n  const db = admin.firestore();\n  \n  console.log('üîß FIXING RSS EVENT MATCHING');\n  console.log('‚ïê'.repeat(70));\n  \n  try {\n    // Step 1: Clean up wrong events\n    await cleanupWrongEvents(db);\n    \n    // Step 2: Fetch fresh RSS data\n    console.log('\\nüì° Fetching RSS feed...');\n    const xmlContent = await fetchRSSFeed('https://buffalo.campuslabs.com/engage/events.rss');\n    const events = parseRSSItems(xmlContent);\n    console.log(`Found ${events.length} events`);\n    \n    // Step 3: Process recent events with CORRECT matching\n    const recentEvents = events\n      .filter(e => e.pubDate > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000))\n      .slice(0, 50); // Start with 50 for testing\n    \n    console.log(`\\nüìä Processing ${recentEvents.length} recent events with correct matching...`);\n    \n    const stats = {\n      processed: 0,\n      newSpaces: 0,\n      existingSpaces: 0,\n      eventsCreated: 0\n    };\n    \n    // Track unique organizers\n    \n    const organizers = new Map();\n    \n    for (const event of recentEvents) {\n      stats.processed++;\n      \n      // Find or create the correct space for this organizer\n      if (!organizers.has(event.organizerName)) {\n        const space = await findOrCreateSpace(\n          event.organizerName,\n          event.organizerEmail,\n          db\n        );\n        organizers.set(event.organizerName, space);\n        \n        if (!space.existing) {\n          stats.newSpaces++;\n        } else {\n          stats.existingSpaces++;\n        }\n      }\n      \n      const space = organizers.get(event.organizerName);\n      \n      // Add event to the CORRECT space\n      \n      const eventData = {\n        title: event.title,\n        description: event.description,\n        startDate: event.pubDate,\n        endDate: new Date(event.pubDate.getTime() + 2 * 60 * 60 * 1000),\n        link: event.link,\n        organizerName: event.organizerName,\n        organizerEmail: event.organizerEmail,\n        rssGuid: event.guid,\n        isFromRSS: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n      \n      // Check if event already exists\n      \n      const existingEvent = await db\n        .collection('spaces')\n        .doc(space.type)\n        .collection('spaces')\n        .doc(space.id)\n        .collection('events')\n        .where('rssGuid', '==', event.guid)\n        .limit(1)\n        .get();\n      \n      if (existingEvent.empty) {\n        await db\n          .collection('spaces')\n          .doc(space.type)\n          .collection('spaces')\n          .doc(space.id)\n          .collection('events')\n          .add(eventData);\n        \n        stats.eventsCreated++;\n        console.log(`‚úÖ \"${event.title.substring(0, 40)}...\" ‚Üí ${space.name}`);\n      }\n    }\n    \n    console.log('\\n\\nüìä FIXED MATCHING SUMMARY');\n    console.log('‚ïê'.repeat(70));\n    console.log(`Events Processed: ${stats.processed}`);\n    console.log(`New Spaces Created: ${stats.newSpaces}`);\n    console.log(`Existing Spaces Used: ${stats.existingSpaces}`);\n    console.log(`Events Created: ${stats.eventsCreated}`);\n    console.log(`\\nUnique Organizations: ${organizers.size}`);\n    \n    console.log('\\nüìã Organizations found:');\n    let count = 0;\n    for (const [name, space] of organizers) {\n      count++;\n      if (count <= 10) {\n        console.log(`  ${count}. ${name} (${space.type})`);\n      }\n    }\n    if (organizers.size > 10) {\n      console.log(`  ... and ${organizers.size - 10} more`);\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Fix failed:', error);\n    throw error;\n  }\n}\n\n// Run the fix\nfixRSSMatching()\n  .then(() => {\n    console.log('\\n‚úÖ RSS matching fixed successfully!');\n    console.log('Events are now going to the CORRECT spaces based on their actual organizers.');\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error('Fix failed:', error);\n    process.exit(1);\n  });\n*/","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/setup-admins.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-auth-flow.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-email-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-firebase-auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-firebase-connection.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'createUserWithEmailAndPassword' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'addDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env tsx\n/**\n * Test Firebase Connection\n * Verifies Firebase is properly configured and accessible\n */\n\nimport { config } from 'dotenv';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, getDocs, query, where } from 'firebase/firestore';\n\n// Load environment variables\nconfig({ path: '.env.local' });\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY?.replace('\\\\n', ''),\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN?.replace('\\\\n', ''),\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID?.replace('\\\\n', ''),\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET?.replace('\\\\n', ''),\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID?.replace('\\\\n', ''),\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID?.replace('\\\\n', ''),\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID?.replace('\\\\n', '')\n};\n\nconsole.log('üî• Testing Firebase Connection');\nconsole.log('==============================\\n');\n\nconsole.log('üìã Configuration:');\nconsole.log(`Project ID: ${firebaseConfig.projectId}`);\nconsole.log(`Auth Domain: ${firebaseConfig.authDomain}`);\nconsole.log(`Storage Bucket: ${firebaseConfig.storageBucket}\\n`);\n\nasync function testConnection() {\n  try {\n    // Initialize Firebase\n    const app = initializeApp(firebaseConfig);\n    console.log('‚úÖ Firebase app initialized successfully');\n\n    // Test Auth\n    const auth = getAuth(app);\n    console.log('‚úÖ Firebase Auth initialized');\n\n    // Test Firestore\n    const db = getFirestore(app);\n    console.log('‚úÖ Firestore initialized');\n\n    // Try to read from a collection (will fail if rules block it, but connection works)\n    try {\n      const spacesRef = collection(db, 'spaces');\n      const q = query(spacesRef, where('campusId', '==', 'ub-buffalo'));\n      const snapshot = await getDocs(q);\n      console.log(`‚úÖ Firestore query successful: Found ${snapshot.size} spaces`);\n    } catch (error: any) {\n      if (error.code === 'permission-denied') {\n        console.log('‚ö†Ô∏è Firestore connection works but permission denied (expected if not authenticated)');\n      } else {\n        console.log('‚ö†Ô∏è Firestore query error:', error.message);\n      }\n    }\n\n    // Check if Admin SDK credentials are configured\n    console.log('\\nüìã Admin SDK Configuration:');\n    const hasAdminConfig = !!(\n      process.env.FIREBASE_PROJECT_ID &&\n      process.env.FIREBASE_CLIENT_EMAIL &&\n      process.env.FIREBASE_PRIVATE_KEY\n    );\n\n    if (hasAdminConfig) {\n      console.log('‚úÖ Admin SDK credentials are configured');\n      console.log(`   Project: ${process.env.FIREBASE_PROJECT_ID}`);\n      console.log(`   Client Email: ${process.env.FIREBASE_CLIENT_EMAIL}`);\n    } else {\n      console.log('‚ùå Admin SDK credentials are missing!');\n      console.log('   Please download service account key from Firebase Console:');\n      console.log('   https://console.firebase.google.com/project/hive-9265c/settings/serviceaccounts/adminsdk');\n    }\n\n    // Test Auth Methods\n    console.log('\\nüìã Authentication Status:');\n    try {\n      // Check if email/password is enabled by trying to sign in\n      const testEmail = 'test@buffalo.edu';\n      const testPassword = 'test123456';\n\n      // This will fail but tells us if the auth method is enabled\n      await signInWithEmailAndPassword(auth, testEmail, testPassword);\n    } catch (error: any) {\n      if (error.code === 'auth/user-not-found') {\n        console.log('‚úÖ Email/Password authentication is enabled');\n      } else if (error.code === 'auth/operation-not-allowed') {\n        console.log('‚ùå Email/Password authentication is NOT enabled!');\n        console.log('   Enable it at: https://console.firebase.google.com/project/hive-9265c/authentication/providers');\n      } else {\n        console.log('‚ö†Ô∏è Auth check:', error.code);\n      }\n    }\n\n    console.log('\\nüéâ Firebase connection test complete!');\n\n    // Summary\n    console.log('\\nüìä Summary:');\n    console.log('===========');\n    console.log('‚úÖ Client SDK: Connected');\n    console.log(hasAdminConfig ? '‚úÖ Admin SDK: Configured' : '‚ùå Admin SDK: Not configured');\n    console.log('‚úÖ Firestore: Connected');\n    console.log('‚úÖ Security Rules: Deployed');\n\n    if (!hasAdminConfig) {\n      console.log('\\n‚ö†Ô∏è Next Steps:');\n      console.log('1. Download service account key from Firebase Console');\n      console.log('2. Add FIREBASE_PROJECT_ID, FIREBASE_CLIENT_EMAIL, and FIREBASE_PRIVATE_KEY to .env.local');\n      console.log('3. Run this test again');\n    }\n\n  } catch (error) {\n    console.error('‚ùå Firebase connection failed:', error);\n    process.exit(1);\n  }\n}\n\n// Run the test\ntestConnection().then(() => {\n  process.exit(0);\n}).catch((error) => {\n  console.error('Test failed:', error);\n  process.exit(1);\n});","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-mobile.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/scripts/test-security.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logger' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'listUsersResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":91,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'validateOrigin' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":177,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":177,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env tsx\n/**\n * Security Implementation Test Script\n * Verifies all security measures are working correctly\n */\n\nimport { config } from 'dotenv';\nimport { logger } from '../src/lib/logger';\n\n// Load environment variables\nconfig({ path: '.env.local' });\n\ninterface TestResult {\n  name: string;\n  passed: boolean;\n  message: string;\n}\n\nconst results: TestResult[] = [];\n\nfunction addResult(name: string, passed: boolean, message: string) {\n  results.push({ name, passed, message });\n  const emoji = passed ? '‚úÖ' : '‚ùå';\n  console.log(`${emoji} ${name}: ${message}`);\n}\n\nasync function testEnvironmentVariables() {\n  console.log('\\nüìã Testing Environment Variables...\\n');\n\n  // Check for dev bypass variables in production\n  const dangerousVars = [\n    'NEXT_PUBLIC_BYPASS_AUTH',\n    'NEXT_PUBLIC_USE_EMULATOR',\n    'BYPASS_RATE_LIMIT',\n    'SKIP_AUTH_CHECK',\n    'DEV_MODE'\n  ];\n\n  for (const varName of dangerousVars) {\n    const value = process.env[varName];\n    if (process.env.NODE_ENV === 'production' && (value === 'true' || value === '1')) {\n      addResult(\n        `Check ${varName}`,\n        false,\n        `CRITICAL: ${varName} is enabled in production!`\n      );\n    } else {\n      addResult(\n        `Check ${varName}`,\n        true,\n        `${varName} is not enabled (value: ${value || 'undefined'})`\n      );\n    }\n  }\n\n  // Check required security variables\n  const requiredVars = [\n    'FIREBASE_PROJECT_ID',\n    'FIREBASE_CLIENT_EMAIL',\n    'FIREBASE_PRIVATE_KEY',\n    'NEXTAUTH_SECRET',\n    'JWT_SECRET'\n  ];\n\n  for (const varName of requiredVars) {\n    const value = process.env[varName];\n    if (!value) {\n      addResult(\n        `Check ${varName}`,\n        false,\n        `${varName} is missing!`\n      );\n    } else {\n      addResult(\n        `Check ${varName}`,\n        true,\n        `${varName} is set (length: ${value.length})`\n      );\n    }\n  }\n}\n\nasync function testFirebaseConnection() {\n  console.log('\\nüî• Testing Firebase Connection...\\n');\n\n  try {\n    const { authAdmin } = await import('../src/lib/firebase-admin');\n    const adminAuth = authAdmin;\n\n    // Try to list users (will fail if not properly configured)\n    const listUsersResult = await adminAuth.listUsers(1);\n\n    addResult(\n      'Firebase Admin SDK',\n      true,\n      'Successfully connected to Firebase Admin SDK'\n    );\n\n    // Check if Firebase project ID matches expected\n    const projectId = process.env.FIREBASE_PROJECT_ID;\n    if (projectId && projectId.includes('demo')) {\n      addResult(\n        'Firebase Project ID',\n        false,\n        `Using demo project: ${projectId}`\n      );\n    } else {\n      addResult(\n        'Firebase Project ID',\n        true,\n        `Using production project: ${projectId}`\n      );\n    }\n  } catch (error: any) {\n    addResult(\n      'Firebase Admin SDK',\n      false,\n      `Failed to connect: ${error.message}`\n    );\n  }\n}\n\nasync function testRateLimiting() {\n  console.log('\\n‚è±Ô∏è Testing Rate Limiting...\\n');\n\n  try {\n    // Import rate limiter\n    const { checkRedisRateLimit } = await import('../src/lib/rate-limiter-redis');\n\n    // Test Redis connection\n    const testResult = await checkRedisRateLimit('api', 'test-identifier');\n\n    if (testResult.success) {\n      addResult(\n        'Redis Rate Limiting',\n        true,\n        `Rate limiter connected (remaining: ${testResult.remaining}/${testResult.limit})`\n      );\n    } else {\n      addResult(\n        'Redis Rate Limiting',\n        false,\n        'Rate limit exceeded on test'\n      );\n    }\n\n    // Check if Redis URL is configured\n    const redisUrl = process.env.REDIS_URL || process.env.UPSTASH_REDIS_URL;\n    if (!redisUrl) {\n      addResult(\n        'Redis Configuration',\n        false,\n        'No Redis URL configured - using in-memory fallback'\n      );\n    } else {\n      addResult(\n        'Redis Configuration',\n        true,\n        'Redis URL is configured'\n      );\n    }\n  } catch (error: any) {\n    addResult(\n      'Rate Limiting',\n      false,\n      `Rate limiter error: ${error.message}`\n    );\n  }\n}\n\nasync function testSecurityMiddleware() {\n  console.log('\\nüîí Testing Security Middleware...\\n');\n\n  try {\n    const {\n      blockDevBypassesInProduction,\n      validateOrigin,\n      validateEmailDomain,\n      sanitizeInput\n    } = await import('../src/lib/security-middleware');\n\n    // Test dev bypass blocking\n    try {\n      blockDevBypassesInProduction();\n      addResult(\n        'Dev Bypass Blocking',\n        true,\n        'Dev bypasses are properly blocked'\n      );\n    } catch (error: any) {\n      addResult(\n        'Dev Bypass Blocking',\n        false,\n        `Dev bypass detected: ${error.message}`\n      );\n    }\n\n    // Test email domain validation\n    const validEmail = validateEmailDomain('student@buffalo.edu', 'buffalo.edu');\n    const invalidEmail = validateEmailDomain('hacker@evil.com', 'buffalo.edu');\n\n    if (validEmail && !invalidEmail) {\n      addResult(\n        'Email Domain Validation',\n        true,\n        'Email domain validation working correctly'\n      );\n    } else {\n      addResult(\n        'Email Domain Validation',\n        false,\n        'Email domain validation not working properly'\n      );\n    }\n\n    // Test input sanitization\n    const maliciousInput = {\n      name: 'Normal Name',\n      bio: '<script>alert(\"XSS\")</script>',\n      website: 'javascript:alert(\"XSS\")'\n    };\n\n    const sanitized = sanitizeInput(maliciousInput, ['name', 'bio', 'website']);\n\n    if (!sanitized.bio?.includes('<script>') && !sanitized.website?.includes('javascript:')) {\n      addResult(\n        'Input Sanitization',\n        true,\n        'XSS attempts are properly sanitized'\n      );\n    } else {\n      addResult(\n        'Input Sanitization',\n        false,\n        'XSS attempts not properly sanitized'\n      );\n    }\n  } catch (error: any) {\n    addResult(\n      'Security Middleware',\n      false,\n      `Security middleware error: ${error.message}`\n    );\n  }\n}\n\nasync function testCampusIsolation() {\n  console.log('\\nüè´ Testing Campus Isolation...\\n');\n\n  try {\n    const { validateCampusAccess } = await import('../src/lib/firebase');\n\n    // Test same campus access\n    const sameAccess = validateCampusAccess('ub-buffalo', 'ub-buffalo');\n    if (sameAccess) {\n      addResult(\n        'Same Campus Access',\n        true,\n        'Same campus access is allowed'\n      );\n    } else {\n      addResult(\n        'Same Campus Access',\n        false,\n        'Same campus access was blocked incorrectly'\n      );\n    }\n\n    // Test cross-campus access\n    const crossAccess = validateCampusAccess('ub-buffalo', 'harvard');\n    if (!crossAccess) {\n      addResult(\n        'Cross-Campus Block',\n        true,\n        'Cross-campus access is properly blocked'\n      );\n    } else {\n      addResult(\n        'Cross-Campus Block',\n        false,\n        'Cross-campus access was not blocked!'\n      );\n    }\n  } catch (error: any) {\n    addResult(\n      'Campus Isolation',\n      false,\n      `Campus isolation error: ${error.message}`\n    );\n  }\n}\n\nasync function printSummary() {\n  console.log('\\n' + '='.repeat(60));\n  console.log('SECURITY TEST SUMMARY');\n  console.log('='.repeat(60) + '\\n');\n\n  const passed = results.filter(r => r.passed).length;\n  const failed = results.filter(r => !r.passed).length;\n  const total = results.length;\n  const passRate = Math.round((passed / total) * 100);\n\n  console.log(`Total Tests: ${total}`);\n  console.log(`‚úÖ Passed: ${passed}`);\n  console.log(`‚ùå Failed: ${failed}`);\n  console.log(`Pass Rate: ${passRate}%\\n`);\n\n  if (failed > 0) {\n    console.log('Failed Tests:');\n    results.filter(r => !r.passed).forEach(r => {\n      console.log(`  ‚ùå ${r.name}: ${r.message}`);\n    });\n    console.log('');\n  }\n\n  // Determine security status\n  if (failed === 0) {\n    console.log('üéâ ALL SECURITY TESTS PASSED! Platform is secure.');\n  } else if (failed <= 2) {\n    console.log('‚ö†Ô∏è MINOR SECURITY ISSUES detected. Please review and fix.');\n  } else {\n    console.log('üö® CRITICAL SECURITY ISSUES detected! Do not deploy to production!');\n  }\n}\n\n// Run all tests\nasync function runSecurityTests() {\n  console.log('üîê HIVE Platform Security Test Suite');\n  console.log('=====================================\\n');\n  console.log(`Environment: ${process.env.NODE_ENV || 'development'}`);\n  console.log(`Timestamp: ${new Date().toISOString()}\\n`);\n\n  await testEnvironmentVariables();\n  await testFirebaseConnection();\n  await testRateLimiting();\n  await testSecurityMiddleware();\n  await testCampusIsolation();\n  await printSummary();\n\n  // Exit with appropriate code\n  const failed = results.filter(r => !r.passed).length;\n  process.exit(failed > 0 ? 1 : 0);\n}\n\n// Handle errors\nprocess.on('unhandledRejection', (error) => {\n  console.error('Unhandled rejection in security test:', error);\n  process.exit(1);\n});\n\n// Run tests\nrunSecurityTests().catch((error) => {\n  console.error('Security test suite failed:', error);\n  process.exit(1);\n});","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/admin/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FeedAlgorithmControl' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadDashboardData'. Either include it or remove the dependency array.","line":130,"column":6,"nodeType":"ArrayExpression","endLine":130,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [loadDashboardData, mounted]","fix":{"range":[3832,3841],"text":"[loadDashboardData, mounted]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@hive/ui';\nimport { Button } from '@hive/ui';\nimport { Badge } from '@hive/ui';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@hive/ui';\nimport { Alert, AlertDescription } from '@hive/ui';\nimport { Switch } from '@hive/ui';\nimport { useCSRF, protectedFetch } from '@/hooks/use-csrf';\nimport {\n  Users,\n  Home,\n  Settings,\n  Activity,\n  Flag,\n  TrendingUp,\n  AlertTriangle,\n  CheckCircle,\n  BarChart3,\n  Database,\n  Shield,\n  LineChart,\n  Bell,\n  Server\n} from 'lucide-react';\nimport { RealTimeModeration } from '@/components/admin/real-time-moderation';\nimport { ContentAnalytics } from '@/components/admin/content-analytics';\nimport { FeedAlgorithmControl } from '@/components/admin/feed-algorithm-control';\nimport { BehavioralAnalytics } from '@/components/admin/behavioral-analytics';\nimport { AdminGuard } from '@/components/admin/admin-guard';\nimport { FeedConfigurationPanel } from '@/components/admin/feed-configuration-panel';\nimport { RitualManagementPanel } from '@/components/admin/ritual-management-panel';\nimport { FirebaseMonitoring } from '@/components/admin/firebase-monitoring';\nimport { AlertDashboard } from '@/components/admin/alert-dashboard';\nimport { DatabasePerformanceDashboard } from '@/components/admin/database-performance-dashboard';\nimport CampusExpansionDashboard from '@/components/admin/campus-expansion-dashboard';\nimport CacheManagementDashboard from '@/components/admin/cache-management-dashboard';\n\ninterface AdminDashboardData {\n  platform: {\n    name: string;\n    version: string;\n    environment: string;\n    university: string;\n  };\n  statistics: {\n    users: {\n      total: number;\n      active: number;\n      inactive: number;\n      byMajor: Record<string, number>;\n      byYear: Record<string, number>;\n      growth?: {\n        lastWeek: number;\n        lastMonth: number;\n      };\n    };\n    spaces: {\n      total: number;\n      active: number;\n      dormant: number;\n      byType: Record<string, { total: number; members: number }>;\n      hasBuilders: number;\n      totalMembers: number;\n      activationRate: number;\n    };\n    builderRequests: {\n      total: number;\n      pending: number;\n      approved: number;\n      rejected: number;\n      urgent: number;\n      approvalRate: number;\n      averageResponseTime: number;\n    };\n    system: {\n      status: string;\n      uptime: number;\n      memory: { heapUsed: number; heapTotal: number } | null;\n      collections: {\n        users: number;\n        spaces: number;\n        builderRequests: number;\n      };\n    };\n  };\n}\n\ninterface FeatureFlag {\n  id: string;\n  name: string;\n  description: string;\n  category: 'core' | 'experimental' | 'infrastructure' | 'ui_ux' | 'tools' | 'spaces' | 'admin';\n  enabled: boolean;\n  rollout: {\n    type: 'all' | 'percentage' | 'users' | 'schools' | 'ab_test';\n    percentage?: number;\n    targetUsers?: string[];\n    targetSchools?: string[];\n  };\n  metadata: {\n    createdAt: string;\n    updatedAt: string;\n    updatedBy: string;\n    version: number;\n  };\n}\n\nfunction AdminDashboardInternal() {\n  const [dashboardData, setDashboardData] = useState<AdminDashboardData | null>(null);\n  const [featureFlags, setFeatureFlags] = useState<FeatureFlag[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [flagsLoading, setFlagsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [mounted, setMounted] = useState(false);\n  const { token: csrfToken, getHeaders } = useCSRF();\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  useEffect(() => {\n    if (mounted) {\n      loadDashboardData();\n    }\n  }, [mounted]);\n\n  if (!mounted) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  const loadDashboardData = async () => {\n    try {\n      setLoading(true);\n      const response = await protectedFetch('/api/admin/dashboard', {\n        headers: getHeaders()\n      }, csrfToken);\n      \n      if (!response.ok) {\n        throw new Error('Failed to load dashboard data');\n      }\n      \n      const data = await response.json() as AdminDashboardData;\n      setDashboardData(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadFeatureFlags = async () => {\n    try {\n      setFlagsLoading(true);\n      const response = await protectedFetch('/api/admin/feature-flags', {\n        headers: getHeaders()\n      }, csrfToken);\n      \n      if (!response.ok) {\n        throw new Error('Failed to load feature flags');\n      }\n      \n      const data = await response.json() as { flags?: FeatureFlag[] };\n      setFeatureFlags(data.flags || []);\n    } catch (err) {\n      console.error('Error loading feature flags:', err);\n      setFeatureFlags([]);\n    } finally {\n      setFlagsLoading(false);\n    }\n  };\n\n  const toggleFeatureFlag = async (flagId: string, enabled: boolean) => {\n    try {\n      const response = await protectedFetch(`/api/admin/feature-flags/${flagId}`, {\n        method: 'PATCH',\n        headers: getHeaders(),\n        body: JSON.stringify({ enabled }),\n      }, csrfToken);\n\n      if (!response.ok) {\n        throw new Error('Failed to update feature flag');\n      }\n\n      // Update local state\n      setFeatureFlags(prev => \n        prev.map(flag => \n          flag.id === flagId ? { ...flag, enabled } : flag\n        )\n      );\n    } catch (err) {\n      console.error('Error updating feature flag:', err);\n    }\n  };\n\n  const formatUptime = (seconds: number): string => {\n    const days = Math.floor(seconds / (24 * 60 * 60));\n    const hours = Math.floor((seconds % (24 * 60 * 60)) / (60 * 60));\n    const minutes = Math.floor((seconds % (60 * 60)) / 60);\n    \n    if (days > 0) return `${days}d ${hours}h ${minutes}m`;\n    if (hours > 0) return `${hours}h ${minutes}m`;\n    return `${minutes}m`;\n  };\n\n  const formatMemory = (bytes: number): string => {\n    return `${Math.round(bytes / 1024 / 1024)}MB`;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"container mx-auto px-4 py-8\">\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>\n            Failed to load admin dashboard: {error}\n          </AlertDescription>\n        </Alert>\n        <Button onClick={loadDashboardData} className=\"mt-4\">\n          Retry\n        </Button>\n      </div>\n    );\n  }\n\n  if (!dashboardData) {\n    return null;\n  }\n\n  const { platform, statistics } = dashboardData;\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 space-y-8\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">{platform.name} Admin Dashboard</h1>\n          <p className=\"text-muted-foreground\">\n            {platform.university} ‚Ä¢ Version {platform.version} ‚Ä¢ {platform.environment}\n          </p>\n        </div>\n        <Badge variant={platform.environment === 'production' ? 'default' : 'secondary'}>\n          {platform.environment.toUpperCase()}\n        </Badge>\n      </div>\n\n      {/* Quick Stats Grid */}\n      <div className=\"grid gap-4 md:grid-cols-3 lg:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Users</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{statistics.users.total}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {statistics.users.active} active ‚Ä¢ {statistics.users.inactive} inactive\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active Spaces</CardTitle>\n            <Home className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{statistics.spaces.active}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {statistics.spaces.activationRate}% activation rate\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Builder Requests</CardTitle>\n            <Settings className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{statistics.builderRequests.pending}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {statistics.builderRequests.urgent} urgent\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">System Status</CardTitle>\n            <Database className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center space-x-2\">\n              <div className={`w-3 h-3 rounded-full ${\n                statistics.system.status === 'healthy' ? 'bg-green-500' : 'bg-red-500'\n              }`} />\n              <span className=\"text-sm font-medium capitalize\">{statistics.system.status}</span>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Uptime: {formatUptime(statistics.system.uptime)}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Enhanced Alert Bar for Critical Issues */}\n      {statistics.builderRequests.urgent > 0 && (\n        <Alert className=\"bg-red-500/10 border-red-500/30\">\n          <Bell className=\"h-4 w-4 text-red-500\" />\n          <AlertDescription className=\"text-red-400\">\n            <strong>{statistics.builderRequests.urgent} urgent items</strong> require immediate attention\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Detailed Sections */}\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\n        <TabsList className=\"grid w-full grid-cols-10 bg-gray-900 border border-gray-800\">\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n          <TabsTrigger value=\"algorithm\" className=\"flex items-center gap-2\">\n            <Settings className=\"w-4 h-4\" />\n            Algorithm\n          </TabsTrigger>\n          <TabsTrigger value=\"rituals\" className=\"flex items-center gap-2\">\n            <Activity className=\"w-4 h-4\" />\n            Rituals\n          </TabsTrigger>\n          <TabsTrigger value=\"moderation\" className=\"flex items-center gap-2\">\n            <Shield className=\"w-4 h-4\" />\n            Moderation\n          </TabsTrigger>\n          <TabsTrigger value=\"analytics\" className=\"flex items-center gap-2\">\n            <LineChart className=\"w-4 h-4\" />\n            Analytics\n          </TabsTrigger>\n          <TabsTrigger value=\"infrastructure\" className=\"flex items-center gap-2\">\n            <Server className=\"w-4 h-4\" />\n            Infrastructure\n          </TabsTrigger>\n          <TabsTrigger value=\"users\">Users</TabsTrigger>\n          <TabsTrigger value=\"spaces\">Spaces</TabsTrigger>\n          <TabsTrigger value=\"flags\">Features</TabsTrigger>\n          <TabsTrigger value=\"system\">System</TabsTrigger>\n        </TabsList>\n\n        {/* Overview Tab - Quick Actions Dashboard */}\n        <TabsContent value=\"overview\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {/* Platform Health Score */}\n            <Card className=\"bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-500/30\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle>Platform Health Score</CardTitle>\n                  <div className=\"text-3xl font-bold text-green-400\">92/100</div>\n                </div>\n                <CardDescription>Overall platform performance and stability</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-gray-400\">User Engagement</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex-1 w-32 bg-gray-800 rounded-full h-2 overflow-hidden\">\n                        <div className=\"h-full bg-green-500\" style={{ width: '88%' }} />\n                      </div>\n                      <span className=\"text-xs text-gray-400\">88%</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-gray-400\">Content Quality</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex-1 w-32 bg-gray-800 rounded-full h-2 overflow-hidden\">\n                        <div className=\"h-full bg-blue-500\" style={{ width: '94%' }} />\n                      </div>\n                      <span className=\"text-xs text-gray-400\">94%</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-gray-400\">System Performance</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex-1 w-32 bg-gray-800 rounded-full h-2 overflow-hidden\">\n                        <div className=\"h-full bg-purple-500\" style={{ width: '96%' }} />\n                      </div>\n                      <span className=\"text-xs text-gray-400\">96%</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-gray-400\">Safety & Trust</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex-1 w-32 bg-gray-800 rounded-full h-2 overflow-hidden\">\n                        <div className=\"h-full bg-yellow-500\" style={{ width: '90%' }} />\n                      </div>\n                      <span className=\"text-xs text-gray-400\">90%</span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Quick Actions */}\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Quick Actions</CardTitle>\n                <CardDescription>Common administrative tasks</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid gap-3\">\n                  <Button className=\"w-full justify-start bg-[var(--hive-brand-primary)]/10 hover:bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border border-[var(--hive-brand-primary)]/30\">\n                    <Users className=\"w-4 h-4 mr-2\" />\n                    Review Builder Requests ({statistics.builderRequests.pending})\n                  </Button>\n                  <Button className=\"w-full justify-start\" variant=\"outline\">\n                    <Shield className=\"w-4 h-4 mr-2\" />\n                    Moderate Reported Content\n                  </Button>\n                  <Button className=\"w-full justify-start\" variant=\"outline\">\n                    <Activity className=\"w-4 h-4 mr-2\" />\n                    View Live Activity Feed\n                  </Button>\n                  <Button className=\"w-full justify-start\" variant=\"outline\">\n                    <BarChart3 className=\"w-4 h-4 mr-2\" />\n                    Generate Weekly Report\n                  </Button>\n                  <Button className=\"w-full justify-start\" variant=\"outline\">\n                    <Settings className=\"w-4 h-4 mr-2\" />\n                    Platform Settings\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Recent Activity Feed */}\n          <Card className=\"bg-gray-900/50 border-gray-800\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <CardTitle>Recent Admin Activity</CardTitle>\n                <Button className=\"max-w-sm\" variant=\"outline\">\n                  View All\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg\">\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-white\">Builder request approved for @jacoblee</p>\n                    <p className=\"text-xs text-gray-400\">2 minutes ago</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg\">\n                  <div className=\"w-2 h-2 bg-yellow-500 rounded-full\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-white\">Feature flag 'new_onboarding_flow' enabled</p>\n                    <p className=\"text-xs text-gray-400\">15 minutes ago</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg\">\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-white\">Content removed for policy violation</p>\n                    <p className=\"text-xs text-gray-400\">1 hour ago</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg\">\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-white\">System backup completed successfully</p>\n                    <p className=\"text-xs text-gray-400\">3 hours ago</p>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Algorithm Control Tab - Using Feed Configuration Panel */}\n        <TabsContent value=\"algorithm\" className=\"space-y-4\">\n          <FeedConfigurationPanel />\n        </TabsContent>\n\n        {/* Rituals Tab - Campus-wide Engagement Campaigns */}\n        <TabsContent value=\"rituals\" className=\"space-y-4\">\n          <RitualManagementPanel />\n        </TabsContent>\n\n        {/* Moderation Tab */}\n        <TabsContent value=\"moderation\" className=\"space-y-4\">\n          <RealTimeModeration />\n        </TabsContent>\n\n        {/* Analytics Tab */}\n        <TabsContent value=\"analytics\" className=\"space-y-4\">\n          <Tabs defaultValue=\"behavioral\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n              <TabsTrigger value=\"behavioral\">Behavioral Analytics</TabsTrigger>\n              <TabsTrigger value=\"content\">Content Analytics</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"behavioral\">\n              <BehavioralAnalytics />\n            </TabsContent>\n\n            <TabsContent value=\"content\">\n              <ContentAnalytics />\n            </TabsContent>\n          </Tabs>\n        </TabsContent>\n\n        {/* Infrastructure Tab - Complete Technical Infrastructure */}\n        <TabsContent value=\"infrastructure\" className=\"space-y-4\">\n          <Tabs defaultValue=\"monitoring\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-6 mb-6\">\n              <TabsTrigger value=\"monitoring\">Firebase Monitoring</TabsTrigger>\n              <TabsTrigger value=\"database\">Database Performance</TabsTrigger>\n              <TabsTrigger value=\"alerts\">Alert Dashboard</TabsTrigger>\n              <TabsTrigger value=\"expansion\">Campus Expansion</TabsTrigger>\n              <TabsTrigger value=\"cache\">Cache Management</TabsTrigger>\n              <TabsTrigger value=\"health\">System Health</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"monitoring\">\n              <FirebaseMonitoring />\n            </TabsContent>\n\n            <TabsContent value=\"database\">\n              <DatabasePerformanceDashboard />\n            </TabsContent>\n\n            <TabsContent value=\"alerts\">\n              <AlertDashboard />\n            </TabsContent>\n\n            <TabsContent value=\"expansion\">\n              <CampusExpansionDashboard />\n            </TabsContent>\n\n            <TabsContent value=\"cache\">\n              <CacheManagementDashboard />\n            </TabsContent>\n\n            <TabsContent value=\"health\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>System Health Overview</CardTitle>\n                  <CardDescription>Comprehensive health monitoring across all systems</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-4 md:grid-cols-2\">\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-medium text-white\">Infrastructure Status</h4>\n                      <div className=\"space-y-2\">\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Firebase Database</span>\n                          <Badge className=\"bg-green-500/20 text-green-400 border-green-500/30\">Healthy</Badge>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Authentication</span>\n                          <Badge className=\"bg-green-500/20 text-green-400 border-green-500/30\">Healthy</Badge>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">API Services</span>\n                          <Badge className=\"bg-yellow-500/20 text-yellow-400 border-yellow-500/30\">Degraded</Badge>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Email Service</span>\n                          <Badge className=\"bg-green-500/20 text-green-400 border-green-500/30\">Operational</Badge>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-medium text-white\">Performance Metrics</h4>\n                      <div className=\"space-y-2\">\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Avg Response Time</span>\n                          <span className=\"text-white\">142ms</span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Error Rate</span>\n                          <span className=\"text-white\">0.8%</span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Uptime</span>\n                          <span className=\"text-white\">99.94%</span>\n                        </div>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-gray-400\">Active Connections</span>\n                          <span className=\"text-white\">234</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </TabsContent>\n\n        <TabsContent value=\"users\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>User Distribution by Major</CardTitle>\n                <CardDescription>Top majors on the platform</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  {Object.entries(statistics.users.byMajor).slice(0, 5).map(([major, count]) => (\n                    <div key={major} className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">{major}</span>\n                      <Badge variant=\"secondary\">{count}</Badge>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>User Distribution by Year</CardTitle>\n                <CardDescription>Class year breakdown</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  {Object.entries(statistics.users.byYear).map(([year, count]) => (\n                    <div key={year} className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">{year}</span>\n                      <Badge variant=\"secondary\">{count}</Badge>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"spaces\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Space Statistics</CardTitle>\n                <CardDescription>Overview of all spaces</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between\">\n                    <span>Total Spaces</span>\n                    <span className=\"font-bold\">{statistics.spaces.total}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Active Spaces</span>\n                    <span className=\"font-bold text-green-600\">{statistics.spaces.active}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Dormant Spaces</span>\n                    <span className=\"font-bold text-yellow-600\">{statistics.spaces.dormant}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Total Members</span>\n                    <span className=\"font-bold\">{statistics.spaces.totalMembers}</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Spaces by Type</CardTitle>\n                <CardDescription>Distribution across space categories</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  {Object.entries(statistics.spaces.byType).map(([type, data]) => (\n                    <div key={type} className=\"flex justify-between items-center\">\n                      <span className=\"text-sm capitalize\">{type.replace(/_/g, ' ')}</span>\n                      <div className=\"flex space-x-2\">\n                        <Badge variant=\"secondary\">{data.total}</Badge>\n                        <Badge variant=\"secondary\">{data.members} members</Badge>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"requests\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Pending Requests</CardTitle>\n                <CardDescription>Builder role requests awaiting review</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-3xl font-bold text-yellow-600\">\n                  {statistics.builderRequests.pending}\n                </div>\n                {statistics.builderRequests.urgent > 0 && (\n                  <div className=\"flex items-center mt-2 text-red-600\">\n                    <AlertTriangle className=\"h-4 w-4 mr-1\" />\n                    <span className=\"text-sm\">{statistics.builderRequests.urgent} urgent</span>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Approval Rate</CardTitle>\n                <CardDescription>Historical approval percentage</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-3xl font-bold text-green-600\">\n                  {statistics.builderRequests.approvalRate}%\n                </div>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  {statistics.builderRequests.approved} approved, {statistics.builderRequests.rejected} rejected\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Response Time</CardTitle>\n                <CardDescription>Average time to review requests</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-3xl font-bold\">\n                  {statistics.builderRequests.averageResponseTime}h\n                </div>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  Average response time\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Quick Actions</CardTitle>\n              <CardDescription>Manage builder requests</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex space-x-4\">\n                <Button>\n                  <CheckCircle className=\"h-4 w-4 mr-2\" />\n                  Review Pending\n                </Button>\n                <Button variant=\"outline\">\n                  <BarChart3 className=\"h-4 w-4 mr-2\" />\n                  View Analytics\n                </Button>\n                <Button variant=\"outline\">\n                  <Activity className=\"h-4 w-4 mr-2\" />\n                  Export Data\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"flags\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Feature Flags Management</CardTitle>\n              <CardDescription>Control platform features and experiments</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex space-x-4 mb-6\">\n                <Button onClick={loadFeatureFlags} disabled={flagsLoading}>\n                  <Flag className=\"h-4 w-4 mr-2\" />\n                  {flagsLoading ? 'Loading...' : 'Refresh Flags'}\n                </Button>\n                <Button variant=\"outline\">\n                  <TrendingUp className=\"h-4 w-4 mr-2\" />\n                  View Analytics\n                </Button>\n                <Button variant=\"outline\">\n                  <Settings className=\"h-4 w-4 mr-2\" />\n                  Create Flag\n                </Button>\n              </div>\n\n              {flagsLoading ? (\n                <div className=\"flex items-center justify-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {featureFlags.length === 0 ? (\n                    <div className=\"text-center py-8 text-muted-foreground\">\n                      No feature flags found. Load flags or create your first flag.\n                    </div>\n                  ) : (\n                    <div className=\"grid gap-4\">\n                      {featureFlags.map((flag) => (\n                        <Card key={flag.id} className=\"border-l-4 border-l-blue-500\">\n                          <CardContent className=\"pt-6\">\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex-1\">\n                                <div className=\"flex items-center space-x-3 mb-2\">\n                                  <h3 className=\"font-semibold\">{flag.name}</h3>\n                                  <Badge variant={flag.category === 'experimental' ? 'secondary' : 'outline'}>\n                                    {flag.category.replace('_', ' ')}\n                                  </Badge>\n                                  <Badge variant={flag.enabled ? 'default' : 'secondary'}>\n                                    {flag.enabled ? 'Enabled' : 'Disabled'}\n                                  </Badge>\n                                </div>\n                                <p className=\"text-sm text-muted-foreground mb-3\">\n                                  {flag.description}\n                                </p>\n                                <div className=\"flex items-center space-x-4 text-xs text-muted-foreground\">\n                                  <span>ID: {flag.id}</span>\n                                  <span>Rollout: {flag.rollout.type}</span>\n                                  {flag.rollout.percentage && (\n                                    <span>{flag.rollout.percentage}% rollout</span>\n                                  )}\n                                  <span>v{flag.metadata.version}</span>\n                                </div>\n                              </div>\n                              <div className=\"flex items-center space-x-4\">\n                                <Switch\n                                  checked={flag.enabled}\n                                  onCheckedChange={(enabled: boolean) => toggleFeatureFlag(flag.id, enabled)}\n                                />\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"system\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>System Health</CardTitle>\n                <CardDescription>Current system status and metrics</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between\">\n                    <span>Status</span>\n                    <Badge variant={statistics.system.status === 'healthy' ? 'default' : 'destructive'}>\n                      {statistics.system.status}\n                    </Badge>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Uptime</span>\n                    <span>{formatUptime(statistics.system.uptime)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Memory Usage</span>\n                    <span>{formatMemory(statistics.system.memory?.heapUsed || 0)} / {formatMemory(statistics.system.memory?.heapTotal || 0)}</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Database Collections</CardTitle>\n                <CardDescription>Document counts in Firestore</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span>Users</span>\n                    <Badge variant=\"secondary\">{statistics.system.collections.users}</Badge>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Spaces</span>\n                    <Badge variant=\"secondary\">{statistics.system.collections.spaces}</Badge>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Builder Requests</span>\n                    <Badge variant=\"secondary\">{statistics.system.collections.builderRequests}</Badge>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n\n// Export wrapped with AdminGuard for security\nexport default function AdminDashboard() {\n  return (\n    <AdminGuard>\n      <AdminDashboardInternal />\n    </AdminGuard>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/auth/expired/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/auth/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/auth/verify/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/calendar/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/events/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/feed/page-storybook-migration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/feed/page-v2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/feed/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/hivelab/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tool' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":41,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useCallback } from 'react';\nimport { VisualToolComposer } from '@/components/tools/visual-tool-composer';\n\n// Define a simple Tool type for the builder\ninterface Tool {\n  id: string;\n  name: string;\n  description: string;\n}\nimport { PageContainer } from \"@/components/temp-stubs\";\nimport { Zap, Code, Palette, Database, BarChart3, Users, Rocket, ArrowLeft, Wrench } from 'lucide-react';\n\nexport default function HiveLabPage() {\n  const [mode, setMode] = useState<'overview' | 'visual' | 'template' | 'wizard'>('overview');\n  const [, setCurrentTool] = useState<Tool | null>(null);\n\n  // Handle tool saving\n  const handleToolSave = useCallback((tool: Tool) => {\n    // Handle async operation without returning promise\n    (async () => {\n      try {\n        // In a real app, this would save to the backend\n        \n        // Simulate API call\n        await new Promise(resolve => setTimeout(resolve, 1000));\n        \n        alert(`Tool \"${tool.name}\" saved successfully!`);\n        setCurrentTool(tool);\n      } catch (error) {\n        alert('Failed to save tool. Please try again.');\n      }\n    })();\n  }, []);\n\n  // Handle tool preview\n  const handleToolPreview = useCallback((tool: Tool) => {\n    // Preview is handled within the VisualToolBuilder\n  }, []);\n\n  // Handle mode selection\n  const handleModeSelect = useCallback((selectedMode: 'visual' | 'template' | 'wizard') => {\n    setMode(selectedMode);\n  }, []);\n\n  if (mode === 'visual') {\n    return (\n      <div className=\"h-screen flex flex-col\">\n        <div className=\"border-b border-[var(--hive-border-default)] bg-[var(--hive-background-primary)] px-4 py-2\">\n          <div className=\"flex items-center space-x-2\">\n            <button\n              onClick={() => setMode('overview')}\n              className=\"flex items-center space-x-2 text-[var(--hive-text-secondary)] hover:text-[var(--hive-text-primary)] transition-colors\"\n            >\n              <ArrowLeft className=\"w-4 h-4\" />\n              <span className=\"text-sm\">Back to HiveLab</span>\n            </button>\n            <span className=\"text-[var(--hive-text-tertiary)]\">|</span>\n            <span className=\"text-sm text-[var(--hive-text-primary)]\">Visual Builder</span>\n          </div>\n        </div>\n        <div className=\"flex-1\">\n          <VisualToolComposer\n            onSave={async (composition) => {\n              // Convert composition to Tool for the handler\n              const tool = {\n                id: composition.id,\n                name: composition.name,\n                description: composition.description\n              };\n              handleToolSave(tool);\n            }}\n            onPreview={(composition) => {\n              const tool = {\n                id: composition.id,\n                name: composition.name,\n                description: composition.description\n              };\n              handleToolPreview(tool);\n            }}\n            onCancel={() => {}}\n            userId=\"current-user\"\n          />\n        </div>\n      </div>\n    );\n  }\n  return (\n    <PageContainer title=\"HiveLAB\" maxWidth=\"xl\">\n      <div className=\"space-y-8\">\n        {/* Header */}\n        <div className=\"text-center space-y-4\">\n          <div className=\"flex items-center justify-center\">\n            <div className=\"w-16 h-16 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-2xl flex items-center justify-center\">\n              <Zap className=\"w-8 h-8 text-[var(--hive-background-primary)]\" />\n            </div>\n          </div>\n          <div>\n            <h1 className=\"text-4xl font-bold text-[var(--hive-text-primary)] mb-2\">\n              HiveLAB\n            </h1>\n            <p className=\"text-lg text-[var(--hive-text-secondary)] max-w-2xl mx-auto\">\n              Visual tool composer for campus utilities. Build with elements, deploy to spaces, solve real problems collaboratively.\n            </p>\n            <div className=\"flex items-center justify-center space-x-4 mt-4\">\n              <div className=\"flex items-center space-x-2 text-sm text-[var(--hive-text-secondary)]\">\n                <Code className=\"w-4 h-4 text-blue-400\" />\n                <span>No code required</span>\n              </div>\n              <div className=\"flex items-center space-x-2 text-sm text-[var(--hive-text-secondary)]\">\n                <Users className=\"w-4 h-4 text-green-400\" />\n                <span>Deploy to spaces</span>\n              </div>\n              <div className=\"flex items-center space-x-2 text-sm text-[var(--hive-text-secondary)]\">\n                <Palette className=\"w-4 h-4 text-purple-400\" />\n                <span>Element composition</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Quick Actions Grid */}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {/* Visual Builder - Element System */}\n          <div \n            onClick={() => handleModeSelect('visual')}\n            className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-yellow-400/50 transition-all duration-200 cursor-pointer\"\n          >\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-yellow-400/20 flex items-center justify-center\">\n                <Palette className=\"w-5 h-5 text-yellow-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Element Builder</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)] mb-4\">\n              Compose campus tools from visual elements - inputs, displays, filters, actions\n            </p>\n            <div className=\"flex items-center space-x-2 mb-3\">\n              <div className=\"text-xs bg-blue-400/20 text-blue-400 px-2 py-1 rounded\">8 Elements</div>\n              <div className=\"text-xs bg-green-400/20 text-green-400 px-2 py-1 rounded\">Drag & Drop</div>\n            </div>\n            <div className=\"text-xs text-yellow-400 font-medium\">üé≠ Most Unique HIVE Feature</div>\n          </div>\n\n          {/* Code Editor */}\n          <div className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-[var(--hive-border-hover)] transition-all duration-200 cursor-pointer\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-blue-400/20 flex items-center justify-center\">\n                <Code className=\"w-5 h-5 text-blue-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Code Editor</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)]\">\n              Advanced development environment for custom solutions\n            </p>\n          </div>\n\n          {/* Database Tools */}\n          <div className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-[var(--hive-border-hover)] transition-all duration-200 cursor-pointer\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-green-400/20 flex items-center justify-center\">\n                <Database className=\"w-5 h-5 text-green-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Database Tools</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)]\">\n              Manage data structures and integrations\n            </p>\n          </div>\n\n          {/* Analytics */}\n          <div className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-[var(--hive-border-hover)] transition-all duration-200 cursor-pointer\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-purple-400/20 flex items-center justify-center\">\n                <BarChart3 className=\"w-5 h-5 text-purple-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Analytics</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)]\">\n              Track usage and performance of your tools\n            </p>\n          </div>\n\n          {/* Templates */}\n          <div className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-[var(--hive-border-hover)] transition-all duration-200 cursor-pointer\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-orange-400/20 flex items-center justify-center\">\n                <Wrench className=\"w-5 h-5 text-orange-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Templates</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)]\">\n              Start with pre-built solutions for common use cases\n            </p>\n          </div>\n\n          {/* Collaboration */}\n          <div className=\"group p-6 rounded-xl border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)] hover:border-[var(--hive-border-hover)] transition-all duration-200 cursor-pointer\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-lg bg-pink-400/20 flex items-center justify-center\">\n                <Users className=\"w-5 h-5 text-pink-400\" />\n              </div>\n              <h3 className=\"font-semibold text-[var(--hive-text-primary)]\">Collaboration</h3>\n            </div>\n            <p className=\"text-sm text-[var(--hive-text-secondary)]\">\n              Work together on tools and share with your community\n            </p>\n          </div>\n        </div>\n\n        {/* Element System Showcase */}\n        <div className=\"space-y-4\">\n          <h2 className=\"text-xl font-semibold text-[var(--hive-text-primary)]\">Available Elements</h2>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            {/* Input Elements */}\n            <div className=\"p-4 rounded-lg border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)]\">\n              <div className=\"w-8 h-8 bg-blue-400/20 rounded-lg flex items-center justify-center mb-3\">\n                <Code className=\"w-4 h-4 text-blue-400\" />\n              </div>\n              <h4 className=\"font-medium text-[var(--hive-text-primary)] mb-1\">Input Elements</h4>\n              <p className=\"text-xs text-[var(--hive-text-secondary)]\">Text fields, buttons, selectors</p>\n            </div>\n            \n            {/* Display Elements */}\n            <div className=\"p-4 rounded-lg border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)]\">\n              <div className=\"w-8 h-8 bg-green-400/20 rounded-lg flex items-center justify-center mb-3\">\n                <BarChart3 className=\"w-4 h-4 text-green-400\" />\n              </div>\n              <h4 className=\"font-medium text-[var(--hive-text-primary)] mb-1\">Display Elements</h4>\n              <p className=\"text-xs text-[var(--hive-text-secondary)]\">Charts, lists, data views</p>\n            </div>\n            \n            {/* Filter Elements */}\n            <div className=\"p-4 rounded-lg border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)]\">\n              <div className=\"w-8 h-8 bg-purple-400/20 rounded-lg flex items-center justify-center mb-3\">\n                <Wrench className=\"w-4 h-4 text-purple-400\" />\n              </div>\n              <h4 className=\"font-medium text-[var(--hive-text-primary)] mb-1\">Filter Elements</h4>\n              <p className=\"text-xs text-[var(--hive-text-secondary)]\">Search, date range, categories</p>\n            </div>\n            \n            {/* Action Elements */}\n            <div className=\"p-4 rounded-lg border border-[var(--hive-border-default)] bg-[var(--hive-bg-secondary)]\">\n              <div className=\"w-8 h-8 bg-orange-400/20 rounded-lg flex items-center justify-center mb-3\">\n                <Zap className=\"w-4 h-4 text-orange-400\" />\n              </div>\n              <h4 className=\"font-medium text-[var(--hive-text-primary)] mb-1\">Action Elements</h4>\n              <p className=\"text-xs text-[var(--hive-text-secondary)]\">Submit, share, export, notify</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Call to Action */}\n        <div className=\"space-y-4\">\n          <div className=\"p-8 rounded-xl border border-[var(--hive-border-default)] bg-gradient-to-br from-[var(--hive-bg-secondary)] to-[var(--hive-background-primary)] text-center\">\n            <div className=\"w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center mx-auto mb-6\">\n              <Rocket className=\"w-6 h-6 text-white\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-[var(--hive-text-primary)] mb-2\">Build Your First Tool</h3>\n            <p className=\"text-[var(--hive-text-secondary)] mb-6 max-w-md mx-auto\">\n              Join the community of campus builders creating solutions that matter. No code required - just drag, drop, and deploy to your spaces.\n            </p>\n            <button\n              onClick={() => handleModeSelect('visual')}\n              className=\"px-6 py-3 bg-gradient-to-r from-yellow-400 to-yellow-600 text-white rounded-lg font-medium hover:opacity-90 transition-opacity\"\n            >\n              Start Building ‚Üí\n            </button>\n          </div>\n        </div>\n      </div>\n    </PageContainer>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/hivelab/variants/mock-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/landing/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/legal/community-guidelines/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/legal/privacy/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/legal/terms/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/not-found.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/notifications/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/hive-onboarding-wizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-academics-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-builder-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-completion-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-faculty-info-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-handle-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-interests-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-legal-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-name-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-photo-step.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":241,"column":15,"nodeType":"JSXOpeningElement","endLine":247,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-user-type-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/components/steps/hive-welcome-step.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/onboarding/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/[id]/ProfilePageContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ownPresenceStatus' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":22,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isGhostMode' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":22,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":57}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport { useParams, useRouter, notFound } from 'next/navigation';\nimport { ProfileViewLayout, specProfileToUIProfile } from \"@hive/ui\";\nimport { PresenceStatus } from \"@hive/ui\";\nimport { ErrorBoundary } from '@/components/error-boundary';\nimport { useSession } from '@/hooks/use-session';\nimport { useProfileContext } from '@/components/profile/ProfileContextProvider';\nimport type { SpecCompliantProfile } from '@hive/core';\nimport { db } from '@hive/core';\nimport { doc, onSnapshot } from 'firebase/firestore';\nimport type { PresenceData } from '@hive/core';\n\nexport default function ProfilePageContent() {\n  const params = useParams();\n  const router = useRouter();\n  const { user: currentUser } = useSession();\n  const profileId = params.id as string;\n\n  // Get presence data from context for current user\n  const { presenceStatus: ownPresenceStatus, isGhostMode } = useProfileContext();\n\n  const [profile, setProfile] = useState<SpecCompliantProfile | null>(null);\n  const [activities, setActivities] = useState<any[]>([]);\n  const [spaces, setSpaces] = useState<any[]>([]);\n  const [connections, setConnections] = useState<any[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Profile owner's presence data\n  const [profilePresenceStatus, setProfilePresenceStatus] = useState<PresenceStatus>('offline');\n  const [profileLastSeen, setProfileLastSeen] = useState<Date | null>(null);\n\n  // HiveLab-related state\n  const [isSpaceLeader, setIsSpaceLeader] = useState(false);\n  const [hasHiveLabAccess, setHasHiveLabAccess] = useState(false);\n  const [toolsCreated, setToolsCreated] = useState(0);\n  const [leadingSpaces, setLeadingSpaces] = useState<Array<{ id: string; name: string; memberCount: number }>>([]);\n\n  // Subscribe to profile owner's presence\n  useEffect(() => {\n    if (!profileId || profileId === currentUser?.id) return;\n\n    const presenceRef = doc(db, 'presence', profileId);\n    const unsubscribe = onSnapshot(presenceRef, (snapshot) => {\n      if (snapshot.exists()) {\n        const data = snapshot.data() as PresenceData;\n\n        // Check if the user is in ghost mode\n        if (data.isGhostMode) {\n          setProfilePresenceStatus('offline');\n        } else {\n          setProfilePresenceStatus(data.status as PresenceStatus);\n        }\n\n        if (data.lastSeen) {\n          setProfileLastSeen(data.lastSeen.toDate());\n        }\n      } else {\n        setProfilePresenceStatus('offline');\n      }\n    });\n\n    return () => unsubscribe();\n  }, [profileId, currentUser?.id]);\n\n  useEffect(() => {\n    const loadPublicProfile = async () => {\n      if (!profileId) return;\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Check if viewing own profile - redirect to edit page\n        const isOwnProfile = currentUser?.id === profileId;\n        if (isOwnProfile) {\n          router.push('/profile/edit');\n          return;\n        }\n\n        // Load public profile via our SPEC-compliant API\n        const response = await fetch(`/api/profile-v2/${profileId}`);\n\n        if (response.status === 404) {\n          notFound();\n          return;\n        }\n\n        if (response.status === 403) {\n          setError('This profile is private');\n          setIsLoading(false);\n          return;\n        }\n\n        const data = await response.json();\n        if (!data.success) {\n          throw new Error(data.error || 'Failed to load profile');\n        }\n\n        // Set the SPEC-compliant profile\n        setProfile(data.profile);\n\n        // Load additional data for widgets\n        setActivities(data.activities || []);\n        setSpaces(data.spaces || []);\n        setConnections(data.connections || []);\n\n        // Set HiveLab access data\n        setIsSpaceLeader(data.isSpaceLeader || false);\n        setHasHiveLabAccess(data.hasHiveLabAccess || false);\n        setToolsCreated(data.toolsCreated || 0);\n        setLeadingSpaces(data.leadingSpaces || []);\n\n        setIsLoading(false);\n\n      } catch (err) {\n        console.error('Failed to load public profile:', err);\n        setError(err instanceof Error ? err.message : 'Failed to load profile');\n        setIsLoading(false);\n      }\n    };\n\n    loadPublicProfile();\n  }, [profileId, currentUser, router]);\n\n  // Add presence status to connections\n  const connectionsWithPresence = connections.map(conn => ({\n    ...conn,\n    // TODO: Subscribe to each connection's presence in real app\n    presenceStatus: 'offline' as PresenceStatus,\n    lastSeen: new Date(Date.now() - 1000 * 60 * 30) // Mock: 30 mins ago\n  }));\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)] mx-auto mb-4\"></div>\n          <p className=\"text-white mb-2\">Loading profile...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-white mb-4\">Profile Not Available</h1>\n          <p className=\"text-gray-400 mb-6\">{error}</p>\n          <button\n            onClick={() => router.push('/spaces/browse')}\n            className=\"px-6 py-2 bg-[var(--hive-brand-primary)] text-black rounded-lg font-medium hover:bg-[var(--hive-brand-primary)]/90 transition-colors\"\n          >\n            Browse Spaces Instead\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Profile not found\n  if (!profile) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-white mb-4\">Profile Not Found</h1>\n          <p className=\"text-gray-400 mb-6\">This profile doesn't exist or has been removed.</p>\n          <button\n            onClick={() => router.push('/')}\n            className=\"px-6 py-2 bg-[var(--hive-brand-primary)] text-black rounded-lg font-medium hover:bg-[var(--hive-brand-primary)]/90 transition-colors\"\n          >\n            Go Home\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Convert to UI profile format for our components\n  const uiProfile = specProfileToUIProfile(profile);\n\n  return (\n    <ErrorBoundary>\n      <ProfileViewLayout\n        profile={uiProfile}\n        isOwnProfile={false}\n        presenceStatus={profilePresenceStatus}\n        lastSeen={profileLastSeen}\n        activities={activities}\n        spaces={spaces}\n        connections={connectionsWithPresence}\n        // HiveLab props\n        isSpaceLeader={isSpaceLeader}\n        hasHiveLabAccess={hasHiveLabAccess}\n        toolsCreated={toolsCreated}\n        leadingSpaces={leadingSpaces}\n        onRequestHiveLabAccess={() => router.push('/spaces/create')}\n        onOpenHiveLab={() => router.push('/tools')}\n      />\n    </ErrorBoundary>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/calendar/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteEvent' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":145,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":145,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dayEvents' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":387,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":387,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button, Card, Badge, Input, Textarea } from '@hive/ui';\nimport { useAuth } from '@hive/auth-logic';\nimport { db } from '@hive/core';\nimport {\n  collection,\n  query,\n  where,\n  orderBy,\n  onSnapshot,\n  doc,\n  setDoc,\n  deleteDoc,\n  serverTimestamp,\n  Timestamp\n} from 'firebase/firestore';\n\ninterface CalendarEvent {\n  id: string;\n  title: string;\n  description?: string;\n  startTime: Date;\n  endTime: Date;\n  location?: string;\n  type: 'class' | 'study' | 'social' | 'work' | 'personal';\n  recurring?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    until?: Date;\n  };\n  spaceId?: string;\n  spaceName?: string;\n  isPrivate: boolean;\n  attendees?: string[];\n  createdBy: string;\n}\n\ninterface TimeBlock {\n  hour: number;\n  events: CalendarEvent[];\n  isFreeTime: boolean;\n}\n\nexport default function CalendarPage() {\n  const { user } = useAuth();\n  const router = useRouter();\n\n  const [events, setEvents] = useState<CalendarEvent[]>([]);\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [viewMode, setViewMode] = useState<'day' | 'week' | 'month'>('week');\n  const [showAddEvent, setShowAddEvent] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  // New event form state\n  const [newEvent, setNewEvent] = useState({\n    title: '',\n    description: '',\n    startTime: '',\n    endTime: '',\n    location: '',\n    type: 'personal' as CalendarEvent['type'],\n    isPrivate: false\n  });\n\n  // Load calendar events\n  useEffect(() => {\n    if (!user) {\n      router.push('/auth/login');\n      return;\n    }\n\n    const eventsRef = collection(db, 'users', user.id, 'calendar');\n    const startOfWeek = new Date(currentDate);\n    startOfWeek.setDate(startOfWeek.getDate() - startOfWeek.getDay());\n    const endOfWeek = new Date(startOfWeek);\n    endOfWeek.setDate(endOfWeek.getDate() + 7);\n\n    const q = query(\n      eventsRef,\n      where('startTime', '>=', Timestamp.fromDate(startOfWeek)),\n      where('startTime', '<=', Timestamp.fromDate(endOfWeek)),\n      orderBy('startTime', 'asc')\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const eventsData: CalendarEvent[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        eventsData.push({\n          id: doc.id,\n          title: data.title,\n          description: data.description,\n          startTime: data.startTime.toDate(),\n          endTime: data.endTime.toDate(),\n          location: data.location,\n          type: data.type,\n          recurring: data.recurring,\n          spaceId: data.spaceId,\n          spaceName: data.spaceName,\n          isPrivate: data.isPrivate || false,\n          attendees: data.attendees,\n          createdBy: data.createdBy\n        });\n      });\n      setEvents(eventsData);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, [user, currentDate, router]);\n\n  // Create new event\n  const createEvent = async () => {\n    if (!user || !newEvent.title || !newEvent.startTime || !newEvent.endTime) return;\n\n    try {\n      const eventRef = doc(collection(db, 'users', user.id, 'calendar'));\n      await setDoc(eventRef, {\n        ...newEvent,\n        startTime: Timestamp.fromDate(new Date(newEvent.startTime)),\n        endTime: Timestamp.fromDate(new Date(newEvent.endTime)),\n        createdBy: user.id,\n        createdAt: serverTimestamp(),\n        campusId: 'ub-buffalo'\n      });\n\n      setShowAddEvent(false);\n      setNewEvent({\n        title: '',\n        description: '',\n        startTime: '',\n        endTime: '',\n        location: '',\n        type: 'personal',\n        isPrivate: false\n      });\n    } catch (error) {\n      console.error('Failed to create event:', error);\n    }\n  };\n\n  // Delete event\n  const deleteEvent = async (eventId: string) => {\n    if (!user) return;\n\n    try {\n      await deleteDoc(doc(db, 'users', user.id, 'calendar', eventId));\n    } catch (error) {\n      console.error('Failed to delete event:', error);\n    }\n  };\n\n  // Get events for a specific day\n  const getEventsForDay = (date: Date): CalendarEvent[] => {\n    return events.filter(event => {\n      const eventDate = new Date(event.startTime);\n      return eventDate.toDateString() === date.toDateString();\n    });\n  };\n\n  // Get free time blocks\n  const getFreeTimeBlocks = (date: Date): TimeBlock[] => {\n    const dayEvents = getEventsForDay(date);\n    const blocks: TimeBlock[] = [];\n\n    for (let hour = 8; hour < 22; hour++) {\n      const hourEvents = dayEvents.filter(event => {\n        const eventHour = new Date(event.startTime).getHours();\n        return eventHour === hour;\n      });\n\n      blocks.push({\n        hour,\n        events: hourEvents,\n        isFreeTime: hourEvents.length === 0\n      });\n    }\n\n    return blocks;\n  };\n\n  // Navigate dates\n  const navigateDate = (direction: 'prev' | 'next') => {\n    const newDate = new Date(currentDate);\n    if (viewMode === 'day') {\n      newDate.setDate(newDate.getDate() + (direction === 'next' ? 1 : -1));\n    } else if (viewMode === 'week') {\n      newDate.setDate(newDate.getDate() + (direction === 'next' ? 7 : -7));\n    } else {\n      newDate.setMonth(newDate.getMonth() + (direction === 'next' ? 1 : -1));\n    }\n    setCurrentDate(newDate);\n  };\n\n  // Get type color\n  const getTypeColor = (type: CalendarEvent['type']) => {\n    switch (type) {\n      case 'class': return 'bg-blue-500';\n      case 'study': return 'bg-green-500';\n      case 'social': return 'bg-purple-500';\n      case 'work': return 'bg-orange-500';\n      case 'personal': return 'bg-gray-500';\n      default: return 'bg-gray-500';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-white\">Loading calendar...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black text-white p-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8 flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold mb-2\">My Calendar</h1>\n            <p className=\"text-gray-400\">Manage your schedule and find free time</p>\n          </div>\n          <Button\n            onClick={() => setShowAddEvent(!showAddEvent)}\n            className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-[var(--hive-brand-primary)]/90\"\n          >\n            + Add Event\n          </Button>\n        </div>\n\n        {/* Add Event Form */}\n        {showAddEvent && (\n          <Card className=\"mb-6 p-6 bg-gray-900 border-white/8\">\n            <h3 className=\"text-lg font-semibold mb-4\">Add New Event</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Input\n                placeholder=\"Event title\"\n                value={newEvent.title}\n                onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, title: (e.target as any).value })}\n                className=\"bg-black border-white/20\"\n              />\n              <select\n                value={newEvent.type}\n                onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, type: (e.target as any).value as CalendarEvent['type'] })}\n                className=\"px-3 py-2 bg-black border border-white/20 rounded-lg\"\n              >\n                <option value=\"personal\">Personal</option>\n                <option value=\"class\">Class</option>\n                <option value=\"study\">Study</option>\n                <option value=\"social\">Social</option>\n                <option value=\"work\">Work</option>\n              </select>\n              <Input\n                type=\"datetime-local\"\n                placeholder=\"Start time\"\n                value={newEvent.startTime}\n                onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, startTime: (e.target as any).value })}\n                className=\"bg-black border-white/20\"\n              />\n              <Input\n                type=\"datetime-local\"\n                placeholder=\"End time\"\n                value={newEvent.endTime}\n                onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, endTime: (e.target as any).value })}\n                className=\"bg-black border-white/20\"\n              />\n              <Input\n                placeholder=\"Location (optional)\"\n                value={newEvent.location}\n                onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, location: (e.target as any).value })}\n                className=\"bg-black border-white/20\"\n              />\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"checkbox\"\n                  checked={newEvent.isPrivate}\n                  onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, isPrivate: e.target.checked })}\n                  className=\"rounded border-white/20\"\n                />\n                <label className=\"text-sm\">Private event</label>\n              </div>\n            </div>\n            <Textarea\n              placeholder=\"Description (optional)\"\n              value={newEvent.description}\n              onChange={(e: React.ChangeEvent) => setNewEvent({ ...newEvent, description: (e.target as any).value })}\n              className=\"mt-4 bg-black border-white/20\"\n              rows={3}\n            />\n            <div className=\"flex gap-2 mt-4\">\n              <Button\n                onClick={createEvent}\n                className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-[var(--hive-brand-primary)]/90\"\n              >\n                Create Event\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowAddEvent(false)}\n                className=\"border-white/20\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </Card>\n        )}\n\n        {/* Calendar Navigation */}\n        <div className=\"mb-6 flex justify-between items-center\">\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => navigateDate('prev')}\n              className=\"border-white/20\"\n            >\n              ‚Üê Previous\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => setCurrentDate(new Date())}\n              className=\"border-white/20\"\n            >\n              Today\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => navigateDate('next')}\n              className=\"border-white/20\"\n            >\n              Next ‚Üí\n            </Button>\n          </div>\n\n          <h2 className=\"text-xl font-semibold\">\n            {currentDate.toLocaleDateString('en-US', {\n              month: 'long',\n              year: 'numeric',\n              ...(viewMode === 'day' && { day: 'numeric' })\n            })}\n          </h2>\n\n          <div className=\"flex gap-2\">\n            <Button\n              variant={viewMode === 'day' ? 'default' : 'outline'}\n              onClick={() => setViewMode('day')}\n              className={`max-w-sm ${viewMode === 'day' ? 'bg-[var(--hive-brand-primary)] text-black' : 'border-white/20'}`}\n            >\n              Day\n            </Button>\n            <Button\n              variant={viewMode === 'week' ? 'default' : 'outline'}\n              onClick={() => setViewMode('week')}\n              className={`max-w-sm ${viewMode === 'week' ? 'bg-[var(--hive-brand-primary)] text-black' : 'border-white/20'}`}\n            >\n              Week\n            </Button>\n            <Button\n              variant={viewMode === 'month' ? 'default' : 'outline'}\n              onClick={() => setViewMode('month')}\n              className={`max-w-sm ${viewMode === 'month' ? 'bg-[var(--hive-brand-primary)] text-black' : 'border-white/20'}`}\n            >\n              Month\n            </Button>\n          </div>\n        </div>\n\n        {/* Calendar View */}\n        {viewMode === 'week' && (\n          <div className=\"grid grid-cols-8 gap-2\">\n            {/* Time column */}\n            <div className=\"space-y-2\">\n              <div className=\"h-12\"></div>\n              {Array.from({ length: 14 }, (_, i) => i + 8).map(hour => (\n                <div key={hour} className=\"h-20 text-xs text-gray-400 text-right pr-2\">\n                  {hour > 12 ? `${hour - 12}PM` : `${hour}AM`}\n                </div>\n              ))}\n            </div>\n\n            {/* Days */}\n            {Array.from({ length: 7 }, (_, i) => {\n              const date = new Date(currentDate);\n              date.setDate(date.getDate() - date.getDay() + i);\n              const dayEvents = getEventsForDay(date);\n\n              return (\n                <div key={i} className=\"space-y-2\">\n                  <div className=\"h-12 text-center\">\n                    <div className=\"text-xs text-gray-400\">\n                      {date.toLocaleDateString('en-US', { weekday: 'short' })}\n                    </div>\n                    <div className={`text-lg font-semibold ${\n                      date.toDateString() === new Date().toDateString() ? 'text-[var(--hive-brand-primary)]' : ''\n                    }`}>\n                      {date.getDate()}\n                    </div>\n                  </div>\n\n                  {/* Hour blocks */}\n                  {getFreeTimeBlocks(date).map((block) => (\n                    <div\n                      key={block.hour}\n                      className={`h-20 border border-white/8 rounded-lg p-1 ${\n                        block.isFreeTime ? 'bg-gray-900/50' : ''\n                      }`}\n                    >\n                      {block.events.map((event) => (\n                        <div\n                          key={event.id}\n                          className={`${getTypeColor(event.type)} text-xs p-1 rounded mb-1 cursor-pointer hover:opacity-80`}\n                          onClick={() => router.push(`/profile/calendar/event/${event.id}`)}\n                        >\n                          <div className=\"font-medium truncate\">{event.title}</div>\n                          {event.location && (\n                            <div className=\"text-white/70 truncate\">{event.location}</div>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  ))}\n                </div>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Free Time Finder */}\n        <Card className=\"mt-8 p-6 bg-gray-900 border-white/8\">\n          <h3 className=\"text-lg font-semibold mb-4\">Free Time This Week</h3>\n          <div className=\"space-y-2\">\n            {Array.from({ length: 7 }, (_, i) => {\n              const date = new Date(currentDate);\n              date.setDate(date.getDate() - date.getDay() + i);\n              const freeBlocks = getFreeTimeBlocks(date).filter(b => b.isFreeTime);\n\n              if (freeBlocks.length === 0) return null;\n\n              return (\n                <div key={i} className=\"flex items-center gap-4\">\n                  <div className=\"w-24 text-sm text-gray-400\">\n                    {date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}\n                  </div>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    {freeBlocks.slice(0, 3).map((block) => (\n                      <Badge\n                        key={block.hour}\n                        className=\"bg-green-900/20 text-green-400 border-green-400/50\"\n                      >\n                        {block.hour > 12 ? `${block.hour - 12}PM` : `${block.hour}AM`}\n                      </Badge>\n                    ))}\n                    {freeBlocks.length > 3 && (\n                      <Badge className=\"bg-gray-800 text-gray-400\">\n                        +{freeBlocks.length - 3} more\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/connections/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":9},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":296,"column":29,"nodeType":"JSXOpeningElement","endLine":300,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onRemoveConnection' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":369,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":369,"endColumn":21},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":385,"column":15,"nodeType":"JSXOpeningElement","endLine":389,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button, Input, Tabs, TabsContent, TabsList, TabsTrigger, Badge } from '@hive/ui';\nimport { useAuth } from '@hive/auth-logic';\nimport { db } from '@hive/core';\nimport {\n  collection,\n  query,\n  where,\n  orderBy,\n  onSnapshot,\n  doc,\n  setDoc,\n  deleteDoc,\n  serverTimestamp,\n  getDoc\n} from 'firebase/firestore';\n\ninterface Connection {\n  uid: string;\n  displayName: string;\n  avatarUrl?: string;\n  bio?: string;\n  major?: string;\n  gradYear?: number;\n  connectionStrength: number;\n  isFriend: boolean;\n  connectedAt: Date;\n  sharedSpaces: number;\n  mutualConnections: number;\n  lastInteraction?: Date;\n}\n\ninterface FriendRequest {\n  id: string;\n  fromUserId: string;\n  fromUserName: string;\n  fromUserAvatar?: string;\n  message?: string;\n  createdAt: Date;\n  status: 'pending' | 'accepted' | 'rejected';\n}\n\nexport default function ConnectionsPage() {\n  const { user } = useAuth();\n  const router = useRouter();\n\n  const [connections, setConnections] = useState<Connection[]>([]);\n  const [friendRequests, setFriendRequests] = useState<FriendRequest[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [activeTab, setActiveTab] = useState<'all' | 'friends' | 'requests'>('all');\n  const [loading, setLoading] = useState(true);\n\n  // Load connections\n  useEffect(() => {\n    if (!user) {\n      router.push('/auth/login');\n      return;\n    }\n\n    const connectionsRef = collection(db, 'users', user.id, 'connections');\n    const q = query(\n      connectionsRef,\n      where('campusId', '==', 'ub-buffalo'),\n      orderBy('connectionStrength', 'desc')\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const connectionsData: Connection[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        connectionsData.push({\n          uid: doc.id,\n          displayName: data.displayName,\n          avatarUrl: data.avatarUrl,\n          bio: data.bio,\n          major: data.major,\n          gradYear: data.gradYear,\n          connectionStrength: data.connectionStrength || 0,\n          isFriend: data.isFriend || false,\n          connectedAt: data.connectedAt?.toDate() || new Date(),\n          sharedSpaces: data.sharedSpaces || 0,\n          mutualConnections: data.mutualConnections || 0,\n          lastInteraction: data.lastInteraction?.toDate()\n        });\n      });\n      setConnections(connectionsData);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, [user, router]);\n\n  // Load friend requests\n  useEffect(() => {\n    if (!user) return;\n\n    const requestsRef = collection(db, 'users', user.id, 'friendRequests');\n    const q = query(\n      requestsRef,\n      where('status', '==', 'pending'),\n      orderBy('createdAt', 'desc')\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const requestsData: FriendRequest[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        requestsData.push({\n          id: doc.id,\n          fromUserId: data.fromUserId,\n          fromUserName: data.fromUserName,\n          fromUserAvatar: data.fromUserAvatar,\n          message: data.message,\n          createdAt: data.createdAt?.toDate() || new Date(),\n          status: data.status\n        });\n      });\n      setFriendRequests(requestsData);\n    });\n\n    return () => unsubscribe();\n  }, [user]);\n\n  const sendFriendRequest = async (connectionId: string) => {\n    if (!user) return;\n\n    try {\n      // Create friend request in recipient's collection\n      const requestRef = doc(collection(db, 'users', connectionId, 'friendRequests'));\n      await setDoc(requestRef, {\n        fromUserId: user.id,\n        fromUserName: user.displayName || 'HIVE User',\n        fromUserAvatar: user.photoURL,\n        message: 'Would like to be friends on HIVE',\n        status: 'pending',\n        createdAt: serverTimestamp(),\n        campusId: 'ub-buffalo'\n      });\n\n      // Update local connection to show pending request\n      setConnections(prev =>\n        prev.map(conn =>\n          conn.id === connectionId\n            ? { ...conn, friendRequestPending: true }\n            : conn\n        )\n      );\n    } catch (error) {\n      console.error('Failed to send friend request:', error);\n    }\n  };\n\n  const acceptFriendRequest = async (requestId: string, fromUserId: string) => {\n    if (!user) return;\n\n    try {\n      // Update request status\n      const requestRef = doc(db, 'users', user.id, 'friendRequests', requestId);\n      await setDoc(requestRef, { status: 'accepted' }, { merge: true });\n\n      // Update both users' connections to mark as friends\n      const myConnRef = doc(db, 'users', user.id, 'connections', fromUserId);\n      const theirConnRef = doc(db, 'users', fromUserId, 'connections', user.id);\n\n      await setDoc(myConnRef, { isFriend: true }, { merge: true });\n      await setDoc(theirConnRef, { isFriend: true }, { merge: true });\n\n      // Remove from pending requests\n      setFriendRequests(prev => prev.filter(req => req.id !== requestId));\n    } catch (error) {\n      console.error('Failed to accept friend request:', error);\n    }\n  };\n\n  const rejectFriendRequest = async (requestId: string) => {\n    if (!user) return;\n\n    try {\n      const requestRef = doc(db, 'users', user.id, 'friendRequests', requestId);\n      await deleteDoc(requestRef);\n      setFriendRequests(prev => prev.filter(req => req.id !== requestId));\n    } catch (error) {\n      console.error('Failed to reject friend request:', error);\n    }\n  };\n\n  const removeConnection = async (connectionId: string) => {\n    if (!user) return;\n\n    try {\n      const connRef = doc(db, 'users', user.id, 'connections', connectionId);\n      await deleteDoc(connRef);\n      setConnections(prev => prev.filter(conn => conn.id !== connectionId));\n    } catch (error) {\n      console.error('Failed to remove connection:', error);\n    }\n  };\n\n  // Filter connections based on search and tab\n  const filteredConnections = connections.filter(conn => {\n    const matchesSearch = conn.displayName.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesTab =\n      activeTab === 'all' ||\n      (activeTab === 'friends' && conn.isFriend) ||\n      (activeTab === 'requests' && friendRequests.length > 0);\n    return matchesSearch && matchesTab;\n  });\n\n  // Connection strength indicator\n  const getStrengthColor = (strength: number) => {\n    if (strength >= 80) return 'bg-green-500';\n    if (strength >= 60) return 'bg-yellow-500';\n    if (strength >= 40) return 'bg-orange-500';\n    return 'bg-gray-500';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-white\">Loading connections...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black text-white p-8\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Connections & Friends</h1>\n          <p className=\"text-gray-400\">Manage your HIVE network</p>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">\n          <div className=\"bg-gray-900 border border-white/8 rounded-lg p-4\">\n            <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">{connections.length}</div>\n            <div className=\"text-sm text-gray-400\">Total Connections</div>\n          </div>\n          <div className=\"bg-gray-900 border border-white/8 rounded-lg p-4\">\n            <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">\n              {connections.filter(c => c.isFriend).length}\n            </div>\n            <div className=\"text-sm text-gray-400\">Friends</div>\n          </div>\n          <div className=\"bg-gray-900 border border-white/8 rounded-lg p-4\">\n            <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">{friendRequests.length}</div>\n            <div className=\"text-sm text-gray-400\">Pending Requests</div>\n          </div>\n          <div className=\"bg-gray-900 border border-white/8 rounded-lg p-4\">\n            <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">\n              {Math.round(connections.reduce((acc, c) => acc + c.connectionStrength, 0) / connections.length) || 0}%\n            </div>\n            <div className=\"text-sm text-gray-400\">Avg Connection Strength</div>\n          </div>\n        </div>\n\n        {/* Search and Tabs */}\n        <div className=\"mb-6\">\n          <Input\n            placeholder=\"Search connections...\"\n            value={searchQuery}\n            onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n            className=\"mb-4 bg-gray-900 border-white/8\"\n          />\n\n          <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as any)}>\n            <TabsList className=\"bg-gray-900\">\n              <TabsTrigger value=\"all\">All Connections</TabsTrigger>\n              <TabsTrigger value=\"friends\">Friends</TabsTrigger>\n              <TabsTrigger value=\"requests\">\n                Friend Requests {friendRequests.length > 0 && (\n                  <Badge className=\"ml-2 bg-[var(--hive-brand-primary)] text-black\">{friendRequests.length}</Badge>\n                )}\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"requests\" className=\"mt-6\">\n              {friendRequests.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-400\">\n                  No pending friend requests\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {friendRequests.map((request) => (\n                    <div\n                      key={request.id}\n                      className=\"bg-gray-900 border border-white/8 rounded-lg p-4 flex items-center justify-between\"\n                    >\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center\">\n                          {request.fromUserAvatar ? (\n                            <img\n                              src={request.fromUserAvatar}\n                              alt={request.fromUserName}\n                              className=\"w-full h-full rounded-full object-cover\"\n                            />\n                          ) : (\n                            <span className=\"text-xl\">üë§</span>\n                          )}\n                        </div>\n                        <div>\n                          <div className=\"font-medium\">{request.fromUserName}</div>\n                          <div className=\"text-sm text-gray-400\">{request.message}</div>\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button\n                          className=\"max-w-sm bg-[var(--hive-brand-primary)] text-black hover:bg-[var(--hive-brand-primary)]/90\"\n                          onClick={() => acceptFriendRequest(request.id, request.fromUserId)}\n                        >\n                          Accept\n                        </Button>\n                        <Button\n                          className=\"max-w-sm border-white/20\"\n                          variant=\"outline\"\n                          onClick={() => rejectFriendRequest(request.id)}\n                        >\n                          Decline\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            <TabsContent value=\"all\" className=\"mt-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {filteredConnections.map((connection) => (\n                  <ConnectionCard\n                    key={connection.id}\n                    connection={connection}\n                    onSendFriendRequest={sendFriendRequest}\n                    onRemoveConnection={removeConnection}\n                    getStrengthColor={getStrengthColor}\n                  />\n                ))}\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"friends\" className=\"mt-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {filteredConnections.filter(c => c.isFriend).map((connection) => (\n                  <ConnectionCard\n                    key={connection.id}\n                    connection={connection}\n                    onSendFriendRequest={sendFriendRequest}\n                    onRemoveConnection={removeConnection}\n                    getStrengthColor={getStrengthColor}\n                  />\n                ))}\n              </div>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Connection Card Component\nfunction ConnectionCard({\n  connection,\n  onSendFriendRequest,\n  onRemoveConnection,\n  getStrengthColor\n}: {\n  connection: Connection;\n  onSendFriendRequest: (id: string) => void;\n  onRemoveConnection: (id: string) => void;\n  getStrengthColor: (strength: number) => string;\n}) {\n  const router = useRouter();\n\n  return (\n    <div className=\"bg-gray-900 border border-white/8 rounded-lg p-4\">\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center\">\n            {connection.avatarUrl ? (\n              <img\n                src={connection.avatarUrl}\n                alt={connection.displayName}\n                className=\"w-full h-full rounded-full object-cover\"\n              />\n            ) : (\n              <span className=\"text-xl\">üë§</span>\n            )}\n          </div>\n          <div>\n            <div className=\"font-medium\">{connection.displayName}</div>\n            {connection.major && (\n              <div className=\"text-xs text-gray-400\">\n                {connection.major} {connection.gradYear && `'${connection.gradYear % 100}`}\n              </div>\n            )}\n          </div>\n        </div>\n        {connection.isFriend && (\n          <Badge className=\"bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-[var(--hive-brand-primary)]/50\">\n            Friend\n          </Badge>\n        )}\n      </div>\n\n      {/* Connection Strength */}\n      <div className=\"mb-3\">\n        <div className=\"flex justify-between text-xs mb-1\">\n          <span className=\"text-gray-400\">Connection Strength</span>\n          <span className=\"text-gray-400\">{connection.connectionStrength}%</span>\n        </div>\n        <div className=\"w-full bg-gray-800 rounded-full h-1.5\">\n          <div\n            className={`h-full rounded-full ${getStrengthColor(connection.connectionStrength)}`}\n            style={{ width: `${connection.connectionStrength}%` }}\n          />\n        </div>\n      </div>\n\n      {/* Stats */}\n      <div className=\"flex justify-between text-xs text-gray-400 mb-3\">\n        <span>{connection.sharedSpaces} shared spaces</span>\n        <span>{connection.mutualConnections} mutual</span>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex gap-2\">\n        <Button\n          className=\"max-w-sm flex-1 border-white/20\"\n          variant=\"outline\"\n          onClick={() => router.push(`/profile/${connection.id}`)}\n        >\n          View Profile\n        </Button>\n        {!connection.isFriend && (\n          <Button\n            className=\"max-w-sm flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-[var(--hive-brand-primary)]/90\"\n            onClick={() => onSendFriendRequest(connection.id)}\n          >\n            Add Friend\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/edit/page-storybook-migration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/edit/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSaving' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":30,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n/**\n * SPEC-COMPLIANT PROFILE EDIT PAGE\n *\n * Per SPEC.md:\n * - NO HANDLE DISPLAY: Handles are backend only\n * - CAMPUS ISOLATION: All data filtered by campusId: 'ub-buffalo'\n * - PRIVACY WIDGETS: Per-widget privacy controls\n * - 70% COMPLETION: Behavioral psychology hooks\n */\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ProfileViewLayout, specProfileToUIProfile } from \"@hive/ui\";\nimport { useSession } from '@/hooks/use-session';\nimport { useToast } from '@/hooks/use-toast';\nimport type { SpecCompliantProfile } from '@hive/core';\n\nexport default function EditProfilePage() {\n  const router = useRouter();\n  const { user: currentUser } = useSession();\n  const { toast } = useToast();\n\n  const [profile, setProfile] = useState<SpecCompliantProfile | null>(null);\n  const [activities, setActivities] = useState<any[]>([]);\n  const [spaces, setSpaces] = useState<any[]>([]);\n  const [connections, setConnections] = useState<any[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n\n  // HiveLab-related state\n  const [isSpaceLeader, setIsSpaceLeader] = useState(false);\n  const [hasHiveLabAccess, setHasHiveLabAccess] = useState(false);\n  const [toolsCreated, setToolsCreated] = useState(0);\n  const [leadingSpaces, setLeadingSpaces] = useState<Array<{ id: string; name: string; memberCount: number }>>([]);\n\n  useEffect(() => {\n    const loadOwnProfile = async () => {\n      if (!currentUser?.id) {\n        router.push('/auth/login');\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n\n        // Load own profile via SPEC-compliant API\n        const response = await fetch('/api/profile-v2', {\n          credentials: 'include'\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to load profile');\n        }\n\n        const data = await response.json();\n        if (!data.success) {\n          throw new Error(data.error || 'Failed to load profile');\n        }\n\n        setProfile(data.profile);\n        setActivities(data.activities || []);\n        setSpaces(data.spaces || []);\n        setConnections(data.connections || []);\n\n        // Set HiveLab access data\n        // SPEC: Space Leaders ONLY get build access\n        setIsSpaceLeader(data.isSpaceLeader || false);\n        setHasHiveLabAccess(data.hasHiveLabAccess || false);\n        setToolsCreated(data.toolsCreated || 0);\n        setLeadingSpaces(data.leadingSpaces || []);\n        setIsLoading(false);\n\n      } catch (err) {\n        console.error('Failed to load profile:', err);\n        toast({\n          title: 'Error',\n          description: 'Failed to load your profile',\n          variant: 'destructive'\n        });\n        setIsLoading(false);\n      }\n    };\n\n    loadOwnProfile();\n  }, [currentUser, router, toast]);\n\n  const handleEditPhoto = () => {\n    // TODO: Implement photo upload modal\n    toast({\n      title: 'Coming Soon',\n      description: 'Photo upload will be available soon',\n      type: 'info'\n    });\n  };\n\n  const handlePrivacyChange = async (widget: string, level: 'public' | 'connections' | 'private') => {\n    if (!profile) return;\n\n    try {\n      setIsSaving(true);\n\n      // Map widget and level to privacy settings\n      const privacyUpdate: any = {};\n      if (widget === 'email') {\n        privacyUpdate.showEmail = level !== 'private';\n      } else if (widget === 'schedule') {\n        privacyUpdate.showSchedule = level !== 'private';\n      } else if (widget === 'profile') {\n        privacyUpdate.profileVisibility = level === 'public' ? 'public' : level === 'connections' ? 'connections' : 'private';\n      }\n\n      const response = await fetch('/api/profile-v2', {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          privacy: {\n            ...profile.privacy,\n            ...privacyUpdate\n          }\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to update privacy settings');\n      }\n\n      const data = await response.json();\n      setProfile(data.profile);\n\n      toast({\n        title: 'Privacy Updated',\n        description: `${widget} visibility set to ${level}`,\n        type: 'success'\n      });\n\n    } catch (err) {\n      console.error('Failed to update privacy:', err);\n      toast({\n        title: 'Error',\n        description: 'Failed to update privacy settings',\n        variant: 'destructive'\n      });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleStepClick = async (stepId: string) => {\n    // Navigate to appropriate section for completing profile\n    switch (stepId) {\n      case 'avatar':\n        handleEditPhoto();\n        break;\n      case 'bio':\n        // TODO: Open bio edit modal\n        break;\n      case 'academic':\n        // TODO: Open academic info modal\n        break;\n      case 'housing':\n        // TODO: Open housing selection\n        break;\n      case 'interests':\n        // TODO: Open interests picker\n        break;\n      case 'spaces':\n        router.push('/spaces/browse');\n        break;\n      default:\n        break;\n    }\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)] mx-auto mb-4\"></div>\n          <p className=\"text-white mb-2\">Loading your profile...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Not logged in\n  if (!currentUser) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-white mb-4\">Sign In Required</h1>\n          <p className=\"text-gray-400 mb-6\">Please sign in to edit your profile</p>\n          <button\n            onClick={() => router.push('/auth/login')}\n            className=\"px-6 py-2 bg-[var(--hive-brand-primary)] text-black rounded-lg font-medium hover:bg-[var(--hive-brand-primary)]/90 transition-colors\"\n          >\n            Sign In\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // No profile data\n  if (!profile) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-white mb-4\">Profile Setup Required</h1>\n          <p className=\"text-gray-400 mb-6\">Let's set up your profile first</p>\n          <button\n            onClick={() => router.push('/onboarding')}\n            className=\"px-6 py-2 bg-[var(--hive-brand-primary)] text-black rounded-lg font-medium hover:bg-[var(--hive-brand-primary)]/90 transition-colors\"\n          >\n            Complete Setup\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Convert to UI profile format for our components\n  const uiProfile = specProfileToUIProfile(profile);\n\n  return (\n    <ProfileViewLayout\n      profile={uiProfile}\n      isOwnProfile={true}\n      activities={activities}\n      spaces={spaces}\n      connections={connections}\n      onEditPhoto={handleEditPhoto}\n      onPrivacyChange={handlePrivacyChange}\n      onStepClick={handleStepClick}\n      // HiveLab props\n      isSpaceLeader={isSpaceLeader}\n      hasHiveLabAccess={hasHiveLabAccess}\n      toolsCreated={toolsCreated}\n      leadingSpaces={leadingSpaces}\n      onRequestHiveLabAccess={() => router.push('/spaces/create')}\n      onOpenHiveLab={() => router.push('/tools')}\n    />\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/settings/page-storybook-migration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/profile/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/providers.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'firebaseIntegration' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\nimport React, { useState } from 'react';\nimport ErrorProvider from '../components/error-provider';\nimport createFirebaseAuthIntegration from '../lib/firebase-auth-integration';\nimport { SimpleAuthProvider } from '../components/auth/simple-auth-provider';\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const [queryClient] = useState(() => new QueryClient({\n    defaultOptions: {\n      queries: {\n        staleTime: 60 * 1000, // 1 minute\n        retry: 1,\n      },\n    },\n  }));\n\n  const [firebaseIntegration] = useState(() => {\n    // Only create Firebase integration on client-side\n    if (typeof window !== 'undefined') {\n      try {\n        return createFirebaseAuthIntegration();\n      } catch (error) {\n        console.warn('Firebase auth integration failed to initialize:', error);\n        return undefined;\n      }\n    }\n    return undefined;\n  });\n\n  // Navigation is now handled by NavigationLayout in layout.tsx\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ErrorProvider>\n        <SimpleAuthProvider>\n          {children}\n          <ReactQueryDevtools initialIsOpen={false} />\n        </SimpleAuthProvider>\n      </ErrorProvider>\n    </QueryClientProvider>\n  );\n} ","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/resources/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/rituals/[ritualId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/rituals/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/schools/components/school-search.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/schools/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport React, { useState, useEffect } from 'react';\n// import { useRouter } from 'next/navigation';\nimport { Search, Users, ArrowRight, MapPin } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Button } from '@hive/ui';\nimport { SchoolsPageHeader } from '../../components/temp-stubs';\n\n\ninterface School {\n  id: string;\n  name: string;\n  domain: string;\n  location: string;\n  signupCount?: number;\n  activationThreshold?: number;\n  isActive?: boolean;\n  isComingSoon?: boolean;\n  status?: 'active' | 'waitlist' | 'inactive';\n}\n\n// Fallback for development only\nconst fallbackSchools: School[] = [\n  // Development Test School - Always first for easy access\n  {\n    id: 'test-university',\n    name: 'Test University (Development)',\n    domain: 'test.edu',\n    location: 'Development, NY',\n    signupCount: 999,\n    activationThreshold: 350,\n    isActive: true,\n  },\n  // SUNY Schools - Major Campuses\n  {\n    id: 'ub',\n    name: 'University at Buffalo',\n    domain: 'buffalo.edu',\n    location: 'Buffalo, NY',\n    signupCount: 350,\n    activationThreshold: 350,\n    isActive: true,\n  },\n  {\n    id: 'stonybrook',\n    name: 'Stony Brook University',\n    domain: 'stonybrook.edu',\n    location: 'Stony Brook, NY',\n    signupCount: 312,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'binghamton',\n    name: 'Binghamton University',\n    domain: 'binghamton.edu',\n    location: 'Binghamton, NY',\n    signupCount: 298,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'albany',\n    name: 'University at Albany',\n    domain: 'albany.edu',\n    location: 'Albany, NY',\n    signupCount: 267,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'newpaltz',\n    name: 'SUNY New Paltz',\n    domain: 'newpaltz.edu',\n    location: 'New Paltz, NY',\n    signupCount: 189,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'geneseo',\n    name: 'SUNY Geneseo',\n    domain: 'geneseo.edu',\n    location: 'Geneseo, NY',\n    signupCount: 156,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'oswego',\n    name: 'SUNY Oswego',\n    domain: 'oswego.edu',\n    location: 'Oswego, NY',\n    signupCount: 134,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'brockport',\n    name: 'SUNY Brockport',\n    domain: 'brockport.edu',\n    location: 'Brockport, NY',\n    signupCount: 112,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'cortland',\n    name: 'SUNY Cortland',\n    domain: 'cortland.edu',\n    location: 'Cortland, NY',\n    signupCount: 98,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'plattsburgh',\n    name: 'SUNY Plattsburgh',\n    domain: 'plattsburgh.edu',\n    location: 'Plattsburgh, NY',\n    signupCount: 87,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'oneonta',\n    name: 'SUNY Oneonta',\n    domain: 'oneonta.edu',\n    location: 'Oneonta, NY',\n    signupCount: 76,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'potsdam',\n    name: 'SUNY Potsdam',\n    domain: 'potsdam.edu',\n    location: 'Potsdam, NY',\n    signupCount: 65,\n    activationThreshold: 350,\n    isActive: false,\n  },\n\n  // Private Universities in NY\n  {\n    id: 'nyu',\n    name: 'New York University',\n    domain: 'nyu.edu',\n    location: 'New York, NY',\n    signupCount: 289,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'cornell',\n    name: 'Cornell University',\n    domain: 'cornell.edu',\n    location: 'Ithaca, NY',\n    signupCount: 234,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'columbia',\n    name: 'Columbia University',\n    domain: 'columbia.edu',\n    location: 'New York, NY',\n    signupCount: 187,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'syracuse',\n    name: 'Syracuse University',\n    domain: 'syr.edu',\n    location: 'Syracuse, NY',\n    signupCount: 176,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'rochester',\n    name: 'University of Rochester',\n    domain: 'rochester.edu',\n    location: 'Rochester, NY',\n    signupCount: 145,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'fordham',\n    name: 'Fordham University',\n    domain: 'fordham.edu',\n    location: 'Bronx, NY',\n    signupCount: 123,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'hofstra',\n    name: 'Hofstra University',\n    domain: 'hofstra.edu',\n    location: 'Hempstead, NY',\n    signupCount: 98,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'pace',\n    name: 'Pace University',\n    domain: 'pace.edu',\n    location: 'New York, NY',\n    signupCount: 87,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'rpi',\n    name: 'Rensselaer Polytechnic Institute',\n    domain: 'rpi.edu',\n    location: 'Troy, NY',\n    signupCount: 76,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'stjohns',\n    name: \"St. John's University\",\n    domain: 'stjohns.edu',\n    location: 'Queens, NY',\n    signupCount: 65,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'adelphi',\n    name: 'Adelphi University',\n    domain: 'adelphi.edu',\n    location: 'Garden City, NY',\n    signupCount: 54,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'marist',\n    name: 'Marist College',\n    domain: 'marist.edu',\n    location: 'Poughkeepsie, NY',\n    signupCount: 43,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'iona',\n    name: 'Iona University',\n    domain: 'iona.edu',\n    location: 'New Rochelle, NY',\n    signupCount: 32,\n    activationThreshold: 350,\n    isActive: false,\n  },\n  {\n    id: 'manhattan',\n    name: 'Manhattan College',\n    domain: 'manhattan.edu',\n    location: 'Riverdale, NY',\n    signupCount: 21,\n    activationThreshold: 350,\n    isActive: false,\n  },\n];\n\nexport default function SchoolsPage() {\n  // const router = useRouter();\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isComingSoonOpen, setIsComingSoonOpen] = useState(false);\n  const [schools, setSchools] = useState<School[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  // Fetch schools from API\n  useEffect(() => {\n    async function fetchSchools() {\n      try {\n        const response = await fetch('/api/schools');\n        if (response.ok) {\n          const schoolsData = await response.json();\n          const formattedSchools = schoolsData\n            .filter((school: any) => school && school.name && school.location)\n            .map((school: any) => {\n              // Handle location field - convert object to string if needed\n              let locationString = school.location;\n              if (typeof school.location === 'object' && school.location !== null) {\n                // Convert {city, state, country} object to string\n                const { city, state, country } = school.location;\n                locationString = [city, state, country].filter(Boolean).join(', ');\n              }\n              \n              return {\n                ...school,\n                location: locationString,\n                isActive: school.status === 'active',\n                isComingSoon: school.status === 'waitlist',\n                signupCount: school.signupCount || 0,\n                activationThreshold: school.activationThreshold || 350\n              };\n            });\n          setSchools(formattedSchools);\n        } else {\n          // Fallback to hardcoded data only in development\n          console.warn('Failed to fetch schools from API, using fallback');\n          setSchools(fallbackSchools);\n        }\n      } catch (_error) {\n        console.error('Error fetching schools:', _error);\n        setSchools(fallbackSchools);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchSchools();\n  }, []);\n\n  const filteredSchools = schools.filter(school => {\n    if (!school || !school.name || !school.location) return false;\n    return school.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n           school.location.toLowerCase().includes(searchTerm.toLowerCase());\n  });\n\n  const handleSchoolSelect = (school: School) => {\n    if (school.isActive) {\n      const params = new URLSearchParams({\n        schoolId: school.id,\n        schoolName: school.name,\n        domain: school.domain,\n      });\n      // Use window.location for more reliable navigation in E2E tests\n      window.location.href = `/auth/login?${params.toString()}`;\n    }\n  };\n\n  if (!isMounted) {\n    return (\n      <div className=\"relative min-h-screen overflow-hidden hive-font-sans bg-hive-background-primary text-hive-text-primary\" \n           style={{ backgroundColor: '#0A0A0B', color: '#F5F5F7' }}>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"w-6 h-6 border-2 border-white/20 border-t-white/60 rounded-full animate-spin\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <React.Fragment>\n      <motion.div \n        className=\"relative min-h-screen overflow-hidden hive-font-sans bg-hive-background-primary text-hive-text-primary\" \n        style={{ backgroundColor: '#0A0A0B', color: '#F5F5F7' }}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        transition={{ duration: 0.3, ease: [0.23, 1, 0.32, 1] }}\n      >\n      {/* Enhanced Glassy Background */}\n      <div className=\"absolute inset-0\" style={{ \n        background: 'radial-gradient(circle at 30% 40%, rgba(255, 255, 255, 0.02) 0%, transparent 50%), radial-gradient(circle at 70% 60%, rgba(255, 191, 0, 0.03) 0%, transparent 50%)',\n        backdropFilter: 'blur(40px)'\n      }} />\n      \n      {/* Header */}\n      <SchoolsPageHeader onComingSoonClick={() => setIsComingSoonOpen(true)} />\n\n      {/* Main Content */}\n      <div className=\"relative z-10 max-w-6xl mx-auto p-6 py-12\">\n        <div className=\"text-center mb-16\">\n          <h1 className=\"hive-font-sans text-4xl md:text-5xl lg:text-6xl font-bold leading-tight tracking-tight mb-6\" style={{ color: '#F5F5F7' }}>\n            Find your campus\n          </h1>\n          <p className=\"hive-font-sans text-lg md:text-xl leading-relaxed max-w-3xl mx-auto mb-8\" style={{ color: '#9A9AA1' }}>\n            Join the students building the future of campus life at your university\n          </p>\n\n          {/* Search Bar */}\n          <div className=\"max-w-md mx-auto\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/40\" />\n              <input\n                type=\"text\"\n                placeholder=\"Search universities...\"\n                value={searchTerm}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setSearchTerm((e.target as any).value)}\n                className=\"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/40 focus:outline-none focus:border-white/20 focus:bg-white/10 transition-all\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Loading State */}\n        {loading && (\n          <div className=\"text-center py-12\">\n            <div className=\"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <div className=\"w-6 h-6 border-2 border-white/20 border-t-white/60 rounded-full animate-spin\" />\n            </div>\n            <p className=\"hive-font-sans text-sm\" style={{ color: '#9A9AA1' }}>\n              Loading universities...\n            </p>\n          </div>\n        )}\n\n        {/* Schools Grid */}\n        {!loading && (\n          <div className=\"grid gap-4 hive-animate-liquid-reveal mb-16\">\n            {filteredSchools.map((school) => {\n              const isUB = school.id === 'ub' || school.id === 'test-university';\n              const isBlurred = !isUB;\n\n              return (\n            <div\n              key={school.id}\n              data-testid={`school-${school.id}`}\n              className={`group relative overflow-hidden rounded-2xl border border-white/5 hover:border-white/10 transition-all duration-500 cursor-pointer hive-interactive ${\n                isBlurred ? 'opacity-40 blur-sm hover:opacity-60 hover:blur-none' : ''\n              }`}\n              onClick={() => handleSchoolSelect(school)}\n              style={{\n                background: 'rgba(255, 255, 255, 0.02)',\n                backdropFilter: 'blur(20px)',\n                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1)'\n              }}\n            >\n              {/* Glass reflection effect */}\n              <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-transparent opacity-50\" />\n              <div className=\"absolute inset-0 bg-gradient-to-tl from-yellow-500/5 via-transparent to-transparent\" />\n\n              {/* Coming Soon Overlay for blurred schools */}\n              {isBlurred && (\n                <div className=\"absolute inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\n                  <div className=\"text-center\">\n                    <span className=\"text-[var(--hive-brand-primary)] font-semibold text-lg\">Coming Soon</span>\n                    <p className=\"text-white/70 text-sm mt-1\">Join the waitlist!</p>\n                  </div>\n                </div>\n              )}\n              \n              <div className=\"relative p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center hive-gap-md mb-3\">\n                      <h3 className=\"hive-font-sans text-lg font-semibold tracking-tight\" style={{ color: '#F5F5F7' }}>\n                        {school.name}\n                      </h3>\n                      {school.isActive && (\n                        <div className=\"px-3 py-1 bg-white/10 backdrop-blur-sm text-white text-xs rounded-full border border-white/20 font-medium\">\n                          LIVE\n                        </div>\n                      )}\n                      {school.isComingSoon && (\n                        <div className=\"px-3 py-1 bg-yellow-500/10 backdrop-blur-sm text-yellow-300 text-xs rounded-full border border-yellow-500/20 font-medium\">\n                          SOON\n                        </div>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center hive-gap-md hive-font-sans text-sm\" style={{ color: '#9A9AA1' }}>\n                      <div className=\"flex items-center hive-gap-xs\">\n                        <MapPin className=\"w-4 h-4\" />\n                        <span className=\"font-medium\">{school.location}</span>\n                      </div>\n                      <div className=\"flex items-center hive-gap-xs\">\n                        <Users className=\"w-4 h-4\" />\n                        <span className=\"font-mono text-xs\">@{school.domain}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"ml-6 opacity-60 group-hover:opacity-100 transition-opacity\">\n                    {school.isActive ? (\n                      <div className=\"flex items-center hive-gap-sm text-white\">\n                        <span className=\"hive-font-sans font-medium text-sm\">Enter HIVE</span>\n                        <ArrowRight className=\"w-4 h-4\" />\n                      </div>\n                    ) : (\n                      <div className=\"text-center\">\n                        <div className=\"hive-font-sans text-sm font-medium\" style={{ color: '#C1C1C4' }}>\n                          {isBlurred ? 'Coming Soon' : (school.isComingSoon ? 'Coming Soon' : 'Join Waitlist')}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n              \n              {/* Hover glow effect */}\n              <div className=\"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none\">\n                <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent\" />\n              </div>\n            </div>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Empty State */}\n        {filteredSchools.length === 0 && (\n          <div className=\"text-center py-12 hive-animate-silk-emerge\">\n            <div className=\"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <Search className=\"w-6 h-6 text-white/40\" />\n            </div>\n            <h3 className=\"hive-font-sans text-lg font-semibold mb-2\" style={{ color: '#F5F5F7' }}>\n              No universities found\n            </h3>\n            <p className=\"hive-font-sans text-sm leading-relaxed\" style={{ color: '#9A9AA1' }}>\n              Try adjusting your search or check back later for more campuses\n            </p>\n          </div>\n        )}\n\n        {/* Call to Action */}\n        <div className=\"text-center\">\n          <div className=\"hive-glass-strong p-8 rounded-xl max-w-2xl mx-auto\" style={{ border: '1px solid rgba(255, 191, 0, 0.3)' }}>\n            <h3 className=\"hive-font-sans text-xl md:text-2xl font-bold mb-4 tracking-tight\" style={{ color: '#F5F5F7' }}>\n              Don&apos;t see your university?\n            </h3>\n            <p className=\"hive-font-sans text-base mb-6 leading-relaxed\" style={{ color: '#9A9AA1' }}>\n              We&apos;re expanding to more campuses every month. Join our general waitlist to be notified when HIVE arrives at your school.\n            </p>\n <Button variant=\"default\" className=\"max-w-lg px-8 py-3\">\n              Join General Waitlist\n            </Button>\n          </div>\n        </div>\n      </div>\n      </motion.div>\n\n      {/* Coming Soon Modal */}\n      {isComingSoonOpen && (\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n          <div className=\"bg-black/90 border border-white/10 rounded-2xl p-8 max-w-md w-full\">\n            <h2 className=\"text-2xl font-bold text-white mb-4\">What&apos;s Coming to HIVE</h2>\n            <p className=\"text-white/70 mb-6\">\n              We&apos;re building the future of campus collaboration. Check back soon for new features and campus expansions.\n            </p>\n            <button\n              onClick={() => setIsComingSoonOpen(false)}\n              className=\"w-full bg-white/10 hover:bg-white/20 text-white px-6 py-3 rounded-xl transition-all\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n    </React.Fragment>\n  );\n} ","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/[spaceId]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":71},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pin' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Menu' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":63,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSpace'. Either include it or remove the dependency array.","line":78,"column":6,"nodeType":"ArrayExpression","endLine":78,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [loadSpace, spaceId]","fix":{"range":[2080,2089],"text":"[loadSpace, spaceId]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":156,"column":13,"nodeType":"JSXOpeningElement","endLine":156,"endColumn":90}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { Button, Card, Badge, Tabs, TabsList, TabsTrigger, TabsContent } from '@hive/ui';\nimport {\n  Hash,\n  Users,\n  Calendar,\n  FileText,\n  Settings,\n  Bell,\n  Share,\n  Pin,\n  TrendingUp,\n  MessageSquare,\n  ChevronRight,\n  Menu,\n  X,\n  Plus,\n  Star\n} from 'lucide-react';\nimport { useAuth } from '@hive/auth-logic';\nimport { api } from '@/lib/api-client';\nimport { SpaceChatBoard } from '@/components/spaces/space-chat-board';\nimport { SpaceSidebar } from '@/components/spaces/space-sidebar';\nimport { EventsPanel } from '@/components/spaces/panels/events-panel';\nimport { MembersPanel } from '@/components/spaces/panels/members-panel';\nimport { ResourcesPanel } from '@/components/spaces/panels/resources-panel';\n\ninterface SpaceData {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  memberCount: number;\n  onlineCount: number;\n  bannerImage?: string;\n  avatarImage?: string;\n  joinPolicy: string;\n  visibility: string;\n  leaders: string[];\n  settings: {\n    maxPinnedPosts: number;\n    autoArchiveDays: number;\n  };\n}\n\ninterface SpaceMembership {\n  role: 'owner' | 'leader' | 'moderator' | 'member';\n  joinedAt?: Date;\n  notifications?: {\n    posts: boolean;\n    events: boolean;\n    announcements: boolean;\n    mentions: boolean;\n  };\n}\n\nexport default function SpaceDetailPage() {\n  const params = useParams();\n  const router = useRouter();\n  const { user } = useAuth();\n  const spaceId = params.spaceId as string;\n\n  const [loading, setLoading] = useState(true);\n  const [space, setSpace] = useState<SpaceData | null>(null);\n  const [membership, setMembership] = useState<SpaceMembership | null>(null);\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const [contextPanel, setContextPanel] = useState<string | null>(null);\n\n  // SPEC.md: Hot thread tabs\n  const [hotThreads, setHotThreads] = useState<any[]>([]);\n  const [activeTab, setActiveTab] = useState('main');\n\n  useEffect(() => {\n    loadSpace();\n  }, [spaceId]);\n\n  const loadSpace = async () => {\n    try {\n      setLoading(true);\n\n      const spaceData = await api.get<SpaceData>(`/api/spaces/${spaceId}`);\n      setSpace(spaceData);\n\n      const membershipData = await api.spaces.membership.get<{ requestingUser?: SpaceMembership }>(spaceId);\n      setMembership(membershipData?.requestingUser ?? null);\n\n      const threadsResponse = await api.get<{ posts: any[] }>(`/api/spaces/${spaceId}/posts`, {\n        params: {\n          type: 'hot_threads',\n          minReplies: 10,\n          limit: 5\n        }\n      });\n      setHotThreads(threadsResponse.posts || []);\n\n    } catch (error) {\n      console.error('Failed to load space:', error);\n      router.push('/spaces');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleJoinSpace = async () => {\n    try {\n      await api.post(`/api/spaces/${spaceId}/join`);\n      const membershipData = await api.spaces.membership.get<{ requestingUser?: SpaceMembership }>(spaceId);\n      setMembership(membershipData?.requestingUser ?? null);\n    } catch (error) {\n      console.error('Failed to join space:', error);\n    }\n  };\n\n  const handleLeaveSpace = async () => {\n    try {\n      await api.post(`/api/spaces/${spaceId}/leave`);\n      setMembership(null);\n    } catch (error) {\n      console.error('Failed to leave space:', error);\n    }\n  };\n\n  const isLeader = membership?.role === 'owner' || membership?.role === 'leader';\n  const isModerator = isLeader || membership?.role === 'moderator';\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <p className=\"text-[var(--hive-brand-primary)]\">Loading space...</p>\n      </div>\n    );\n  }\n\n  if (!space) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <p className=\"text-red-400\">Space not found</p>\n      </div>\n    );\n  }\n\n  // SPEC.md: 60/40 split with context panels\n  const mainWidth = contextPanel ? 'w-[40%]' : (sidebarCollapsed ? 'w-[85%]' : 'w-[60%]');\n  const sidebarWidth = sidebarCollapsed ? 'w-[15%]' : 'w-[40%]';\n  const contextWidth = 'w-[40%]';\n\n  return (\n    <div className=\"min-h-screen bg-black\">\n      {/* Space Header */}\n      <div className=\"bg-gray-900 border-b border-gray-800\">\n        <div className=\"relative h-32 bg-gradient-to-br from-hive-gold/20 to-purple-600/20\">\n          {space.bannerImage && (\n            <img src={space.bannerImage} alt=\"\" className=\"w-full h-full object-cover\" />\n          )}\n\n          {/* Header Content */}\n          <div className=\"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent\" />\n          <div className=\"absolute bottom-0 left-0 right-0 p-4\">\n            <div className=\"max-w-7xl mx-auto flex items-end justify-between\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-16 h-16 bg-[var(--hive-brand-primary)] rounded-lg flex items-center justify-center\">\n                  <Hash className=\"w-8 h-8 text-black\" />\n                </div>\n                <div>\n                  <h1 className=\"text-2xl font-bold text-white flex items-center gap-2\">\n                    {space.name}\n                    <Badge className=\"bg-gray-800 text-gray-300\">\n                      {space.category.replace('_', ' ')}\n                    </Badge>\n                  </h1>\n                  <div className=\"flex items-center gap-4 text-sm text-gray-400\">\n                    <span>{space.memberCount} members</span>\n                    <span className=\"flex items-center gap-1\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n                      {space.onlineCount} online\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex items-center gap-2\">\n                {membership ? (\n                  <>\n                    <Button\n                      className=\"max-w-sm border-gray-700\"\n                      variant=\"outline\"\n                      \n                      onClick={() => {}}\n                    >\n                      <Bell className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      className=\"max-w-sm border-gray-700\"\n                      variant=\"outline\"\n                      \n                      onClick={() => {}}\n                    >\n                      <Share className=\"w-4 h-4\" />\n                    </Button>\n                    {isLeader && (\n                      <Button\n                        className=\"max-w-sm border-gray-700\"\n                        variant=\"outline\"\n                        \n                        onClick={() => router.push(`/spaces/${spaceId}/settings`)}\n                      >\n                        <Settings className=\"w-4 h-4\" />\n                      </Button>\n                    )}\n                    <Button\n                      className=\"max-w-sm border-red-500 text-red-400 hover:bg-red-500/10\"\n                      variant=\"outline\"\n                      \n                      onClick={handleLeaveSpace}\n                    >\n                      Leave\n                    </Button>\n                  </>\n                ) : (\n                  <Button\n                    className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n                    onClick={handleJoinSpace}\n                  >\n                    Join Space\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* SPEC.md: Tab System for Hot Threads */}\n      {hotThreads.length > 0 && (\n        <div className=\"bg-gray-900 border-b border-gray-800\">\n          <div className=\"max-w-7xl mx-auto\">\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\n              <TabsList className=\"bg-transparent border-0 h-auto p-0\">\n                <TabsTrigger\n                  value=\"main\"\n                  className=\"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-[var(--hive-brand-primary)] rounded-none px-4 py-3\"\n                >\n                  <Hash className=\"w-4 h-4 mr-2\" />\n                  Main Board\n                </TabsTrigger>\n                {hotThreads.slice(0, 5).map((thread) => (\n                  <TabsTrigger\n                    key={thread.id}\n                    value={thread.id}\n                    className=\"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-[var(--hive-brand-primary)] rounded-none px-4 py-3\"\n                  >\n                    <MessageSquare className=\"w-4 h-4 mr-2\" />\n                    {thread.content ?\n                      `${thread.content.slice(0, 30)}...` :\n                      `Thread (${thread.commentCount || thread.replyCount || 0})`\n                    }\n                    {thread.isLive && (\n                      <div className=\"ml-2 w-2 h-2 bg-red-500 rounded-full animate-pulse\" />\n                    )}\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n            </Tabs>\n          </div>\n        </div>\n      )}\n\n      {/* Main Content Area - SPEC.md 60/40 Split */}\n      <div className=\"flex h-[calc(100vh-12rem)]\">\n        {/* Main Board (60% or 40% with context panel) */}\n        <div className={`${mainWidth} transition-all duration-300 border-r border-gray-800`}>\n          {activeTab === 'main' ? (\n            <SpaceChatBoard\n              spaceId={spaceId}\n              membership={membership}\n              isLeader={isLeader}\n              isModerator={isModerator}\n              onOpenContext={(panel) => setContextPanel(panel)}\n            />\n          ) : (\n            <SpaceChatBoard\n              spaceId={spaceId}\n              threadId={activeTab}\n              membership={membership}\n              isLeader={isLeader}\n              isModerator={isModerator}\n              onOpenContext={(panel) => setContextPanel(panel)}\n            />\n          )}\n        </div>\n\n        {/* Sidebar (40% or collapsed) */}\n        <div className={`${sidebarWidth} transition-all duration-300 bg-gray-900/50`}>\n          <SpaceSidebar\n            spaceId={spaceId}\n            collapsed={sidebarCollapsed}\n            onToggleCollapse={() => setSidebarCollapsed(!sidebarCollapsed)}\n            onOpenPanel={(panel) => setContextPanel(panel)}\n            membership={membership}\n          />\n        </div>\n\n        {/* Context Panel (40% when open) */}\n        {contextPanel && (\n          <div className={`${contextWidth} bg-gray-900 border-l border-gray-800 animate-slide-in-right`}>\n            <div className=\"p-4 border-b border-gray-800 flex items-center justify-between\">\n              <h3 className=\"font-bold text-white capitalize\">{contextPanel}</h3>\n              <Button\n                className=\"max-w-sm\"\n                variant=\"outline\"\n                onClick={() => setContextPanel(null)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n\n            {/* Context Panel Content */}\n            {contextPanel === 'events' && (\n              <EventsPanel\n                spaceId={spaceId}\n                userRole={membership?.role || 'guest'}\n                canCreateEvents={isLeader || isModerator}\n              />\n            )}\n            {contextPanel === 'members' && (\n              <MembersPanel\n                spaceId={spaceId}\n                userRole={membership?.role || 'guest'}\n                isLeader={isLeader}\n              />\n            )}\n            {contextPanel === 'resources' && (\n              <ResourcesPanel\n                spaceId={spaceId}\n                userRole={membership?.role || 'guest'}\n                canUpload={membership !== null}\n                isLeader={isLeader}\n              />\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/browse/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":4},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":72,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'hasSearched'. Either include it or remove the dependency array.","line":85,"column":6,"nodeType":"ArrayExpression","endLine":85,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [hasSearched]","fix":{"range":[2402,2404],"text":"[hasSearched]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":336,"column":13,"nodeType":"JSXOpeningElement","endLine":336,"endColumn":101}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Grid, Card, Button, Badge, Input } from \"@hive/ui\";\nimport {\n  Search,\n  Filter,\n  Users,\n  TrendingUp,\n  Shield,\n  Home,\n  Building,\n  SlidersHorizontal,\n  X\n} from 'lucide-react';\nimport { useAuth } from '@hive/auth-logic';\nimport { api } from '@/lib/api-client';\n\n// SPEC.md categories\nconst CATEGORIES = {\n  university_org: { label: 'University Org', icon: Shield, color: 'text-blue-400' },\n  student_org: { label: 'Student Org', icon: Users, color: 'text-green-400' },\n  residential: { label: 'Residential', icon: Home, color: 'text-yellow-400' },\n  greek_life: { label: 'Greek Life', icon: Building, color: 'text-purple-400' }\n};\n\nconst ACTIVITY_LEVELS = {\n  very_active: { label: 'Very Active', color: 'bg-green-500' },\n  active: { label: 'Active', color: 'bg-blue-500' },\n  moderate: { label: 'Moderate', color: 'bg-yellow-500' },\n  quiet: { label: 'Quiet', color: 'bg-gray-500' }\n};\n\nconst JOIN_POLICIES = {\n  open: { label: 'Open', description: 'Anyone can join' },\n  approval: { label: 'Approval Required', description: 'Leaders must approve' },\n  invite_only: { label: 'Invite Only', description: 'Invitation required' }\n};\n\ninterface SearchFilters {\n  category?: string;\n  memberCountMin?: number;\n  memberCountMax?: number;\n  activityLevel?: string;\n  joinPolicy?: string;\n}\n\ninterface SpaceSearchResult {\n  id: string;\n  name: string;\n  description: string;\n  category: keyof typeof CATEGORIES;\n  memberCount: number;\n  onlineCount: number;\n  activityLevel: keyof typeof ACTIVITY_LEVELS;\n  joinPolicy: keyof typeof JOIN_POLICIES;\n  tags: string[];\n  bannerImage?: string;\n  lastActivity: Date;\n\n  // Mutual member data\n  mutualMembers: Array<{\n    id: string;\n    name: string;\n    isFriend: boolean;\n  }>;\n}\n\nexport default function SpacesBrowsePage() {\n  const router = useRouter();\n  const { user } = useAuth();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<SearchFilters>({});\n  const [showFilters, setShowFilters] = useState(false);\n  const [results, setResults] = useState<SpaceSearchResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [hasSearched, setHasSearched] = useState(false);\n\n  // Load initial suggestions\n  useEffect(() => {\n    if (!hasSearched) {\n      loadInitialSpaces();\n    }\n  }, []);\n\n  const loadInitialSpaces = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get<{ spaces: SpaceSearchResult[] }>('/api/spaces', {\n        params: { limit: 20 }\n      });\n      setResults(response.spaces || []);\n    } catch (error) {\n      console.error('Failed to load initial spaces:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSearch = async () => {\n    if (!searchQuery && Object.keys(filters).length === 0) {\n      loadInitialSpaces();\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setHasSearched(true);\n\n      // SPEC.md: Text search with fuzzy matching\n      const response = await api.get<{ spaces: SpaceSearchResult[] }>('/api/spaces/search', {\n        params: {\n          q: searchQuery,\n          ...filters,\n          limit: 50\n        }\n      });\n\n      setResults(response.spaces || []);\n    } catch (error) {\n      console.error('Search failed:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFilterChange = (key: keyof SearchFilters, value: any) => {\n    setFilters(prev => ({\n      ...prev,\n      [key]: value\n    }));\n  };\n\n  const clearFilters = () => {\n    setFilters({});\n    setSearchQuery('');\n    setHasSearched(false);\n    loadInitialSpaces();\n  };\n\n  const activeFilterCount = Object.keys(filters).length;\n\n  return (\n    <div className=\"min-h-screen bg-black\">\n      {/* Header */}\n      <div className=\"sticky top-0 z-40 bg-black/90 backdrop-blur border-b border-gray-800\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex flex-col lg:flex-row lg:items-center gap-4\">\n            <h1 className=\"text-2xl lg:text-3xl font-bold text-white\">\n              Browse Spaces\n            </h1>\n\n            {/* Search Bar */}\n            <div className=\"flex-1 flex gap-2\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5\" />\n                <Input\n                  placeholder=\"Search by name, description, or tags...\"\n                  value={searchQuery}\n                  onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n                  onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\n                  className=\"pl-10 bg-gray-900 border-gray-700\"\n                />\n              </div>\n\n              <Button\n                onClick={handleSearch}\n                className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n              >\n                Search\n              </Button>\n\n              <Button\n                onClick={() => setShowFilters(!showFilters)}\n                variant=\"outline\"\n                className={`border-gray-700 relative ${showFilters ? 'bg-gray-800' : ''}`}\n              >\n                <SlidersHorizontal className=\"w-4 h-4\" />\n                {activeFilterCount > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-5 h-5 bg-[var(--hive-brand-primary)] text-black text-xs rounded-full flex items-center justify-center\">\n                    {activeFilterCount}\n                  </span>\n                )}\n              </Button>\n            </div>\n          </div>\n\n          {/* Filter Panel */}\n          {showFilters && (\n            <div className=\"mt-4 p-4 bg-gray-900 rounded-lg border border-gray-800\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"font-semibold text-white\">Filters</h3>\n                {activeFilterCount > 0 && (\n                  <Button\n                    className=\"max-w-sm text-red-400 hover:text-red-300\"\n                    variant=\"outline\"\n                    onClick={clearFilters}\n                  >\n                    Clear all\n                  </Button>\n                )}\n              </div>\n\n              <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-4\">\n                {/* Category Filter */}\n                <div>\n                  <label className=\"text-sm text-gray-400 mb-2 block\">Category</label>\n                  <select\n                    value={filters.category || ''}\n                    onChange={(e: React.ChangeEvent) => handleFilterChange('category', (e.target as any).value || undefined)}\n                    className=\"w-full bg-gray-800 border border-gray-700 rounded px-3 py-2 text-white\"\n                  >\n                    <option value=\"\">All Categories</option>\n                    {Object.entries(CATEGORIES).map(([key, config]) => (\n                      <option key={key} value={key}>{config.label}</option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Member Count Range */}\n                <div>\n                  <label className=\"text-sm text-gray-400 mb-2 block\">Member Count</label>\n                  <div className=\"flex gap-2\">\n                    <input\n                      type=\"number\"\n                      placeholder=\"Min\"\n                      value={filters.memberCountMin || ''}\n                      onChange={(e: React.ChangeEvent) => handleFilterChange('memberCountMin', (e.target as any).value ? parseInt((e.target as any).value) : undefined)}\n                      className=\"w-1/2 bg-gray-800 border border-gray-700 rounded px-2 py-2 text-white text-sm\"\n                    />\n                    <input\n                      type=\"number\"\n                      placeholder=\"Max\"\n                      value={filters.memberCountMax || ''}\n                      onChange={(e: React.ChangeEvent) => handleFilterChange('memberCountMax', (e.target as any).value ? parseInt((e.target as any).value) : undefined)}\n                      className=\"w-1/2 bg-gray-800 border border-gray-700 rounded px-2 py-2 text-white text-sm\"\n                    />\n                  </div>\n                </div>\n\n                {/* Activity Level */}\n                <div>\n                  <label className=\"text-sm text-gray-400 mb-2 block\">Activity Level</label>\n                  <select\n                    value={filters.activityLevel || ''}\n                    onChange={(e: React.ChangeEvent) => handleFilterChange('activityLevel', (e.target as any).value || undefined)}\n                    className=\"w-full bg-gray-800 border border-gray-700 rounded px-3 py-2 text-white\"\n                  >\n                    <option value=\"\">Any Activity</option>\n                    {Object.entries(ACTIVITY_LEVELS).map(([key, config]) => (\n                      <option key={key} value={key}>{config.label}</option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Join Policy */}\n                <div>\n                  <label className=\"text-sm text-gray-400 mb-2 block\">Join Policy</label>\n                  <select\n                    value={filters.joinPolicy || ''}\n                    onChange={(e: React.ChangeEvent) => handleFilterChange('joinPolicy', (e.target as any).value || undefined)}\n                    className=\"w-full bg-gray-800 border border-gray-700 rounded px-3 py-2 text-white\"\n                  >\n                    <option value=\"\">Any Policy</option>\n                    {Object.entries(JOIN_POLICIES).map(([key, config]) => (\n                      <option key={key} value={key}>{config.label}</option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Results */}\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n        {/* Results Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <p className=\"text-gray-400\">\n            {hasSearched\n              ? `Found ${results.length} spaces`\n              : `Showing ${results.length} popular spaces`}\n          </p>\n        </div>\n\n        {/* Results Grid */}\n        {loading ? (\n          <div className=\"text-center py-20\">\n            <p className=\"text-[var(--hive-brand-primary)]\">Searching spaces...</p>\n          </div>\n        ) : results.length === 0 ? (\n          <div className=\"text-center py-20\">\n            <Search className=\"w-16 h-16 text-gray-600 mx-auto mb-4\" />\n            <h3 className=\"text-xl font-bold text-white mb-2\">No spaces found</h3>\n            <p className=\"text-gray-400\">Try adjusting your search or filters</p>\n          </div>\n        ) : (\n          <Grid columns={1} responsive=\"adaptive\" gap={4}>\n            {results.map((space) => (\n              <SpaceSearchCard\n                key={space.id}\n                space={space}\n                onClick={() => router.push(`/spaces/${space.id}`)}\n              />\n            ))}\n          </Grid>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// SPEC.md compliant search result card\nfunction SpaceSearchCard({\n  space,\n  onClick\n}: {\n  space: SpaceSearchResult;\n  onClick: () => void;\n}) {\n  const category = CATEGORIES[space.category];\n  const activityLevel = ACTIVITY_LEVELS[space.activityLevel];\n  const joinPolicy = JOIN_POLICIES[space.joinPolicy];\n\n  return (\n    <Card\n      className=\"bg-gray-900/50 border-gray-800 hover:border-[var(--hive-brand-primary)] transition-all cursor-pointer\"\n      onClick={onClick}\n    >\n      <div className=\"flex gap-4\">\n        {/* Icon/Banner */}\n        <div className=\"w-24 h-24 bg-gradient-to-br from-hive-gold/20 to-purple-600/20 rounded-lg flex items-center justify-center flex-shrink-0\">\n          {space.bannerImage ? (\n            <img src={space.bannerImage} alt=\"\" className=\"w-full h-full object-cover rounded-lg\" />\n          ) : (\n            <category.icon className={`w-10 h-10 ${category.color}`} />\n          )}\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-start justify-between mb-2\">\n            <div>\n              <h3 className=\"font-bold text-white hover:text-[var(--hive-brand-primary)] transition-colors\">\n                {space.name}\n              </h3>\n              <p className=\"text-sm text-gray-400 line-clamp-2\">\n                {space.description}\n              </p>\n            </div>\n\n            {/* Activity Indicator */}\n            <div className=\"flex items-center gap-2\">\n              <div className={`w-2 h-2 rounded-full ${activityLevel.color}`} />\n              {space.onlineCount > 0 && (\n                <span className=\"text-xs text-green-400\">{space.onlineCount} online</span>\n              )}\n            </div>\n          </div>\n\n          {/* Metadata */}\n          <div className=\"flex items-center gap-4 text-xs text-gray-500\">\n            <span className=\"flex items-center gap-1\">\n              <Users className=\"w-3 h-3\" />\n              {space.memberCount} members\n            </span>\n            <Badge className=\"bg-gray-800 text-gray-300\">\n              {category.label}\n            </Badge>\n            {joinPolicy.label !== 'Open' && (\n              <Badge className=\"bg-yellow-500/20 text-yellow-400\">\n                {joinPolicy.label}\n              </Badge>\n            )}\n          </div>\n\n          {/* Tags */}\n          {space.tags.length > 0 && (\n            <div className=\"flex gap-1 mt-2 flex-wrap\">\n              {space.tags.slice(0, 5).map((tag) => (\n                <span\n                  key={tag}\n                  className=\"px-2 py-1 bg-gray-800 text-gray-400 rounded text-xs\"\n                >\n                  #{tag}\n                </span>\n              ))}\n            </div>\n          )}\n\n          {/* Mutual Members Preview */}\n          {space.mutualMembers.length > 0 && (\n            <div className=\"mt-2 pt-2 border-t border-gray-800\">\n              <p className=\"text-xs text-gray-400\">\n                {space.mutualMembers.filter(m => m.isFriend).length > 0 && (\n                  <span className=\"text-green-400\">\n                    {space.mutualMembers.filter(m => m.isFriend).length} friends\n                  </span>\n                )}\n                {space.mutualMembers.filter(m => m.isFriend).length > 0 &&\n                 space.mutualMembers.filter(m => !m.isFriend).length > 0 && ' and '}\n                {space.mutualMembers.filter(m => !m.isFriend).length > 0 && (\n                  <span className=\"text-blue-400\">\n                    {space.mutualMembers.filter(m => !m.isFriend).length} connections\n                  </span>\n                )}\n                {' are members'}\n              </p>\n            </div>\n          )}\n\n          {/* Last Activity */}\n          <div className=\"mt-2 text-xs text-gray-500\">\n            Last active: {formatLastActivity(space.lastActivity)}\n          </div>\n        </div>\n\n        {/* Join Button */}\n        <div className=\"flex-shrink-0\">\n          <Button\n            className=\"max-w-sm bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] hover:bg-[var(--hive-brand-primary)] hover:text-black\"\n            onClick={(e: React.MouseEvent) => {\n              e.stopPropagation();\n              // Handle join\n            }}\n          >\n            View\n          </Button>\n        </div>\n      </div>\n    </Card>\n  );\n}\n\nfunction formatLastActivity(date: Date): string {\n  const now = new Date();\n  const d = new Date(date);\n  const diff = now.getTime() - d.getTime();\n  const hours = Math.floor(diff / (1000 * 60 * 60));\n\n  if (hours < 1) return 'just now';\n  if (hours < 24) return `${hours}h ago`;\n  if (hours < 48) return 'yesterday';\n  if (hours < 168) return `${Math.floor(hours / 24)}d ago`;\n  return d.toLocaleDateString();\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/create/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedCategory' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":92,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reset' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":115,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":115,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkCreationPermission'. Either include it or remove the dependency array.","line":130,"column":6,"nodeType":"ArrayExpression","endLine":130,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [checkCreationPermission, user]","fix":{"range":[3617,3623],"text":"[checkCreationPermission, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button, Card, Input, Badge } from '@hive/ui';\nimport {\n  ArrowLeft,\n  Shield,\n  Users,\n  Home,\n  Building,\n  Lock,\n  Globe,\n  UserCheck,\n  AlertCircle,\n  Sparkles,\n  ChevronRight\n} from 'lucide-react';\nimport { useAuth } from '@hive/auth-logic';\nimport { api, HttpError } from '@/lib/api-client';\nimport { z } from 'zod';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\n\n// SPEC.md categories with LOCKS\nconst SPACE_CATEGORIES = {\n  university_org: {\n    label: 'University Organization',\n    description: 'Official university groups and departments',\n    icon: Shield,\n    color: 'bg-blue-500',\n    requiresVerification: true,\n    locked: true, // LOCKED - requires admin\n    lockMessage: 'Contact admin@hive.college for verification'\n  },\n  student_org: {\n    label: 'Student Organization',\n    description: 'Student-run clubs and organizations',\n    icon: Users,\n    color: 'bg-green-500',\n    requiresVerification: false,\n    locked: false // OPEN for students\n  },\n  residential: {\n    label: 'Residential',\n    description: 'Dorm floors and residential communities',\n    icon: Home,\n    color: 'bg-yellow-500',\n    requiresVerification: false,\n    locked: false // OPEN for students\n  },\n  greek_life: {\n    label: 'Greek Life',\n    description: 'Fraternities and sororities',\n    icon: Building,\n    color: 'bg-purple-500',\n    requiresVerification: true,\n    locked: true, // LOCKED - requires verification\n    lockMessage: 'Requires Greek Life council approval'\n  }\n};\n\n// Form schema with validation\nconst createSpaceSchema = z.object({\n  name: z.string()\n    .min(3, 'Space name must be at least 3 characters')\n    .max(50, 'Space name must be less than 50 characters')\n    .regex(/^[a-zA-Z0-9\\s\\-_]+$/, 'Only letters, numbers, spaces, hyphens and underscores'),\n\n  description: z.string()\n    .min(10, 'Description must be at least 10 characters')\n    .max(280, 'Description must be less than 280 characters'),\n\n  category: z.enum(['student_org', 'residential']), // Only unlocked categories\n\n  joinPolicy: z.enum(['open', 'approval', 'invite_only']),\n\n  tags: z.array(z.string()).min(1, 'Add at least one tag').max(5, 'Maximum 5 tags'),\n\n  agreedToGuidelines: z.boolean().refine(val => val === true, {\n    message: 'You must agree to the community guidelines'\n  })\n});\n\ntype CreateSpaceForm = z.infer<typeof createSpaceSchema>;\n\nexport default function CreateSpacePage() {\n  const router = useRouter();\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\n  const [tagInput, setTagInput] = useState('');\n\n  // LOCKS\n  const [globalLock, setGlobalLock] = useState(false);\n  const [lockReason, setLockReason] = useState('');\n  const [userPermissions, setUserPermissions] = useState({\n    canCreate: false,\n    spacesCreatedToday: 0,\n    maxSpacesPerDay: 3,\n    accountAge: 0,\n    minAccountAge: 7,\n    emailVerified: false,\n    isAdmin: false,\n    reason: ''\n  });\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    setValue,\n    watch,\n    reset\n  } = useForm<CreateSpaceForm>({\n    resolver: zodResolver(createSpaceSchema),\n    defaultValues: {\n      joinPolicy: 'open',\n      tags: [],\n      agreedToGuidelines: false\n    }\n  });\n\n  const tags = watch('tags') || [];\n\n  // Check permissions on mount\n  useEffect(() => {\n    checkCreationPermission();\n  }, [user]);\n\n  const checkCreationPermission = async () => {\n    if (!user) {\n      setGlobalLock(true);\n      setLockReason('You must be logged in to create spaces');\n      return;\n    }\n\n    try {\n      type PermissionPayload = {\n        canCreate: boolean;\n        reason?: string;\n        spacesCreatedToday: number;\n        maxSpacesPerDay: number;\n        accountAge: number;\n        minAccountAge: number;\n        emailVerified: boolean;\n        isAdmin: boolean;\n      };\n\n      const data = await api.get<PermissionPayload>('/api/spaces/check-create-permission');\n\n      setUserPermissions(prev => ({\n        ...prev,\n        ...data,\n        reason: data.reason || ''\n      }));\n\n      // Apply locks based on permissions\n      if (!data.canCreate) {\n        setGlobalLock(true);\n        setLockReason(data.reason || 'Space creation is currently restricted');\n      } else if (data.spacesCreatedToday >= data.maxSpacesPerDay) {\n        setGlobalLock(true);\n        setLockReason(`Daily limit reached (${data.maxSpacesPerDay} spaces per day)`);\n      } else if (data.accountAge < data.minAccountAge) {\n        setGlobalLock(true);\n        setLockReason(`Account must be at least ${data.minAccountAge} days old`);\n      } else if (!data.emailVerified) {\n        setGlobalLock(true);\n        setLockReason('Please verify your email address first');\n      }\n    } catch (error) {\n      console.error('Failed to check permissions:', error);\n      setGlobalLock(true);\n      setLockReason('Unable to verify creation permissions');\n    }\n  };\n\n  const handleCategorySelect = (category: string) => {\n    const cat = SPACE_CATEGORIES[category as keyof typeof SPACE_CATEGORIES];\n\n    if (cat.locked) {\n      alert(cat.lockMessage || 'This category requires special permission');\n      return;\n    }\n\n    setSelectedCategory(category);\n    setValue('category', category as any);\n    setCurrentStep(2);\n  };\n\n  const handleAddTag = () => {\n    if (tagInput && tags.length < 5) {\n      const cleanTag = tagInput.toLowerCase().replace(/[^a-z0-9]/g, '');\n      if (cleanTag && !tags.includes(cleanTag)) {\n        setValue('tags', [...tags, cleanTag]);\n      }\n      setTagInput('');\n    }\n  };\n\n  const onSubmit = async (data: CreateSpaceForm) => {\n    if (globalLock) {\n      alert(lockReason);\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      type CreateSpaceResponse = {\n        space: {\n          id: string;\n          [key: string]: unknown;\n        };\n      };\n\n      const result = await api.post<CreateSpaceResponse>('/api/spaces', {\n        ...data,\n        campusId: 'ub-buffalo',\n        visibility: 'public', // Default for now\n        settings: {\n          maxPinnedPosts: 3,\n          autoArchiveDays: 7\n        }\n      });\n\n      if (result?.space) {\n        // Track creation\n        await api.post('/api/analytics/track', {\n          event: 'space_created',\n          properties: {\n            spaceId: result.space.id,\n            category: data.category\n          }\n        });\n\n        router.push(`/spaces/${result.space.id}`);\n      }\n    } catch (error: any) {\n      console.error('Failed to create space:', error);\n\n      if (error instanceof HttpError && error.status === 403) {\n        setGlobalLock(true);\n        setLockReason('You do not have permission to create spaces');\n      } else if (error instanceof HttpError && error.status === 429) {\n        setGlobalLock(true);\n        setLockReason('Too many spaces created. Try again tomorrow.');\n      } else if (error instanceof HttpError && typeof error.data === 'object' && error.data && 'message' in error.data && typeof (error.data as any).message === 'string' && (error.data as any).message.includes('exists')) {\n        alert('A space with this name already exists');\n      } else {\n        alert('Failed to create space. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // GLOBAL LOCK SCREEN\n  if (globalLock) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center p-4\">\n        <Card className=\"bg-gray-900/50 border-red-500/30 max-w-md w-full p-8 text-center\">\n          <Lock className=\"w-20 h-20 text-red-400 mx-auto mb-4\" />\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Space Creation Locked</h1>\n          <p className=\"text-gray-400 mb-6\">{lockReason}</p>\n\n          {/* Show unlock requirements */}\n          <div className=\"bg-gray-800/50 rounded-lg p-4 mb-6 text-left\">\n            <h3 className=\"text-sm font-semibold text-gray-300 mb-2\">Requirements:</h3>\n            <ul className=\"space-y-1 text-xs text-gray-400\">\n              <li className={userPermissions.emailVerified ? 'text-green-400' : ''}>\n                ‚úì Verified email address\n              </li>\n              <li className={userPermissions.accountAge >= 7 ? 'text-green-400' : ''}>\n                ‚úì Account age: {userPermissions.accountAge}/7 days\n              </li>\n              <li className={userPermissions.spacesCreatedToday < 3 ? 'text-green-400' : ''}>\n                ‚úì Daily limit: {userPermissions.spacesCreatedToday}/3 spaces\n              </li>\n            </ul>\n          </div>\n\n          <Button\n            onClick={() => router.push('/spaces')}\n            variant=\"outline\"\n            className=\"border-gray-700 w-full\"\n          >\n            Browse Existing Spaces\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black\">\n      {/* Header */}\n      <div className=\"bg-gray-900 border-b border-gray-800\">\n        <div className=\"max-w-4xl mx-auto px-4 py-4\">\n          <Button\n            onClick={() => router.back()}\n            variant=\"outline\"\n            className=\"max-w-sm mb-4\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back\n          </Button>\n\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-white\">Create a Space</h1>\n              <p className=\"text-gray-400 mt-1\">\n                {userPermissions.spacesCreatedToday}/{userPermissions.maxSpacesPerDay} spaces created today\n              </p>\n            </div>\n\n            {/* Steps */}\n            <div className=\"flex gap-2\">\n              {[1, 2, 3].map(step => (\n                <div\n                  key={step}\n                  className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${\n                    currentStep >= step\n                      ? 'bg-[var(--hive-brand-primary)] text-black'\n                      : 'bg-gray-800 text-gray-500'\n                  }`}\n                >\n                  {step}\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        {/* Step 1: Category Selection */}\n        {currentStep === 1 && (\n          <div>\n            <h2 className=\"text-xl font-bold text-white mb-2\">Choose Category</h2>\n            <p className=\"text-gray-400 mb-6\">Some categories require special permission</p>\n\n            <div className=\"grid gap-4\">\n              {Object.entries(SPACE_CATEGORIES).map(([key, cat]) => (\n                <Card\n                  key={key}\n                  className={`p-4 cursor-pointer transition-all ${\n                    cat.locked\n                      ? 'border-red-500/30 bg-red-500/5 opacity-75'\n                      : 'border-gray-800 hover:border-[var(--hive-brand-primary)] bg-gray-900/50'\n                  }`}\n                  onClick={() => handleCategorySelect(key)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className={`w-12 h-12 rounded-lg ${cat.color} flex items-center justify-center`}>\n                        <cat.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-white flex items-center gap-2\">\n                          {cat.label}\n                          {cat.locked && <Lock className=\"w-4 h-4 text-red-400\" />}\n                        </h3>\n                        <p className=\"text-sm text-gray-400\">{cat.description}</p>\n                        {cat.locked && (\n                          <p className=\"text-xs text-red-400 mt-1\">{cat.lockMessage}</p>\n                        )}\n                      </div>\n                    </div>\n                    {!cat.locked && <ChevronRight className=\"w-5 h-5 text-gray-400\" />}\n                  </div>\n                </Card>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Step 2: Details */}\n        {currentStep === 2 && (\n          <form onSubmit={handleSubmit(onSubmit)}>\n            <h2 className=\"text-xl font-bold text-white mb-6\">Space Details</h2>\n\n            <div className=\"space-y-4\">\n              {/* Name */}\n              <div>\n                <label className=\"text-sm text-gray-400 mb-1 block\">Space Name</label>\n                <Input\n                  {...register('name')}\n                  placeholder=\"e.g., CS Study Group\"\n                  className=\"bg-gray-900 border-gray-700\"\n                />\n                {errors.name && (\n                  <p className=\"text-xs text-red-400 mt-1\">{errors.name.message}</p>\n                )}\n              </div>\n\n              {/* Description */}\n              <div>\n                <label className=\"text-sm text-gray-400 mb-1 block\">Description</label>\n                <textarea\n                  {...register('description')}\n                  placeholder=\"What is this space about?\"\n                  rows={3}\n                  className=\"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white\"\n                />\n                {errors.description && (\n                  <p className=\"text-xs text-red-400 mt-1\">{errors.description.message}</p>\n                )}\n              </div>\n\n              {/* Tags */}\n              <div>\n                <label className=\"text-sm text-gray-400 mb-1 block\">Tags</label>\n                <div className=\"flex gap-2 mb-2\">\n                  <Input\n                    value={tagInput}\n                    onChange={(e: React.ChangeEvent) => setTagInput((e.target as any).value)}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        e.preventDefault();\n                        handleAddTag();\n                      }\n                    }}\n                    placeholder=\"Add tag\"\n                    className=\"bg-gray-900 border-gray-700\"\n                  />\n                  <Button type=\"button\" onClick={handleAddTag} variant=\"outline\">\n                    Add\n                  </Button>\n                </div>\n                <div className=\"flex gap-2 flex-wrap\">\n                  {tags.map(tag => (\n                    <Badge\n                      key={tag}\n                      className=\"bg-gray-800 cursor-pointer\"\n                      onClick={() => setValue('tags', tags.filter(t => t !== tag))}\n                    >\n                      #{tag} √ó\n                    </Badge>\n                  ))}\n                </div>\n                {errors.tags && (\n                  <p className=\"text-xs text-red-400 mt-1\">{errors.tags.message}</p>\n                )}\n              </div>\n\n              <Button type=\"button\" onClick={() => setCurrentStep(3)}>\n                Continue\n              </Button>\n            </div>\n          </form>\n        )}\n\n        {/* Step 3: Settings & Agreement */}\n        {currentStep === 3 && (\n          <form onSubmit={handleSubmit(onSubmit)}>\n            <h2 className=\"text-xl font-bold text-white mb-6\">Final Settings</h2>\n\n            {/* Join Policy */}\n            <div className=\"mb-6\">\n              <label className=\"text-sm text-gray-400 mb-3 block\">Join Policy</label>\n              <div className=\"space-y-2\">\n                {[\n                  { value: 'open', label: 'Open', desc: 'Anyone can join' },\n                  { value: 'approval', label: 'Approval', desc: 'Leaders approve' },\n                  { value: 'invite_only', label: 'Invite Only', desc: 'Invitation required' }\n                ].map(policy => (\n                  <label key={policy.value} className=\"flex items-center gap-3 p-3 bg-gray-900/50 border border-gray-800 rounded cursor-pointer hover:border-gray-700\">\n                    <input\n                      type=\"radio\"\n                      {...register('joinPolicy')}\n                      value={policy.value}\n                      className=\"text-[var(--hive-brand-primary)]\"\n                    />\n                    <div>\n                      <div className=\"font-semibold text-white\">{policy.label}</div>\n                      <div className=\"text-xs text-gray-400\">{policy.desc}</div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n\n            {/* Guidelines Agreement */}\n            <Card className=\"bg-yellow-500/10 border-yellow-500/30 p-4 mb-6\">\n              <div className=\"flex gap-3\">\n                <AlertCircle className=\"w-5 h-5 text-yellow-400 flex-shrink-0 mt-1\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"font-semibold text-white mb-2\">Community Guidelines</h3>\n                  <ul className=\"text-sm text-gray-300 space-y-1 mb-3\">\n                    <li>‚Ä¢ No harassment or hate speech</li>\n                    <li>‚Ä¢ Keep content relevant to space purpose</li>\n                    <li>‚Ä¢ Follow university policies</li>\n                    <li>‚Ä¢ Report inappropriate content</li>\n                  </ul>\n                  <label className=\"flex items-center gap-2\">\n                    <input\n                      type=\"checkbox\"\n                      {...register('agreedToGuidelines')}\n                      className=\"text-[var(--hive-brand-primary)]\"\n                    />\n                    <span className=\"text-sm text-white\">\n                      I agree to enforce these guidelines\n                    </span>\n                  </label>\n                  {errors.agreedToGuidelines && (\n                    <p className=\"text-xs text-red-400 mt-1\">\n                      {errors.agreedToGuidelines.message}\n                    </p>\n                  )}\n                </div>\n              </div>\n            </Card>\n\n            {/* Actions */}\n            <div className=\"flex gap-3\">\n              <Button\n                type=\"button\"\n                onClick={() => setCurrentStep(2)}\n                variant=\"outline\"\n                className=\"border-gray-700\"\n              >\n                Back\n              </Button>\n              <Button\n                type=\"submit\"\n                disabled={loading}\n                className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400 flex-1\"\n              >\n                {loading ? 'Creating...' : 'Create Space'}\n              </Button>\n            </div>\n          </form>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/s/[slug]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Space' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'api' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect } from 'react';\nimport { useParams, useRouter, notFound } from 'next/navigation';\nimport { UnifiedSpaceInterface } from '@/components/spaces/unified-space-interface';\nimport type { Space, User } from '@hive/core';\nimport { api } from '@/lib/api-client';\n\n/**\n * ‚òÖ Insight ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n * This implements the new /spaces/s/[slug] pattern, following Reddit's r/subreddit convention. Slug-based URLs are more memorable and shareable than IDs, improving the user experience and SEO.\n * ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n */\n\nexport default function SpacePage() {\n  const params = useParams();\n  const router = useRouter();\n  const slug = params.slug as string;\n\n  const [spaceId, setSpaceId] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Resolve slug to space ID\n  useEffect(() => {\n    async function resolveSlug() {\n      if (!slug) return;\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Try to resolve slug to space ID via API\n        const response = await fetch(`/api/spaces/resolve-slug/${slug}`);\n\n        if (response.status === 404) {\n          notFound();\n          return;\n        }\n\n        if (!response.ok) {\n          throw new Error('Failed to resolve space');\n        }\n\n        const data = await response.json();\n        setSpaceId(data.spaceId);\n\n      } catch (err) {\n        console.error('Error resolving space slug:', err);\n        setError(err instanceof Error ? err.message : 'Failed to load space');\n      } finally {\n        setIsLoading(false);\n      }\n    }\n\n    resolveSlug();\n  }, [slug]);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)] mx-auto mb-4\" />\n          <p className=\"text-white/70\">Loading /s/{slug}...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !spaceId) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"max-w-md mx-auto text-center p-8\">\n          <h2 className=\"text-2xl font-bold text-white mb-4\">Space Not Found</h2>\n          <p className=\"text-gray-400 mb-6\">\n            The space /s/{slug} could not be found or is no longer available.\n          </p>\n          <button\n            onClick={() => router.push('/spaces')}\n            className=\"px-6 py-2 bg-[var(--hive-brand-primary)] text-black rounded-lg hover:bg-yellow-400 transition-colors\"\n          >\n            Browse Spaces\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return <UnifiedSpaceInterface spaceId={spaceId} />;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/spaces/search/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/analytics/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/deploy/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/edit/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/preview/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/run/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/[toolId]/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/tools/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'personalTools' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":274,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":274,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":285,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":285,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleTabChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":287,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":287,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleToolInstall' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":292,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":292,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleToolPreview' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":380,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":380,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleToolAction' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":386,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":386,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useToast } from \"@hive/ui\";\nimport { CompleteHIVEToolsSystem } from \"@/components/temp-stubs\";\nimport { useSession } from \"../../hooks/use-session\";\nimport { ErrorBoundary } from \"../../components/error-boundary\";\nimport { ToolsLoadingSkeleton } from \"../../components/tools/tools-loading-skeleton\";\nimport { logger } from \"@/lib/logger\";\nimport {\n  MessageSquare,\n  Timer,\n  Calculator,\n  BarChart3,\n  Calendar,\n  Car,\n} from \"lucide-react\";\n\n// Type definition for fetch headers\ntype HeadersInit = Record<string, string>;\n\n// Enhanced tools fetch with API integration\nasync function fetchMarketplaceTools(): Promise<any[]> {\n  const headers: HeadersInit = {};\n  try {\n    const sessionJson = window.localStorage.getItem(\"hive_session\");\n    if (sessionJson) {\n      const session = JSON.parse(sessionJson);\n      headers.Authorization = `Bearer ${\n        process.env.NODE_ENV === \"development\" ? \"test-token\" : session.token\n      }`;\n    } else {\n      headers.Authorization = `Bearer test-token`;\n    }\n  } catch (error) {\n    headers.Authorization = `Bearer test-token`;\n  }\n\n  const response = await fetch(\"/api/tools/browse\", { headers });\n\n  if (!response.ok) {\n    throw new Error(`Failed to fetch marketplace tools: ${response.status}`);\n  }\n\n  const data = await response.json();\n  return data.tools || [];\n}\n\nasync function fetchPersonalTools(): Promise<any[]> {\n  const headers: HeadersInit = {};\n  try {\n    const sessionJson = window.localStorage.getItem(\"hive_session\");\n    if (sessionJson) {\n      const session = JSON.parse(sessionJson);\n      headers.Authorization = `Bearer ${\n        process.env.NODE_ENV === \"development\" ? \"test-token\" : session.token\n      }`;\n    } else {\n      headers.Authorization = `Bearer test-token`;\n    }\n  } catch (error) {\n    headers.Authorization = `Bearer test-token`;\n  }\n\n  const response = await fetch(\"/api/tools/personal\", { headers });\n\n  if (!response.ok) {\n    throw new Error(`Failed to fetch personal tools: ${response.status}`);\n  }\n\n  const data = await response.json();\n  return data.tools || [];\n}\n\n// Import campus-specific templates and deployment system\nimport { CAMPUS_TOOL_TEMPLATES } from \"../../lib/campus-tools-templates\";\nimport {\n  TemplateDeploymentService,\n  DEPLOYMENT_PRESETS,\n} from \"../../lib/template-deployment\";\n\n// Convert campus templates to marketplace format\nconst CAMPUS_MARKETPLACE_TOOLS = CAMPUS_TOOL_TEMPLATES.map((template) => ({\n  id: template.id,\n  name: template.name,\n  description: template.description,\n  category: template.category,\n  type: \"template\" as const,\n  icon:\n    template.category === \"academic\"\n      ? Calculator\n      : template.category === \"social\"\n      ? MessageSquare\n      : template.category === \"events\"\n      ? Calendar\n      : template.category === \"services\"\n      ? Car\n      : BarChart3,\n  color:\n    template.category === \"academic\"\n      ? \"#10B981\"\n      : template.category === \"social\"\n      ? \"#3B82F6\"\n      : template.category === \"events\"\n      ? \"#F59E0B\"\n      : template.category === \"services\"\n      ? \"#8B5CF6\"\n      : \"#6B7280\",\n  downloads:\n    template.viralPotential === \"very-high\"\n      ? Math.floor(Math.random() * 500) + 200\n      : template.viralPotential === \"high\"\n      ? Math.floor(Math.random() * 300) + 100\n      : Math.floor(Math.random() * 150) + 50,\n  rating: 4.5 + Math.random() * 0.5,\n  ratingCount: Math.floor(Math.random() * 50) + 20,\n  creator: \"UB Students\",\n  creatorType: \"community\" as const,\n  tags: [template.category, \"campus\", \"ub\"],\n  version: \"1.0.0\",\n  lastUpdated: new Date(),\n  isFeatured: template.viralPotential === \"very-high\",\n  isVerified: true,\n  isInstalled: false,\n  isPremium: false,\n  supportedPlatforms: [\"web\", \"mobile\"] as const,\n  requiredPermissions: [\"spaces.read\", \"spaces.write\"],\n  viralPotential: template.viralPotential,\n  ubSpecific: template.ubSpecific,\n}));\n\n// Legacy marketplace tools for comparison\nconst MARKETPLACE_TOOLS = [\n  {\n    id: \"poll-maker\",\n    name: \"Poll Maker\",\n    description: \"Create interactive polls for spaces and events\",\n    category: \"social\" as const,\n    type: \"individual\" as const,\n    icon: MessageSquare,\n    color: \"#3B82F6\",\n    downloads: 1247,\n    rating: 4.8,\n    ratingCount: 89,\n    creator: \"HIVE Team\",\n    creatorType: \"hive_team\" as const,\n    tags: [\"polling\", \"engagement\", \"voting\"],\n    version: \"2.1.0\",\n    lastUpdated: new Date(\"2024-01-15\"),\n    isFeatured: true,\n    isVerified: true,\n    isInstalled: true,\n    isPremium: false,\n    supportedPlatforms: [\"web\", \"mobile\"] as const,\n    requiredPermissions: [\"spaces.read\", \"spaces.write\"],\n  },\n  {\n    id: \"study-timer\",\n    name: \"Study Timer\",\n    description: \"Pomodoro-style timer with focus tracking\",\n    category: \"productivity\" as const,\n    type: \"individual\" as const,\n    icon: Timer,\n    color: \"var(--hive-brand-primary)\",\n    downloads: 892,\n    rating: 4.6,\n    ratingCount: 67,\n    creator: \"Focus Labs\",\n    creatorType: \"organization\" as const,\n    tags: [\"timer\", \"productivity\", \"study\"],\n    version: \"1.5.2\",\n    lastUpdated: new Date(\"2024-01-10\"),\n    isFeatured: true,\n    isVerified: true,\n    isInstalled: false,\n    isPremium: false,\n    supportedPlatforms: [\"web\", \"mobile\", \"desktop\"] as const,\n    requiredPermissions: [\"notifications\"],\n  },\n  {\n    id: \"grade-calculator\",\n    name: \"Grade Calculator\",\n    description: \"Calculate GPA and track academic progress\",\n    category: \"academic\" as const,\n    type: \"individual\" as const,\n    icon: Calculator,\n    color: \"#F59E0B\",\n    downloads: 2156,\n    rating: 4.9,\n    ratingCount: 234,\n    creator: \"Academic Tools\",\n    creatorType: \"student\" as const,\n    tags: [\"grades\", \"gpa\", \"academic\"],\n    version: \"3.0.1\",\n    lastUpdated: new Date(\"2024-01-08\"),\n    isFeatured: false,\n    isVerified: true,\n    isInstalled: true,\n    isPremium: false,\n    supportedPlatforms: [\"web\", \"mobile\"] as const,\n    requiredPermissions: [\"profile.read\"],\n  },\n  {\n    id: \"analytics-dashboard\",\n    name: \"Analytics Dashboard\",\n    description: \"Track and visualize your space engagement\",\n    category: \"productivity\" as const,\n    type: \"individual\" as const,\n    icon: BarChart3,\n    color: \"#10B981\",\n    downloads: 543,\n    rating: 4.7,\n    ratingCount: 45,\n    creator: \"HIVE Team\",\n    creatorType: \"hive_team\" as const,\n    tags: [\"analytics\", \"dashboard\", \"metrics\"],\n    version: \"1.2.0\",\n    lastUpdated: new Date(\"2024-01-12\"),\n    isFeatured: true,\n    isVerified: true,\n    isInstalled: false,\n    isPremium: true,\n    supportedPlatforms: [\"web\"] as const,\n    requiredPermissions: [\"analytics.read\", \"spaces.read\"],\n  },\n];\n\n// Unified Tools Section per @hive.md: Marketplace, Personal Tools, and HiveLab\nexport default function ToolsPage() {\n  const [isClient, setIsClient] = useState(false);\n  const [activeTab, setActiveTab] = useState<\n    \"marketplace\" | \"personal\" | \"hivelab\"\n  >(\"marketplace\");\n\n  const { user: _user } = useSession();\n  const { showToast } = useToast();\n\n  // Temporarily using default flags while fixing React context issue\n  const flags = useMemo(\n    () => ({\n      trackEvent: (_feature: string, _action: string, _metadata?: any) => {\n        logger.debug(\"Track event\", {\n          category: 'tools',\n          action: _action,\n          metadata: _metadata,\n        });\n      },\n    }),\n    []\n  );\n\n  useEffect(() => {\n    setIsClient(true);\n    // Track page view\n    flags.trackEvent(\"tools\", \"view\", { page: \"tools-marketplace\" });\n  }, [flags]);\n\n  const {\n    data: marketplaceTools,\n    isLoading: marketplaceLoading,\n    error: marketplaceError,\n  } = useQuery({\n    queryKey: [\"marketplace-tools\"],\n    queryFn: fetchMarketplaceTools,\n    staleTime: 300000, // 5 minutes\n    enabled: isClient && activeTab === \"marketplace\",\n  });\n\n  const {\n    data: personalTools,\n    isLoading: personalLoading,\n    error: personalError,\n  } = useQuery({\n    queryKey: [\"personal-tools\"],\n    queryFn: fetchPersonalTools,\n    staleTime: 300000, // 5 minutes\n    enabled: isClient && activeTab === \"personal\",\n  });\n\n  const isLoading = marketplaceLoading || personalLoading;\n  const error = marketplaceError || personalError;\n\n  const handleTabChange = (tab: \"marketplace\" | \"personal\" | \"hivelab\") => {\n    setActiveTab(tab);\n    flags.trackEvent(\"tools\", \"tab_change\", { tab });\n  };\n\n  const handleToolInstall = async (toolId: string) => {\n    try {\n      const tool = [...CAMPUS_MARKETPLACE_TOOLS, ...MARKETPLACE_TOOLS].find(\n        (t) => t.id === toolId\n      );\n      if (!tool) {\n        throw new Error(\"Tool not found\");\n      }\n\n      // Check if this is a campus template\n      const isCampusTemplate = CAMPUS_TOOL_TEMPLATES.some(\n        (t) => t.id === toolId\n      );\n\n      if (isCampusTemplate) {\n        // Deploy campus template as working tool\n        const deploymentRequest = {\n          templateId: toolId,\n          userId: _user?.id || \"anonymous\",\n          socialSettings: DEPLOYMENT_PRESETS.space_shared, // Default to viral sharing\n        };\n\n        const deployedTool = await TemplateDeploymentService.deployTemplate(\n          deploymentRequest\n        );\n\n        flags.trackEvent(\"tools\", \"template_deploy\", {\n          toolId,\n          templateId: deployedTool.templateId,\n          viralPotential: 'viralPotential' in tool ? (tool as any).viralPotential : 'high',\n        });\n\n        // Show success with link to use the tool\n        showToast({\n          title: `${tool.name} created! üéâ`,\n          message: 'Share with friends to get the most value',\n          type: 'success',\n          duration: 4000\n        });\n\n        // Navigate to the deployed tool\n        window.location.href = `/tools/${deployedTool.id}/run`;\n      } else {\n        // Legacy tool installation\n        const sessionData = window.localStorage.getItem(\"hive_session\");\n        const authToken = sessionData ? \"session-token\" : \"test-token\";\n\n        const response = await fetch(\"/api/tools/install\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${authToken}`,\n          },\n          body: JSON.stringify({ toolId }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          throw new Error(\n            errorData.message || `Installation failed (${response.status})`\n          );\n        }\n\n        flags.trackEvent(\"tools\", \"install\", { toolId });\n        showToast({\n          title: 'Tool installed!',\n          message: `${tool.name} is now ready to use`,\n          type: 'success',\n          duration: 3000\n        });\n      }\n    } catch (error) {\n      logger.error(\"Failed to install tool\", {\n        toolId,\n        error: error instanceof Error ? error.message : String(error),\n        stack: error instanceof Error ? error.stack : undefined,\n      });\n      const errorMessage =\n        error instanceof Error ? error.message : \"Failed to install tool\";\n      showToast({\n        title: 'Installation failed',\n        message: errorMessage,\n        type: 'error',\n        duration: 5000\n      });\n    }\n  };\n\n  const handleToolPreview = (toolId: string) => {\n    flags.trackEvent(\"tools\", \"preview\", { toolId });\n    // Navigate to tool preview page\n    window.location.href = `/tools/${toolId}/preview`;\n  };\n\n  const handleToolAction = (toolId: string, action: string) => {\n    flags.trackEvent(\"tools\", \"action\", { toolId, action });\n\n    switch (action) {\n      case \"edit\":\n        window.location.href = `/tools/${toolId}/edit`;\n        break;\n      case \"run\":\n        window.location.href = `/tools/${toolId}/run`;\n        break;\n      case \"settings\":\n        window.location.href = `/tools/${toolId}/settings`;\n        break;\n      case \"share\": {\n        navigator.clipboard.writeText(\n          `${window.location.origin}/tools/${toolId}`\n        );\n        showToast({\n          title: 'Link copied!',\n          message: 'Tool link copied to clipboard',\n          type: 'success',\n          duration: 2000\n        });\n        break;\n      }\n      default:\n        logger.warn(\"Unknown tool action\", { action });\n    }\n  };\n\n  const handleCreateTool = (\n    mode: \"visual\" | \"template\" | \"wizard\" = \"visual\"\n  ) => {\n    flags.trackEvent(\"tools\", \"create_start\", { mode });\n    // Navigate to HiveLab with mode parameter\n    window.location.href = `/hivelab?mode=${mode}`;\n  };\n\n  // Show loading skeleton while data is being fetched\n  if (isLoading || !isClient) {\n    return <ToolsLoadingSkeleton />;\n  }\n\n  return (\n    <ErrorBoundary>\n      <CompleteHIVEToolsSystem\n        tools={\n          marketplaceTools || [\n            ...CAMPUS_MARKETPLACE_TOOLS,\n            ...MARKETPLACE_TOOLS,\n          ]\n        }\n        onToolCreate={handleCreateTool}\n        showCreateButton={true}\n        showSearch={true}\n        showFilters={true}\n        className=\"w-full\"\n      />\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/universal-shell-provider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":44,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'navigationItems' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":47,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'notificationCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":95,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'messageCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":96,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSearch' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":98,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'query' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":98,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleNotificationsClick' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":101,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleMessagesClick' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":105,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":105,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { usePathname } from 'next/navigation';\nimport dynamic from 'next/dynamic';\nimport { useAuth } from '@hive/auth-logic';\nimport {\n  Home,\n  Users,\n  User,\n  Wrench,\n  Calendar,\n  Sparkles,\n} from 'lucide-react';\n\n// Import UniversalShell with SSR support for better performance\nconst UniversalShell = dynamic(\n  () => import('@hive/ui').then(mod => mod.UniversalShell || mod.default),\n  {\n    ssr: true, // Enable SSR for better initial load performance\n    loading: () => <ShellLoader />\n  }\n);\n\n// Routes that should NOT have the shell (auth pages, landing, etc.)\nconst NO_SHELL_ROUTES = [\n  '/auth/login',\n  '/auth/verify',\n  '/signin',\n  '/onboarding',\n  '/landing',\n  '/waitlist',\n  '/schools',\n  '/debug-auth',\n];\n\n// Routes that should have a minimal shell (public profiles)\nconst MINIMAL_SHELL_ROUTES = [\n  '/profile/', // Public profile pages\n];\n\nexport function UniversalShellProvider({ children }: { children: React.ReactNode }) {\n  const pathname = usePathname();\n  const { user } = useAuth();\n\n  // Define navigation items based on HIVE's structure (migrated from NavigationLayout)\n  const navigationItems = [\n    // Tier 1: Primary Navigation (always visible in top bar)\n    {\n      id: 'feed',\n      label: 'Feed',\n      icon: <Home className=\"h-4 w-4\" />,\n      href: '/feed',\n      tier: 1\n    },\n    {\n      id: 'spaces',\n      label: 'Spaces',\n      icon: <Users className=\"h-4 w-4\" />,\n      href: '/spaces',\n      tier: 1\n    },\n    {\n      id: 'profile',\n      label: 'Profile',\n      icon: <User className=\"h-4 w-4\" />,\n      href: '/profile',\n      tier: 1\n    },\n    // Tier 3: Secondary Navigation (hamburger menu)\n    {\n      id: 'hivelab',\n      label: 'HiveLab',\n      icon: <Wrench className=\"h-4 w-4\" />,\n      href: '/hivelab',\n      tier: 3\n    },\n    {\n      id: 'events',\n      label: 'Events',\n      icon: <Calendar className=\"h-4 w-4\" />,\n      href: '/events',\n      tier: 3\n    },\n    {\n      id: 'rituals',\n      label: 'Rituals',\n      icon: <Sparkles className=\"h-4 w-4\" />,\n      href: '/rituals',\n      tier: 3\n    }\n  ];\n\n  // Mock notification and message counts (in production, these would come from hooks)\n  const [notificationCount, setNotificationCount] = React.useState(5);\n  const [messageCount, setMessageCount] = React.useState(3);\n\n  const handleSearch = (query: string) => {\n  };\n\n  const handleNotificationsClick = () => {\n    setNotificationCount(0);\n  };\n\n  const handleMessagesClick = () => {\n    setMessageCount(0);\n  };\n\n  // Check if current route should have no shell\n  const shouldHaveNoShell = NO_SHELL_ROUTES.some(route =>\n    pathname?.startsWith(route) || pathname === '/'\n  );\n\n  // Check if current route should have minimal shell\n  const shouldHaveMinimalShell = MINIMAL_SHELL_ROUTES.some(route =>\n    pathname?.includes(route) && !pathname?.startsWith('/(dashboard)')\n  );\n\n  // For routes without shell, render children directly\n  if (shouldHaveNoShell) {\n    return <>{children}</>;\n  }\n\n  // For routes with minimal shell (public pages)\n  if (shouldHaveMinimalShell) {\n    return (\n      <UniversalShell variant=\"minimal\">\n        {children}\n      </UniversalShell>\n    );\n  }\n\n  // For dashboard routes, use full shell with navigation\n  // TODO: Extend UniversalShell to accept navigation props or create NavigationProvider\n  return (\n    <UniversalShell variant=\"full\">\n      {children}\n    </UniversalShell>\n  );\n}\n\n// Loading component while shell loads\nfunction ShellLoader() {\n  return (\n    <div className=\"min-h-screen bg-black flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"w-16 h-16 mx-auto mb-4 border-4 border-[var(--hive-brand-primary)] border-t-transparent rounded-full animate-spin\" />\n        <p className=\"text-white/60 animate-pulse\">Loading HIVE...</p>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/user/[handle]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HiveProfile' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n// Force dynamic rendering to avoid SSG issues\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect } from 'react';\nimport { useParams, useRouter, notFound } from 'next/navigation';\nimport { Card, Button } from \"@hive/ui\";\nimport { toUnifiedProfile } from '@/lib/profile-transformers';\nimport { ErrorBoundary } from '@/components/error-boundary';\nimport { useSession } from '@/hooks/use-session';\nimport type { HiveProfile, UnifiedHiveProfile } from '@hive/core';\n\nexport default function UserProfilePage() {\n  const params = useParams();\n  const router = useRouter();\n  const { user: currentUser } = useSession();\n  const handle = params.handle as string;\n\n  const [unifiedProfile, setUnifiedProfile] = useState<UnifiedHiveProfile | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const loadPublicProfile = async () => {\n      if (!handle) return;\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Check if viewing own profile - redirect to settings for editing\n        const isOwnProfile = currentUser?.handle === handle;\n        if (isOwnProfile) {\n          // Own profile - show with edit capabilities\n          router.push('/settings');\n          return;\n        }\n\n        // Load public profile\n        const response = await fetch(`/api/profile/public/${handle}`);\n\n        if (response.status === 404) {\n          notFound();\n          return;\n        }\n\n        if (!response.ok) {\n          throw new Error('Failed to load profile');\n        }\n\n        const data = await response.json();\n        // Convert HiveProfile to UnifiedHiveProfile\n        const unified = toUnifiedProfile(data.profile || data);\n        setUnifiedProfile(unified);\n\n      } catch (err) {\n        console.error('Error loading public profile:', err);\n        setError(err instanceof Error ? err.message : 'Failed to load profile');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadPublicProfile();\n  }, [handle, currentUser, router]);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)] mx-auto mb-4\" />\n          <p className=\"text-white/70\">Loading @{handle}...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-black flex items-center justify-center\">\n        <Card className=\"p-8 max-w-md mx-auto text-center bg-gray-900 border-gray-800\">\n          <h2 className=\"text-xl font-bold text-white mb-4\">Profile Not Found</h2>\n          <p className=\"text-gray-400 mb-6\">\n            The profile @{handle} could not be found or is not available.\n          </p>\n          <Button onClick={() => router.push('/')} variant=\"default\">\n            Back to Home\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary>\n      <div className=\"min-h-screen bg-black\">\n        <div className=\"max-w-7xl mx-auto px-4 py-8\">\n\n          {/* Profile Header with @handle */}\n          <div className=\"mb-8 text-center\">\n            <h1 className=\"text-4xl font-bold text-white mb-2\">\n              @{handle}\n            </h1>\n            <p className=\"text-[var(--hive-brand-primary)] text-lg\">\n              {unifiedProfile?.identity?.displayName || handle}\n            </p>\n          </div>\n\n          {unifiedProfile && (\n            <Card className=\"bg-gray-900/60 border border-gray-800 text-left text-gray-100\">\n              <div className=\"grid gap-6 md:grid-cols-2 p-6\">\n                <div>\n                  <h2 className=\"text-xl font-semibold text-white mb-2\">About</h2>\n                  <p className=\"text-gray-400\">\n                    {unifiedProfile.personal?.bio || 'This student has not added a bio yet.'}\n                  </p>\n                  <dl className=\"mt-4 space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <dt className=\"text-gray-500\">Campus</dt>\n                      <dd className=\"text-gray-200\">{unifiedProfile.campusId || 'UB Buffalo'}</dd>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <dt className=\"text-gray-500\">Major</dt>\n                      <dd className=\"text-gray-200\">{unifiedProfile.academic?.major || 'Undeclared'}</dd>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <dt className=\"text-gray-500\">Graduation</dt>\n                      <dd className=\"text-gray-200\">{unifiedProfile.academic?.graduationYear || 'TBD'}</dd>\n                    </div>\n                  </dl>\n                </div>\n                <div>\n                  <h2 className=\"text-xl font-semibold text-white mb-2\">Highlights</h2>\n                  <ul className=\"space-y-2 text-sm text-gray-300\">\n                    <li>Spaces joined: {unifiedProfile.stats?.spacesJoined ?? 0}</li>\n                    <li>Connections: {unifiedProfile.stats?.connectionsCount ?? 0}</li>\n                    <li>Current streak: {unifiedProfile.stats?.currentStreak ?? 0} days</li>\n                  </ul>\n                </div>\n              </div>\n            </Card>\n          )}\n\n          {/* Social Actions */}\n          <div className=\"mt-8 flex justify-center gap-4\">\n            <Button\n              variant=\"default\"\n              className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n            >\n              Follow\n            </Button>\n            <Button variant=\"outline\">\n              Message\n            </Button>\n          </div>\n        </div>\n      </div>\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/waitlist/[schoolId]/components/waitlist-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/waitlist/[schoolId]/components/waitlist-progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/app/waitlist/[schoolId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/admin-guard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/alert-dashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'filters.resolved' and 'filters.search'. Either exclude them or remove the dependency array.","line":139,"column":6,"nodeType":"ArrayExpression","endLine":139,"endColumn":100,"suggestions":[{"desc":"Update the dependencies array to be: [csrfToken, filters.component, filters.severity, getHeaders]","fix":{"range":[3469,3563],"text":"[csrfToken, filters.component, filters.severity, getHeaders]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@hive/ui';\nimport { Button } from '@hive/ui';\nimport { Badge } from '@hive/ui';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@hive/ui';\nimport { Alert, AlertDescription } from '@hive/ui';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@hive/ui';\nimport { Input } from '@hive/ui';\nimport { Textarea } from '@hive/ui';\nimport { Switch } from '@hive/ui';\nimport {\n  AlertTriangle,\n  CheckCircle,\n  Clock,\n  Eye,\n  EyeOff,\n  RefreshCw,\n  Shield,\n  Database,\n  Zap,\n  Users,\n  Search,\n  ArrowUp,\n  Activity,\n  User\n} from 'lucide-react';\nimport { useCSRF, protectedFetch } from '@/hooks/use-csrf';\n\ninterface Alert {\n  id: string;\n  type: 'system' | 'performance' | 'security' | 'user_impact';\n  severity: 'critical' | 'high' | 'medium' | 'low';\n  component: string;\n  title: string;\n  description: string;\n  timestamp: string;\n  resolved: boolean;\n  acknowledged: boolean;\n  assignee: string | null;\n  tags: string[];\n  metadata: {\n    source: string;\n    context: Record<string, any>;\n    [key: string]: any;\n  };\n}\n\ninterface AlertSummary {\n  total: number;\n  active: number;\n  resolved: number;\n  acknowledged: number;\n  critical: number;\n  high: number;\n  medium: number;\n  low: number;\n}\n\ninterface Incident {\n  id: string;\n  title: string;\n  description: string;\n  status: 'investigating' | 'identified' | 'monitoring' | 'resolved';\n  severity: 'critical' | 'high' | 'medium' | 'low';\n  affectedUsers: string;\n  startedAt: string;\n  lastUpdate: string;\n  assignee: string;\n  updates: Array<{\n    timestamp: string;\n    status: string;\n    message: string;\n  }>;\n}\n\ninterface AlertsData {\n  summary: AlertSummary;\n  active: {\n    critical: Alert[];\n    high: Alert[];\n    medium: Alert[];\n    low: Alert[];\n  };\n  incidents: Incident[];\n  categories: {\n    system: Alert[];\n    performance: Alert[];\n    security: Alert[];\n    userImpact: Alert[];\n  };\n  trends: {\n    alertsPerHour: Array<{ hour: string; count: number }>;\n    resolutionTime: { average: number; median: number };\n    falsePositiveRate: number;\n  };\n}\n\nexport function AlertDashboard() {\n  const [alertsData, setAlertsData] = useState<AlertsData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedAlert, setSelectedAlert] = useState<Alert | null>(null);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [filters, setFilters] = useState({\n    severity: '',\n    component: '',\n    resolved: false,\n    search: ''\n  });\n\n  const { token: csrfToken, getHeaders } = useCSRF();\n\n  const loadAlerts = useCallback(async () => {\n    setLoading(true);\n    try {\n      const params = new URLSearchParams({\n        range: '24h',\n        ...(filters.severity && { severity: filters.severity }),\n        ...(filters.component && { component: filters.component })\n      });\n\n      const response = await protectedFetch(`/api/admin/alerts?${params}`, {\n        headers: getHeaders()\n      }, csrfToken);\n\n      if (!response.ok) {\n        throw new Error('Failed to load alerts');\n      }\n\n      const data = await response.json();\n      setAlertsData(data.alerts);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error');\n    } finally {\n      setLoading(false);\n    }\n  }, [csrfToken, filters.component, filters.resolved, filters.search, filters.severity, getHeaders]);\n\n  useEffect(() => {\n    loadAlerts();\n  }, [loadAlerts]);\n\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    const interval = setInterval(() => {\n      loadAlerts();\n    }, 30000); // Refresh every 30 seconds\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, loadAlerts]);\n\n  const handleAlertAction = async (alertId: string, action: string, notes?: string) => {\n    try {\n      const response = await protectedFetch('/api/admin/alerts', {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify({ alertId, action, notes })\n      }, csrfToken);\n\n      if (!response.ok) {\n        throw new Error(`Failed to ${action} alert`);\n      }\n\n      // Reload alerts to reflect changes\n      await loadAlerts();\n      setSelectedAlert(null);\n    } catch (err) {\n      console.error(`Error ${action} alert:`, err);\n    }\n  };\n\n  const filteredAlerts = (alerts: Alert[]) => {\n    return alerts.filter(alert => {\n      if (filters.resolved && !alert.resolved) return false;\n      if (filters.search && !alert.title.toLowerCase().includes(filters.search.toLowerCase()) &&\n          !alert.description.toLowerCase().includes(filters.search.toLowerCase())) return false;\n      return true;\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  if (error || !alertsData) {\n    return (\n      <Alert variant=\"destructive\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertDescription>\n          Failed to load alerts: {error}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  const { summary, active, incidents, categories, trends } = alertsData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header Controls */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\">Alert Dashboard</h2>\n          <p className=\"text-gray-400 mt-1\">Real-time system monitoring and alerting</p>\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              id=\"auto-refresh\"\n              checked={autoRefresh}\n              onCheckedChange={setAutoRefresh}\n            />\n            <label htmlFor=\"auto-refresh\" className=\"text-sm text-gray-400\">\n              Auto-refresh\n            </label>\n          </div>\n          <Button onClick={loadAlerts} variant=\"outline\" className=\"max-w-sm\">\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </div>\n\n      {/* Alert Summary Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card className=\"bg-gradient-to-br from-red-600/20 to-red-800/20 border-red-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Critical Alerts</CardTitle>\n            <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-red-400\">{summary.critical}</div>\n            <p className=\"text-xs text-gray-400\">\n              {summary.critical > 0 ? 'Immediate attention required' : 'No critical issues'}\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-orange-600/20 to-orange-800/20 border-orange-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">High Priority</CardTitle>\n            <ArrowUp className=\"h-4 w-4 text-orange-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-orange-400\">{summary.high}</div>\n            <p className=\"text-xs text-gray-400\">\n              Require prompt attention\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-blue-600/20 to-blue-800/20 border-blue-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active Alerts</CardTitle>\n            <Activity className=\"h-4 w-4 text-blue-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-blue-400\">{summary.active}</div>\n            <p className=\"text-xs text-gray-400\">\n              {summary.acknowledged} acknowledged\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Resolution Time</CardTitle>\n            <Clock className=\"h-4 w-4 text-green-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-400\">{trends.resolutionTime.average}m</div>\n            <p className=\"text-xs text-gray-400\">\n              Average resolution time\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Active Incidents Banner */}\n      {incidents.length > 0 && (\n        <Alert className=\"bg-red-500/10 border-red-500/30\">\n          <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n          <AlertDescription className=\"text-red-400\">\n            <strong>{incidents.length} active incident{incidents.length > 1 ? 's' : ''}</strong> requiring attention\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Main Alert Interface */}\n      <Tabs defaultValue=\"active\" className=\"space-y-4\">\n        <TabsList className=\"grid w-full grid-cols-5 bg-gray-900 border border-gray-800\">\n          <TabsTrigger value=\"active\">\n            Active ({summary.active})\n          </TabsTrigger>\n          <TabsTrigger value=\"incidents\">\n            Incidents ({incidents.length})\n          </TabsTrigger>\n          <TabsTrigger value=\"categories\">\n            By Category\n          </TabsTrigger>\n          <TabsTrigger value=\"trends\">\n            Trends\n          </TabsTrigger>\n          <TabsTrigger value=\"settings\">\n            Settings\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Active Alerts Tab */}\n        <TabsContent value=\"active\" className=\"space-y-4\">\n          {/* Filters */}\n          <div className=\"flex items-center gap-4 mb-6\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n              <Input\n                placeholder=\"Search alerts...\"\n                className=\"pl-10\"\n                value={filters.search}\n                onChange={(e: React.ChangeEvent) => setFilters(prev => ({ ...prev, search: (e.target as any).value }))}\n              />\n            </div>\n            <select\n              className=\"px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white\"\n              value={filters.severity}\n              onChange={(e: React.ChangeEvent) => setFilters(prev => ({ ...prev, severity: (e.target as any).value }))}\n            >\n              <option value=\"\">All Severities</option>\n              <option value=\"critical\">Critical</option>\n              <option value=\"high\">High</option>\n              <option value=\"medium\">Medium</option>\n              <option value=\"low\">Low</option>\n            </select>\n            <select\n              className=\"px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white\"\n              value={filters.component}\n              onChange={(e: React.ChangeEvent) => setFilters(prev => ({ ...prev, component: (e.target as any).value }))}\n            >\n              <option value=\"\">All Components</option>\n              <option value=\"database\">Database</option>\n              <option value=\"api\">API</option>\n              <option value=\"authentication\">Authentication</option>\n              <option value=\"security\">Security</option>\n            </select>\n          </div>\n\n          {/* Critical Alerts */}\n          {active.critical.length > 0 && (\n            <Card className=\"border-red-500/30 bg-red-500/5\">\n              <CardHeader>\n                <CardTitle className=\"text-red-400 flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5\" />\n                  Critical Alerts ({active.critical.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {filteredAlerts(active.critical).map((alert) => (\n                    <AlertCard\n                      key={alert.id}\n                      alert={alert}\n                      onSelect={setSelectedAlert}\n                      onAction={handleAlertAction}\n                    />\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* High Priority Alerts */}\n          {active.high.length > 0 && (\n            <Card className=\"border-orange-500/30 bg-orange-500/5\">\n              <CardHeader>\n                <CardTitle className=\"text-orange-400 flex items-center gap-2\">\n                  <ArrowUp className=\"w-5 h-5\" />\n                  High Priority Alerts ({active.high.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {filteredAlerts(active.high).map((alert) => (\n                    <AlertCard\n                      key={alert.id}\n                      alert={alert}\n                      onSelect={setSelectedAlert}\n                      onAction={handleAlertAction}\n                    />\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Medium & Low Priority */}\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {active.medium.length > 0 && (\n              <Card className=\"border-yellow-500/30\">\n                <CardHeader>\n                  <CardTitle className=\"text-yellow-400 text-sm\">Medium Priority ({active.medium.length})</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    {filteredAlerts(active.medium).slice(0, 5).map((alert) => (\n                      <AlertCard\n                        key={alert.id}\n                        alert={alert}\n                        onSelect={setSelectedAlert}\n                        onAction={handleAlertAction}\n                        compact\n                      />\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {active.low.length > 0 && (\n              <Card className=\"border-blue-500/30\">\n                <CardHeader>\n                  <CardTitle className=\"text-blue-400 text-sm\">Low Priority ({active.low.length})</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    {filteredAlerts(active.low).slice(0, 5).map((alert) => (\n                      <AlertCard\n                        key={alert.id}\n                        alert={alert}\n                        onSelect={setSelectedAlert}\n                        onAction={handleAlertAction}\n                        compact\n                      />\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* Incidents Tab */}\n        <TabsContent value=\"incidents\" className=\"space-y-4\">\n          {incidents.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-8 text-center\">\n                <CheckCircle className=\"w-12 h-12 text-green-400 mx-auto mb-4\" />\n                <p className=\"text-gray-400\">No active incidents</p>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"space-y-4\">\n              {incidents.map((incident) => (\n                <IncidentCard key={incident.id} incident={incident} />\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        {/* Categories Tab */}\n        <TabsContent value=\"categories\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <CategoryCard\n              title=\"System Alerts\"\n              alerts={categories.system}\n              icon={<Database className=\"w-5 h-5\" />}\n              color=\"blue\"\n            />\n            <CategoryCard\n              title=\"Performance\"\n              alerts={categories.performance}\n              icon={<Zap className=\"w-5 h-5\" />}\n              color=\"yellow\"\n            />\n            <CategoryCard\n              title=\"Security\"\n              alerts={categories.security}\n              icon={<Shield className=\"w-5 h-5\" />}\n              color=\"red\"\n            />\n            <CategoryCard\n              title=\"User Impact\"\n              alerts={categories.userImpact}\n              icon={<Users className=\"w-5 h-5\" />}\n              color=\"purple\"\n            />\n          </div>\n        </TabsContent>\n\n        {/* Trends Tab */}\n        <TabsContent value=\"trends\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Alert Volume Trend</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-blue-400 mb-2\">\n                  {trends.alertsPerHour.reduce((sum, hour) => sum + hour.count, 0)}\n                </div>\n                <p className=\"text-xs text-gray-400\">Total alerts (24h)</p>\n                <div className=\"mt-4 space-y-1\">\n                  {trends.alertsPerHour.slice(-6).map(hour => (\n                    <div key={hour.hour} className=\"flex justify-between text-xs\">\n                      <span className=\"text-gray-400\">\n                        {new Date(hour.hour).toLocaleTimeString([], { hour: '2-digit' })}\n                      </span>\n                      <span className=\"text-white\">{hour.count}</span>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Resolution Metrics</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-green-400 mb-2\">\n                  {trends.resolutionTime.average}m\n                </div>\n                <p className=\"text-xs text-gray-400\">Avg resolution time</p>\n                <div className=\"mt-4 space-y-2\">\n                  <div className=\"flex justify-between text-xs\">\n                    <span className=\"text-gray-400\">Median:</span>\n                    <span className=\"text-white\">{trends.resolutionTime.median}m</span>\n                  </div>\n                  <div className=\"flex justify-between text-xs\">\n                    <span className=\"text-gray-400\">False positive rate:</span>\n                    <span className=\"text-white\">{trends.falsePositiveRate.toFixed(1)}%</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">System Health</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-green-400 mb-2\">\n                  {summary.critical === 0 && summary.high <= 1 ? '98%' : '85%'}\n                </div>\n                <p className=\"text-xs text-gray-400\">Overall health score</p>\n                <div className=\"mt-4\">\n                  <div className=\"w-full bg-gray-800 rounded-full h-2\">\n                    <div\n                      className=\"bg-green-500 h-2 rounded-full\"\n                      style={{ width: summary.critical === 0 && summary.high <= 1 ? '98%' : '85%' }}\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* Settings Tab */}\n        <TabsContent value=\"settings\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Alert Configuration</CardTitle>\n              <CardDescription>Configure alert thresholds and notification settings</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium\">Real-time notifications</p>\n                    <p className=\"text-sm text-gray-400\">Push notifications for critical alerts</p>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium\">Email summaries</p>\n                    <p className=\"text-sm text-gray-400\">Daily summary of all alerts</p>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium\">Auto-acknowledge low priority</p>\n                    <p className=\"text-sm text-gray-400\">Automatically acknowledge low priority alerts after 1 hour</p>\n                  </div>\n                  <Switch />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Alert Detail Modal */}\n      {selectedAlert && (\n        <AlertDetailModal\n          alert={selectedAlert}\n          onClose={() => setSelectedAlert(null)}\n          onAction={handleAlertAction}\n        />\n      )}\n    </div>\n  );\n}\n\n// Alert Card Component\nfunction AlertCard({\n  alert,\n  onSelect,\n  onAction,\n  compact = false\n}: {\n  alert: Alert;\n  onSelect: (alert: Alert) => void;\n  onAction: (id: string, action: string, notes?: string) => void;\n  compact?: boolean;\n}) {\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'critical': return 'text-red-400 bg-red-400/10 border-red-400/30';\n      case 'high': return 'text-orange-400 bg-orange-400/10 border-orange-400/30';\n      case 'medium': return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n      case 'low': return 'text-blue-400 bg-blue-400/10 border-blue-400/30';\n      default: return 'text-gray-400 bg-gray-400/10 border-gray-400/30';\n    }\n  };\n\n  const formatRelativeTime = (timestamp: string) => {\n    const now = new Date();\n    const time = new Date(timestamp);\n    const diffInMinutes = Math.floor((now.getTime() - time.getTime()) / (1000 * 60));\n    if (diffInMinutes < 60) return `${diffInMinutes}m ago`;\n    if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}h ago`;\n    return `${Math.floor(diffInMinutes / 1440)}d ago`;\n  };\n\n  return (\n    <div\n      className={`p-3 bg-gray-800/50 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors cursor-pointer ${compact ? 'py-2' : ''}`}\n      onClick={() => onSelect(alert)}\n    >\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex-1\">\n          <div className=\"flex items-center gap-3 mb-1\">\n            <Badge className={`text-xs ${getSeverityColor(alert.severity)}`}>\n              {alert.severity.toUpperCase()}\n            </Badge>\n            <span className={`text-xs text-gray-400 ${compact ? 'hidden' : ''}`}>\n              {alert.component}\n            </span>\n            <span className=\"text-xs text-gray-500\">\n              {formatRelativeTime(alert.timestamp)}\n            </span>\n          </div>\n          <h4 className={`text-white font-medium ${compact ? 'text-sm' : ''}`}>\n            {alert.title}\n          </h4>\n          {!compact && (\n            <p className=\"text-sm text-gray-400 mt-1 line-clamp-2\">\n              {alert.description}\n            </p>\n          )}\n          <div className=\"flex items-center gap-4 mt-2\">\n            {alert.acknowledged && (\n              <span className=\"text-xs text-green-400 flex items-center gap-1\">\n                <Eye className=\"w-3 h-3\" />\n                Acknowledged\n              </span>\n            )}\n            {alert.assignee && (\n              <span className=\"text-xs text-blue-400 flex items-center gap-1\">\n                <User className=\"w-3 h-3\" />\n                {alert.assignee}\n              </span>\n            )}\n            {alert.tags.length > 0 && (\n              <div className=\"flex gap-1\">\n                {alert.tags.slice(0, 3).map(tag => (\n                  <Badge key={tag} variant=\"secondary\" className=\"text-xs py-0\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"flex items-center gap-2 ml-4\">\n          {!alert.acknowledged && (\n            <Button\n              className=\"max-w-sm\"\n              variant=\"outline\"\n              onClick={(e: React.MouseEvent) => {\n                e.stopPropagation();\n                onAction(alert.id, 'acknowledge');\n              }}\n            >\n              <Eye className=\"w-3 h-3\" />\n            </Button>\n          )}\n          {!alert.resolved && (\n            <Button\n              className=\"max-w-sm\"\n              variant=\"outline\"\n              onClick={(e: React.MouseEvent) => {\n                e.stopPropagation();\n                onAction(alert.id, 'resolve');\n              }}\n            >\n              <CheckCircle className=\"w-3 h-3\" />\n            </Button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Incident Card Component\nfunction IncidentCard({ incident }: { incident: Incident }) {\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'investigating': return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n      case 'identified': return 'text-orange-400 bg-orange-400/10 border-orange-400/30';\n      case 'monitoring': return 'text-blue-400 bg-blue-400/10 border-blue-400/30';\n      case 'resolved': return 'text-green-400 bg-green-400/10 border-green-400/30';\n      default: return 'text-gray-400 bg-gray-400/10 border-gray-400/30';\n    }\n  };\n\n  return (\n    <Card className=\"border-orange-500/30 bg-orange-500/5\">\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <AlertTriangle className=\"w-5 h-5 text-orange-400\" />\n            <div>\n              <CardTitle className=\"text-white\">{incident.title}</CardTitle>\n              <CardDescription className=\"text-gray-400\">\n                Started {new Date(incident.startedAt).toLocaleString()}\n              </CardDescription>\n            </div>\n          </div>\n          <Badge className={getStatusColor(incident.status)}>\n            {incident.status.toUpperCase()}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          <p className=\"text-gray-300\">{incident.description}</p>\n          <div className=\"flex items-center gap-4 text-sm text-gray-400\">\n            <span>Affected: {incident.affectedUsers}</span>\n            <span>Assignee: {incident.assignee}</span>\n            <span>Last update: {new Date(incident.lastUpdate).toLocaleString()}</span>\n          </div>\n          {incident.updates && incident.updates.length > 0 && (\n            <div className=\"mt-4 border-t border-gray-700 pt-3\">\n              <h4 className=\"text-sm font-medium text-white mb-2\">Recent Updates</h4>\n              <div className=\"space-y-2\">\n                {incident.updates.slice(-2).map((update, index) => (\n                  <div key={index} className=\"text-sm\">\n                    <span className=\"text-gray-400\">\n                      {new Date(update.timestamp).toLocaleTimeString()} -\n                    </span>\n                    <span className=\"text-gray-300 ml-2\">{update.message}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n// Category Card Component\nfunction CategoryCard({\n  title,\n  alerts,\n  icon,\n  color\n}: {\n  title: string;\n  alerts: Alert[];\n  icon: React.ReactNode;\n  color: string;\n}) {\n  const activeAlerts = alerts.filter(alert => !alert.resolved);\n  const colorClasses = {\n    blue: 'border-blue-500/30 text-blue-400',\n    yellow: 'border-yellow-500/30 text-yellow-400',\n    red: 'border-red-500/30 text-red-400',\n    purple: 'border-purple-500/30 text-purple-400'\n  };\n\n  return (\n    <Card className={colorClasses[color as keyof typeof colorClasses]}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-sm\">\n          {icon}\n          {title}\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"text-2xl font-bold mb-2\">\n          {activeAlerts.length}\n        </div>\n        <p className=\"text-xs text-gray-400 mb-3\">\n          Active alerts\n        </p>\n        {activeAlerts.length > 0 && (\n          <div className=\"space-y-1\">\n            {activeAlerts.slice(0, 3).map((alert) => (\n              <div key={alert.id} className=\"text-xs\">\n                <span className=\"text-white truncate block\">\n                  {alert.title}\n                </span>\n              </div>\n            ))}\n            {activeAlerts.length > 3 && (\n              <p className=\"text-xs text-gray-400\">\n                +{activeAlerts.length - 3} more\n              </p>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\n// Alert Detail Modal Component\nfunction AlertDetailModal({\n  alert,\n  onClose,\n  onAction\n}: {\n  alert: Alert;\n  onClose: () => void;\n  onAction: (id: string, action: string, notes?: string) => void;\n}) {\n  const [notes, setNotes] = useState('');\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-3\">\n            <Badge className={`${alert.severity === 'critical' ? 'bg-red-500' : alert.severity === 'high' ? 'bg-orange-500' : 'bg-yellow-500'}`}>\n              {alert.severity.toUpperCase()}\n            </Badge>\n            {alert.title}\n          </DialogTitle>\n          <DialogDescription>\n            {alert.type} ‚Ä¢ {alert.component} ‚Ä¢ {new Date(alert.timestamp).toLocaleString()}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-medium mb-2\">Description</h4>\n            <p className=\"text-gray-300\">{alert.description}</p>\n          </div>\n\n          {alert.metadata?.context && Object.keys(alert.metadata.context).length > 0 && (\n            <div>\n              <h4 className=\"font-medium mb-2\">Context</h4>\n              <pre className=\"bg-gray-800 p-3 rounded text-sm overflow-x-auto\">\n                {JSON.stringify(alert.metadata.context, null, 2)}\n              </pre>\n            </div>\n          )}\n\n          {alert.tags.length > 0 && (\n            <div>\n              <h4 className=\"font-medium mb-2\">Tags</h4>\n              <div className=\"flex gap-2 flex-wrap\">\n                {alert.tags.map(tag => (\n                  <Badge key={tag} variant=\"secondary\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div>\n            <h4 className=\"font-medium mb-2\">Actions</h4>\n            <Textarea\n              placeholder=\"Add notes (optional)...\"\n              value={notes}\n              onChange={(e: React.ChangeEvent) => setNotes((e.target as any).value)}\n              className=\"mb-3\"\n            />\n            <div className=\"flex gap-2\">\n              {!alert.acknowledged && (\n                <Button\n                  onClick={() => onAction(alert.id, 'acknowledge', notes)}\n                  variant=\"outline\"\n                >\n                  <Eye className=\"w-4 h-4 mr-2\" />\n                  Acknowledge\n                </Button>\n              )}\n              {!alert.resolved && (\n                <Button\n                  onClick={() => onAction(alert.id, 'resolve', notes)}\n                >\n                  <CheckCircle className=\"w-4 h-4 mr-2\" />\n                  Resolve\n                </Button>\n              )}\n              <Button\n                onClick={() => onAction(alert.id, 'escalate', notes)}\n                variant=\"outline\"\n              >\n                <ArrowUp className=\"w-4 h-4 mr-2\" />\n                Escalate\n              </Button>\n              <Button\n                onClick={() => onAction(alert.id, 'suppress', notes)}\n                variant=\"outline\"\n              >\n                <EyeOff className=\"w-4 h-4 mr-2\" />\n                Suppress\n              </Button>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/behavioral-analytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/cache-management-dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/campus-expansion-dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/content-analytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":306,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":306,"endColumn":57}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Button,\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger\n} from '@hive/ui';\nimport {\n  TrendingUp,\n  Users,\n  MessageCircle,\n  Heart,\n  Calendar,\n  BarChart3,\n  Activity,\n  Zap,\n  Award,\n  Target,\n  ArrowUp,\n  ArrowDown,\n  Minus\n} from 'lucide-react';\n\ninterface ContentMetrics {\n  posts: {\n    total: number;\n    today: number;\n    weeklyGrowth: number;\n    averageLength: number;\n    topTypes: { type: string; count: number }[];\n  };\n  engagement: {\n    likes: number;\n    comments: number;\n    shares: number;\n    averagePerPost: number;\n    engagementRate: number;\n  };\n  users: {\n    activePosters: number;\n    lurkers: number;\n    superUsers: { id: string; name: string; posts: number; engagement: number }[];\n    newContributors: number;\n  };\n  trending: {\n    posts: {\n      id: string;\n      content: string;\n      author: string;\n      engagement: number;\n      velocity: number;\n    }[];\n    topics: { tag: string; mentions: number; growth: number }[];\n    spaces: { id: string; name: string; activity: number; growth: number }[];\n  };\n  quality: {\n    averageScore: number;\n    reportRate: number;\n    deletionRate: number;\n    highQualityPosts: number;\n    lowQualityPosts: number;\n  };\n  patterns: {\n    peakHours: { hour: number; activity: number }[];\n    peakDays: { day: string; activity: number }[];\n    contentLifecycle: { age: string; engagement: number }[];\n  };\n}\n\ninterface SpaceAnalytics {\n  id: string;\n  name: string;\n  type: string;\n  metrics: {\n    members: number;\n    posts: number;\n    engagement: number;\n    growth: number;\n    health: 'healthy' | 'growing' | 'stable' | 'declining' | 'inactive';\n  };\n  topContributors: { id: string; name: string; posts: number }[];\n  recentActivity: { date: string; posts: number; engagement: number }[];\n}\n\nexport function ContentAnalytics() {\n  const [metrics, setMetrics] = useState<ContentMetrics | null>(null);\n  const [spaceAnalytics, setSpaceAnalytics] = useState<SpaceAnalytics[]>([]);\n  const [timeRange, setTimeRange] = useState<'24h' | '7d' | '30d' | '90d'>('7d');\n  const contentType: 'all' = 'all';\n  const [loading, setLoading] = useState(true);\n\n  const loadAnalytics = useCallback(async () => {\n    try {\n      setLoading(true);\n      const [metricsRes, spacesRes] = await Promise.all([\n        fetch(`/api/admin/analytics/content?range=${timeRange}&type=${contentType}`),\n        fetch(`/api/admin/analytics/spaces?range=${timeRange}`)\n      ]);\n\n      if (metricsRes.ok) {\n        const metricsData = await metricsRes.json();\n        setMetrics(metricsData);\n      }\n\n      if (spacesRes.ok) {\n        const spacesData = await spacesRes.json();\n        setSpaceAnalytics(spacesData.spaces || []);\n      }\n    } catch (error) {\n      console.error('Failed to load analytics:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [contentType, timeRange]);\n\n  useEffect(() => {\n    loadAnalytics();\n  }, [loadAnalytics]);\n\n  const getHealthColor = (health: string) => {\n    switch (health) {\n      case 'healthy': return 'text-green-500';\n      case 'growing': return 'text-blue-500';\n      case 'stable': return 'text-yellow-500';\n      case 'declining': return 'text-orange-500';\n      case 'inactive': return 'text-red-500';\n      default: return 'text-gray-500';\n    }\n  };\n\n  const getTrendIcon = (value: number) => {\n    if (value > 0) return <ArrowUp className=\"w-4 h-4 text-green-500\" />;\n    if (value < 0) return <ArrowDown className=\"w-4 h-4 text-red-500\" />;\n    return <Minus className=\"w-4 h-4 text-gray-500\" />;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  if (!metrics) {\n    return (\n      <div className=\"text-center py-8 text-gray-400\">\n        No analytics data available\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Time Range Selector */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\">Content Analytics</h2>\n          <p className=\"text-gray-400\">Deep insights into platform content and engagement</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Tabs value={timeRange} onValueChange={(v) => setTimeRange(v as any)}>\n            <TabsList className=\"bg-gray-800 border border-gray-700\">\n              <TabsTrigger value=\"24h\">24h</TabsTrigger>\n              <TabsTrigger value=\"7d\">7 days</TabsTrigger>\n              <TabsTrigger value=\"30d\">30 days</TabsTrigger>\n              <TabsTrigger value=\"90d\">90 days</TabsTrigger>\n            </TabsList>\n          </Tabs>\n          <Button variant=\"outline\" className=\"max-w-sm\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Export Report\n          </Button>\n        </div>\n      </div>\n\n      {/* Key Metrics Overview */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card className=\"bg-gradient-to-br from-blue-600/20 to-blue-800/20 border-blue-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Total Posts</CardTitle>\n              <MessageCircle className=\"h-4 w-4 text-blue-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">{metrics.posts.total}</div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              {getTrendIcon(metrics.posts.weeklyGrowth)}\n              <span className=\"text-xs text-gray-400\">\n                {Math.abs(metrics.posts.weeklyGrowth)}% vs last week\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Engagement Rate</CardTitle>\n              <Heart className=\"h-4 w-4 text-green-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">{metrics.engagement.engagementRate}%</div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <span className=\"text-xs text-gray-400\">\n                {metrics.engagement.averagePerPost} avg/post\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-purple-600/20 to-purple-800/20 border-purple-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Active Contributors</CardTitle>\n              <Users className=\"h-4 w-4 text-purple-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">{metrics.users.activePosters}</div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <Zap className=\"w-3 h-3 text-yellow-500\" />\n              <span className=\"text-xs text-gray-400\">\n                +{metrics.users.newContributors} new this week\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-yellow-600/20 to-yellow-800/20 border-yellow-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Content Quality</CardTitle>\n              <Award className=\"h-4 w-4 text-yellow-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">{metrics.quality.averageScore}/10</div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <span className=\"text-xs text-gray-400\">\n                {metrics.quality.reportRate}% report rate\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Trending Content */}\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card className=\"bg-gray-900/50 border-gray-800\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Trending Posts</CardTitle>\n              <TrendingUp className=\"h-4 w-4 text-[var(--hive-brand-primary)]\" />\n            </div>\n            <CardDescription>Most engaging content right now</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {metrics.trending.posts.slice(0, 5).map((post, index) => (\n                <div key={post.id} className=\"flex items-start gap-3\">\n                  <div className=\"flex-shrink-0 w-8 h-8 bg-[var(--hive-brand-primary)]/20 rounded-full flex items-center justify-center\">\n                    <span className=\"text-sm font-bold text-[var(--hive-brand-primary)]\">#{index + 1}</span>\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm text-gray-300 line-clamp-2\">{post.content}</p>\n                    <div className=\"flex items-center gap-3 mt-1\">\n                      <span className=\"text-xs text-gray-500\">by {post.author}</span>\n                      <div className=\"flex items-center gap-1\">\n                        <Activity className=\"w-3 h-3 text-green-500\" />\n                        <span className=\"text-xs text-green-400\">{post.engagement} engagements</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Zap className=\"w-3 h-3 text-yellow-500\" />\n                        <span className=\"text-xs text-yellow-400\">+{post.velocity}/hr</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gray-900/50 border-gray-800\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Trending Topics</CardTitle>\n              <Target className=\"h-4 w-4 text-[var(--hive-brand-primary)]\" />\n            </div>\n            <CardDescription>What people are talking about</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {metrics.trending.topics.map((topic, index) => (\n                <div key={topic.tag} className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Badge className=\"bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)]\">#{topic.tag}</Badge>\n                    <span className=\"text-sm text-gray-400\">{topic.mentions} mentions</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    {getTrendIcon(topic.growth)}\n                    <span className=\"text-xs text-gray-400\">{Math.abs(topic.growth)}%</span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Activity Patterns */}\n      <Card className=\"bg-gray-900/50 border-gray-800\">\n        <CardHeader>\n          <CardTitle>Activity Patterns</CardTitle>\n          <CardDescription>When your community is most active</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            {/* Peak Hours */}\n            <div>\n              <h4 className=\"text-sm font-medium text-gray-300 mb-4\">Peak Hours (EST)</h4>\n              <div className=\"space-y-2\">\n                {metrics.patterns.peakHours.slice(0, 5).map(({ hour, activity }) => (\n                  <div key={hour} className=\"flex items-center gap-3\">\n                    <span className=\"text-sm text-gray-400 w-20\">\n                      {hour > 12 ? `${hour - 12}:00 PM` : `${hour}:00 AM`}\n                    </span>\n                    <div className=\"flex-1 bg-gray-800 rounded-full h-4 overflow-hidden\">\n                      <div\n                        className=\"h-full bg-gradient-to-r from-hive-gold to-yellow-400\"\n                        style={{ width: `${(activity / Math.max(...metrics.patterns.peakHours.map(h => h.activity))) * 100}%` }}\n                      />\n                    </div>\n                    <span className=\"text-xs text-gray-400 w-12 text-right\">{activity}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Peak Days */}\n            <div>\n              <h4 className=\"text-sm font-medium text-gray-300 mb-4\">Peak Days</h4>\n              <div className=\"space-y-2\">\n                {metrics.patterns.peakDays.map(({ day, activity }) => (\n                  <div key={day} className=\"flex items-center gap-3\">\n                    <span className=\"text-sm text-gray-400 w-20\">{day}</span>\n                    <div className=\"flex-1 bg-gray-800 rounded-full h-4 overflow-hidden\">\n                      <div\n                        className=\"h-full bg-gradient-to-r from-purple-500 to-pink-500\"\n                        style={{ width: `${(activity / Math.max(...metrics.patterns.peakDays.map(d => d.activity))) * 100}%` }}\n                      />\n                    </div>\n                    <span className=\"text-xs text-gray-400 w-12 text-right\">{activity}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Space Health Dashboard */}\n      <Card className=\"bg-gray-900/50 border-gray-800\">\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>Space Health Monitor</CardTitle>\n              <CardDescription>Track community space vitality and growth</CardDescription>\n            </div>\n            <Button variant=\"outline\" className=\"max-w-sm\">\n              <BarChart3 className=\"w-4 h-4 mr-2\" />\n              Detailed Report\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {spaceAnalytics.slice(0, 10).map((space) => (\n              <div key={space.id} className=\"p-4 bg-gray-800/50 rounded-lg\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div>\n                    <h4 className=\"font-medium text-white\">{space.name}</h4>\n                    <div className=\"flex items-center gap-3 mt-1\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">{space.type}</Badge>\n                      <span className=\"text-xs text-gray-400\">\n                        {space.metrics.members} members\n                      </span>\n                      <span className={`text-xs font-medium ${getHealthColor(space.metrics.health)}`}>\n                        {space.metrics.health}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"text-right\">\n                      <p className=\"text-sm font-medium text-white\">{space.metrics.posts}</p>\n                      <p className=\"text-xs text-gray-400\">posts</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-sm font-medium text-white\">{space.metrics.engagement}</p>\n                      <p className=\"text-xs text-gray-400\">engagement</p>\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      {getTrendIcon(space.metrics.growth)}\n                      <span className=\"text-xs\">{Math.abs(space.metrics.growth)}%</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Mini activity chart */}\n                <div className=\"flex items-end gap-1 h-8 mt-3\">\n                  {space.recentActivity.map((day, i) => (\n                    <div\n                      key={i}\n                      className=\"flex-1 bg-[var(--hive-brand-primary)]/30 rounded-t\"\n                      style={{\n                        height: `${(day.engagement / Math.max(...space.recentActivity.map(d => d.engagement))) * 100}%`,\n                        minHeight: '2px'\n                      }}\n                      title={`${day.date}: ${day.posts} posts, ${day.engagement} engagement`}\n                    />\n                  ))}\n                </div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/database-performance-dashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'suggestions' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":202,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":202,"endColumn":63}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@hive/ui';\nimport { Button } from '@hive/ui';\nimport { Badge } from '@hive/ui';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@hive/ui';\nimport { Alert, AlertDescription } from '@hive/ui';\nimport { Switch } from '@hive/ui';\nimport { Progress } from '@hive/ui';\nimport {\n  Database,\n  TrendingUp,\n  TrendingDown,\n  Zap,\n  AlertTriangle,\n  Clock,\n  BarChart3,\n  Settings,\n  RefreshCw,\n  Play,\n  ArrowUp,\n  ArrowRight,\n  Activity,\n  Hash,\n  Eye,\n  Trash2,\n  Plus,\n  Wrench,\n  Gauge\n} from 'lucide-react';\nimport { useCSRF, protectedFetch } from '@/hooks/use-csrf';\n\ninterface OptimizationData {\n  overview: {\n    totalCollections: number;\n    indexesTotal: number;\n    indexesUsed: number;\n    indexesUnused: number;\n    slowQueries: number;\n    avgQueryTime: number;\n    optimizationScore: number;\n  };\n  indexes: {\n    total: number;\n    used: number;\n    unused: number;\n    missing: number;\n    collections: Record<string, any>;\n    recommendations: any[];\n  };\n  queries: {\n    averageTime: number;\n    slowQueries: any[];\n    queryStats: Record<string, any>;\n    bottlenecks: any[];\n  };\n  collections: {\n    total: number;\n    details: Record<string, any>;\n    totalDocuments: number;\n    totalSize: number;\n    growth: Record<string, number>;\n  };\n  suggestions: any[];\n  trends: {\n    queryTimes: any[];\n    indexUsage: any[];\n    collectionGrowth: any[];\n    errorRates: any[];\n  };\n  recommendations: {\n    critical: any[];\n    high: any[];\n    medium: any[];\n  };\n}\n\nexport function DatabasePerformanceDashboard() {\n  const [optimizationData, setOptimizationData] = useState<OptimizationData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedCollection, setSelectedCollection] = useState<string>('');\n  const [autoRefresh, setAutoRefresh] = useState(false);\n  const [actionInProgress, setActionInProgress] = useState<string | null>(null);\n\n  const { token: csrfToken, getHeaders } = useCSRF();\n\n  const loadOptimizationData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const params = new URLSearchParams({\n        analysis: 'full',\n        ...(selectedCollection && { collection: selectedCollection })\n      });\n\n      const response = await protectedFetch(`/api/admin/database-optimization?${params}`, {\n        headers: getHeaders()\n      }, csrfToken);\n\n      if (!response.ok) {\n        throw new Error('Failed to load optimization data');\n      }\n\n      const data = await response.json();\n      setOptimizationData(data.optimization);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error');\n    } finally {\n      setLoading(false);\n    }\n  }, [csrfToken, getHeaders, selectedCollection]);\n\n  useEffect(() => {\n    loadOptimizationData();\n  }, [loadOptimizationData]);\n\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    const interval = setInterval(() => {\n      loadOptimizationData();\n    }, 60000); // Refresh every minute\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, loadOptimizationData]);\n\n  const handleOptimizationAction = async (action: string, params: any = {}) => {\n    try {\n      setActionInProgress(action);\n      const response = await protectedFetch('/api/admin/database-optimization', {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify({ action, ...params })\n      }, csrfToken);\n\n      if (!response.ok) {\n        throw new Error(`Failed to perform ${action}`);\n      }\n\n      const result = await response.json();\n\n      // Reload data to reflect changes\n      await loadOptimizationData();\n\n      return result.result;\n    } catch (err) {\n      console.error(`Error performing ${action}:`, err);\n      throw err;\n    } finally {\n      setActionInProgress(null);\n    }\n  };\n\n  const getScoreColor = (score: number) => {\n    if (score >= 90) return 'text-green-400 bg-green-400/10 border-green-400/30';\n    if (score >= 70) return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n    return 'text-red-400 bg-red-400/10 border-red-400/30';\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'critical': return 'text-red-400 bg-red-400/10 border-red-400/30';\n      case 'high': return 'text-orange-400 bg-orange-400/10 border-orange-400/30';\n      case 'medium': return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n      case 'low': return 'text-blue-400 bg-blue-400/10 border-blue-400/30';\n      default: return 'text-gray-400 bg-gray-400/10 border-gray-400/30';\n    }\n  };\n\n  const formatBytes = (bytes: number) => {\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    if (bytes === 0) return '0 B';\n    const i = Math.floor(Math.log(bytes) / Math.log(1024));\n    return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];\n  };\n\n  const formatDuration = (ms: number) => {\n    if (ms < 1000) return `${ms}ms`;\n    return `${(ms / 1000).toFixed(1)}s`;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  if (error || !optimizationData) {\n    return (\n      <Alert variant=\"destructive\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertDescription>\n          Failed to load database optimization data: {error}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  const { overview, indexes, queries, collections, suggestions, trends, recommendations } = optimizationData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header Controls */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\">Database Performance Dashboard</h2>\n          <p className=\"text-gray-400 mt-1\">Optimize queries, indexes, and data models for maximum performance</p>\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <select\n            className=\"px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white\"\n            value={selectedCollection}\n            onChange={(e: React.ChangeEvent) => setSelectedCollection((e.target as any).value)}\n          >\n            <option value=\"\">All Collections</option>\n            <option value=\"users\">Users</option>\n            <option value=\"spaces\">Spaces</option>\n            <option value=\"posts\">Posts</option>\n            <option value=\"rituals\">Rituals</option>\n          </select>\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              id=\"auto-refresh\"\n              checked={autoRefresh}\n              onCheckedChange={setAutoRefresh}\n            />\n            <label htmlFor=\"auto-refresh\" className=\"text-sm text-gray-400\">\n              Auto-refresh\n            </label>\n          </div>\n          <Button onClick={loadOptimizationData} variant=\"outline\" className=\"max-w-sm\">\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </div>\n\n      {/* Optimization Score Overview */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card className={`${getScoreColor(overview.optimizationScore)} border`}>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Optimization Score</CardTitle>\n            <Gauge className=\"h-4 w-4\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{overview.optimizationScore}/100</div>\n            <Progress\n              value={overview.optimizationScore}\n              className=\"mt-2 h-2\"\n            />\n            <p className=\"text-xs mt-2 opacity-80\">\n              {overview.optimizationScore >= 90 ? 'Excellent' :\n               overview.optimizationScore >= 70 ? 'Good' : 'Needs Attention'}\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-blue-600/20 to-blue-800/20 border-blue-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Query Performance</CardTitle>\n            <Activity className=\"h-4 w-4 text-blue-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-blue-400\">{formatDuration(overview.avgQueryTime)}</div>\n            <p className=\"text-xs text-gray-400\">\n              {overview.slowQueries} slow queries detected\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-purple-600/20 to-purple-800/20 border-purple-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Index Health</CardTitle>\n            <Hash className=\"h-4 w-4 text-purple-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-purple-400\">\n              {overview.indexesUsed}/{overview.indexesTotal}\n            </div>\n            <p className=\"text-xs text-gray-400\">\n              {overview.indexesUnused} unused indexes\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-500/30\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Collections</CardTitle>\n            <Database className=\"h-4 w-4 text-green-400\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-400\">{overview.totalCollections}</div>\n            <p className=\"text-xs text-gray-400\">\n              {collections.totalDocuments.toLocaleString()} documents\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Critical Issues Alert */}\n      {recommendations.critical.length > 0 && (\n        <Alert className=\"bg-red-500/10 border-red-500/30\">\n          <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n          <AlertDescription className=\"text-red-400\">\n            <strong>{recommendations.critical.length} critical optimization issue{recommendations.critical.length > 1 ? 's' : ''}</strong> requiring immediate attention\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Main Dashboard Tabs */}\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\n        <TabsList className=\"grid w-full grid-cols-6 bg-gray-900 border border-gray-800\">\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n          <TabsTrigger value=\"indexes\">Indexes</TabsTrigger>\n          <TabsTrigger value=\"queries\">Queries</TabsTrigger>\n          <TabsTrigger value=\"collections\">Collections</TabsTrigger>\n          <TabsTrigger value=\"suggestions\">Suggestions</TabsTrigger>\n          <TabsTrigger value=\"trends\">Trends</TabsTrigger>\n        </TabsList>\n\n        {/* Overview Tab */}\n        <TabsContent value=\"overview\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {/* Quick Actions */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Quick Optimization Actions</CardTitle>\n                <CardDescription>Common performance improvements</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {recommendations.critical.slice(0, 3).map((rec, index) => (\n                    <div key={rec.id || index} className=\"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg\">\n                      <div className=\"flex-1\">\n                        <h4 className=\"font-medium text-white text-sm\">{rec.title}</h4>\n                        <p className=\"text-xs text-gray-400 mt-1\">{rec.description}</p>\n                        <Badge className={`text-xs mt-2 ${getPriorityColor(rec.priority)}`}>\n                          {rec.priority.toUpperCase()}\n                        </Badge>\n                      </div>\n                      <Button\n                        className=\"max-w-sm\"\n                        onClick={() => handleOptimizationAction(\n                          rec.type === 'index' ? 'create_index' : 'optimize_queries',\n                          { collection: rec.collection, suggestion: rec }\n                        )}\n                        disabled={actionInProgress === rec.id}\n                      >\n                        {actionInProgress === rec.id ? (\n                          <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <Play className=\"w-3 h-3\" />\n                        )}\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Performance Summary */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Performance Summary</CardTitle>\n                <CardDescription>Current database performance metrics</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-gray-400\">Average Query Time</span>\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-white font-medium\">{formatDuration(overview.avgQueryTime)}</span>\n                      {overview.avgQueryTime > 500 ? (\n                        <TrendingDown className=\"w-4 h-4 text-red-400\" />\n                      ) : (\n                        <TrendingUp className=\"w-4 h-4 text-green-400\" />\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-gray-400\">Index Efficiency</span>\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-white font-medium\">\n                        {Math.round((overview.indexesUsed / overview.indexesTotal) * 100)}%\n                      </span>\n                      <Progress\n                        value={(overview.indexesUsed / overview.indexesTotal) * 100}\n                        className=\"w-16 h-2\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-gray-400\">Total Data Size</span>\n                    <span className=\"text-white font-medium\">\n                      {formatBytes(collections.totalSize * 1024)}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-gray-400\">Growth Rate</span>\n                    <span className=\"text-white font-medium\">\n                      {Object.values(collections.growth).reduce((avg, rate) => avg + rate, 0) / Object.values(collections.growth).length}% /day\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Collection Health Matrix */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Collection Health Matrix</CardTitle>\n              <CardDescription>Performance overview across all collections</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid gap-3 md:grid-cols-5\">\n                {Object.entries(collections.details).map(([name, details]: [string, any]) => (\n                  <div key={name} className=\"p-3 bg-gray-800/50 rounded-lg\">\n                    <h4 className=\"font-medium text-white capitalize mb-2\">{name}</h4>\n                    <div className=\"space-y-1 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-400\">Documents:</span>\n                        <span className=\"text-white\">{details.documentCount?.toLocaleString()}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-400\">Size:</span>\n                        <span className=\"text-white\">{formatBytes((details.estimatedSize || 0) * 1024)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-400\">Growth:</span>\n                        <span className={`${details.growthRate > 15 ? 'text-orange-400' : 'text-green-400'}`}>\n                          {details.growthRate?.toFixed(1)}%\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Indexes Tab */}\n        <TabsContent value=\"indexes\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <Card className=\"bg-green-500/5 border-green-500/30\">\n              <CardHeader>\n                <CardTitle className=\"text-green-400 text-sm\">Used Indexes</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-green-400 mb-2\">{indexes.used}</div>\n                <p className=\"text-xs text-gray-400\">Actively optimizing queries</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-yellow-500/5 border-yellow-500/30\">\n              <CardHeader>\n                <CardTitle className=\"text-yellow-400 text-sm\">Unused Indexes</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-yellow-400 mb-2\">{indexes.unused}</div>\n                <p className=\"text-xs text-gray-400\">Consider removing to save storage</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-red-500/5 border-red-500/30\">\n              <CardHeader>\n                <CardTitle className=\"text-red-400 text-sm\">Missing Indexes</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-red-400 mb-2\">{indexes.missing}</div>\n                <p className=\"text-xs text-gray-400\">Recommended for optimization</p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Index Details by Collection */}\n          <div className=\"space-y-4\">\n            {Object.entries(indexes.collections).map(([collectionName, collectionData]: [string, any]) => (\n              <Card key={collectionName}>\n                <CardHeader>\n                  <CardTitle className=\"capitalize\">{collectionName} Indexes</CardTitle>\n                  <CardDescription>\n                    {collectionData.usage?.used} used, {collectionData.usage?.unused} unused, {collectionData.usage?.total} total\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {collectionData.indexes?.map((index: any, idx: number) => (\n                      <div key={idx} className=\"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg\">\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-white text-sm\">{index.name}</h4>\n                          <p className=\"text-xs text-gray-400\">\n                            Fields: {Array.isArray(index.fields) ? index.fields.join(', ') : 'Complex'}\n                          </p>\n                          <Badge className={`text-xs mt-1 ${index.used ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'}`}>\n                            {index.used ? 'Active' : 'Unused'}\n                          </Badge>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Button className=\"max-w-sm\" variant=\"outline\">\n                            <Eye className=\"w-3 h-3\" />\n                          </Button>\n                          {!index.used && (\n                            <Button\n                              className=\"max-w-sm\"\n                              variant=\"outline\"\n                              onClick={() => handleOptimizationAction('drop_index', {\n                                collection: collectionName,\n                                indexName: index.name\n                              })}\n                              disabled={actionInProgress === `drop_${index.name}`}\n                            >\n                              <Trash2 className=\"w-3 h-3\" />\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n\n                    {/* Index Recommendations */}\n                    {collectionData.recommendations?.map((rec: any, idx: number) => (\n                      <div key={idx} className=\"flex items-center justify-between p-3 bg-blue-500/5 rounded-lg border border-blue-500/30\">\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-blue-400 text-sm\">\n                            <Plus className=\"w-3 h-3 inline mr-1\" />\n                            {rec.indexName}\n                          </h4>\n                          <p className=\"text-xs text-gray-400 mt-1\">{rec.reason}</p>\n                          <Badge className={`text-xs mt-1 ${getPriorityColor(rec.priority)}`}>\n                            {rec.priority.toUpperCase()}\n                          </Badge>\n                        </div>\n                        <Button\n                          className=\"max-w-sm\"\n                          onClick={() => handleOptimizationAction('create_index', {\n                            collection: collectionName,\n                            indexName: rec.indexName,\n                            indexFields: rec.fields\n                          })}\n                          disabled={actionInProgress === `create_${rec.indexName}`}\n                        >\n                          {actionInProgress === `create_${rec.indexName}` ? (\n                            <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                          ) : (\n                            <Plus className=\"w-3 h-3\" />\n                          )}\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </TabsContent>\n\n        {/* Queries Tab */}\n        <TabsContent value=\"queries\" className=\"space-y-4\">\n          {/* Slow Queries */}\n          <Card className=\"border-orange-500/30 bg-orange-500/5\">\n            <CardHeader>\n              <CardTitle className=\"text-orange-400 flex items-center gap-2\">\n                <Clock className=\"w-5 h-5\" />\n                Slow Queries ({queries.slowQueries.length})\n              </CardTitle>\n              <CardDescription>Queries taking longer than 1 second</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {queries.slowQueries.map((query, index) => (\n                  <div key={index} className=\"p-3 bg-gray-800/50 rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <Badge className=\"bg-orange-500/20 text-orange-400 border-orange-500/30 capitalize\">\n                        {query.collection}\n                      </Badge>\n                      <div className=\"flex items-center gap-4 text-sm\">\n                        <span className=\"text-gray-400\">\n                          Avg: <span className=\"text-orange-400 font-medium\">{formatDuration(query.avgDuration)}</span>\n                        </span>\n                        <span className=\"text-gray-400\">\n                          Count: <span className=\"text-white font-medium\">{query.count?.toLocaleString()}</span>\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"bg-gray-900 p-2 rounded text-xs font-mono text-gray-300 mb-2\">\n                      {query.pattern}\n                    </div>\n                    {query.suggestedOptimization && (\n                      <p className=\"text-xs text-blue-400\">\n                        üí° {query.suggestedOptimization}\n                      </p>\n                    )}\n                    <div className=\"flex justify-end mt-2\">\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={() => handleOptimizationAction('optimize_queries', {\n                          collection: query.collection,\n                          query: query.pattern\n                        })}\n                        disabled={actionInProgress === `optimize_${index}`}\n                      >\n                        {actionInProgress === `optimize_${index}` ? (\n                          <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <Settings className=\"w-3 h-3\" />\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Performance Bottlenecks */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Performance Bottlenecks</CardTitle>\n              <CardDescription>Identified performance issues requiring attention</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {queries.bottlenecks.map((bottleneck, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <Badge className=\"capitalize\">{bottleneck.collection}</Badge>\n                        <Badge className={getPriorityColor(bottleneck.severity)}>\n                          {bottleneck.severity.toUpperCase()}\n                        </Badge>\n                      </div>\n                      <h4 className=\"font-medium text-white text-sm\">{bottleneck.description}</h4>\n                      <p className=\"text-xs text-gray-400 mt-1\">{bottleneck.recommendation}</p>\n                    </div>\n                    <Button className=\"max-w-sm\" variant=\"outline\">\n                      <Wrench className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Collections Tab */}\n        <TabsContent value=\"collections\" className=\"space-y-4\">\n          <div className=\"grid gap-4\">\n            {Object.entries(collections.details).map(([name, details]: [string, any]) => (\n              <Card key={name}>\n                <CardHeader>\n                  <CardTitle className=\"capitalize flex items-center gap-2\">\n                    <Database className=\"w-5 h-5\" />\n                    {name}\n                  </CardTitle>\n                  <CardDescription>\n                    {details.documentCount?.toLocaleString()} documents ‚Ä¢ {formatBytes((details.estimatedSize || 0) * 1024)}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-4 md:grid-cols-3\">\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium text-white\">Storage Metrics</h4>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Documents:</span>\n                          <span className=\"text-white font-medium\">{details.documentCount?.toLocaleString()}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Avg Doc Size:</span>\n                          <span className=\"text-white font-medium\">{formatBytes((details.averageDocumentSize || 0) * 1024)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Total Size:</span>\n                          <span className=\"text-white font-medium\">{formatBytes((details.estimatedSize || 0) * 1024)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Growth Rate:</span>\n                          <span className={`font-medium ${details.growthRate > 15 ? 'text-orange-400' : 'text-green-400'}`}>\n                            {details.growthRate?.toFixed(1)}%/day\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium text-white\">Activity Metrics</h4>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Reads/hour:</span>\n                          <span className=\"text-white font-medium\">{details.readFrequency?.toLocaleString()}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Writes/hour:</span>\n                          <span className=\"text-white font-medium\">{details.writeFrequency?.toLocaleString()}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-400\">Read/Write Ratio:</span>\n                          <span className=\"text-white font-medium\">\n                            {((details.readFrequency || 0) / (details.writeFrequency || 1)).toFixed(1)}:1\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <h4 className=\"font-medium text-white\">Data Hotspots</h4>\n                      <div className=\"space-y-2\">\n                        {details.hotspots?.map((hotspot: any, index: number) => (\n                          <div key={index} className=\"text-sm\">\n                            <div className=\"flex justify-between items-center\">\n                              <span className=\"text-gray-400\">{hotspot.field}:</span>\n                              <span className=\"text-white font-medium\">{hotspot.concentration}%</span>\n                            </div>\n                            <p className=\"text-xs text-gray-500 mt-1\">{hotspot.reason}</p>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"mt-4 pt-4 border-t border-gray-700\">\n                    <div className=\"flex gap-2\">\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={() => handleOptimizationAction('analyze_collection', { collection: name })}\n                        disabled={actionInProgress === `analyze_${name}`}\n                      >\n                        {actionInProgress === `analyze_${name}` ? (\n                          <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <BarChart3 className=\"w-3 h-3\" />\n                        )}\n                        Analyze\n                      </Button>\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={() => handleOptimizationAction('optimize_queries', { collection: name })}\n                        disabled={actionInProgress === `optimize_collection_${name}`}\n                      >\n                        {actionInProgress === `optimize_collection_${name}` ? (\n                          <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <Settings className=\"w-3 h-3\" />\n                        )}\n                        Optimize\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </TabsContent>\n\n        {/* Suggestions Tab */}\n        <TabsContent value=\"suggestions\" className=\"space-y-4\">\n          {/* Critical Recommendations */}\n          {recommendations.critical.length > 0 && (\n            <Card className=\"border-red-500/30 bg-red-500/5\">\n              <CardHeader>\n                <CardTitle className=\"text-red-400 flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5\" />\n                  Critical Recommendations ({recommendations.critical.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {recommendations.critical.map((rec, index) => (\n                    <OptimizationSuggestionCard\n                      key={rec.id || index}\n                      suggestion={rec}\n                      onAction={handleOptimizationAction}\n                      actionInProgress={actionInProgress}\n                    />\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* High Priority Recommendations */}\n          {recommendations.high.length > 0 && (\n            <Card className=\"border-orange-500/30 bg-orange-500/5\">\n              <CardHeader>\n                <CardTitle className=\"text-orange-400 flex items-center gap-2\">\n                  <ArrowUp className=\"w-5 h-5\" />\n                  High Priority Recommendations ({recommendations.high.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {recommendations.high.map((rec, index) => (\n                    <OptimizationSuggestionCard\n                      key={rec.id || index}\n                      suggestion={rec}\n                      onAction={handleOptimizationAction}\n                      actionInProgress={actionInProgress}\n                    />\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Medium Priority Recommendations */}\n          {recommendations.medium.length > 0 && (\n            <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n              <CardHeader>\n                <CardTitle className=\"text-yellow-400 flex items-center gap-2\">\n                  <ArrowRight className=\"w-5 h-5\" />\n                  Medium Priority Recommendations ({recommendations.medium.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {recommendations.medium.map((rec, index) => (\n                    <OptimizationSuggestionCard\n                      key={rec.id || index}\n                      suggestion={rec}\n                      onAction={handleOptimizationAction}\n                      actionInProgress={actionInProgress}\n                    />\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </TabsContent>\n\n        {/* Trends Tab */}\n        <TabsContent value=\"trends\" className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {/* Query Time Trends */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Query Performance Trends</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Current Average:</span>\n                    <span className=\"text-white font-medium\">{formatDuration(overview.avgQueryTime)}</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">24h Trend:</span>\n                    <span className=\"text-green-400 font-medium flex items-center gap-1\">\n                      <TrendingDown className=\"w-3 h-3\" />\n                      -12%\n                    </span>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"text-xs text-gray-400 mb-2\">Last 6 hours</div>\n                    <div className=\"flex items-end gap-1 h-8\">\n                      {trends.queryTimes.slice(-6).map((point, index) => (\n                        <div\n                          key={index}\n                          className=\"bg-blue-500/50 flex-1 rounded-t\"\n                          style={{ height: `${(point.avgTime / 800) * 100}%` }}\n                          title={`${formatDuration(point.avgTime)} at ${new Date(point.time).toLocaleTimeString()}`}\n                        />\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Index Usage Trends */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Index Usage Trends</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Hit Rate:</span>\n                    <span className=\"text-green-400 font-medium\">\n                      {trends.indexUsage[trends.indexUsage.length - 1]?.hitRate?.toFixed(1)}%\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Miss Rate:</span>\n                    <span className=\"text-orange-400 font-medium\">\n                      {trends.indexUsage[trends.indexUsage.length - 1]?.missRate?.toFixed(1)}%\n                    </span>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"text-xs text-gray-400 mb-2\">Last 6 hours</div>\n                    <div className=\"flex items-end gap-1 h-8\">\n                      {trends.indexUsage.slice(-6).map((point, index) => (\n                        <div key={index} className=\"flex-1 flex flex-col\">\n                          <div\n                            className=\"bg-green-500/50 rounded-t\"\n                            style={{ height: `${point.hitRate}%` }}\n                            title={`${point.hitRate.toFixed(1)}% hit rate`}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Collection Growth */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Collection Growth</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Docs Added/hour:</span>\n                    <span className=\"text-blue-400 font-medium\">\n                      {trends.collectionGrowth[trends.collectionGrowth.length - 1]?.documentsAdded}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Size Growth/hour:</span>\n                    <span className=\"text-purple-400 font-medium\">\n                      {formatBytes((trends.collectionGrowth[trends.collectionGrowth.length - 1]?.sizeIncrease || 0) * 1024 * 1024)}\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Error Rates */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-sm\">Error Rate Trends</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Current Error Rate:</span>\n                    <span className=\"text-green-400 font-medium\">\n                      {trends.errorRates[trends.errorRates.length - 1]?.errorRate?.toFixed(2)}%\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-400\">Timeouts/hour:</span>\n                    <span className=\"text-yellow-400 font-medium\">\n                      {trends.errorRates[trends.errorRates.length - 1]?.timeouts || 0}\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n\n// Optimization Suggestion Card Component\nfunction OptimizationSuggestionCard({\n  suggestion,\n  onAction,\n  actionInProgress\n}: {\n  suggestion: any;\n  onAction: (action: string, params: any) => Promise<any>;\n  actionInProgress: string | null;\n}) {\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'critical': return 'text-red-400 bg-red-400/10 border-red-400/30';\n      case 'high': return 'text-orange-400 bg-orange-400/10 border-orange-400/30';\n      case 'medium': return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n      case 'low': return 'text-blue-400 bg-blue-400/10 border-blue-400/30';\n      default: return 'text-gray-400 bg-gray-400/10 border-gray-400/30';\n    }\n  };\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'index': return <Hash className=\"w-4 h-4\" />;\n      case 'query': return <Zap className=\"w-4 h-4\" />;\n      case 'data_model': return <Database className=\"w-4 h-4\" />;\n      case 'performance': return <TrendingUp className=\"w-4 h-4\" />;\n      default: return <Settings className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getActionType = (suggestionType: string) => {\n    switch (suggestionType) {\n      case 'index': return 'create_index';\n      case 'query': return 'optimize_queries';\n      default: return 'analyze_collection';\n    }\n  };\n\n  return (\n    <div className=\"p-4 bg-gray-800/50 rounded-lg\">\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex items-center gap-3\">\n          {getTypeIcon(suggestion.type)}\n          <div>\n            <h4 className=\"font-medium text-white\">{suggestion.title}</h4>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <Badge className={`text-xs ${getPriorityColor(suggestion.priority)}`}>\n                {suggestion.priority.toUpperCase()}\n              </Badge>\n              <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                {suggestion.type.replace('_', ' ')}\n              </Badge>\n              <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                {suggestion.collection || 'All'}\n              </Badge>\n            </div>\n          </div>\n        </div>\n        <Button\n          className=\"max-w-sm\"\n          onClick={() => onAction(getActionType(suggestion.type), {\n            collection: suggestion.collection,\n            suggestion\n          })}\n          disabled={actionInProgress === suggestion.id}\n        >\n          {actionInProgress === suggestion.id ? (\n            <RefreshCw className=\"w-3 h-3 animate-spin\" />\n          ) : (\n            <Play className=\"w-3 h-3\" />\n          )}\n        </Button>\n      </div>\n\n      <p className=\"text-sm text-gray-300 mb-3\">{suggestion.description}</p>\n\n      <div className=\"grid gap-3 md:grid-cols-2\">\n        <div>\n          <h5 className=\"text-xs font-medium text-gray-400 mb-1\">Expected Impact</h5>\n          <p className=\"text-sm text-green-400\">{suggestion.estimatedImpact}</p>\n        </div>\n        <div>\n          <h5 className=\"text-xs font-medium text-gray-400 mb-1\">Implementation</h5>\n          <p className=\"text-sm text-blue-400\">{suggestion.effort || 'Medium'} effort</p>\n        </div>\n      </div>\n\n      {suggestion.implementation && (\n        <div className=\"mt-3\">\n          <h5 className=\"text-xs font-medium text-gray-400 mb-1\">Implementation Details</h5>\n          <div className=\"bg-gray-900 p-2 rounded text-xs font-mono text-gray-300\">\n            {suggestion.implementation}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/feed-algorithm-control.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAlgorithmConfig'. Either include it or remove the dependency array.","line":99,"column":6,"nodeType":"ArrayExpression","endLine":99,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadAlgorithmConfig]","fix":{"range":[2362,2364],"text":"[loadAlgorithmConfig]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@hive/ui';\nimport { Button } from '@hive/ui';\nimport { Badge } from '@hive/ui';\nimport { Switch } from '@hive/ui';\nimport { Slider } from '@hive/ui';\nimport { Alert, AlertDescription } from '@hive/ui';\nimport {\n  Settings,\n  TrendingUp,\n  Clock,\n  Users,\n  Calendar,\n  BarChart3,\n  RefreshCw,\n  Save,\n  AlertTriangle,\n  CheckCircle,\n  Activity,\n  Zap,\n  Target\n} from 'lucide-react';\n\ninterface AlgorithmConfig {\n  temporalWeights: {\n    happeningNow: number;\n    next2Hours: number;\n    today: number;\n    tomorrow: number;\n    thisWeek: number;\n    pastEvents: number;\n  };\n  contentTypePriorities: {\n    liveEvent: number;\n    ritualContent: number;\n    upcomingEvent: number;\n    userPost: number;\n    spaceActivity: number;\n    rssEvent: number;\n  };\n  engagementFactors: {\n    recencyWeight: number;\n    popularityWeight: number;\n    membershipWeight: number;\n    builderBonus: number;\n  };\n  feedMixRules: {\n    maxEventsPerFeed: number;\n    minPostsPerFeed: number;\n    diversityThreshold: number;\n    campusEventBoost: number;\n  };\n  realTimeSettings: {\n    enableSSE: boolean;\n    updateInterval: number;\n    maxConcurrentUsers: number;\n    cacheTimeout: number;\n  };\n}\n\ninterface AlgorithmMetrics {\n  performance: {\n    avgResponseTime: number;\n    cacheHitRate: number;\n    errorRate: number;\n    throughput: number;\n  };\n  engagement: {\n    avgSessionTime: number;\n    clickThroughRate: number;\n    contentInteractionRate: number;\n    feedScrollDepth: number;\n  };\n  contentDistribution: {\n    events: number;\n    posts: number;\n    rituals: number;\n    averageAge: number;\n  };\n}\n\nexport function FeedAlgorithmControl() {\n  const [config, setConfig] = useState<AlgorithmConfig | null>(null);\n  const [metrics, setMetrics] = useState<AlgorithmMetrics | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n  const [unsavedChanges, setUnsavedChanges] = useState(false);\n\n  useEffect(() => {\n    loadAlgorithmConfig();\n    loadMetrics();\n\n    // Auto-refresh metrics every 30 seconds\n    const interval = setInterval(loadMetrics, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const loadAlgorithmConfig = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/admin/feed-algorithm');\n\n      if (!response.ok) {\n        throw new Error('Failed to load algorithm config');\n      }\n\n      const data = await response.json();\n      setConfig(data.config);\n      setLastUpdated(new Date(data.lastUpdated));\n    } catch (error) {\n      console.error('Error loading algorithm config:', error);\n      // Set default config if loading fails\n      setConfig(getDefaultConfig());\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadMetrics = async () => {\n    try {\n      const response = await fetch('/api/admin/feed-metrics');\n\n      if (!response.ok) {\n        throw new Error('Failed to load metrics');\n      }\n\n      const data = await response.json();\n      setMetrics(data.metrics);\n    } catch (error) {\n      console.error('Error loading metrics:', error);\n    }\n  };\n\n  const saveConfig = async () => {\n    if (!config) return;\n\n    try {\n      setSaving(true);\n      const response = await fetch('/api/admin/feed-algorithm', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ config }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to save config');\n      }\n\n      setUnsavedChanges(false);\n      setLastUpdated(new Date());\n    } catch (error) {\n      console.error('Error saving config:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const resetToDefaults = () => {\n    setConfig(getDefaultConfig());\n    setUnsavedChanges(true);\n  };\n\n  const updateConfig = (path: string, value: number | boolean) => {\n    if (!config) return;\n\n    const keys = path.split('.');\n    const newConfig = { ...config };\n    let current: any = newConfig;\n\n    for (let i = 0; i < keys.length - 1; i++) {\n      current[keys[i]] = { ...current[keys[i]] };\n      current = current[keys[i]];\n    }\n\n    current[keys[keys.length - 1]] = value;\n    setConfig(newConfig);\n    setUnsavedChanges(true);\n  };\n\n  const getDefaultConfig = (): AlgorithmConfig => ({\n    temporalWeights: {\n      happeningNow: 100,\n      next2Hours: 90,\n      today: 70,\n      tomorrow: 60,\n      thisWeek: 40,\n      pastEvents: 20,\n    },\n    contentTypePriorities: {\n      liveEvent: 10,\n      ritualContent: 9,\n      upcomingEvent: 8,\n      userPost: 6,\n      spaceActivity: 5,\n      rssEvent: 4,\n    },\n    engagementFactors: {\n      recencyWeight: 0.3,\n      popularityWeight: 0.2,\n      membershipWeight: 0.4,\n      builderBonus: 5,\n    },\n    feedMixRules: {\n      maxEventsPerFeed: 8,\n      minPostsPerFeed: 3,\n      diversityThreshold: 0.7,\n      campusEventBoost: 0.8,\n    },\n    realTimeSettings: {\n      enableSSE: true,\n      updateInterval: 5000,\n      maxConcurrentUsers: 1000,\n      cacheTimeout: 300,\n    },\n  });\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  if (!config) {\n    return (\n      <Alert variant=\"destructive\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertDescription>\n          Failed to load algorithm configuration. Please try refreshing the page.\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Actions */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-hive-text-primary\">Feed Algorithm Control</h2>\n          <p className=\"text-hive-text-secondary\">\n            Real-time control of the temporal event weighting algorithm and feed parameters\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          {unsavedChanges && (\n            <Badge variant=\"destructive\" className=\"animate-pulse\">\n              Unsaved Changes\n            </Badge>\n          )}\n          {lastUpdated && (\n            <span className=\"text-sm text-hive-text-secondary\">\n              Last updated: {lastUpdated.toLocaleTimeString()}\n            </span>\n          )}\n          <Button onClick={loadMetrics} variant=\"outline\" className=\"max-w-sm\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Refresh\n          </Button>\n          <Button onClick={resetToDefaults} variant=\"outline\" className=\"max-w-sm\">\n            Reset Defaults\n          </Button>\n          <Button\n            onClick={saveConfig}\n            disabled={saving || !unsavedChanges}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            {saving ? (\n              <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n            ) : (\n              <Save className=\"h-4 w-4 mr-2\" />\n            )}\n            Save Changes\n          </Button>\n        </div>\n      </div>\n\n      {/* Real-time Metrics Dashboard */}\n      {metrics && (\n        <div className=\"grid gap-4 md:grid-cols-4\">\n          <Card className=\"bg-green-500/10 border-green-500/30\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm text-green-400\">Response Time</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-400\">\n                {metrics.performance.avgResponseTime}ms\n              </div>\n              <p className=\"text-xs text-green-400/70\">Average feed load time</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-blue-500/10 border-blue-500/30\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm text-blue-400\">Cache Hit Rate</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-400\">\n                {metrics.performance.cacheHitRate}%\n              </div>\n              <p className=\"text-xs text-blue-400/70\">Algorithm efficiency</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-purple-500/10 border-purple-500/30\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm text-purple-400\">Engagement Rate</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-purple-400\">\n                {metrics.engagement.clickThroughRate}%\n              </div>\n              <p className=\"text-xs text-purple-400/70\">Content interaction</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-orange-500/10 border-orange-500/30\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm text-orange-400\">Content Mix</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-orange-400\">\n                {Math.round((metrics.contentDistribution.events / (metrics.contentDistribution.events + metrics.contentDistribution.posts)) * 100)}%\n              </div>\n              <p className=\"text-xs text-orange-400/70\">Events vs Posts</p>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        {/* Temporal Weights Control */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Clock className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n              <span>Temporal Event Weights</span>\n            </CardTitle>\n            <CardDescription>\n              Control how time proximity affects content ranking (0-100 points)\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {Object.entries(config.temporalWeights).map(([key, value]) => (\n              <div key={key} className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <label className=\"text-sm font-medium text-hive-text-primary capitalize\">\n                    {key.replace(/([A-Z])/g, ' $1')}\n                  </label>\n                  <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                    {value} pts\n                  </Badge>\n                </div>\n                <Slider\n                  value={[value]}\n                  onValueChange={([newValue]) => updateConfig(`temporalWeights.${key}`, newValue)}\n                  max={100}\n                  min={0}\n                  step={5}\n                  className=\"w-full\"\n                />\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        {/* Content Type Priorities */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Target className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n              <span>Content Type Priorities</span>\n            </CardTitle>\n            <CardDescription>\n              Set relative importance of different content types (1-10 scale)\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {Object.entries(config.contentTypePriorities).map(([key, value]) => (\n              <div key={key} className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <label className=\"text-sm font-medium text-hive-text-primary capitalize\">\n                    {key.replace(/([A-Z])/g, ' $1')}\n                  </label>\n                  <Badge\n                    variant=\"secondary\"\n                    className={value >= 8 ? \"text-green-400\" : value >= 6 ? \"text-yellow-400\" : \"text-gray-400\"}\n                  >\n                    Priority {value}\n                  </Badge>\n                </div>\n                <Slider\n                  value={[value]}\n                  onValueChange={([newValue]) => updateConfig(`contentTypePriorities.${key}`, newValue)}\n                  max={10}\n                  min={1}\n                  step={1}\n                  className=\"w-full\"\n                />\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        {/* Engagement Factors */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <TrendingUp className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n              <span>Engagement Factors</span>\n            </CardTitle>\n            <CardDescription>\n              Weight distribution for engagement scoring (0.0-1.0 scale)\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {Object.entries(config.engagementFactors).map(([key, value]) => {\n              const isBonus = key === 'builderBonus';\n              const maxValue = isBonus ? 20 : 1;\n              const step = isBonus ? 1 : 0.1;\n              const displayValue = isBonus ? `+${value}` : value.toFixed(1);\n\n              return (\n                <div key={key} className=\"space-y-2\">\n                  <div className=\"flex justify-between items-center\">\n                    <label className=\"text-sm font-medium text-hive-text-primary capitalize\">\n                      {key.replace(/([A-Z])/g, ' $1')}\n                    </label>\n                    <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                      {displayValue}{isBonus ? ' pts' : ''}\n                    </Badge>\n                  </div>\n                  <Slider\n                    value={[value]}\n                    onValueChange={([newValue]) => updateConfig(`engagementFactors.${key}`, newValue)}\n                    max={maxValue}\n                    min={0}\n                    step={step}\n                    className=\"w-full\"\n                  />\n                </div>\n              );\n            })}\n          </CardContent>\n        </Card>\n\n        {/* Feed Mix Rules */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <BarChart3 className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n              <span>Feed Mix Rules</span>\n            </CardTitle>\n            <CardDescription>\n              Control content distribution and diversity in feeds\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {Object.entries(config.feedMixRules).map(([key, value]) => {\n              const isPercentage = key.includes('Boost') || key.includes('Threshold');\n              const maxValue = isPercentage ? 1 : key.includes('max') ? 20 : key.includes('min') ? 10 : 1;\n              const step = isPercentage ? 0.1 : 1;\n              const displayValue = isPercentage ? `${(value * 100).toFixed(0)}%` : value.toString();\n\n              return (\n                <div key={key} className=\"space-y-2\">\n                  <div className=\"flex justify-between items-center\">\n                    <label className=\"text-sm font-medium text-hive-text-primary capitalize\">\n                      {key.replace(/([A-Z])/g, ' $1')}\n                    </label>\n                    <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                      {displayValue}\n                    </Badge>\n                  </div>\n                  <Slider\n                    value={[value]}\n                    onValueChange={([newValue]) => updateConfig(`feedMixRules.${key}`, newValue)}\n                    max={maxValue}\n                    min={0}\n                    step={step}\n                    className=\"w-full\"\n                  />\n                </div>\n              );\n            })}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Real-time Settings */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <Activity className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n            <span>Real-time Settings</span>\n          </CardTitle>\n          <CardDescription>\n            Configure SSE updates and performance parameters\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <label className=\"text-sm font-medium text-hive-text-primary\">\n                    Enable Server-Sent Events\n                  </label>\n                  <p className=\"text-xs text-hive-text-secondary\">\n                    Real-time feed updates via SSE\n                  </p>\n                </div>\n                <Switch\n                  checked={config.realTimeSettings.enableSSE}\n                  onCheckedChange={(checked) => updateConfig('realTimeSettings.enableSSE', checked)}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <label className=\"text-sm font-medium text-hive-text-primary\">\n                    Update Interval\n                  </label>\n                  <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                    {config.realTimeSettings.updateInterval / 1000}s\n                  </Badge>\n                </div>\n                <Slider\n                  value={[config.realTimeSettings.updateInterval]}\n                  onValueChange={([newValue]) => updateConfig('realTimeSettings.updateInterval', newValue)}\n                  max={30000}\n                  min={1000}\n                  step={1000}\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <label className=\"text-sm font-medium text-hive-text-primary\">\n                    Max Concurrent Users\n                  </label>\n                  <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                    {config.realTimeSettings.maxConcurrentUsers}\n                  </Badge>\n                </div>\n                <Slider\n                  value={[config.realTimeSettings.maxConcurrentUsers]}\n                  onValueChange={([newValue]) => updateConfig('realTimeSettings.maxConcurrentUsers', newValue)}\n                  max={5000}\n                  min={100}\n                  step={100}\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <label className=\"text-sm font-medium text-hive-text-primary\">\n                    Cache Timeout\n                  </label>\n                  <Badge variant=\"secondary\" className=\"text-[var(--hive-brand-primary)]\">\n                    {config.realTimeSettings.cacheTimeout}s\n                  </Badge>\n                </div>\n                <Slider\n                  value={[config.realTimeSettings.cacheTimeout]}\n                  onValueChange={([newValue]) => updateConfig('realTimeSettings.cacheTimeout', newValue)}\n                  max={3600}\n                  min={60}\n                  step={60}\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Save Reminder */}\n      {unsavedChanges && (\n        <Alert className=\"border-[var(--hive-brand-primary)]/30 bg-[var(--hive-brand-primary)]/10\">\n          <CheckCircle className=\"h-4 w-4 text-[var(--hive-brand-primary)]\" />\n          <AlertDescription className=\"text-[var(--hive-brand-primary)]\">\n            You have unsaved changes to the feed algorithm configuration.\n            Remember to save your changes to apply them to the live system.\n          </AlertDescription>\n        </Alert>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/feed-configuration-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/firebase-monitoring.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Server' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wifi' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HardDrive' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cpu' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used. Allowed unused vars must match /^_/u.","line":38,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadFirebaseMetrics'. Either include it or remove the dependency array.","line":135,"column":6,"nodeType":"ArrayExpression","endLine":135,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [autoRefresh, loadFirebaseMetrics, timeRange]","fix":{"range":[2708,2732],"text":"[autoRefresh, loadFirebaseMetrics, timeRange]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Button,\n  Progress,\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n  Alert,\n  AlertDescription\n} from '@hive/ui';\nimport {\n  Server,\n  Database,\n  Zap,\n  Activity,\n  AlertTriangle,\n  CheckCircle,\n  Clock,\n  Users,\n  BarChart3,\n  TrendingUp,\n  TrendingDown,\n  Wifi,\n  HardDrive,\n  Cpu,\n  RefreshCw,\n  Shield,\n  Globe,\n  Eye,\n  Flame\n} from 'lucide-react';\n\ninterface FirebaseMetrics {\n  firestore: {\n    reads: number;\n    writes: number;\n    deletes: number;\n    activeConnections: number;\n    queriesPerSecond: number;\n    indexUsage: {\n      total: number;\n      used: number;\n      unused: number;\n    };\n    storage: {\n      documentsCount: number;\n      totalSizeMB: number;\n      growth: number; // percentage\n    };\n  };\n  authentication: {\n    activeUsers: number;\n    signInsToday: number;\n    signUpsToday: number;\n    failedAttempts: number;\n    magicLinksSent: number;\n    providers: {\n      email: number;\n      google: number;\n      development: number;\n    };\n  };\n  hosting: {\n    bandwidth: number; // MB\n    requests: number;\n    cacheHitRate: number; // percentage\n    averageResponseTime: number; // ms\n    errors: {\n      \"4xx\": number;\n      \"5xx\": number;\n    };\n  };\n  functions: {\n    invocations: number;\n    errors: number;\n    averageExecutionTime: number; // ms\n    memoryUsage: number; // MB\n    timeouts: number;\n  };\n  performance: {\n    pageLoadTimes: {\n      p50: number;\n      p90: number;\n      p95: number;\n    };\n    coreWebVitals: {\n      lcp: number; // Largest Contentful Paint\n      fid: number; // First Input Delay\n      cls: number; // Cumulative Layout Shift\n    };\n    networkLatency: number;\n  };\n}\n\ninterface SystemHealth {\n  status: 'healthy' | 'warning' | 'critical';\n  uptime: number;\n  issues: {\n    level: 'warning' | 'critical';\n    message: string;\n    timestamp: string;\n    resolved: boolean;\n  }[];\n  recommendations: string[];\n}\n\nexport function FirebaseMonitoring() {\n  const [metrics, setMetrics] = useState<FirebaseMetrics | null>(null);\n  const [health, setHealth] = useState<SystemHealth | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [timeRange, setTimeRange] = useState<'1h' | '24h' | '7d' | '30d'>('24h');\n\n  useEffect(() => {\n    loadFirebaseMetrics();\n\n    // Auto-refresh every 30 seconds if enabled\n    let interval: NodeJS.Timeout;\n    if (autoRefresh) {\n      interval = setInterval(loadFirebaseMetrics, 30000);\n    }\n\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [autoRefresh, timeRange]);\n\n  const loadFirebaseMetrics = async () => {\n    try {\n      setLoading(true);\n      const [metricsRes, healthRes] = await Promise.all([\n        fetch(`/api/admin/firebase-metrics?range=${timeRange}`),\n        fetch('/api/admin/system-health')\n      ]);\n\n      if (metricsRes.ok) {\n        const metricsData = await metricsRes.json();\n        setMetrics(metricsData.metrics);\n      }\n\n      if (healthRes.ok) {\n        const healthData = await healthRes.json();\n        setHealth(healthData.health);\n      }\n    } catch (error) {\n      console.error('Failed to load Firebase metrics:', error);\n      setMetrics(getMockFirebaseMetrics());\n      setHealth(getMockSystemHealth());\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'healthy': return 'text-green-400 bg-green-400/10 border-green-400/30';\n      case 'warning': return 'text-yellow-400 bg-yellow-400/10 border-yellow-400/30';\n      case 'critical': return 'text-red-400 bg-red-400/10 border-red-400/30';\n      default: return 'text-gray-400 bg-gray-400/10 border-gray-400/30';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'healthy': return <CheckCircle className=\"w-5 h-5 text-green-400\" />;\n      case 'warning': return <AlertTriangle className=\"w-5 h-5 text-yellow-400\" />;\n      case 'critical': return <AlertTriangle className=\"w-5 h-5 text-red-400\" />;\n      default: return <Activity className=\"w-5 h-5 text-gray-400\" />;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  if (!metrics || !health) {\n    return (\n      <div className=\"text-center py-8 text-gray-400\">\n        No Firebase monitoring data available\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Status */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\">Firebase Infrastructure</h2>\n          <p className=\"text-gray-400\">Real-time monitoring and performance metrics</p>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          <Card className={`px-4 py-2 ${getStatusColor(health.status)}`}>\n            <div className=\"flex items-center gap-2\">\n              {getStatusIcon(health.status)}\n              <div>\n                <div className=\"text-sm font-medium capitalize\">{health.status}</div>\n                <div className=\"text-xs opacity-70\">\n                  {Math.floor(health.uptime / 60)}h {health.uptime % 60}m uptime\n                </div>\n              </div>\n            </div>\n          </Card>\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm text-gray-400\">Auto-refresh</label>\n            <input\n              type=\"checkbox\"\n              checked={autoRefresh}\n              onChange={(e: React.ChangeEvent) => setAutoRefresh(e.target.checked)}\n              className=\"w-4 h-4 rounded border border-gray-600 bg-gray-800\"\n            />\n          </div>\n          <select\n            value={timeRange}\n            onChange={(e: React.ChangeEvent) => setTimeRange((e.target as any).value as any)}\n            className=\"px-3 py-2 bg-gray-800 border border-gray-600 rounded text-sm\"\n          >\n            <option value=\"1h\">Last Hour</option>\n            <option value=\"24h\">Last 24h</option>\n            <option value=\"7d\">Last 7 days</option>\n            <option value=\"30d\">Last 30 days</option>\n          </select>\n          <Button variant=\"outline\" className=\"max-w-sm\" onClick={loadFirebaseMetrics}>\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Refresh\n          </Button>\n        </div>\n      </div>\n\n      {/* Active Issues Alert */}\n      {health.issues.filter(issue => !issue.resolved).length > 0 && (\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>\n            {health.issues.filter(issue => !issue.resolved).length} active issues require attention.\n            Check the System Health tab for details.\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Core Metrics Overview */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card className=\"bg-gradient-to-br from-blue-600/20 to-blue-800/20 border-blue-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Firestore Operations</CardTitle>\n              <Database className=\"h-4 w-4 text-blue-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">\n              {(metrics.firestore.reads + metrics.firestore.writes).toLocaleString()}\n            </div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <div className=\"text-xs text-blue-400\">\n                {metrics.firestore.reads.toLocaleString()} reads\n              </div>\n              <div className=\"text-xs text-blue-400\">\n                {metrics.firestore.writes.toLocaleString()} writes\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Active Users</CardTitle>\n              <Users className=\"h-4 w-4 text-green-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">\n              {metrics.authentication.activeUsers.toLocaleString()}\n            </div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <TrendingUp className=\"w-3 h-3 text-green-500\" />\n              <span className=\"text-xs text-green-400\">\n                +{metrics.authentication.signUpsToday} today\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-purple-600/20 to-purple-800/20 border-purple-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Response Time</CardTitle>\n              <Zap className=\"h-4 w-4 text-purple-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">\n              {metrics.hosting.averageResponseTime}ms\n            </div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <span className=\"text-xs text-purple-400\">\n                {metrics.hosting.cacheHitRate}% cache hits\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-orange-600/20 to-orange-800/20 border-orange-500/30\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">Functions</CardTitle>\n              <Flame className=\"h-4 w-4 text-orange-400\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-white\">\n              {metrics.functions.invocations.toLocaleString()}\n            </div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <span className=\"text-xs text-orange-400\">\n                {((1 - metrics.functions.errors / metrics.functions.invocations) * 100).toFixed(1)}% success\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Tabs defaultValue=\"firestore\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-5\">\n          <TabsTrigger value=\"firestore\">Firestore</TabsTrigger>\n          <TabsTrigger value=\"auth\">Authentication</TabsTrigger>\n          <TabsTrigger value=\"hosting\">Hosting</TabsTrigger>\n          <TabsTrigger value=\"performance\">Performance</TabsTrigger>\n          <TabsTrigger value=\"health\">System Health</TabsTrigger>\n        </TabsList>\n\n        {/* Firestore Monitoring */}\n        <TabsContent value=\"firestore\" className=\"space-y-4\">\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Database Operations</CardTitle>\n                <CardDescription>Real-time Firestore activity</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Queries/second</span>\n                  <Badge className=\"bg-blue-500/20 text-blue-400\">\n                    {metrics.firestore.queriesPerSecond}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Active connections</span>\n                  <Badge className=\"bg-green-500/20 text-green-400\">\n                    {metrics.firestore.activeConnections}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Documents stored</span>\n                  <Badge variant=\"secondary\">\n                    {metrics.firestore.storage.documentsCount.toLocaleString()}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Storage size</span>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-sm font-medium\">\n                      {metrics.firestore.storage.totalSizeMB} MB\n                    </span>\n                    {metrics.firestore.storage.growth > 0 && (\n                      <Badge className=\"bg-yellow-500/20 text-yellow-400\">\n                        +{metrics.firestore.storage.growth}%\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Index Usage</CardTitle>\n                <CardDescription>Database optimization status</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span>Index Efficiency</span>\n                    <span>\n                      {Math.round((metrics.firestore.indexUsage.used / metrics.firestore.indexUsage.total) * 100)}%\n                    </span>\n                  </div>\n                  <Progress\n                    value={(metrics.firestore.indexUsage.used / metrics.firestore.indexUsage.total) * 100}\n                    className=\"h-2\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <div className=\"text-gray-400\">Used indexes</div>\n                    <div className=\"font-medium text-green-400\">\n                      {metrics.firestore.indexUsage.used}\n                    </div>\n                  </div>\n                  <div>\n                    <div className=\"text-gray-400\">Unused indexes</div>\n                    <div className=\"font-medium text-yellow-400\">\n                      {metrics.firestore.indexUsage.unused}\n                    </div>\n                  </div>\n                </div>\n                {metrics.firestore.indexUsage.unused > 0 && (\n                  <Alert>\n                    <AlertTriangle className=\"h-4 w-4\" />\n                    <AlertDescription className=\"text-xs\">\n                      {metrics.firestore.indexUsage.unused} unused indexes detected.\n                      Consider cleanup to reduce costs.\n                    </AlertDescription>\n                  </Alert>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* Authentication Monitoring */}\n        <TabsContent value=\"auth\" className=\"space-y-4\">\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Authentication Activity</CardTitle>\n                <CardDescription>User sign-ins and registrations</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Sign-ins today</span>\n                  <Badge className=\"bg-green-500/20 text-green-400\">\n                    {metrics.authentication.signInsToday}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">New sign-ups</span>\n                  <Badge className=\"bg-blue-500/20 text-blue-400\">\n                    {metrics.authentication.signUpsToday}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Failed attempts</span>\n                  <Badge className={`${metrics.authentication.failedAttempts > 10 ? 'bg-red-500/20 text-red-400' : 'bg-gray-500/20 text-gray-400'}`}>\n                    {metrics.authentication.failedAttempts}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Magic links sent</span>\n                  <Badge variant=\"secondary\">\n                    {metrics.authentication.magicLinksSent}\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Auth Providers</CardTitle>\n                <CardDescription>Authentication method distribution</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm\">Email/Magic Link</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-20 bg-gray-700 rounded-full h-2\">\n                        <div\n                          className=\"bg-blue-500 h-2 rounded-full\"\n                          style={{ width: `${(metrics.authentication.providers.email / metrics.authentication.activeUsers) * 100}%` }}\n                        />\n                      </div>\n                      <span className=\"text-xs text-gray-400 w-12\">\n                        {metrics.authentication.providers.email}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm\">Google OAuth</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-20 bg-gray-700 rounded-full h-2\">\n                        <div\n                          className=\"bg-green-500 h-2 rounded-full\"\n                          style={{ width: `${(metrics.authentication.providers.google / metrics.authentication.activeUsers) * 100}%` }}\n                        />\n                      </div>\n                      <span className=\"text-xs text-gray-400 w-12\">\n                        {metrics.authentication.providers.google}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm\">Development</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-20 bg-gray-700 rounded-full h-2\">\n                        <div\n                          className=\"bg-yellow-500 h-2 rounded-full\"\n                          style={{ width: `${(metrics.authentication.providers.development / metrics.authentication.activeUsers) * 100}%` }}\n                        />\n                      </div>\n                      <span className=\"text-xs text-gray-400 w-12\">\n                        {metrics.authentication.providers.development}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* Hosting Monitoring */}\n        <TabsContent value=\"hosting\" className=\"space-y-4\">\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Hosting Performance</CardTitle>\n                <CardDescription>Web traffic and response times</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Total requests</span>\n                  <Badge variant=\"secondary\">\n                    {metrics.hosting.requests.toLocaleString()}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Bandwidth used</span>\n                  <Badge variant=\"secondary\">\n                    {metrics.hosting.bandwidth} MB\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Cache hit rate</span>\n                  <Badge className={`${metrics.hosting.cacheHitRate > 80 ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'}`}>\n                    {metrics.hosting.cacheHitRate}%\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Avg response time</span>\n                  <Badge className={`${metrics.hosting.averageResponseTime < 200 ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'}`}>\n                    {metrics.hosting.averageResponseTime}ms\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Error Monitoring</CardTitle>\n                <CardDescription>HTTP error tracking</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Client errors (4xx)</span>\n                  <Badge className={`${metrics.hosting.errors['4xx'] > 50 ? 'bg-yellow-500/20 text-yellow-400' : 'bg-gray-500/20 text-gray-400'}`}>\n                    {metrics.hosting.errors['4xx']}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Server errors (5xx)</span>\n                  <Badge className={`${metrics.hosting.errors['5xx'] > 10 ? 'bg-red-500/20 text-red-400' : 'bg-gray-500/20 text-gray-400'}`}>\n                    {metrics.hosting.errors['5xx']}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm\">Success rate</span>\n                  <Badge className=\"bg-green-500/20 text-green-400\">\n                    {((1 - (metrics.hosting.errors['4xx'] + metrics.hosting.errors['5xx']) / metrics.hosting.requests) * 100).toFixed(2)}%\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* Performance Monitoring */}\n        <TabsContent value=\"performance\" className=\"space-y-4\">\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Core Web Vitals</CardTitle>\n                <CardDescription>User experience metrics</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  <div>\n                    <div className=\"flex justify-between text-sm mb-1\">\n                      <span>LCP (Largest Contentful Paint)</span>\n                      <span className={metrics.performance.coreWebVitals.lcp <= 2500 ? 'text-green-400' : 'text-yellow-400'}>\n                        {(metrics.performance.coreWebVitals.lcp / 1000).toFixed(1)}s\n                      </span>\n                    </div>\n                    <Progress\n                      value={Math.min((metrics.performance.coreWebVitals.lcp / 4000) * 100, 100)}\n                      className=\"h-2\"\n                    />\n                  </div>\n                  <div>\n                    <div className=\"flex justify-between text-sm mb-1\">\n                      <span>FID (First Input Delay)</span>\n                      <span className={metrics.performance.coreWebVitals.fid <= 100 ? 'text-green-400' : 'text-yellow-400'}>\n                        {metrics.performance.coreWebVitals.fid}ms\n                      </span>\n                    </div>\n                    <Progress\n                      value={Math.min((metrics.performance.coreWebVitals.fid / 300) * 100, 100)}\n                      className=\"h-2\"\n                    />\n                  </div>\n                  <div>\n                    <div className=\"flex justify-between text-sm mb-1\">\n                      <span>CLS (Cumulative Layout Shift)</span>\n                      <span className={metrics.performance.coreWebVitals.cls <= 0.1 ? 'text-green-400' : 'text-yellow-400'}>\n                        {metrics.performance.coreWebVitals.cls.toFixed(3)}\n                      </span>\n                    </div>\n                    <Progress\n                      value={Math.min((metrics.performance.coreWebVitals.cls / 0.25) * 100, 100)}\n                      className=\"h-2\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Page Load Performance</CardTitle>\n                <CardDescription>Response time percentiles</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-3 gap-4 text-center\">\n                  <div>\n                    <div className=\"text-gray-400 text-xs\">P50</div>\n                    <div className=\"text-lg font-bold text-green-400\">\n                      {metrics.performance.pageLoadTimes.p50}ms\n                    </div>\n                  </div>\n                  <div>\n                    <div className=\"text-gray-400 text-xs\">P90</div>\n                    <div className=\"text-lg font-bold text-yellow-400\">\n                      {metrics.performance.pageLoadTimes.p90}ms\n                    </div>\n                  </div>\n                  <div>\n                    <div className=\"text-gray-400 text-xs\">P95</div>\n                    <div className=\"text-lg font-bold text-orange-400\">\n                      {metrics.performance.pageLoadTimes.p95}ms\n                    </div>\n                  </div>\n                </div>\n                <div className=\"flex justify-between items-center pt-2 border-t border-gray-700\">\n                  <span className=\"text-sm\">Network latency</span>\n                  <Badge variant=\"secondary\">\n                    {metrics.performance.networkLatency}ms\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* System Health */}\n        <TabsContent value=\"health\" className=\"space-y-4\">\n          <div className=\"space-y-4\">\n            {health.recommendations.length > 0 && (\n              <Alert>\n                <CheckCircle className=\"h-4 w-4\" />\n                <AlertDescription>\n                  <div className=\"font-medium mb-2\">Optimization Recommendations:</div>\n                  <ul className=\"list-disc list-inside space-y-1\">\n                    {health.recommendations.map((rec, index) => (\n                      <li key={index} className=\"text-sm\">{rec}</li>\n                    ))}\n                  </ul>\n                </AlertDescription>\n              </Alert>\n            )}\n\n            <Card className=\"bg-gray-900/50 border-gray-800\">\n              <CardHeader>\n                <CardTitle>Recent Issues</CardTitle>\n                <CardDescription>System alerts and incident history</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {health.issues.length === 0 ? (\n                    <div className=\"text-center py-4 text-gray-400\">\n                      <CheckCircle className=\"w-8 h-8 mx-auto mb-2 text-green-400\" />\n                      No issues detected. System running smoothly.\n                    </div>\n                  ) : (\n                    health.issues.map((issue, index) => (\n                      <div key={index} className={`p-3 rounded-lg border ${\n                        issue.resolved\n                          ? 'bg-gray-800/50 border-gray-700'\n                          : issue.level === 'critical'\n                            ? 'bg-red-500/10 border-red-500/30'\n                            : 'bg-yellow-500/10 border-yellow-500/30'\n                      }`}>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              {issue.resolved ? (\n                                <CheckCircle className=\"w-4 h-4 text-green-400\" />\n                              ) : (\n                                <AlertTriangle className={`w-4 h-4 ${issue.level === 'critical' ? 'text-red-400' : 'text-yellow-400'}`} />\n                              )}\n                              <Badge variant={issue.level === 'critical' ? 'destructive' : 'secondary'}>\n                                {issue.level}\n                              </Badge>\n                              <span className=\"text-xs text-gray-400\">\n                                {new Date(issue.timestamp).toLocaleString()}\n                              </span>\n                            </div>\n                            <p className=\"text-sm\">{issue.message}</p>\n                          </div>\n                        </div>\n                      </div>\n                    ))\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n\n// Mock data for development\nfunction getMockFirebaseMetrics(): FirebaseMetrics {\n  return {\n    firestore: {\n      reads: 45234,\n      writes: 12456,\n      deletes: 234,\n      activeConnections: 89,\n      queriesPerSecond: 23.4,\n      indexUsage: {\n        total: 45,\n        used: 38,\n        unused: 7\n      },\n      storage: {\n        documentsCount: 15678,\n        totalSizeMB: 234.5,\n        growth: 12.3\n      }\n    },\n    authentication: {\n      activeUsers: 1234,\n      signInsToday: 234,\n      signUpsToday: 34,\n      failedAttempts: 5,\n      magicLinksSent: 189,\n      providers: {\n        email: 956,\n        google: 234,\n        development: 44\n      }\n    },\n    hosting: {\n      bandwidth: 5678,\n      requests: 23456,\n      cacheHitRate: 87,\n      averageResponseTime: 245,\n      errors: {\n        \"4xx\": 45,\n        \"5xx\": 8\n      }\n    },\n    functions: {\n      invocations: 8934,\n      errors: 23,\n      averageExecutionTime: 456,\n      memoryUsage: 128,\n      timeouts: 2\n    },\n    performance: {\n      pageLoadTimes: {\n        p50: 1200,\n        p90: 2400,\n        p95: 3200\n      },\n      coreWebVitals: {\n        lcp: 1800,\n        fid: 85,\n        cls: 0.08\n      },\n      networkLatency: 120\n    }\n  };\n}\n\nfunction getMockSystemHealth(): SystemHealth {\n  return {\n    status: 'healthy',\n    uptime: 1440, // 24 hours\n    issues: [\n      {\n        level: 'warning',\n        message: 'High Firestore read volume detected - consider implementing caching',\n        timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),\n        resolved: true\n      },\n      {\n        level: 'warning',\n        message: '7 unused Firestore indexes consuming unnecessary storage',\n        timestamp: new Date(Date.now() - 30 * 60 * 1000).toISOString(),\n        resolved: false\n      }\n    ],\n    recommendations: [\n      'Consider implementing Redis caching for frequently accessed data',\n      'Remove 7 unused Firestore indexes to reduce costs',\n      'Enable compression for static assets to improve load times',\n      'Set up Firebase Performance Monitoring alerts for proactive monitoring'\n    ]\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/moderation-queue.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTrigger' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":180,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":193},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchModerationQueue'. Either include it or remove the dependency array.","line":132,"column":6,"nodeType":"ArrayExpression","endLine":137,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [statusFilter, categoryFilter, severityFilter, assignmentFilter, fetchModerationQueue]","fix":{"range":[3677,3762],"text":"[statusFilter, categoryFilter, severityFilter, assignmentFilter, fetchModerationQueue]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, Button, Badge, Select, SelectContent, SelectItem, SelectTrigger, SelectValue, Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, Textarea, Alert, AlertDescription, Progress, Tabs, TabsContent, TabsList, TabsTrigger,  } from '@hive/ui';\nimport {\n  AlertTriangle,\n  Eye,\n  EyeOff,\n  Trash2,\n  UserX,\n  Ban,\n  MessageSquare,\n  Clock,\n  CheckCircle,\n  XCircle,\n  Filter,\n  RefreshCw,\n  ArrowUpDown,\n  User,\n  Calendar,\n  Flag,\n  Shield,\n} from \"lucide-react\";\n\ninterface ContentReport {\n  id: string;\n  reporterId: string;\n  reporterInfo: {\n    name: string;\n    email: string;\n    trustScore: number;\n  };\n  contentId: string;\n  contentType:\n    | \"post\"\n    | \"comment\"\n    | \"message\"\n    | \"tool\"\n    | \"space\"\n    | \"profile\"\n    | \"event\";\n  contentOwnerId: string;\n  spaceId?: string;\n  category: string;\n  subCategory?: string;\n  severity: \"low\" | \"medium\" | \"high\" | \"critical\";\n  description: string;\n  evidence?: {\n    screenshots: string[];\n    urls: string[];\n    additionalContext: string;\n  };\n  status: \"pending\" | \"under_review\" | \"resolved\" | \"dismissed\" | \"escalated\";\n  assignedModerator?: string;\n  aiAnalysis?: {\n    confidence: number;\n    suggestedAction: string;\n    riskScore: number;\n    reasoning: string;\n  };\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface ModerationStats {\n  pendingReports: number;\n  todayReports: number;\n  resolvedToday: number;\n  lastUpdated: string;\n}\n\nexport function ModerationQueue() {\n  const [reports, setReports] = useState<ContentReport[]>([]);\n  const [stats, setStats] = useState<ModerationStats | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedReport, setSelectedReport] = useState<ContentReport | null>(\n    null\n  );\n  const [isReviewDialogOpen, setIsReviewDialogOpen] = useState(false);\n  const [isProcessingAction, setIsProcessingAction] = useState(false);\n\n  // Filters\n  const [statusFilter, setStatusFilter] = useState(\"pending\");\n  const [categoryFilter, setCategoryFilter] = useState(\"all\");\n  const [severityFilter, setSeverityFilter] = useState(\"all\");\n  const [assignmentFilter, setAssignmentFilter] = useState(\"all\");\n\n  // Action dialog state\n  const [actionDialog, setActionDialog] = useState<{\n    isOpen: boolean;\n    report: ContentReport | null;\n    action: string;\n  }>({\n    isOpen: false,\n    report: null,\n    action: \"\",\n  });\n\n  const [actionReason, setActionReason] = useState(\"\");\n  const [actionNotes, setActionNotes] = useState(\"\");\n\n  const fetchModerationQueue = async () => {\n    try {\n      setIsLoading(true);\n      const params = new URLSearchParams({\n        limit: \"50\",\n        ...(statusFilter !== \"all\" && { status: statusFilter }),\n        ...(categoryFilter !== \"all\" && { category: categoryFilter }),\n        ...(severityFilter !== \"all\" && { severity: severityFilter }),\n        ...(assignmentFilter === \"me\" && { assignedTo: \"me\" }),\n        ...(assignmentFilter !== \"all\" &&\n          assignmentFilter !== \"me\" && { assignedTo: assignmentFilter }),\n      });\n\n      const response = await fetch(`/api/admin/moderation?${params}`);\n      if (response.ok) {\n        const data = await response.json();\n        setReports(data.reports);\n        setStats(data.statistics);\n      }\n    } catch (error) {\n      console.error(\"Failed to fetch moderation queue:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchModerationQueue();\n    const interval = setInterval(fetchModerationQueue, 30000); // Refresh every 30 seconds\n    return () => clearInterval(interval);\n  }, [\n    statusFilter,\n    categoryFilter,\n    severityFilter,\n    assignmentFilter,\n  ]);\n\n  const handleModerationAction = async (\n    reportId: string,\n    action: string,\n    reason: string,\n    notes?: string\n  ) => {\n    try {\n      setIsProcessingAction(true);\n      const response = await fetch(\"/api/admin/moderation\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          reportId,\n          action,\n          reason,\n          notes,\n        }),\n      });\n\n      if (response.ok) {\n        await fetchModerationQueue(); // Refresh the queue\n        setActionDialog({ isOpen: false, report: null, action: \"\" });\n        setActionReason(\"\");\n        setActionNotes(\"\");\n      } else {\n        throw new Error(\"Failed to process moderation action\");\n      }\n    } catch (error) {\n      console.error(\"Error processing moderation action:\", error);\n    } finally {\n      setIsProcessingAction(false);\n    }\n  };\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case \"critical\":\n        return \"bg-red-500\";\n      case \"high\":\n        return \"bg-orange-500\";\n      case \"medium\":\n        return \"bg-yellow-500\";\n      case \"low\":\n        return \"bg-blue-500\";\n      default:\n        return \"bg-gray-500\";\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\n      case \"under_review\":\n        return <Eye className=\"h-4 w-4 text-blue-500\" />;\n      case \"resolved\":\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n      case \"dismissed\":\n        return <XCircle className=\"h-4 w-4 text-gray-500\" />;\n      case \"escalated\":\n        return <AlertTriangle className=\"h-4 w-4 text-red-500\" />;\n      default:\n        return <Flag className=\"h-4 w-4 text-gray-500\" />;\n    }\n  };\n\n  const getActionIcon = (action: string) => {\n    switch (action) {\n      case \"hide_content\":\n        return <EyeOff className=\"h-4 w-4\" />;\n      case \"remove_content\":\n        return <Trash2 className=\"h-4 w-4\" />;\n      case \"warn_user\":\n        return <AlertTriangle className=\"h-4 w-4\" />;\n      case \"suspend_user\":\n        return <UserX className=\"h-4 w-4\" />;\n      case \"ban_user\":\n        return <Ban className=\"h-4 w-4\" />;\n      case \"escalate_human\":\n        return <ArrowUpDown className=\"h-4 w-4\" />;\n      default:\n        return <Shield className=\"h-4 w-4\" />;\n    }\n  };\n\n  const formatTimeAgo = (dateString: string) => {\n    const diff = Date.now() - new Date(dateString).getTime();\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    if (days > 0) return `${days}d ago`;\n    if (hours > 0) return `${hours}h ago`;\n    return `${minutes}m ago`;\n  };\n\n  if (isLoading && reports.length === 0) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"flex items-center justify-center h-64\">\n          <RefreshCw className=\"h-8 w-8 animate-spin text-gray-500\" />\n          <span className=\"ml-2 text-gray-500\">\n            Loading moderation queue...\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white\">Moderation Queue</h1>\n          <p className=\"text-gray-400\">Review and moderate reported content</p>\n        </div>\n\n        <Button\n          onClick={fetchModerationQueue}\n          variant=\"outline\"\n          className=\"max-w-sm\"\n          disabled={isLoading}\n        >\n          <RefreshCw\n            className={`h-4 w-4 mr-2 ${isLoading ? \"animate-spin\" : \"\"}`}\n          />\n          Refresh\n        </Button>\n      </div>\n\n      {/* Statistics */}\n      {stats && (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <Card className=\"bg-gray-900 border-gray-800\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n                <Clock className=\"h-5 w-5 text-yellow-500\" />\n                <span>Pending Reports</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-white\">\n                {stats.pendingReports}\n              </div>\n              <p className=\"text-sm text-gray-400\">Awaiting review</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-gray-900 border-gray-800\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n                <Calendar className=\"h-5 w-5 text-blue-500\" />\n                <span>Today&apos;s Reports</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-white\">\n                {stats.todayReports}\n              </div>\n              <p className=\"text-sm text-gray-400\">New today</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-gray-900 border-gray-800\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Resolved Today</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-white\">\n                {stats.resolvedToday}\n              </div>\n              <p className=\"text-sm text-gray-400\">Processed</p>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Filters */}\n      <Card className=\"bg-gray-900 border-gray-800\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex items-center space-x-4\">\n            <Filter className=\"h-5 w-5 text-gray-400\" />\n\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-40\">\n                <SelectValue placeholder=\"Status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"pending\">Pending</SelectItem>\n                <SelectItem value=\"under_review\">Under Review</SelectItem>\n                <SelectItem value=\"resolved\">Resolved</SelectItem>\n                <SelectItem value=\"dismissed\">Dismissed</SelectItem>\n                <SelectItem value=\"escalated\">Escalated</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n              <SelectTrigger className=\"w-40\">\n                <SelectValue placeholder=\"Category\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Categories</SelectItem>\n                <SelectItem value=\"spam\">Spam</SelectItem>\n                <SelectItem value=\"harassment\">Harassment</SelectItem>\n                <SelectItem value=\"hate_speech\">Hate Speech</SelectItem>\n                <SelectItem value=\"inappropriate_content\">\n                  Inappropriate\n                </SelectItem>\n                <SelectItem value=\"misinformation\">Misinformation</SelectItem>\n                <SelectItem value=\"violence\">Violence</SelectItem>\n                <SelectItem value=\"other\">Other</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={severityFilter} onValueChange={setSeverityFilter}>\n              <SelectTrigger className=\"w-40\">\n                <SelectValue placeholder=\"Severity\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Severities</SelectItem>\n                <SelectItem value=\"critical\">Critical</SelectItem>\n                <SelectItem value=\"high\">High</SelectItem>\n                <SelectItem value=\"medium\">Medium</SelectItem>\n                <SelectItem value=\"low\">Low</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select\n              value={assignmentFilter}\n              onValueChange={setAssignmentFilter}\n            >\n              <SelectTrigger className=\"w-40\">\n                <SelectValue placeholder=\"Assignment\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Reports</SelectItem>\n                <SelectItem value=\"me\">My Reports</SelectItem>\n                <SelectItem value=\"unassigned\">Unassigned</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Reports List */}\n      <div className=\"space-y-4\">\n        {reports.length === 0 ? (\n          <Card className=\"bg-gray-900 border-gray-800\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center py-12\">\n                <CheckCircle className=\"h-12 w-12 text-green-500 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-white mb-2\">\n                  Queue is Clear!\n                </h3>\n                <p className=\"text-gray-400\">\n                  No reports match the current filters.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        ) : (\n          reports.map((report) => (\n            <Card\n              key={report.id}\n              className=\"bg-gray-900 border-gray-800 hover:border-gray-700 transition-colors\"\n            >\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1 space-y-3\">\n                    {/* Header */}\n                    <div className=\"flex items-center space-x-3\">\n                      <div\n                        className={`w-2 h-2 rounded-full ${getSeverityColor(\n                          report.severity\n                        )}`}\n                      />\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {report.contentType}\n                      </Badge>\n                      <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                        {report.category.replace(\"_\", \" \")}\n                      </Badge>\n                      <div className=\"flex items-center space-x-1\">\n                        {getStatusIcon(report.status)}\n                        <span className=\"text-sm text-gray-400 capitalize\">\n                          {report.status.replace(\"_\", \" \")}\n                        </span>\n                      </div>\n                      <span className=\"text-sm text-gray-500\">\n                        {formatTimeAgo(report.createdAt)}\n                      </span>\n                    </div>\n\n                    {/* Content */}\n                    <div>\n                      <p className=\"text-white font-medium mb-1\">\n                        Report #{report.id.slice(-8)}\n                      </p>\n                      <p className=\"text-gray-300 text-sm line-clamp-2\">\n                        {report.description}\n                      </p>\n                    </div>\n\n                    {/* Reporter Info */}\n                    <div className=\"flex items-center space-x-4 text-sm\">\n                      <div className=\"flex items-center space-x-1\">\n                        <User className=\"h-4 w-4 text-gray-400\" />\n                        <span className=\"text-gray-400\">\n                          Reporter: {report.reporterInfo.name}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center space-x-1\">\n                        <Shield className=\"h-4 w-4 text-gray-400\" />\n                        <span className=\"text-gray-400\">\n                          Trust:{\" \"}\n                          {Math.round(report.reporterInfo.trustScore * 100)}%\n                        </span>\n                      </div>\n                      {report.aiAnalysis && (\n                        <div className=\"flex items-center space-x-1\">\n                          <MessageSquare className=\"h-4 w-4 text-purple-400\" />\n                          <span className=\"text-purple-400\">\n                            AI: {Math.round(report.aiAnalysis.confidence * 100)}\n                            % confident\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"max-w-sm\"\n                      onClick={() => {\n                        setSelectedReport(report);\n                        setIsReviewDialogOpen(true);\n                      }}\n                    >\n                      <Eye className=\"h-4 w-4 mr-2\" />\n                      Review\n                    </Button>\n                    <Dialog\n                      open={isReviewDialogOpen}\n                      onOpenChange={setIsReviewDialogOpen}\n                    >\n                      <DialogContent className=\"max-w-4xl\">\n                        <DialogHeader>\n                          <DialogTitle>Report Details</DialogTitle>\n                        </DialogHeader>\n                        {selectedReport && (\n                          <ReportDetailsPanel\n                            report={selectedReport}\n                            onAction={(action) => {\n                              setActionDialog({\n                                isOpen: true,\n                                report: selectedReport,\n                                action,\n                              });\n                            }}\n                          />\n                        )}\n                      </DialogContent>\n                    </Dialog>\n\n                    {report.status === \"pending\" && (\n                      <>\n                        <Button\n                          onClick={() =>\n                            setActionDialog({\n                              isOpen: true,\n                              report,\n                              action: \"warn_user\",\n                            })\n                          }\n                          variant=\"outline\"\n                          className=\"max-w-sm text-yellow-400 border-yellow-400/50 hover:bg-yellow-400/10\"\n                        >\n                          {getActionIcon(\"warn_user\")}\n                        </Button>\n                        <Button\n                          onClick={() =>\n                            setActionDialog({\n                              isOpen: true,\n                              report,\n                              action: \"hide_content\",\n                            })\n                          }\n                          variant=\"outline\"\n                          className=\"max-w-sm text-orange-400 border-orange-400/50 hover:bg-orange-400/10\"\n                        >\n                          {getActionIcon(\"hide_content\")}\n                        </Button>\n                        <Button\n                          onClick={() =>\n                            setActionDialog({\n                              isOpen: true,\n                              report,\n                              action: \"remove_content\",\n                            })\n                          }\n                          variant=\"outline\"\n                          className=\"max-w-sm text-red-400 border-red-400/50 hover:bg-red-400/10\"\n                        >\n                          {getActionIcon(\"remove_content\")}\n                        </Button>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n\n      {/* Moderation Action Dialog */}\n      <Dialog\n        open={actionDialog.isOpen}\n        onOpenChange={(open) =>\n          !open && setActionDialog({ isOpen: false, report: null, action: \"\" })\n        }\n      >\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center space-x-2\">\n              {getActionIcon(actionDialog.action)}\n              <span>Confirm {actionDialog.action.replace(\"_\", \" \")}</span>\n            </DialogTitle>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <Alert>\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription>\n                This action will{\" \"}\n                {actionDialog.action.replace(\"_\", \" \").toLowerCase()} for report\n                #{actionDialog.report?.id.slice(-8)}.\n              </AlertDescription>\n            </Alert>\n\n            <div>\n              <label className=\"text-sm font-medium text-white mb-2 block\">\n                Reason (required)\n              </label>\n              <Textarea\n                value={actionReason}\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                  setActionReason((e.target as any).value)\n                }\n                placeholder=\"Provide a detailed reason for this action...\"\n                className=\"min-h-[80px]\"\n              />\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium text-white mb-2 block\">\n                Additional Notes (optional)\n              </label>\n              <Textarea\n                value={actionNotes}\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                  setActionNotes((e.target as any).value)\n                }\n                placeholder=\"Any additional context or notes...\"\n                className=\"min-h-[60px]\"\n              />\n            </div>\n\n            <div className=\"flex justify-end space-x-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={() =>\n                  setActionDialog({ isOpen: false, report: null, action: \"\" })\n                }\n                disabled={isProcessingAction}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  if (actionDialog.report && actionReason.trim()) {\n                    handleModerationAction(\n                      actionDialog.report.id,\n                      actionDialog.action,\n                      actionReason,\n                      actionNotes.trim() || undefined\n                    );\n                  }\n                }}\n                disabled={isProcessingAction || !actionReason.trim()}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                {isProcessingAction ? (\n                  <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                ) : (\n                  getActionIcon(actionDialog.action)\n                )}\n                Confirm Action\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\n// Detailed report review panel\nfunction ReportDetailsPanel({\n  report,\n  onAction,\n}: {\n  report: ContentReport;\n  onAction: (action: string) => void;\n}) {\n  return (\n    <div className=\"space-y-6\">\n      <Tabs defaultValue=\"details\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"details\">Report Details</TabsTrigger>\n          <TabsTrigger value=\"content\">Content Preview</TabsTrigger>\n          <TabsTrigger value=\"analysis\">AI Analysis</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"details\" className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <h4 className=\"font-medium text-white mb-2\">\n                Report Information\n              </h4>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">ID:</span>\n                  <span className=\"text-white\">{report.id}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Category:</span>\n                  <Badge variant=\"secondary\">{report.category}</Badge>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Severity:</span>\n                  <Badge className={getSeverityColor(report.severity)}>\n                    {report.severity}\n                  </Badge>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Content Type:</span>\n                  <span className=\"text-white\">{report.contentType}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Created:</span>\n                  <span className=\"text-white\">\n                    {new Date(report.createdAt).toLocaleString()}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div>\n              <h4 className=\"font-medium text-white mb-2\">Reporter</h4>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Name:</span>\n                  <span className=\"text-white\">{report.reporterInfo.name}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-400\">Trust Score:</span>\n                  <span className=\"text-white\">\n                    {Math.round(report.reporterInfo.trustScore * 100)}%\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h4 className=\"font-medium text-white mb-2\">Description</h4>\n            <p className=\"text-gray-300 bg-gray-800 p-3 rounded border\">\n              {report.description}\n            </p>\n          </div>\n\n          {report.evidence && (\n            <div>\n              <h4 className=\"font-medium text-white mb-2\">Evidence</h4>\n              <div className=\"bg-gray-800 p-3 rounded border\">\n                {report.evidence.additionalContext && (\n                  <p className=\"text-gray-300 mb-2\">\n                    {report.evidence.additionalContext}\n                  </p>\n                )}\n                {report.evidence.urls && report.evidence.urls.length > 0 && (\n                  <div>\n                    <p className=\"text-sm text-gray-400 mb-1\">URLs:</p>\n                    {report.evidence.urls.map((url, index) => (\n                      <a\n                        key={index}\n                        href={url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"text-blue-400 hover:text-blue-300 text-sm block\"\n                      >\n                        {url}\n                      </a>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"content\" className=\"space-y-4\">\n          <Alert>\n            <AlertTriangle className=\"h-4 w-4\" />\n            <AlertDescription>\n              Content preview would be loaded here from the actual content\n              source.\n            </AlertDescription>\n          </Alert>\n        </TabsContent>\n\n        <TabsContent value=\"analysis\" className=\"space-y-4\">\n          {report.aiAnalysis ? (\n            <div className=\"space-y-4\">\n              <div>\n                <h4 className=\"font-medium text-white mb-2\">AI Assessment</h4>\n                <div className=\"bg-gray-800 p-4 rounded border space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-400\">Confidence:</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <Progress\n                        value={report.aiAnalysis.confidence * 100}\n                        className=\"w-20\"\n                      />\n                      <span className=\"text-white\">\n                        {Math.round(report.aiAnalysis.confidence * 100)}%\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Suggested Action:</span>\n                    <Badge variant=\"secondary\">\n                      {report.aiAnalysis.suggestedAction}\n                    </Badge>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-400\">Risk Score:</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <Progress\n                        value={report.aiAnalysis.riskScore * 100}\n                        className=\"w-20\"\n                      />\n                      <span className=\"text-white\">\n                        {Math.round(report.aiAnalysis.riskScore * 100)}%\n                      </span>\n                    </div>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-400 block mb-1\">Reasoning:</span>\n                    <p className=\"text-gray-300 text-sm\">\n                      {report.aiAnalysis.reasoning}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <Alert>\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription>\n                AI analysis is not available for this report.\n              </AlertDescription>\n            </Alert>\n          )}\n        </TabsContent>\n      </Tabs>\n\n      {/* Quick Actions */}\n      {report.status === \"pending\" && (\n        <div className=\"flex justify-end space-x-2 pt-4 border-t border-gray-800\">\n          <Button\n            onClick={() => onAction(\"no_action\")}\n            variant=\"outline\"\n            className=\"max-w-sm\"\n          >\n            Dismiss\n          </Button>\n      <Button\n        onClick={() => onAction(\"warn_user\")}\n        variant=\"outline\"\n        className=\"max-w-sm text-yellow-400\"\n      >\n            Warn User\n          </Button>\n      <Button\n        onClick={() => onAction(\"hide_content\")}\n        variant=\"outline\"\n        className=\"max-w-sm text-orange-400\"\n      >\n            Hide Content\n          </Button>\n      <Button\n        onClick={() => onAction(\"remove_content\")}\n        variant=\"outline\"\n        className=\"max-w-sm text-red-400\"\n      >\n            Remove Content\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n\n  function getSeverityColor(severity: string) {\n    switch (severity) {\n      case \"critical\":\n        return \"bg-red-500\";\n      case \"high\":\n        return \"bg-orange-500\";\n      case \"medium\":\n        return \"bg-yellow-500\";\n      case \"low\":\n        return \"bg-blue-500\";\n      default:\n        return \"bg-gray-500\";\n    }\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/real-time-moderation.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertDescription' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Avatar' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ban' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedReport' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":92,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Button,\n  Alert,\n  AlertDescription,\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n  Avatar\n} from '@hive/ui';\nimport {\n  Flag,\n  Shield,\n  AlertTriangle,\n  CheckCircle,\n  XCircle,\n  MessageCircle,\n  User,\n  Clock,\n  TrendingUp,\n  Eye,\n  Ban,\n  Trash2,\n  MoreHorizontal\n} from 'lucide-react';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface ContentReport {\n  id: string;\n  type: 'post' | 'comment' | 'profile' | 'space' | 'tool';\n  contentId: string;\n  contentPreview: string;\n  reportedBy: {\n    id: string;\n    name: string;\n    handle: string;\n    avatarUrl?: string;\n  };\n  reportedUser: {\n    id: string;\n    name: string;\n    handle: string;\n    avatarUrl?: string;\n    previousViolations: number;\n  };\n  reason: 'spam' | 'harassment' | 'inappropriate' | 'misinformation' | 'other';\n  description: string;\n  status: 'pending' | 'reviewing' | 'resolved' | 'escalated';\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  createdAt: Date;\n  reviewedAt?: Date;\n  reviewedBy?: string;\n  action?: 'dismissed' | 'warned' | 'content_removed' | 'user_suspended' | 'user_banned';\n  notes?: string;\n}\n\ninterface ModerationStats {\n  pending: number;\n  reviewing: number;\n  resolvedToday: number;\n  avgResponseTime: number;\n  falsePositiveRate: number;\n  topReportReasons: { reason: string; count: number }[];\n  recentTrends: { hour: string; reports: number }[];\n}\n\ninterface AutoModerationRule {\n  id: string;\n  name: string;\n  enabled: boolean;\n  type: 'keyword' | 'pattern' | 'behavior' | 'ml_based';\n  severity: 'low' | 'medium' | 'high';\n  actions: string[];\n  matchCount: number;\n  falsePositives: number;\n}\n\nexport function RealTimeModeration() {\n  const [reports, setReports] = useState<ContentReport[]>([]);\n  const [stats, setStats] = useState<ModerationStats | null>(null);\n  const [autoModRules, setAutoModRules] = useState<AutoModerationRule[]>([]);\n  const [selectedReport, setSelectedReport] = useState<ContentReport | null>(null);\n  const [filterStatus, setFilterStatus] = useState<string>('all');\n  const [filterPriority, setFilterPriority] = useState<string>('all');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadModerationData();\n    // Set up real-time updates\n    const interval = setInterval(loadModerationData, 30000); // Refresh every 30 seconds\n    return () => clearInterval(interval);\n  }, []);\n\n  const loadModerationData = async () => {\n    try {\n      const [reportsRes, statsRes, rulesRes] = await Promise.all([\n        fetch('/api/admin/moderation/reports'),\n        fetch('/api/admin/moderation/stats'),\n        fetch('/api/admin/moderation/rules')\n      ]);\n\n      if (reportsRes.ok) {\n        const reportsData = await reportsRes.json();\n        setReports(reportsData.reports || []);\n      }\n\n      if (statsRes.ok) {\n        const statsData = await statsRes.json();\n        setStats(statsData);\n      }\n\n      if (rulesRes.ok) {\n        const rulesData = await rulesRes.json();\n        setAutoModRules(rulesData.rules || []);\n      }\n    } catch (error) {\n      console.error('Failed to load moderation data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleReportAction = async (reportId: string, action: string, notes?: string) => {\n    try {\n      const response = await fetch(`/api/admin/moderation/reports/${reportId}/action`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ action, notes })\n      });\n\n      if (response.ok) {\n        // Update local state\n        setReports(prev => prev.map(report =>\n          report.id === reportId\n            ? { ...report, status: 'resolved' as const, action, reviewedAt: new Date(), notes } as ContentReport\n            : report\n        ));\n        setSelectedReport(null);\n        loadModerationData(); // Refresh data\n      }\n    } catch (error) {\n      console.error('Failed to perform moderation action:', error);\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'critical': return 'bg-red-500';\n      case 'high': return 'bg-orange-500';\n      case 'medium': return 'bg-yellow-500';\n      case 'low': return 'bg-gray-500';\n      default: return 'bg-gray-400';\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending': return 'bg-yellow-500';\n      case 'reviewing': return 'bg-blue-500';\n      case 'resolved': return 'bg-green-500';\n      case 'escalated': return 'bg-red-500';\n      default: return 'bg-gray-400';\n    }\n  };\n\n  const filteredReports = reports.filter(report => {\n    if (filterStatus !== 'all' && report.status !== filterStatus) return false;\n    if (filterPriority !== 'all' && report.priority !== filterPriority) return false;\n    return true;\n  });\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hive-brand-primary)]\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Real-time Stats */}\n      {stats && (\n        <div className=\"grid gap-4 md:grid-cols-4\">\n          <Card className=\"bg-yellow-500/10 border-yellow-500/30\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium\">Pending</CardTitle>\n                <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-yellow-500\">{stats.pending}</div>\n              <p className=\"text-xs text-gray-400 mt-1\">Awaiting review</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-blue-500/10 border-blue-500/30\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium\">Reviewing</CardTitle>\n                <Eye className=\"h-4 w-4 text-blue-500\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-500\">{stats.reviewing}</div>\n              <p className=\"text-xs text-gray-400 mt-1\">Currently under review</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-green-500/10 border-green-500/30\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium\">Resolved Today</CardTitle>\n                <CheckCircle className=\"h-4 w-4 text-green-500\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-500\">{stats.resolvedToday}</div>\n              <p className=\"text-xs text-gray-400 mt-1\">Avg {stats.avgResponseTime}min response</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-purple-500/10 border-purple-500/30\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium\">Accuracy</CardTitle>\n                <Shield className=\"h-4 w-4 text-purple-500\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-purple-500\">\n                {100 - stats.falsePositiveRate}%\n              </div>\n              <p className=\"text-xs text-gray-400 mt-1\">True positive rate</p>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Auto-Moderation Rules */}\n      <Card className=\"bg-gray-900/50 border-gray-800\">\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>Auto-Moderation</CardTitle>\n              <CardDescription>AI-powered content filtering</CardDescription>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge className=\"bg-green-500/20 text-green-400\">\n                {autoModRules.filter(r => r.enabled).length} Active\n              </Badge>\n              <Button className=\"max-w-sm\" variant=\"outline\">\n                Configure Rules\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-2\">\n            {autoModRules.slice(0, 3).map(rule => (\n              <div key={rule.id} className=\"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  <div className={`w-2 h-2 rounded-full ${rule.enabled ? 'bg-green-500' : 'bg-gray-500'}`} />\n                  <div>\n                    <p className=\"font-medium text-white\">{rule.name}</p>\n                    <p className=\"text-xs text-gray-400\">\n                      {rule.matchCount} matches ‚Ä¢ {rule.falsePositives} false positives\n                    </p>\n                  </div>\n                </div>\n                <Badge className={`${\n                  rule.severity === 'high' ? 'bg-red-500/20 text-red-400' :\n                  rule.severity === 'medium' ? 'bg-yellow-500/20 text-yellow-400' :\n                  'bg-gray-500/20 text-gray-400'\n                }`}>\n                  {rule.severity}\n                </Badge>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Moderation Queue */}\n      <Card className=\"bg-gray-900/50 border-gray-800\">\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>Moderation Queue</CardTitle>\n              <CardDescription>Review reported content in real-time</CardDescription>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Select value={filterStatus} onValueChange={setFilterStatus}>\n                <SelectTrigger className=\"w-32\">\n                  <SelectValue placeholder=\"Status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Status</SelectItem>\n                  <SelectItem value=\"pending\">Pending</SelectItem>\n                  <SelectItem value=\"reviewing\">Reviewing</SelectItem>\n                  <SelectItem value=\"resolved\">Resolved</SelectItem>\n                  <SelectItem value=\"escalated\">Escalated</SelectItem>\n                </SelectContent>\n              </Select>\n              <Select value={filterPriority} onValueChange={setFilterPriority}>\n                <SelectTrigger className=\"w-32\">\n                  <SelectValue placeholder=\"Priority\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Priority</SelectItem>\n                  <SelectItem value=\"critical\">Critical</SelectItem>\n                  <SelectItem value=\"high\">High</SelectItem>\n                  <SelectItem value=\"medium\">Medium</SelectItem>\n                  <SelectItem value=\"low\">Low</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {filteredReports.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-400\">\n                No reports match your filters\n              </div>\n            ) : (\n              filteredReports.map(report => (\n                <div\n                  key={report.id}\n                  className=\"p-4 bg-gray-800/50 rounded-lg border border-gray-700 hover:border-gray-600 transition-colors cursor-pointer\"\n                  onClick={() => setSelectedReport(report)}\n                >\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className={`w-2 h-2 rounded-full ${getPriorityColor(report.priority)}`} />\n                        <Badge className={`${getStatusColor(report.status)} text-white`}>\n                          {report.status}\n                        </Badge>\n                        <Badge variant=\"secondary\">{report.type}</Badge>\n                        <Badge variant=\"secondary\">{report.reason}</Badge>\n                        <span className=\"text-xs text-gray-400\">\n                          {formatDistanceToNow(new Date(report.createdAt), { addSuffix: true })}\n                        </span>\n                      </div>\n\n                      <p className=\"text-sm text-gray-300 mb-2 line-clamp-2\">\n                        \"{report.contentPreview}\"\n                      </p>\n\n                      <div className=\"flex items-center gap-4 text-xs\">\n                        <div className=\"flex items-center gap-1\">\n                          <User className=\"w-3 h-3 text-gray-500\" />\n                          <span className=\"text-gray-400\">Reported user:</span>\n                          <span className=\"text-white\">{report.reportedUser.name}</span>\n                          {report.reportedUser.previousViolations > 0 && (\n                            <Badge className=\"bg-red-500/20 text-red-400 text-xs\">\n                              {report.reportedUser.previousViolations} previous\n                            </Badge>\n                          )}\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Flag className=\"w-3 h-3 text-gray-500\" />\n                          <span className=\"text-gray-400\">By:</span>\n                          <span className=\"text-white\">{report.reportedBy.name}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={(e: React.MouseEvent) => {\n                          e.stopPropagation();\n                          handleReportAction(report.id, 'dismissed');\n                        }}\n                      >\n                        <XCircle className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={(e: React.MouseEvent) => {\n                          e.stopPropagation();\n                          handleReportAction(report.id, 'content_removed');\n                        }}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        className=\"max-w-sm\"\n                        variant=\"outline\"\n                        onClick={(e: React.MouseEvent) => {\n                          e.stopPropagation();\n                          setSelectedReport(report);\n                        }}\n                      >\n                        <MoreHorizontal className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Trend Analysis */}\n      {stats && stats.topReportReasons.length > 0 && (\n        <Card className=\"bg-gray-900/50 border-gray-800\">\n          <CardHeader>\n            <CardTitle>Report Trends</CardTitle>\n            <CardDescription>Most common report reasons this week</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {stats.topReportReasons.map((item, index) => (\n                <div key={item.reason} className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl font-bold text-gray-500\">#{index + 1}</span>\n                    <span className=\"text-sm font-medium capitalize text-white\">\n                      {item.reason.replace('_', ' ')}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-sm text-gray-400\">{item.count} reports</span>\n                    <TrendingUp className=\"w-4 h-4 text-[var(--hive-brand-primary)]\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/realtime-performance-dashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'alert' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":70,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'quality' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":72,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport { \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Button,\n  Badge,\n  Progress,\n  Alert,\n  AlertDescription\n} from '@hive/ui';\nimport {\n  Activity,\n  Wifi,\n  AlertTriangle,\n  CheckCircle,\n  XCircle,\n  Zap,\n  Users,\n  MessageSquare,\n  Clock,\n  TrendingUp,\n  TrendingDown,\n  RefreshCw,\n  Settings\n} from 'lucide-react';\nimport { useRealtimePerformance } from '@/hooks/use-realtime-performance';\n\ninterface SystemMetrics {\n  totalConnections: number;\n  activeConnections: number;\n  messagesPerSecond: number;\n  averageLatency: number;\n  errorRate: number;\n  memoryUsage: number;\n  cpuUsage: number;\n  lastUpdated: number;\n}\n\ninterface PerformanceConfig {\n  enableAutoOptimization: boolean;\n  alertThresholds: {\n    maxLatency: number;\n    maxErrorRate: number;\n    maxMemoryUsage: number;\n    maxBandwidthUsage: number;\n  };\n}\n\nexport function RealtimePerformanceDashboard() {\n  const [systemMetrics, setSystemMetrics] = useState<SystemMetrics | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [config, setConfig] = useState<PerformanceConfig>({\n    enableAutoOptimization: true,\n    alertThresholds: {\n      maxLatency: 2000,\n      maxErrorRate: 0.05,\n      maxMemoryUsage: 100,\n      maxBandwidthUsage: 1000\n    }\n  });\n\n  const [performanceMetrics, connectionHealth, alerts, performanceActions] = useRealtimePerformance({\n    enableMetrics: true,\n    enableAlerts: true,\n    alertThresholds: config.alertThresholds,\n    onAlert: (alert) => {\n    },\n    onQualityChange: (quality) => {\n    }\n  });\n\n  // Fetch system metrics from the API\n  useEffect(() => {\n    fetchSystemMetrics();\n    const interval = setInterval(fetchSystemMetrics, 10000); // Update every 10 seconds\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetchSystemMetrics = async () => {\n    try {\n      setIsLoading(true);\n      const response = await fetch('/api/realtime/metrics?includeConnections=true');\n      if (response.ok) {\n        const data = await response.json();\n        setSystemMetrics(data.metrics.current);\n      }\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleOptimizationToggle = async () => {\n    try {\n      const response = await fetch('/api/realtime/metrics', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'update_config',\n          configuration: {\n            ...config,\n            enableAutoOptimization: !config.enableAutoOptimization\n          }\n        })\n      });\n\n      if (response.ok) {\n        setConfig(prev => ({\n          ...prev,\n          enableAutoOptimization: !prev.enableAutoOptimization\n        }));\n      }\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n  };\n\n  const handleForceHealthCheck = async () => {\n    try {\n      await fetch('/api/realtime/metrics', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ action: 'force_health_check' })\n      });\n      await fetchSystemMetrics();\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n  };\n\n  const getStatusColor = (quality: string) => {\n    switch (quality) {\n      case 'excellent': return 'text-green-500';\n      case 'good': return 'text-blue-500';\n      case 'poor': return 'text-yellow-500';\n      case 'critical': return 'text-red-500';\n      default: return 'text-gray-500';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'connected': return <CheckCircle className=\"h-5 w-5 text-green-500\" />;\n      case 'connecting': return <RefreshCw className=\"h-5 w-5 text-yellow-500 animate-spin\" />;\n      case 'disconnected': return <XCircle className=\"h-5 w-5 text-gray-500\" />;\n      case 'error': return <AlertTriangle className=\"h-5 w-5 text-red-500\" />;\n      default: return <Activity className=\"h-5 w-5 text-gray-500\" />;\n    }\n  };\n\n  const formatLatency = (latency: number) => {\n    return latency > 0 ? `${Math.round(latency)}ms` : 'N/A';\n  };\n\n  const formatBytes = (bytes: number) => {\n    if (bytes === 0) return '0 B';\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(1024));\n    return `${Math.round(bytes / Math.pow(1024, i) * 10) / 10} ${sizes[i]}`;\n  };\n\n  if (isLoading && !systemMetrics) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"flex items-center justify-center h-64\">\n          <RefreshCw className=\"h-8 w-8 animate-spin text-gray-500\" />\n          <span className=\"ml-2 text-gray-500\">Loading performance metrics...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-white\">Real-time Performance</h1>\n          <p className=\"text-gray-400\">Monitor and optimize real-time system performance</p>\n        </div>\n        \n        <div className=\"flex items-center space-x-3\">\n          <Button\n            onClick={handleForceHealthCheck}\n            variant=\"outline\"\n            className=\"max-w-sm\"\n          >\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Health Check\n          </Button>\n          \n          <Button\n            onClick={handleOptimizationToggle}\n            variant={config.enableAutoOptimization ? \"default\" : \"outline\"}\n            className=\"max-w-sm\"\n          >\n            <Settings className=\"h-4 w-4 mr-2\" />\n            Auto-Optimization {config.enableAutoOptimization ? 'ON' : 'OFF'}\n          </Button>\n        </div>\n      </div>\n\n      {/* Alerts */}\n      {alerts.length > 0 && (\n        <div className=\"space-y-2\">\n          {alerts.filter(alert => !alert.acknowledged).slice(0, 3).map((alert) => (\n            <Alert key={alert.id} variant={alert.severity === 'critical' ? 'destructive' : 'default'}>\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription className=\"flex items-center justify-between\">\n                <span>{alert.message}</span>\n                <Button\n                  onClick={() => performanceActions.acknowledgeAlert(alert.id)}\n                  className=\"max-w-sm\"\n                  variant=\"outline\"\n                >\n                  Acknowledge\n                </Button>\n              </AlertDescription>\n            </Alert>\n          ))}\n        </div>\n      )}\n\n      {/* System Overview */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        {/* Connection Status */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n              {getStatusIcon(connectionHealth.status)}\n              <span>Connection Status</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-gray-400\">Quality</span>\n                <Badge className={getStatusColor(connectionHealth.quality)}>\n                  {connectionHealth.quality.toUpperCase()}\n                </Badge>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-gray-400\">Uptime</span>\n                <span className=\"text-sm text-white\">\n                  {Math.round(connectionHealth.uptime / 1000 / 60)}m\n                </span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Active Connections */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n              <Users className=\"h-5 w-5 text-blue-500\" />\n              <span>Connections</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              <div className=\"text-2xl font-bold text-white\">\n                {systemMetrics?.activeConnections || 0}\n              </div>\n              <div className=\"text-sm text-gray-400\">\n                {systemMetrics?.totalConnections || 0} total\n              </div>\n              <Progress \n                value={(systemMetrics?.activeConnections || 0) / Math.max(systemMetrics?.totalConnections || 1, 1) * 100}\n                className=\"w-full h-2\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Message Throughput */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n              <MessageSquare className=\"h-5 w-5 text-green-500\" />\n              <span>Messages/sec</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              <div className=\"text-2xl font-bold text-white\">\n                {Math.round(systemMetrics?.messagesPerSecond || 0)}\n              </div>\n              <div className=\"flex items-center space-x-1 text-sm\">\n                <TrendingUp className=\"h-3 w-3 text-green-500\" />\n                <span className=\"text-gray-400\">Processing normally</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Latency */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center space-x-2 text-sm font-medium\">\n              <Clock className=\"h-5 w-5 text-yellow-500\" />\n              <span>Avg Latency</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              <div className=\"text-2xl font-bold text-white\">\n                {formatLatency(systemMetrics?.averageLatency || performanceMetrics.connectionLatency)}\n              </div>\n              <div className=\"flex items-center space-x-1 text-sm\">\n                {(systemMetrics?.averageLatency || performanceMetrics.connectionLatency) > config.alertThresholds.maxLatency ? (\n                  <>\n                    <TrendingDown className=\"h-3 w-3 text-red-500\" />\n                    <span className=\"text-red-400\">High latency</span>\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle className=\"h-3 w-3 text-green-500\" />\n                    <span className=\"text-gray-400\">Normal</span>\n                  </>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Detailed Performance Metrics */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Performance Breakdown */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Activity className=\"h-5 w-5 text-purple-500\" />\n              <span>Performance Metrics</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <div className=\"text-sm text-gray-400 mb-1\">Error Rate</div>\n                <div className=\"text-lg font-semibold text-white\">\n                  {((systemMetrics?.errorRate || 0) * 100).toFixed(2)}%\n                </div>\n                <Progress \n                  value={(systemMetrics?.errorRate || 0) / config.alertThresholds.maxErrorRate * 100}\n                  className=\"w-full h-1 mt-1\"\n                />\n              </div>\n              \n              <div>\n                <div className=\"text-sm text-gray-400 mb-1\">Memory Usage</div>\n                <div className=\"text-lg font-semibold text-white\">\n                  {Math.round(systemMetrics?.memoryUsage || performanceMetrics.memoryUsage)}MB\n                </div>\n                <Progress \n                  value={(systemMetrics?.memoryUsage || performanceMetrics.memoryUsage) / config.alertThresholds.maxMemoryUsage * 100}\n                  className=\"w-full h-1 mt-1\"\n                />\n              </div>\n              \n              <div>\n                <div className=\"text-sm text-gray-400 mb-1\">Bandwidth</div>\n                <div className=\"text-lg font-semibold text-white\">\n                  {formatBytes(performanceMetrics.bandwidthUsage)}/s\n                </div>\n                <Progress \n                  value={performanceMetrics.bandwidthUsage / config.alertThresholds.maxBandwidthUsage * 100}\n                  className=\"w-full h-1 mt-1\"\n                />\n              </div>\n              \n              <div>\n                <div className=\"text-sm text-gray-400 mb-1\">Messages</div>\n                <div className=\"text-lg font-semibold text-white\">\n                  {performanceMetrics.messagesReceived + performanceMetrics.messagesSent}\n                </div>\n                <div className=\"text-xs text-gray-500\">\n                  {performanceMetrics.messagesReceived} in, {performanceMetrics.messagesSent} out\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Connection Health */}\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Wifi className=\"h-5 w-5 text-blue-500\" />\n              <span>Connection Health</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Issues */}\n            <div>\n              <div className=\"text-sm font-medium text-white mb-2\">Current Issues</div>\n              {connectionHealth.issues.length === 0 ? (\n                <div className=\"flex items-center space-x-2 text-green-400\">\n                  <CheckCircle className=\"h-4 w-4\" />\n                  <span className=\"text-sm\">No issues detected</span>\n                </div>\n              ) : (\n                <div className=\"space-y-1\">\n                  {connectionHealth.issues.map((issue, index) => (\n                    <div key={index} className=\"flex items-center space-x-2 text-yellow-400\">\n                      <AlertTriangle className=\"h-4 w-4\" />\n                      <span className=\"text-sm\">{issue}</span>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {/* Recommendations */}\n            <div>\n              <div className=\"text-sm font-medium text-white mb-2\">Recommendations</div>\n              {connectionHealth.recommendations.length === 0 ? (\n                <div className=\"text-sm text-gray-400\">System operating optimally</div>\n              ) : (\n                <div className=\"space-y-1\">\n                  {connectionHealth.recommendations.slice(0, 3).map((rec, index) => (\n                    <div key={index} className=\"text-sm text-blue-400\">\n                      ‚Ä¢ {rec}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"flex space-x-2 pt-2\">\n              <Button\n                onClick={performanceActions.runSpeedTest}\n                className=\"max-w-sm\"\n                variant=\"outline\"\n              >\n                <Zap className=\"h-4 w-4 mr-1\" />\n                Speed Test\n              </Button>\n              \n              <Button\n                onClick={performanceActions.optimizeConnection}\n                className=\"max-w-sm\"\n                variant=\"outline\"\n              >\n                <Settings className=\"h-4 w-4 mr-1\" />\n                Optimize\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Recent Alerts History */}\n      {alerts.length > 0 && (\n        <Card className=\"bg-gray-900 border-gray-800\">\n          <CardHeader className=\"flex items-center justify-between\">\n            <CardTitle className=\"flex items-center space-x-2\">\n              <AlertTriangle className=\"h-5 w-5 text-yellow-500\" />\n              <span>Recent Alerts</span>\n            </CardTitle>\n            <Button\n              onClick={performanceActions.clearAlerts}\n              className=\"max-w-sm\"\n              variant=\"outline\"\n            >\n              Clear All\n            </Button>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              {alerts.slice(0, 5).map((alert) => (\n                <div key={alert.id} className=\"flex items-center justify-between p-2 rounded border border-gray-800\">\n                  <div className=\"flex items-center space-x-3\">\n                    <Badge \n                      variant={alert.severity === 'critical' ? 'destructive' : 'default'}\n                      className=\"text-xs\"\n                    >\n                      {alert.severity}\n                    </Badge>\n                    <span className=\"text-sm text-white\">{alert.message}</span>\n                    <span className=\"text-xs text-gray-400\">\n                      {new Date(alert.timestamp).toLocaleTimeString()}\n                    </span>\n                  </div>\n                  {!alert.acknowledged && (\n                    <Button\n                      onClick={() => performanceActions.acknowledgeAlert(alert.id)}\n                      className=\"max-w-sm text-xs\"\n                      variant=\"outline\"\n                      \n                    >\n                      Ack\n                    </Button>\n                  )}\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/ritual-management-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gift' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'format' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'differenceInHours' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'where' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onPause' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":1041,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":1041,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n/**\n * Ritual Management Panel for HIVE Admin\n *\n * Control center for campus-wide rituals and competitions.\n * Rituals are time-bound engagement campaigns that create shared experiences\n * and drive specific behaviors across the entire student body.\n *\n * @educational This implements the Observer pattern for real-time updates\n * and the State pattern for ritual lifecycle management. Each ritual can\n * transition through states: draft ‚Üí scheduled ‚Üí active ‚Üí completed.\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, Button, Badge } from '@hive/ui';\nimport {\n  Trophy,\n  Plus,\n  Calendar,\n  Users,\n  TrendingUp,\n  Clock,\n  Zap,\n  Target,\n  Gift,\n  Activity,\n  Pause,\n  Play,\n  StopCircle,\n  Edit,\n  Eye,\n  AlertCircle,\n  CheckCircle,\n  Sparkles,\n  Medal,\n  Crown,\n  Flame,\n  Star,\n  Heart,\n  Award,\n  Flag,\n  Rocket,\n  ChevronRight\n} from 'lucide-react';\nimport { format, formatDistanceToNow, addDays, differenceInHours } from 'date-fns';\nimport { useAuth } from '@hive/auth-logic';\nimport { useToast } from '@/hooks/use-toast';\nimport { db } from '@/lib/firebase';\nimport {\n  collection,\n  query,\n  where,\n  orderBy,\n  onSnapshot,\n  doc,\n  setDoc,\n  updateDoc,\n  serverTimestamp,\n  Timestamp\n} from 'firebase/firestore';\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Types\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nexport interface Ritual {\n  id: string;\n  title: string;\n  subtitle: string;\n  description: string;\n  type: 'competition' | 'collective' | 'challenge' | 'social' | 'academic';\n  status: 'draft' | 'scheduled' | 'active' | 'paused' | 'completed';\n\n  // Timing\n  startDate: Date;\n  endDate: Date;\n  duration: string; // '3_days' | '1_week' | '2_weeks' | 'weekend'\n\n  // Visual\n  icon: string;\n  color: string;\n  accentColor: string;\n  coverImage?: string;\n\n  // Mechanics\n  mechanics: {\n    scoringType: 'points' | 'percentage' | 'count' | 'milestone';\n    targetMetric: string; // 'posts', 'likes', 'shares', 'space_joins', etc.\n    targetValue: number;\n    currentValue: number;\n    allowTeams: boolean;\n    teamSize?: number;\n  };\n\n  // Rewards\n  rewards: {\n    type: 'feature_unlock' | 'badge' | 'points' | 'recognition' | 'prize';\n    description: string;\n    value?: string | number;\n    unlocksAt?: number; // Percentage of target\n  }[];\n\n  // Milestones\n  milestones: {\n    id: string;\n    name: string;\n    target: number;\n    reward: string;\n    achieved: boolean;\n    achievedAt?: Date;\n  }[];\n\n  // Participation\n  participation: {\n    total: number;\n    activeToday: number;\n    growth: number; // Percentage\n    topParticipants: {\n      id: string;\n      name: string;\n      score: number;\n      avatar?: string;\n    }[];\n  };\n\n  // Metadata\n  createdBy: string;\n  createdAt: Date;\n  updatedAt: Date;\n  launchedAt?: Date;\n  completedAt?: Date;\n\n  // Configuration\n  config: {\n    showInFeed: boolean;\n    showLeaderboard: boolean;\n    allowLateJoin: boolean;\n    notifyOnMilestones: boolean;\n    autoComplete: boolean;\n  };\n}\n\n// Preset ritual templates for quick creation\nconst RITUAL_TEMPLATES = [\n  {\n    id: 'space_race',\n    name: 'Space Race',\n    type: 'competition',\n    description: 'Spaces compete for the most active community',\n    icon: 'rocket',\n    color: '#8b5cf6',\n    duration: '1_week',\n    targetMetric: 'space_activity',\n    rewards: ['Top space gets featured placement', 'Custom space badge']\n  },\n  {\n    id: 'night_owl',\n    name: '3AM Ritual',\n    type: 'collective',\n    description: 'Unite night owls in late-night solidarity',\n    icon: 'moon',\n    color: '#1e40af',\n    duration: '3_days',\n    targetMetric: 'posts_after_midnight',\n    rewards: ['Unlock night mode theme', 'Night owl badge']\n  },\n  {\n    id: 'study_streak',\n    name: 'Study Streak Challenge',\n    type: 'challenge',\n    description: 'Maintain daily study group participation',\n    icon: 'flame',\n    color: '#dc2626',\n    duration: '2_weeks',\n    targetMetric: 'daily_study_posts',\n    rewards: ['Priority study room booking', 'Academic achievement badge']\n  },\n  {\n    id: 'campus_madness',\n    name: 'Campus Madness',\n    type: 'competition',\n    description: 'March Madness-style tournament for spaces',\n    icon: 'trophy',\n    color: '#f59e0b',\n    duration: '2_weeks',\n    targetMetric: 'bracket_votes',\n    rewards: ['Winning space becomes default for new users', 'Championship banner']\n  },\n  {\n    id: 'welcome_week',\n    name: 'Welcome Week',\n    type: 'social',\n    description: 'Help new students find their community',\n    icon: 'heart',\n    color: '#ec4899',\n    duration: '1_week',\n    targetMetric: 'welcomes_given',\n    rewards: ['Mentor badge', 'Early access to events']\n  }\n];\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Component\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nexport function RitualManagementPanel() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [rituals, setRituals] = useState<Ritual[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState<'active' | 'scheduled' | 'completed' | 'create'>('active');\n  const [selectedRitual, setSelectedRitual] = useState<Ritual | null>(null);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n\n  // Form state for new ritual\n  const [newRitual, setNewRitual] = useState<Partial<Ritual>>({\n    title: '',\n    subtitle: '',\n    description: '',\n    type: 'competition',\n    duration: '1_week',\n    icon: 'trophy',\n    color: '#f59e0b',\n    accentColor: '#d97706',\n    mechanics: {\n      scoringType: 'points',\n      targetMetric: 'posts',\n      targetValue: 1000,\n      currentValue: 0,\n      allowTeams: false\n    },\n    rewards: [],\n    milestones: [],\n    config: {\n      showInFeed: true,\n      showLeaderboard: true,\n      allowLateJoin: true,\n      notifyOnMilestones: true,\n      autoComplete: true\n    }\n  });\n\n  // Load rituals from Firebase\n  useEffect(() => {\n    if (!user) return;\n\n    const ritualsQuery = query(\n      collection(db, 'rituals'),\n      orderBy('createdAt', 'desc')\n    );\n\n    const unsubscribe = onSnapshot(ritualsQuery, (snapshot) => {\n      const loadedRituals: Ritual[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        loadedRituals.push({\n          id: doc.id,\n          ...data,\n          startDate: data.startDate?.toDate(),\n          endDate: data.endDate?.toDate(),\n          createdAt: data.createdAt?.toDate(),\n          updatedAt: data.updatedAt?.toDate(),\n          launchedAt: data.launchedAt?.toDate(),\n          completedAt: data.completedAt?.toDate(),\n        } as Ritual);\n      });\n      setRituals(loadedRituals);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, [user]);\n\n  // Create new ritual\n  const createRitual = useCallback(async () => {\n    if (!user || !newRitual.title) return;\n\n    try {\n      const ritualId = `ritual_${Date.now()}`;\n      const startDate = new Date();\n      const endDate = getEndDate(startDate, newRitual.duration || '1_week');\n\n      const ritualData = {\n        ...newRitual,\n        id: ritualId,\n        status: 'draft',\n        startDate: Timestamp.fromDate(startDate),\n        endDate: Timestamp.fromDate(endDate),\n        createdBy: user.email || user.id,\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp(),\n        participation: {\n          total: 0,\n          activeToday: 0,\n          growth: 0,\n          topParticipants: []\n        }\n      };\n\n      await setDoc(doc(db, 'rituals', ritualId), ritualData);\n\n      toast({\n        title: 'Ritual created',\n        description: `${newRitual.title} has been created successfully`,\n        type: 'success'\n      });\n\n      setShowCreateForm(false);\n      resetForm();\n    } catch (error) {\n      console.error('Failed to create ritual:', error);\n      toast({\n        title: 'Failed to create ritual',\n        type: 'error'\n      });\n    }\n  }, [newRitual, user, toast]);\n\n  // Launch ritual (activate it)\n  const launchRitual = useCallback(async (ritualId: string) => {\n    try {\n      await updateDoc(doc(db, 'rituals', ritualId), {\n        status: 'active',\n        launchedAt: serverTimestamp(),\n        updatedAt: serverTimestamp()\n      });\n\n      toast({\n        title: 'Ritual launched!',\n        description: 'The ritual is now active for all students',\n        type: 'success'\n      });\n    } catch (error) {\n      console.error('Failed to launch ritual:', error);\n      toast({\n        title: 'Failed to launch ritual',\n        type: 'error'\n      });\n    }\n  }, [toast]);\n\n  // Pause ritual\n  const pauseRitual = useCallback(async (ritualId: string) => {\n    try {\n      await updateDoc(doc(db, 'rituals', ritualId), {\n        status: 'paused',\n        updatedAt: serverTimestamp()\n      });\n\n      toast({\n        title: 'Ritual paused',\n        description: 'The ritual has been temporarily paused',\n        type: 'info'\n      });\n    } catch (error) {\n      console.error('Failed to pause ritual:', error);\n      toast({\n        title: 'Failed to pause ritual',\n        type: 'error'\n      });\n    }\n  }, [toast]);\n\n  // End ritual\n  const endRitual = useCallback(async (ritualId: string) => {\n    try {\n      await updateDoc(doc(db, 'rituals', ritualId), {\n        status: 'completed',\n        completedAt: serverTimestamp(),\n        updatedAt: serverTimestamp()\n      });\n\n      toast({\n        title: 'Ritual completed',\n        description: 'The ritual has been marked as completed',\n        type: 'success'\n      });\n    } catch (error) {\n      console.error('Failed to end ritual:', error);\n      toast({\n        title: 'Failed to end ritual',\n        type: 'error'\n      });\n    }\n  }, [toast]);\n\n  // Helper functions\n  const getEndDate = (start: Date, duration: string): Date => {\n    switch (duration) {\n      case '3_days': return addDays(start, 3);\n      case '1_week': return addDays(start, 7);\n      case '2_weeks': return addDays(start, 14);\n      case 'weekend': return addDays(start, 2);\n      default: return addDays(start, 7);\n    }\n  };\n\n  const resetForm = () => {\n    setNewRitual({\n      title: '',\n      subtitle: '',\n      description: '',\n      type: 'competition',\n      duration: '1_week',\n      icon: 'trophy',\n      color: '#f59e0b',\n      accentColor: '#d97706',\n      mechanics: {\n        scoringType: 'points',\n        targetMetric: 'posts',\n        targetValue: 1000,\n        currentValue: 0,\n        allowTeams: false\n      },\n      rewards: [],\n      milestones: [],\n      config: {\n        showInFeed: true,\n        showLeaderboard: true,\n        allowLateJoin: true,\n        notifyOnMilestones: true,\n        autoComplete: true\n      }\n    });\n  };\n\n  const applyTemplate = (template: typeof RITUAL_TEMPLATES[0]) => {\n    setNewRitual(prev => ({\n      ...prev,\n      title: template.name,\n      type: template.type as Ritual['type'],\n      description: template.description,\n      icon: template.icon,\n      color: template.color,\n      duration: template.duration as Ritual['duration'],\n      mechanics: {\n        ...prev.mechanics!,\n        targetMetric: template.targetMetric\n      }\n    }));\n  };\n\n  // Filter rituals by status\n  const activeRituals = rituals.filter(r => r.status === 'active' || r.status === 'paused');\n  const scheduledRituals = rituals.filter(r => r.status === 'scheduled' || r.status === 'draft');\n  const completedRituals = rituals.filter(r => r.status === 'completed');\n\n  if (loading) {\n    return (\n      <Card className=\"p-8\">\n        <div className=\"flex items-center justify-center\">\n          <Activity className=\"h-6 w-6 animate-spin mr-2\" />\n          Loading rituals...\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <Card className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <Trophy className=\"h-6 w-6 text-[var(--hive-brand-primary)]\" />\n            <div>\n              <h2 className=\"text-xl font-bold text-hive-text-primary\">Ritual Management</h2>\n              <p className=\"text-sm text-hive-text-secondary\">\n                Create and manage campus-wide engagement campaigns\n              </p>\n            </div>\n          </div>\n\n          <Button\n            onClick={() => {\n              setActiveTab('create');\n              setShowCreateForm(true);\n            }}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Create Ritual\n          </Button>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"flex items-center gap-3\">\n          {[\n            { id: 'active', label: 'Active', count: activeRituals.length, icon: Play },\n            { id: 'scheduled', label: 'Scheduled', count: scheduledRituals.length, icon: Calendar },\n            { id: 'completed', label: 'Completed', count: completedRituals.length, icon: CheckCircle },\n            { id: 'create', label: 'Templates', icon: Sparkles }\n          ].map((tab) => (\n            <Button\n              key={tab.id}\n              variant={activeTab === tab.id ? 'default' : 'ghost'}\n              onClick={() => setActiveTab(tab.id as any)}\n              className=\"flex items-center gap-2\"\n            >\n              <tab.icon className=\"h-4 w-4\" />\n              {tab.label}\n              {tab.count !== undefined && (\n                <Badge className=\"ml-1\">{tab.count}</Badge>\n              )}\n            </Button>\n          ))}\n        </div>\n      </Card>\n\n      {/* Active Rituals */}\n      {activeTab === 'active' && (\n        <div className=\"space-y-4\">\n          {activeRituals.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <Trophy className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-2\">\n                No Active Rituals\n              </h3>\n              <p className=\"text-hive-text-secondary mb-4\">\n                Launch a ritual to engage the campus community\n              </p>\n              <Button\n                onClick={() => {\n                  setActiveTab('create');\n                  setShowCreateForm(true);\n                }}\n                className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n              >\n                Create Your First Ritual\n              </Button>\n            </Card>\n          ) : (\n            activeRituals.map((ritual) => (\n              <RitualCard\n                key={ritual.id}\n                ritual={ritual}\n                onLaunch={launchRitual}\n                onPause={pauseRitual}\n                onEnd={endRitual}\n                onView={() => setSelectedRitual(ritual)}\n              />\n            ))\n          )}\n        </div>\n      )}\n\n      {/* Scheduled Rituals */}\n      {activeTab === 'scheduled' && (\n        <div className=\"space-y-4\">\n          {scheduledRituals.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <Calendar className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-2\">\n                No Scheduled Rituals\n              </h3>\n              <p className=\"text-hive-text-secondary\">\n                Create and schedule upcoming rituals\n              </p>\n            </Card>\n          ) : (\n            scheduledRituals.map((ritual) => (\n              <RitualCard\n                key={ritual.id}\n                ritual={ritual}\n                onLaunch={launchRitual}\n                onPause={pauseRitual}\n                onEnd={endRitual}\n                onView={() => setSelectedRitual(ritual)}\n              />\n            ))\n          )}\n        </div>\n      )}\n\n      {/* Completed Rituals */}\n      {activeTab === 'completed' && (\n        <div className=\"space-y-4\">\n          {completedRituals.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <CheckCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-2\">\n                No Completed Rituals\n              </h3>\n              <p className=\"text-hive-text-secondary\">\n                Completed rituals will appear here\n              </p>\n            </Card>\n          ) : (\n            completedRituals.map((ritual) => (\n              <RitualCard\n                key={ritual.id}\n                ritual={ritual}\n                onLaunch={launchRitual}\n                onPause={pauseRitual}\n                onEnd={endRitual}\n                onView={() => setSelectedRitual(ritual)}\n              />\n            ))\n          )}\n        </div>\n      )}\n\n      {/* Create/Templates Tab */}\n      {activeTab === 'create' && (\n        <div className=\"space-y-6\">\n          {/* Quick Templates */}\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold text-hive-text-primary mb-4\">\n              Quick Start Templates\n            </h3>\n            <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-4\">\n              {RITUAL_TEMPLATES.map((template) => (\n                <Card\n                  key={template.id}\n                  className=\"p-4 cursor-pointer hover:border-[var(--hive-brand-primary)] transition-colors\"\n                  onClick={() => applyTemplate(template)}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div\n                      className=\"w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0\"\n                      style={{ backgroundColor: `${template.color}20` }}\n                    >\n                      {getIcon(template.icon, template.color)}\n                    </div>\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-hive-text-primary mb-1\">\n                        {template.name}\n                      </h4>\n                      <p className=\"text-xs text-hive-text-secondary mb-2\">\n                        {template.description}\n                      </p>\n                      <Badge className=\"text-xs\">{template.duration.replace('_', ' ')}</Badge>\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          </Card>\n\n          {/* Create Form */}\n          {showCreateForm && (\n            <Card className=\"p-6\">\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-4\">\n                Create New Ritual\n              </h3>\n\n              <div className=\"space-y-4\">\n                {/* Basic Info */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Title\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={newRitual.title}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, title: (e.target as any).value })}\n                      className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                      placeholder=\"e.g., Spring Study Marathon\"\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Type\n                    </label>\n                    <select\n                      value={newRitual.type}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, type: (e.target as any).value as Ritual['type'] })}\n                      className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                    >\n                      <option value=\"competition\">Competition</option>\n                      <option value=\"collective\">Collective</option>\n                      <option value=\"challenge\">Challenge</option>\n                      <option value=\"social\">Social</option>\n                      <option value=\"academic\">Academic</option>\n                    </select>\n                  </div>\n                </div>\n\n                {/* Description */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                    Description\n                  </label>\n                  <textarea\n                    value={newRitual.description}\n                    onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, description: (e.target as any).value })}\n                    className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                    rows={3}\n                    placeholder=\"Describe what students will do and why they should participate...\"\n                  />\n                </div>\n\n                {/* Duration and Metrics */}\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Duration\n                    </label>\n                    <select\n                      value={newRitual.duration}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, duration: (e.target as any).value })}\n                      className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                    >\n                      <option value=\"3_days\">3 Days</option>\n                      <option value=\"1_week\">1 Week</option>\n                      <option value=\"2_weeks\">2 Weeks</option>\n                      <option value=\"weekend\">Weekend</option>\n                    </select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Target Metric\n                    </label>\n                    <select\n                      value={newRitual.mechanics?.targetMetric}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({\n                        ...newRitual,\n                        mechanics: { ...newRitual.mechanics!, targetMetric: (e.target as any).value }\n                      })}\n                      className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                    >\n                      <option value=\"posts\">Posts Created</option>\n                      <option value=\"likes\">Likes Given</option>\n                      <option value=\"shares\">Content Shared</option>\n                      <option value=\"space_joins\">Spaces Joined</option>\n                      <option value=\"study_hours\">Study Hours</option>\n                      <option value=\"welcomes_given\">Welcomes Given</option>\n                    </select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Target Value\n                    </label>\n                    <input\n                      type=\"number\"\n                      value={newRitual.mechanics?.targetValue}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({\n                        ...newRitual,\n                        mechanics: { ...newRitual.mechanics!, targetValue: parseInt((e.target as any).value) }\n                      })}\n                      className=\"w-full px-3 py-2 bg-hive-background border border-hive-border rounded-lg\"\n                      placeholder=\"1000\"\n                    />\n                  </div>\n                </div>\n\n                {/* Visual Customization */}\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Icon\n                    </label>\n                    <div className=\"flex gap-2\">\n                      {['trophy', 'flame', 'star', 'heart', 'rocket'].map((icon) => (\n                        <button\n                          key={icon}\n                          onClick={() => setNewRitual({ ...newRitual, icon })}\n                          className={`p-2 rounded-lg border ${\n                            newRitual.icon === icon\n                              ? 'border-[var(--hive-brand-primary)] bg-[var(--hive-brand-primary)]/20'\n                              : 'border-hive-border'\n                          }`}\n                        >\n                          {getIcon(icon)}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Primary Color\n                    </label>\n                    <input\n                      type=\"color\"\n                      value={newRitual.color}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, color: (e.target as any).value })}\n                      className=\"w-full h-10 rounded-lg cursor-pointer\"\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-primary mb-2\">\n                      Accent Color\n                    </label>\n                    <input\n                      type=\"color\"\n                      value={newRitual.accentColor}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({ ...newRitual, accentColor: (e.target as any).value })}\n                      className=\"w-full h-10 rounded-lg cursor-pointer\"\n                    />\n                  </div>\n                </div>\n\n                {/* Configuration Options */}\n                <div className=\"space-y-3\">\n                  <label className=\"flex items-center gap-3\">\n                    <input\n                      type=\"checkbox\"\n                      checked={newRitual.config?.showInFeed}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({\n                        ...newRitual,\n                        config: { ...newRitual.config!, showInFeed: e.target.checked }\n                      })}\n                      className=\"w-4 h-4 rounded\"\n                    />\n                    <span className=\"text-sm text-hive-text-primary\">Show in feed</span>\n                  </label>\n\n                  <label className=\"flex items-center gap-3\">\n                    <input\n                      type=\"checkbox\"\n                      checked={newRitual.config?.showLeaderboard}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({\n                        ...newRitual,\n                        config: { ...newRitual.config!, showLeaderboard: e.target.checked }\n                      })}\n                      className=\"w-4 h-4 rounded\"\n                    />\n                    <span className=\"text-sm text-hive-text-primary\">Show leaderboard</span>\n                  </label>\n\n                  <label className=\"flex items-center gap-3\">\n                    <input\n                      type=\"checkbox\"\n                      checked={newRitual.config?.allowLateJoin}\n                      onChange={(e: React.ChangeEvent) => setNewRitual({\n                        ...newRitual,\n                        config: { ...newRitual.config!, allowLateJoin: e.target.checked }\n                      })}\n                      className=\"w-4 h-4 rounded\"\n                    />\n                    <span className=\"text-sm text-hive-text-primary\">Allow late joining</span>\n                  </label>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex justify-end gap-3\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => {\n                      setShowCreateForm(false);\n                      resetForm();\n                    }}\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    onClick={createRitual}\n                    disabled={!newRitual.title || !newRitual.description}\n                    className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n                  >\n                    Create Ritual\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          )}\n        </div>\n      )}\n\n      {/* Ritual Detail Modal */}\n      {selectedRitual && (\n        <RitualDetailModal\n          ritual={selectedRitual}\n          onClose={() => setSelectedRitual(null)}\n          onLaunch={launchRitual}\n          onPause={pauseRitual}\n          onEnd={endRitual}\n        />\n      )}\n    </div>\n  );\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Sub-components\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nfunction RitualCard({\n  ritual,\n  onLaunch,\n  onPause,\n  onEnd,\n  onView\n}: {\n  ritual: Ritual;\n  onLaunch: (id: string) => void;\n  onPause: (id: string) => void;\n  onEnd: (id: string) => void;\n  onView: () => void;\n}) {\n  const progress = ritual.mechanics.targetValue > 0\n    ? Math.round((ritual.mechanics.currentValue / ritual.mechanics.targetValue) * 100)\n    : 0;\n\n  const timeRemaining = ritual.endDate\n    ? formatDistanceToNow(ritual.endDate, { addSuffix: true })\n    : null;\n\n  return (\n    <Card className=\"p-6\">\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-start gap-4 flex-1\">\n          <div\n            className=\"w-14 h-14 rounded-lg flex items-center justify-center flex-shrink-0\"\n            style={{ backgroundColor: `${ritual.color}20` }}\n          >\n            {getIcon(ritual.icon, ritual.color)}\n          </div>\n\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-3 mb-2\">\n              <h3 className=\"text-lg font-semibold text-hive-text-primary\">\n                {ritual.title}\n              </h3>\n              <StatusBadge status={ritual.status} />\n              <Badge variant=\"secondary\">{ritual.type}</Badge>\n            </div>\n\n            <p className=\"text-sm text-hive-text-secondary mb-4\">\n              {ritual.description}\n            </p>\n\n            {/* Progress Bar */}\n            {ritual.status === 'active' && (\n              <div className=\"mb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-hive-text-secondary\">\n                    Progress: {ritual.mechanics.currentValue} / {ritual.mechanics.targetValue}\n                  </span>\n                  <span className=\"text-sm font-medium text-[var(--hive-brand-primary)]\">\n                    {progress}%\n                  </span>\n                </div>\n                <div className=\"h-2 bg-hive-background rounded-full overflow-hidden\">\n                  <div\n                    className=\"h-full bg-gradient-to-r from-hive-gold to-hive-champagne transition-all duration-500\"\n                    style={{ width: `${progress}%` }}\n                  />\n                </div>\n              </div>\n            )}\n\n            {/* Metrics */}\n            <div className=\"flex items-center gap-6 text-sm\">\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"h-4 w-4 text-hive-text-secondary\" />\n                <span className=\"text-hive-text-secondary\">\n                  {ritual.participation.total} participants\n                </span>\n              </div>\n              {ritual.participation.growth > 0 && (\n                <div className=\"flex items-center gap-2\">\n                  <TrendingUp className=\"h-4 w-4 text-green-400\" />\n                  <span className=\"text-green-400\">\n                    +{ritual.participation.growth}% today\n                  </span>\n                </div>\n              )}\n              {timeRemaining && ritual.status === 'active' && (\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"h-4 w-4 text-hive-text-secondary\" />\n                  <span className=\"text-hive-text-secondary\">\n                    Ends {timeRemaining}\n                  </span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            className=\"max-w-sm\"\n            onClick={onView}\n          >\n            <Eye className=\"h-4 w-4\" />\n          </Button>\n\n          {ritual.status === 'draft' && (\n            <Button\n              variant=\"default\"\n              className=\"max-w-sm bg-green-500 hover:bg-green-600\"\n              onClick={() => onLaunch(ritual.id)}\n            >\n              <Play className=\"h-4 w-4 mr-2\" />\n              Launch\n            </Button>\n          )}\n\n          {ritual.status === 'active' && (\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => onPause(ritual.id)}\n            >\n              <Pause className=\"h-4 w-4 mr-2\" />\n              Pause\n            </Button>\n          )}\n\n          {ritual.status === 'paused' && (\n            <Button\n              variant=\"default\"\n              className=\"max-w-sm bg-green-500 hover:bg-green-600\"\n              onClick={() => onLaunch(ritual.id)}\n            >\n              <Play className=\"h-4 w-4 mr-2\" />\n              Resume\n            </Button>\n          )}\n\n          {(ritual.status === 'active' || ritual.status === 'paused') && (\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm text-red-400 hover:text-red-500\"\n              onClick={() => onEnd(ritual.id)}\n            >\n              <StopCircle className=\"h-4 w-4 mr-2\" />\n              End\n            </Button>\n          )}\n        </div>\n      </div>\n    </Card>\n  );\n}\n\nfunction RitualDetailModal({\n  ritual,\n  onClose,\n  onLaunch,\n  onPause,\n  onEnd\n}: {\n  ritual: Ritual;\n  onClose: () => void;\n  onLaunch: (id: string) => void;\n  onPause: (id: string) => void;\n  onEnd: (id: string) => void;\n}) {\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6 border-b border-hive-border\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div\n                className=\"w-12 h-12 rounded-lg flex items-center justify-center\"\n                style={{ backgroundColor: `${ritual.color}20` }}\n              >\n                {getIcon(ritual.icon, ritual.color)}\n              </div>\n              <div>\n                <h2 className=\"text-xl font-bold text-hive-text-primary\">\n                  {ritual.title}\n                </h2>\n                <p className=\"text-sm text-hive-text-secondary\">\n                  {ritual.subtitle}\n                </p>\n              </div>\n            </div>\n\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-hive-background-overlay rounded-lg transition-colors\"\n            >\n              ‚úï\n            </button>\n          </div>\n        </div>\n\n        <div className=\"p-6 space-y-6\">\n          {/* Participation Stats */}\n          <div className=\"grid grid-cols-4 gap-4\">\n            <Card className=\"p-4 text-center\">\n              <Users className=\"h-6 w-6 text-blue-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-hive-text-primary\">\n                {ritual.participation.total}\n              </div>\n              <div className=\"text-xs text-hive-text-secondary\">Total Participants</div>\n            </Card>\n\n            <Card className=\"p-4 text-center\">\n              <Activity className=\"h-6 w-6 text-green-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-hive-text-primary\">\n                {ritual.participation.activeToday}\n              </div>\n              <div className=\"text-xs text-hive-text-secondary\">Active Today</div>\n            </Card>\n\n            <Card className=\"p-4 text-center\">\n              <TrendingUp className=\"h-6 w-6 text-purple-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-hive-text-primary\">\n                +{ritual.participation.growth}%\n              </div>\n              <div className=\"text-xs text-hive-text-secondary\">Growth Rate</div>\n            </Card>\n\n            <Card className=\"p-4 text-center\">\n              <Target className=\"h-6 w-6 text-orange-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-hive-text-primary\">\n                {Math.round((ritual.mechanics.currentValue / ritual.mechanics.targetValue) * 100)}%\n              </div>\n              <div className=\"text-xs text-hive-text-secondary\">Completion</div>\n            </Card>\n          </div>\n\n          {/* Leaderboard */}\n          {ritual.participation.topParticipants.length > 0 && (\n            <Card className=\"p-6\">\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-4\">\n                Top Participants\n              </h3>\n              <div className=\"space-y-3\">\n                {ritual.participation.topParticipants.map((participant, index) => (\n                  <div key={participant.id} className=\"flex items-center justify-between p-3 bg-hive-background-overlay rounded-lg\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${\n                        index === 0 ? 'bg-yellow-500 text-black' :\n                        index === 1 ? 'bg-gray-400 text-black' :\n                        index === 2 ? 'bg-orange-600 text-white' :\n                        'bg-hive-surface text-hive-text-primary'\n                      }`}>\n                        {index + 1}\n                      </div>\n                      <span className=\"font-medium text-hive-text-primary\">\n                        {participant.name}\n                      </span>\n                    </div>\n                    <span className=\"font-bold text-[var(--hive-brand-primary)]\">\n                      {participant.score} pts\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </Card>\n          )}\n\n          {/* Milestones */}\n          {ritual.milestones.length > 0 && (\n            <Card className=\"p-6\">\n              <h3 className=\"text-lg font-semibold text-hive-text-primary mb-4\">\n                Milestones\n              </h3>\n              <div className=\"space-y-3\">\n                {ritual.milestones.map((milestone) => (\n                  <div\n                    key={milestone.id}\n                    className={`flex items-center justify-between p-3 rounded-lg ${\n                      milestone.achieved\n                        ? 'bg-green-500/10 border border-green-500/30'\n                        : 'bg-hive-background-overlay'\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {milestone.achieved ? (\n                        <CheckCircle className=\"h-5 w-5 text-green-400\" />\n                      ) : (\n                        <Target className=\"h-5 w-5 text-gray-400\" />\n                      )}\n                      <div>\n                        <p className=\"font-medium text-hive-text-primary\">\n                          {milestone.name}\n                        </p>\n                        <p className=\"text-xs text-hive-text-secondary\">\n                          Target: {milestone.target} ‚Ä¢ Reward: {milestone.reward}\n                        </p>\n                      </div>\n                    </div>\n                    {milestone.achievedAt && (\n                      <span className=\"text-xs text-green-400\">\n                        Achieved {formatDistanceToNow(milestone.achievedAt, { addSuffix: true })}\n                      </span>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </Card>\n          )}\n\n          {/* Actions */}\n          <div className=\"flex justify-end gap-3\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n            >\n              Close\n            </Button>\n\n            {ritual.status === 'draft' && (\n              <Button\n                onClick={() => {\n                  onLaunch(ritual.id);\n                  onClose();\n                }}\n                className=\"bg-green-500 hover:bg-green-600\"\n              >\n                <Play className=\"h-4 w-4 mr-2\" />\n                Launch Ritual\n              </Button>\n            )}\n\n            {ritual.status === 'active' && (\n              <Button\n                onClick={() => {\n                  onEnd(ritual.id);\n                  onClose();\n                }}\n                className=\"bg-red-500 hover:bg-red-600\"\n              >\n                <StopCircle className=\"h-4 w-4 mr-2\" />\n                End Ritual\n              </Button>\n            )}\n          </div>\n        </div>\n      </Card>\n    </div>\n  );\n}\n\nfunction StatusBadge({ status }: { status: Ritual['status'] }) {\n  const config = {\n    draft: { color: 'bg-gray-500/20 text-gray-400', icon: Edit },\n    scheduled: { color: 'bg-blue-500/20 text-blue-400', icon: Calendar },\n    active: { color: 'bg-green-500/20 text-green-400', icon: Play },\n    paused: { color: 'bg-orange-500/20 text-orange-400', icon: Pause },\n    completed: { color: 'bg-purple-500/20 text-purple-400', icon: CheckCircle }\n  };\n\n  const { color, icon: Icon } = config[status];\n\n  return (\n    <Badge className={`${color} flex items-center gap-1`}>\n      <Icon className=\"h-3 w-3\" />\n      {status}\n    </Badge>\n  );\n}\n\nfunction getIcon(iconName: string, color?: string) {\n  const iconProps = { className: \"h-6 w-6\", style: color ? { color } : {} };\n\n  switch (iconName) {\n    case 'trophy': return <Trophy {...iconProps} />;\n    case 'flame': return <Flame {...iconProps} />;\n    case 'star': return <Star {...iconProps} />;\n    case 'heart': return <Heart {...iconProps} />;\n    case 'rocket': return <Rocket {...iconProps} />;\n    case 'medal': return <Medal {...iconProps} />;\n    case 'crown': return <Crown {...iconProps} />;\n    case 'flag': return <Flag {...iconProps} />;\n    case 'award': return <Award {...iconProps} />;\n    case 'zap': return <Zap {...iconProps} />;\n    default: return <Trophy {...iconProps} />;\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/admin/space-creation-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'collection' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'addDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'categoryConfig' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":238,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":238,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from 'react';\nimport {\n  Plus,\n  Building2,\n  Users,\n  Home,\n  GraduationCap,\n  Lock,\n  Globe,\n  Eye,\n  EyeOff,\n  Settings,\n  AlertCircle,\n  CheckCircle,\n  Upload,\n  Link\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Input,\n  Label,\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n  Switch,\n  Alert,\n  AlertDescription,\n  Textarea\n} from '@hive/ui';\nimport { useAuth } from '@hive/auth-logic';\nimport { db } from '@hive/core';\nimport { collection, addDoc, serverTimestamp, doc, setDoc } from 'firebase/firestore';\nimport type { SpaceType } from '@/lib/space-type-rules';\nimport { api } from '@/lib/api-client';\n\ninterface SpaceCreationFormData {\n  // Basic Information\n  name: string;\n  handle: string; // URL-friendly identifier\n  description: string;\n  category: SpaceType;\n  avatar?: string;\n  coverImage?: string;\n\n  // Access Control\n  visibility: 'public' | 'campus_only' | 'invite_only';\n  joinMethod: 'instant' | 'approval' | 'invitation_only';\n  membershipLimit?: number;\n\n  // Leadership\n  leaderId?: string;\n  leaderEmail?: string;\n  coLeaders?: string[];\n\n  // Category-Specific Fields\n  // For University Orgs\n  departmentId?: string;\n  courseNumber?: string;\n  facultyAdvisor?: string;\n\n  // For Residential\n  buildingName?: string;\n  floorNumber?: string;\n\n  // For Greek Life\n  chapterName?: string;\n  nationalOrg?: string;\n  foundedYear?: number;\n\n  // For Student Orgs\n  organizationType?: 'academic' | 'cultural' | 'hobby' | 'professional' | 'service';\n  fundingStatus?: 'funded' | 'unfunded' | 'pending';\n\n  // Integration Settings\n  enableRssFeed?: boolean;\n  rssUrl?: string;\n  enableCalendarSync?: boolean;\n  calendarUrl?: string;\n  externalWebsite?: string;\n\n  // Initial Tools\n  defaultTools?: string[];\n}\n\nconst CATEGORY_CONFIGS = {\n  student_organizations: {\n    icon: Users,\n    fields: ['organizationType', 'fundingStatus', 'externalWebsite'],\n    defaultTools: ['event_coordination', 'member_onboarding', 'project_management']\n  },\n  university_organizations: {\n    icon: GraduationCap,\n    fields: ['departmentId', 'courseNumber', 'facultyAdvisor'],\n    defaultTools: ['administrative', 'resource_allocation', 'student_services']\n  },\n  residential_spaces: {\n    icon: Home,\n    fields: ['buildingName', 'floorNumber'],\n    defaultTools: ['resource_booking', 'issue_reporting', 'community_guidelines']\n  },\n  greek_life_spaces: {\n    icon: Building2,\n    fields: ['chapterName', 'nationalOrg', 'foundedYear'],\n    defaultTools: ['rush_management', 'social_planning', 'alumni_network']\n  }\n};\n\nexport function SpaceCreationPanel() {\n  const { user } = useAuth();\n  const [formData, setFormData] = useState<Partial<SpaceCreationFormData>>({\n    category: 'student_organizations',\n    visibility: 'campus_only',\n    joinMethod: 'approval',\n    enableRssFeed: false,\n    enableCalendarSync: false\n  });\n  const [creating, setCreating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  // Check if user is admin\n  const isAdmin = user?.customClaims?.role === 'admin' || user?.customClaims?.isHiveAdmin;\n\n  if (!isAdmin) {\n    return (\n      <Alert className=\"bg-red-900/20 border-red-600\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertDescription className=\"text-red-400\">\n          You do not have permission to create spaces. Only HIVE admins can create new spaces.\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  const handleCreateSpace = async () => {\n    setError(null);\n    setCreating(true);\n\n    try {\n      // Validate required fields\n      if (!formData.name || !formData.handle || !formData.description) {\n        throw new Error('Please fill in all required fields');\n      }\n\n      // Check handle uniqueness\n      const handleResult = await api.spaces.checkHandle<{ available: boolean }>(formData.handle);\n      if (!handleResult.available) {\n        throw new Error('This handle is already taken');\n      }\n\n      // Create the space document\n      const spaceData = {\n        ...formData,\n        id: `space_${formData.handle}`,\n        campusId: 'ub-buffalo', // Hard-coded for vBETA\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp(),\n        createdBy: user?.id,\n        memberCount: 0,\n        postCount: 0,\n        isActive: true,\n        isVerified: true, // Admin-created spaces are auto-verified\n        settings: {\n          allowMemberPosts: true,\n          requirePostApproval: false,\n          allowEvents: true,\n          allowTools: true,\n          maxToolCount: CATEGORY_CONFIGS[formData.category as SpaceType].defaultTools.length * 2\n        },\n        metadata: {\n          creationMethod: 'admin_panel',\n          creatorRole: 'hive_admin'\n        }\n      };\n\n      // Create in Firestore\n      const spaceRef = doc(db, 'spaces', spaceData.id);\n      await setDoc(spaceRef, spaceData);\n\n      // Create initial subcollections\n      await Promise.all([\n        // Members collection with creator as owner\n        setDoc(doc(db, 'spaces', spaceData.id, 'members', user!.id), {\n          userId: user!.id,\n          role: 'owner',\n          joinedAt: serverTimestamp(),\n          addedBy: 'system'\n        }),\n\n        // Settings document\n        setDoc(doc(db, 'spaces', spaceData.id, 'settings', 'main'), {\n          ...spaceData.settings,\n          updatedAt: serverTimestamp()\n        })\n      ]);\n\n      // Install default tools for the category\n      const defaultTools = CATEGORY_CONFIGS[formData.category as SpaceType].defaultTools;\n      if (defaultTools.length > 0) {\n        await api.spaces.installDefaultTools(spaceData.id, defaultTools);\n      }\n\n      // If RSS feed is enabled, set it up\n      if (formData.enableRssFeed && formData.rssUrl) {\n        await api.spaces.setupRssFeed(spaceData.id, formData.rssUrl);\n      }\n\n      setSuccess(true);\n\n      // Reset form after 3 seconds\n      setTimeout(() => {\n        setFormData({\n          category: 'student_organizations',\n          visibility: 'campus_only',\n          joinMethod: 'approval',\n          enableRssFeed: false,\n          enableCalendarSync: false\n        });\n        setSuccess(false);\n      }, 3000);\n\n    } catch (err: any) {\n      setError(err.message || 'Failed to create space');\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  const updateFormData = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const categoryConfig = CATEGORY_CONFIGS[formData.category as SpaceType];\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"bg-gray-900/50 border-gray-800\">\n        <div className=\"p-6\">\n          <div className=\"flex items-center gap-3 mb-6\">\n            <div className=\"w-10 h-10 bg-[var(--hive-brand-primary)]/20 rounded-lg flex items-center justify-center\">\n              <Plus className=\"w-6 h-6 text-[var(--hive-brand-primary)]\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-semibold text-white\">Create New Space</h2>\n              <p className=\"text-sm text-gray-400\">Admin-only space creation panel</p>\n            </div>\n          </div>\n\n          {success && (\n            <Alert className=\"mb-6 bg-green-900/20 border-green-600\">\n              <CheckCircle className=\"h-4 w-4\" />\n              <AlertDescription className=\"text-green-400\">\n                Space created successfully! It's now live and discoverable.\n              </AlertDescription>\n            </Alert>\n          )}\n\n          {error && (\n            <Alert className=\"mb-6 bg-red-900/20 border-red-600\">\n              <AlertCircle className=\"h-4 w-4\" />\n              <AlertDescription className=\"text-red-400\">{error}</AlertDescription>\n            </Alert>\n          )}\n\n          <div className=\"space-y-6\">\n            {/* Category Selection */}\n            <div>\n              <Label className=\"text-white mb-2\">Space Category *</Label>\n              <div className=\"grid grid-cols-2 gap-3\">\n                {Object.entries(CATEGORY_CONFIGS).map(([key, config]) => {\n                  const Icon = config.icon;\n                  return (\n                    <button\n                      key={key}\n                      onClick={() => updateFormData('category', key)}\n                      className={`\n                        p-4 rounded-lg border-2 transition-all\n                        ${formData.category === key\n                          ? 'bg-[var(--hive-brand-primary)]/20 border-[var(--hive-brand-primary)]'\n                          : 'bg-gray-800/50 border-gray-700 hover:bg-gray-800'\n                        }\n                      `}\n                    >\n                      <Icon className=\"w-6 h-6 text-[var(--hive-brand-primary)] mb-2\" />\n                      <div className=\"text-sm font-medium text-white\">\n                        {key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n                      </div>\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Basic Information */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label htmlFor=\"name\" className=\"text-white\">Space Name *</Label>\n                <Input\n                  id=\"name\"\n                  value={formData.name || ''}\n                  onChange={(e: React.ChangeEvent) => updateFormData('name', (e.target as any).value)}\n                  placeholder=\"e.g., Computer Science Club\"\n                  className=\"bg-gray-800 border-gray-700 text-white\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"handle\" className=\"text-white\">URL Handle *</Label>\n                <Input\n                  id=\"handle\"\n                  value={formData.handle || ''}\n                  onChange={(e: React.ChangeEvent) => updateFormData('handle', (e.target as any).value.toLowerCase().replace(/\\s+/g, '-'))}\n                  placeholder=\"e.g., cs-club\"\n                  className=\"bg-gray-800 border-gray-700 text-white\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Space URL: /spaces/{formData.handle || 'handle'}\n                </p>\n              </div>\n            </div>\n\n            <div>\n              <Label htmlFor=\"description\" className=\"text-white\">Description *</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description || ''}\n                onChange={(e: React.ChangeEvent) => updateFormData('description', (e.target as any).value)}\n                placeholder=\"Describe what this space is about...\"\n                className=\"bg-gray-800 border-gray-700 text-white min-h-[100px]\"\n              />\n            </div>\n\n            {/* Category-Specific Fields */}\n            {formData.category === 'student_organizations' && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Organization Type</Label>\n                  <Select\n                    value={formData.organizationType}\n                    onValueChange={(value) => updateFormData('organizationType', value)}\n                  >\n                    <SelectTrigger className=\"bg-gray-800 border-gray-700 text-white\">\n                      <SelectValue placeholder=\"Select type\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"academic\">Academic</SelectItem>\n                      <SelectItem value=\"cultural\">Cultural</SelectItem>\n                      <SelectItem value=\"hobby\">Hobby/Interest</SelectItem>\n                      <SelectItem value=\"professional\">Professional</SelectItem>\n                      <SelectItem value=\"service\">Service</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label className=\"text-white\">Funding Status</Label>\n                  <Select\n                    value={formData.fundingStatus}\n                    onValueChange={(value) => updateFormData('fundingStatus', value)}\n                  >\n                    <SelectTrigger className=\"bg-gray-800 border-gray-700 text-white\">\n                      <SelectValue placeholder=\"Select status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"funded\">SA Funded</SelectItem>\n                      <SelectItem value=\"unfunded\">Unfunded</SelectItem>\n                      <SelectItem value=\"pending\">Pending</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            )}\n\n            {formData.category === 'university_organizations' && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Department</Label>\n                  <Input\n                    value={formData.departmentId || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('departmentId', (e.target as any).value)}\n                    placeholder=\"e.g., Computer Science\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n\n                <div>\n                  <Label className=\"text-white\">Course Number</Label>\n                  <Input\n                    value={formData.courseNumber || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('courseNumber', (e.target as any).value)}\n                    placeholder=\"e.g., CSE 442\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {formData.category === 'residential_spaces' && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Building Name *</Label>\n                  <Input\n                    value={formData.buildingName || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('buildingName', (e.target as any).value)}\n                    placeholder=\"e.g., Ellicott Complex\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n\n                <div>\n                  <Label className=\"text-white\">Floor/Section</Label>\n                  <Input\n                    value={formData.floorNumber || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('floorNumber', (e.target as any).value)}\n                    placeholder=\"e.g., 3rd Floor\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {formData.category === 'greek_life_spaces' && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Chapter Name *</Label>\n                  <Input\n                    value={formData.chapterName || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('chapterName', (e.target as any).value)}\n                    placeholder=\"e.g., Alpha Phi\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n\n                <div>\n                  <Label className=\"text-white\">National Organization</Label>\n                  <Input\n                    value={formData.nationalOrg || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('nationalOrg', (e.target as any).value)}\n                    placeholder=\"e.g., Alpha Phi International\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {/* Access Control */}\n            <div className=\"space-y-4 p-4 bg-gray-800/30 rounded-lg\">\n              <h3 className=\"text-lg font-medium text-white mb-3\">Access Control</h3>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Visibility</Label>\n                  <Select\n                    value={formData.visibility}\n                    onValueChange={(value) => updateFormData('visibility', value as any)}\n                  >\n                    <SelectTrigger className=\"bg-gray-800 border-gray-700 text-white\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"public\">\n                        <div className=\"flex items-center gap-2\">\n                          <Globe className=\"w-4 h-4\" />\n                          <span>Public</span>\n                        </div>\n                      </SelectItem>\n                      <SelectItem value=\"campus_only\">\n                        <div className=\"flex items-center gap-2\">\n                          <Building2 className=\"w-4 h-4\" />\n                          <span>Campus Only</span>\n                        </div>\n                      </SelectItem>\n                      <SelectItem value=\"invite_only\">\n                        <div className=\"flex items-center gap-2\">\n                          <Lock className=\"w-4 h-4\" />\n                          <span>Invite Only</span>\n                        </div>\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label className=\"text-white\">Join Method</Label>\n                  <Select\n                    value={formData.joinMethod}\n                    onValueChange={(value) => updateFormData('joinMethod', value as any)}\n                  >\n                    <SelectTrigger className=\"bg-gray-800 border-gray-700 text-white\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"instant\">Instant Join</SelectItem>\n                      <SelectItem value=\"approval\">Requires Approval</SelectItem>\n                      <SelectItem value=\"invitation_only\">Invitation Only</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </div>\n\n            {/* Integration Settings */}\n            <div className=\"space-y-4 p-4 bg-gray-800/30 rounded-lg\">\n              <h3 className=\"text-lg font-medium text-white mb-3\">Integrations</h3>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label className=\"text-white\">RSS Feed Integration</Label>\n                    <p className=\"text-xs text-gray-400\">Auto-import events and announcements</p>\n                  </div>\n                  <Switch\n                    checked={formData.enableRssFeed}\n                    onCheckedChange={(checked) => updateFormData('enableRssFeed', checked)}\n                  />\n                </div>\n\n                {formData.enableRssFeed && (\n                  <Input\n                    value={formData.rssUrl || ''}\n                    onChange={(e: React.ChangeEvent) => updateFormData('rssUrl', (e.target as any).value)}\n                    placeholder=\"RSS feed URL\"\n                    className=\"bg-gray-800 border-gray-700 text-white\"\n                  />\n                )}\n\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label className=\"text-white\">Calendar Sync</Label>\n                    <p className=\"text-xs text-gray-400\">Sync with external calendar</p>\n                  </div>\n                  <Switch\n                    checked={formData.enableCalendarSync}\n                    onCheckedChange={(checked) => updateFormData('enableCalendarSync', checked)}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Create Button */}\n            <div className=\"flex justify-end gap-3\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setFormData({\n                  category: 'student_organizations',\n                  visibility: 'campus_only',\n                  joinMethod: 'approval',\n                  enableRssFeed: false,\n                  enableCalendarSync: false\n                })}\n                disabled={creating}\n              >\n                Reset Form\n              </Button>\n\n              <Button\n                onClick={handleCreateSpace}\n                disabled={creating || !formData.name || !formData.handle || !formData.description}\n                className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-[var(--hive-brand-primary)]/90\"\n              >\n                {creating ? (\n                  <span className=\"flex items-center gap-2\">\n                    <div className=\"w-4 h-4 border-2 border-black border-t-transparent rounded-full animate-spin\" />\n                    Creating Space...\n                  </span>\n                ) : (\n                  <span className=\"flex items-center gap-2\">\n                    <Plus className=\"w-4 h-4\" />\n                    Create Space\n                  </span>\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Card>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth-guard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth-test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth/advanced-auth-loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth/auth-layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth/auth-status-indicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth/auth-status.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/auth/simple-auth-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/calendar/calendar-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/connections/connections-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Connection' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Friend' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FriendRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getConnectionStrength' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedUserId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":34,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedUserId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":34,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'friendRequestMessage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":35,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setFriendRequestMessage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":35,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":55}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Connections Panel\n * Displays connections, friends, and manages friend requests\n */\n\n'use client';\n\nimport { useState } from 'react';\nimport { useConnections } from '@/hooks/use-connections';\nimport { Button, Badge, Avatar, Card, Tabs, TabsContent, TabsList, TabsTrigger } from '@hive/ui';\nimport { Users, UserPlus, Check, X, Sparkles, Signal, Heart } from 'lucide-react';\nimport type { Connection, Friend, FriendRequest } from '@hive/core';\n\ninterface ConnectionsPanelProps {\n  className?: string;\n}\n\nexport function ConnectionsPanel({ className }: ConnectionsPanelProps) {\n  const {\n    connections,\n    friends,\n    receivedRequests,\n    sentRequests,\n    stats,\n    isLoading,\n    sendFriendRequest,\n    acceptFriendRequest,\n    rejectFriendRequest,\n    unfriend,\n    isFriend,\n    getConnectionStrength\n  } = useConnections();\n\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\n  const [friendRequestMessage, setFriendRequestMessage] = useState('');\n\n  // Get connection strength indicator\n  const getStrengthIndicator = (strength: number) => {\n    if (strength >= 70) return { icon: 'üî•', label: 'Strong', color: 'text-orange-500' };\n    if (strength >= 40) return { icon: '‚ö°', label: 'Good', color: 'text-yellow-500' };\n    return { icon: '‚ú®', label: 'New', color: 'text-gray-500' };\n  };\n\n  // Get availability indicator\n  const getAvailabilityColor = (status?: string) => {\n    switch (status) {\n      case 'online': return 'bg-green-500';\n      case 'studying': return 'bg-yellow-500';\n      case 'busy': return 'bg-red-500';\n      case 'away': return 'bg-gray-400';\n      default: return 'bg-gray-300';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-pulse text-gray-500\">Loading connections...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {/* Stats Overview */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Connections</p>\n              <p className=\"text-2xl font-bold\">{stats.totalConnections}</p>\n            </div>\n            <Users className=\"h-8 w-8 text-blue-500\" />\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Friends</p>\n              <p className=\"text-2xl font-bold\">{stats.totalFriends}</p>\n            </div>\n            <Heart className=\"h-8 w-8 text-pink-500\" />\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Online</p>\n              <p className=\"text-2xl font-bold\">{stats.onlineFriends}</p>\n            </div>\n            <Signal className=\"h-8 w-8 text-green-500\" />\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Pending</p>\n              <p className=\"text-2xl font-bold\">{stats.pendingReceived}</p>\n            </div>\n            <UserPlus className=\"h-8 w-8 text-purple-500\" />\n          </div>\n        </Card>\n      </div>\n\n      {/* Tabs for different sections */}\n      <Tabs defaultValue=\"connections\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-4\">\n          <TabsTrigger value=\"connections\">\n            Connections\n            <Badge className=\"ml-2\">{connections.length}</Badge>\n          </TabsTrigger>\n          <TabsTrigger value=\"friends\">\n            Friends\n            <Badge className=\"ml-2\">{friends.length}</Badge>\n          </TabsTrigger>\n          <TabsTrigger value=\"requests\">\n            Requests\n            {receivedRequests.length > 0 && (\n              <Badge variant=\"destructive\" className=\"ml-2\">\n                {receivedRequests.length}\n              </Badge>\n            )}\n          </TabsTrigger>\n          <TabsTrigger value=\"sent\">\n            Sent\n            <Badge className=\"ml-2\">{sentRequests.length}</Badge>\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Connections Tab */}\n        <TabsContent value=\"connections\" className=\"space-y-3\">\n          {connections.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <Users className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\n              <p className=\"text-gray-600\">No connections yet</p>\n              <p className=\"text-sm text-gray-500 mt-1\">\n                Connections are created automatically when you share affiliations with others\n              </p>\n            </Card>\n          ) : (\n            connections.map((connection: any) => {\n              const strength = getStrengthIndicator(connection.strength);\n              const alreadyFriend = isFriend(connection.userId);\n\n              return (\n                <Card key={connection.userId} className=\"p-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"relative\">\n                        <Avatar\n                          src={connection.profile?.avatarUrl}\n                          alt={connection.profile?.displayName}\n                          fallback={connection.profile?.displayName?.[0] || '?'}\n                        />\n                        <div\n                          className={`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${getAvailabilityColor(\n                            connection.profile?.availabilityStatus\n                          )}`}\n                        />\n                      </div>\n\n                      <div>\n                        <p className=\"font-medium\">{connection.profile?.displayName}</p>\n                        <p className=\"text-sm text-gray-600\">\n                          {connection.profile?.major} ‚Ä¢ {connection.profile?.academicYear}\n                        </p>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <span className={`text-xs ${strength.color}`}>\n                            {strength.icon} {strength.label} connection\n                          </span>\n                          {connection.sources && (\n                            <div className=\"flex gap-1\">\n                              {connection.sources.includes('same_major') && (\n                                <Badge variant=\"secondary\" className=\"text-xs\">\n                                  Major\n                                </Badge>\n                              )}\n                              {connection.sources.includes('same_dorm') && (\n                                <Badge variant=\"secondary\" className=\"text-xs\">\n                                  Dorm\n                                </Badge>\n                              )}\n                              {connection.sources.includes('same_space') && (\n                                <Badge variant=\"secondary\" className=\"text-xs\">\n                                  Spaces\n                                </Badge>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n\n                    <div>\n                      {alreadyFriend ? (\n                        <Badge variant=\"secondary\">Friends</Badge>\n                      ) : (\n                        <Button\n                          className=\"max-w-sm\"\n                          variant=\"outline\"\n                          onClick={() => sendFriendRequest(connection.userId)}\n                        >\n                          <UserPlus className=\"h-4 w-4 mr-1\" />\n                          Add Friend\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                </Card>\n              );\n            })\n          )}\n        </TabsContent>\n\n        {/* Friends Tab */}\n        <TabsContent value=\"friends\" className=\"space-y-3\">\n          {friends.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <Heart className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\n              <p className=\"text-gray-600\">No friends yet</p>\n              <p className=\"text-sm text-gray-500 mt-1\">\n                Send friend requests to your connections to build your network\n              </p>\n            </Card>\n          ) : (\n            friends.map((friend: any) => (\n              <Card key={friend.userId} className=\"p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                      <Avatar\n                        src={friend.profile?.avatarUrl}\n                        alt={friend.profile?.displayName}\n                        fallback={friend.profile?.displayName?.[0] || '?'}\n                      />\n                      <div\n                        className={`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${getAvailabilityColor(\n                          friend.profile?.availabilityStatus\n                        )}`}\n                      />\n                    </div>\n\n                    <div>\n                      <p className=\"font-medium\">{friend.profile?.displayName}</p>\n                      <p className=\"text-sm text-gray-600\">\n                        {friend.profile?.major} ‚Ä¢ {friend.profile?.academicYear}\n                      </p>\n                      {friend.profile?.statusMessage && (\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          \"{friend.profile.statusMessage}\"\n                        </p>\n                      )}\n                      {friend.mutualCount > 0 && (\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          {friend.mutualCount} mutual friends\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  <Button\n                    className=\"max-w-sm\"\n                    variant=\"outline\"\n                    onClick={() => unfriend(friend.userId)}\n                  >\n                    Unfriend\n                  </Button>\n                </div>\n              </Card>\n            ))\n          )}\n        </TabsContent>\n\n        {/* Friend Requests Tab */}\n        <TabsContent value=\"requests\" className=\"space-y-3\">\n          {receivedRequests.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <UserPlus className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\n              <p className=\"text-gray-600\">No pending friend requests</p>\n            </Card>\n          ) : (\n            receivedRequests.map((request: any) => (\n              <Card key={request.id} className=\"p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Avatar\n                      src={request.fromProfile?.avatarUrl}\n                      alt={request.fromProfile?.displayName}\n                      fallback={request.fromProfile?.displayName?.[0] || '?'}\n                    />\n\n                    <div>\n                      <p className=\"font-medium\">{request.fromProfile?.displayName}</p>\n                      <p className=\"text-sm text-gray-600\">\n                        {request.fromProfile?.major} ‚Ä¢ {request.fromProfile?.academicYear}\n                      </p>\n                      {request.message && (\n                        <p className=\"text-sm text-gray-500 mt-1\">\"{request.message}\"</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-2\">\n                    <Button\n                      className=\"max-w-sm\"\n                      variant=\"default\"\n                      onClick={() => acceptFriendRequest(request.id)}\n                    >\n                      <Check className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      className=\"max-w-sm\"\n                      variant=\"outline\"\n                      onClick={() => rejectFriendRequest(request.id)}\n                    >\n                      <X className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </Card>\n            ))\n          )}\n        </TabsContent>\n\n        {/* Sent Requests Tab */}\n        <TabsContent value=\"sent\" className=\"space-y-3\">\n          {sentRequests.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <UserPlus className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\n              <p className=\"text-gray-600\">No sent friend requests</p>\n            </Card>\n          ) : (\n            sentRequests.map((request: any) => (\n              <Card key={request.id} className=\"p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Avatar\n                      src={request.toProfile?.avatarUrl}\n                      alt={request.toProfile?.displayName}\n                      fallback={request.toProfile?.displayName?.[0] || '?'}\n                    />\n\n                    <div>\n                      <p className=\"font-medium\">{request.toProfile?.displayName}</p>\n                      <p className=\"text-sm text-gray-600\">\n                        {request.toProfile?.major} ‚Ä¢ {request.toProfile?.academicYear}\n                      </p>\n                      <p className=\"text-xs text-gray-500 mt-1\">Pending</p>\n                    </div>\n                  </div>\n\n                  <Badge variant=\"secondary\">Pending</Badge>\n                </div>\n              </Card>\n            ))\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/content/report-content-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/error-boundary-test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/feed-error-boundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/profile-error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { AlertTriangle, RefreshCw, User, Settings, Home } from 'lucide-react';\nimport { Button, Card } from \"@hive/ui\";\nimport { ErrorBoundary } from '../error-boundary';\n\ninterface ProfileErrorFallbackProps {\n  error?: any;\n  retry: () => void;\n  errorId?: string;\n}\n\nfunction ProfileErrorFallback({ error, retry, errorId }: ProfileErrorFallbackProps) {\n  return (\n    <div className=\"max-w-2xl mx-auto px-6 py-8\">\n      <Card className=\"p-8 bg-hive-surface border-hive-border text-center\">\n        <div className=\"w-16 h-16 bg-[var(--hive-brand-primary)]/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n          <AlertTriangle className=\"w-8 h-8 text-[var(--hive-brand-primary)]\" />\n        </div>\n\n        <h2 className=\"text-xl font-bold text-hive-text-primary mb-3\">\n          Profile Temporarily Unavailable\n        </h2>\n        <p className=\"text-hive-text-secondary mb-2\">\n          We're having trouble accessing profile data. Don't worry - your information is safe.\n        </p>\n        <p className=\"text-hive-text-tertiary text-sm mb-6\">\n          This usually resolves quickly. Try refreshing in a moment.\n        </p>\n\n        {errorId && (\n          <div className=\"mb-4 p-3 bg-hive-surface-elevated border border-hive-border rounded-lg\">\n            <p className=\"text-xs text-hive-text-tertiary mb-1\">Error ID:</p>\n            <code className=\"text-xs text-hive-text-secondary font-mono\">{errorId}</code>\n          </div>\n        )}\n\n        <div className=\"flex gap-3 justify-center flex-wrap\">\n          <Button\n            onClick={retry}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Retry Profile\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={() => window.location.href = '/feed'}\n            className=\"border-hive-border text-hive-text-secondary\"\n          >\n            <Home className=\"w-4 h-4 mr-2\" />\n            Go to Feed\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={() => window.location.href = '/settings'}\n            className=\"border-hive-border text-hive-text-secondary\"\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            Settings\n          </Button>\n        </div>\n\n        {/* Data safety assurance */}\n        <div className=\"mt-6 pt-4 border-t border-hive-border\">\n          <p className=\"text-xs text-hive-text-tertiary\">\n            Your profile data is safely stored. This is just a temporary display issue.\n          </p>\n        </div>\n      </Card>\n    </div>\n  );\n}\n\ninterface ProfileErrorBoundaryProps {\n  children: React.ReactNode;\n  profileId?: string; // For viewing others' profiles\n  context?: 'own' | 'other' | 'edit' | 'settings';\n}\n\nexport function ProfileErrorBoundary({\n  children,\n  profileId,\n  context = 'own'\n}: ProfileErrorBoundaryProps) {\n  const contextualSettings = {\n    own: { maxRetries: 5, enableRecovery: true },\n    other: { maxRetries: 3, enableRecovery: true },\n    edit: { maxRetries: 2, enableRecovery: false }, // Don't auto-retry edit forms\n    settings: { maxRetries: 3, enableRecovery: false }\n  };\n\n  const settings = contextualSettings[context];\n\n  return (\n    <ErrorBoundary\n      context={`profile_${context}${profileId ? `_${profileId}` : ''}`}\n      enableRecovery={settings.enableRecovery}\n      maxRetries={settings.maxRetries}\n      fallback={ProfileErrorFallback}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/ritual-error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertDescription' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { Component, ReactNode } from 'react';\nimport { Alert, AlertDescription } from '@hive/ui';\nimport { Button } from '@hive/ui';\nimport { RefreshCw, AlertTriangle, Sparkles } from 'lucide-react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: any, errorInfo: React.ErrorInfo) => void;\n  ritualName?: string;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: any;\n  errorId: string;\n  retryCount: number;\n}\n\nexport class RitualErrorBoundary extends Component<Props, State> {\n  private maxRetries = 2; // Fewer retries for rituals since they're less critical\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      errorId: this.generateErrorId(),\n      retryCount: 0\n    };\n  }\n\n  private generateErrorId(): string {\n    return `ritual_error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  static getDerivedStateFromError(error: any): State {\n    return {\n      hasError: true,\n      error,\n      errorId: `ritual_error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      retryCount: 0\n    };\n  }\n\n  componentDidCatch(error: any, errorInfo: React.ErrorInfo) {\n    console.error('Ritual Error Boundary caught an error:', {\n      error: error.message,\n      stack: error.stack,\n      componentStack: errorInfo.componentStack,\n      errorId: this.state.errorId,\n      ritualName: this.props.ritualName,\n      timestamp: new Date().toISOString()\n    });\n\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n\n    // Report ritual-specific errors\n    if (process.env.NODE_ENV === 'production') {\n      this.reportError(error, errorInfo);\n    }\n  }\n\n  private reportError(error: any, errorInfo: React.ErrorInfo) {\n    try {\n      fetch('/api/errors/report', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          errorId: this.state.errorId,\n          message: error.message,\n          stack: error.stack,\n          componentStack: errorInfo.componentStack,\n          ritualName: this.props.ritualName,\n          userAgent: navigator.userAgent,\n          url: window.location.href,\n          timestamp: new Date().toISOString(),\n          type: 'ritual_error_boundary'\n        })\n      }).catch(reportError => {\n        console.error('Failed to report ritual error:', reportError);\n      });\n    } catch (reportError) {\n      console.error('Ritual error reporting failed:', reportError);\n    }\n  }\n\n  private handleRetry = () => {\n    if (this.state.retryCount < this.maxRetries) {\n      this.setState(prevState => ({\n        hasError: false,\n        error: undefined,\n        errorId: this.generateErrorId(),\n        retryCount: prevState.retryCount + 1\n      }));\n    }\n  };\n\n  private handleHideRitual = () => {\n    // Hide this ritual and continue without it\n    this.setState({\n      hasError: false,\n      error: undefined,\n      errorId: this.generateErrorId(),\n      retryCount: 0\n    });\n\n    // In a real implementation, this would hide the specific ritual\n    // For now, we'll just reset the error state\n  };\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Minimalist error state for rituals (less disruptive)\n      return (\n        <div className=\"p-4 border border-orange-500/30 bg-orange-500/10 rounded-lg\">\n          <div className=\"flex items-center space-x-3\">\n            <AlertTriangle className=\"h-5 w-5 text-orange-400 flex-shrink-0\" />\n\n            <div className=\"flex-1\">\n              <h4 className=\"text-sm font-medium text-orange-300\">\n                {this.props.ritualName ? `${this.props.ritualName} Unavailable` : 'Ritual Unavailable'}\n              </h4>\n              <p className=\"text-xs text-orange-400/70 mt-1\">\n                This ritual couldn't load properly. You can try again or continue without it.\n              </p>\n            </div>\n\n            <div className=\"flex space-x-2\">\n              {this.state.retryCount < this.maxRetries && (\n                <Button\n                  onClick={this.handleRetry}\n                  className=\"max-w-sm border-orange-500/30 text-orange-400 hover:bg-orange-500/20\"\n                  variant=\"outline\"\n                  \n                >\n                  <RefreshCw className=\"h-3 w-3\" />\n                </Button>\n              )}\n\n              <Button\n                onClick={this.handleHideRitual}\n                className=\"max-w-sm text-orange-400/70 hover:text-orange-400\"\n                variant=\"outline\"\n                \n              >\n                <span className=\"text-xs\">Skip</span>\n              </Button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Lightweight fallback component for ritual strips\nexport function RitualStripFallback({ message = \"Rituals temporarily unavailable\" }: { message?: string }) {\n  return (\n    <div className=\"bg-hive-surface border-b border-hive-border\">\n      <div className=\"max-w-2xl mx-auto px-6 py-4\">\n        <div className=\"flex items-center justify-center space-x-3 py-4 text-hive-text-secondary\">\n          <Sparkles className=\"h-5 w-5 text-hive-text-secondary/50\" />\n          <span className=\"text-sm\">{message}</span>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/spaces-error-boundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundaries/tools-error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":48}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { AlertTriangle, RefreshCw, Wrench, Plus, Home } from 'lucide-react';\nimport { Button, Card } from \"@hive/ui\";\nimport { ErrorBoundary } from '../error-boundary';\n\ninterface ToolsErrorFallbackProps {\n  error?: any;\n  retry: () => void;\n  errorId?: string;\n}\n\nfunction ToolsErrorFallback({ error, retry, errorId }: ToolsErrorFallbackProps) {\n  return (\n    <div className=\"max-w-2xl mx-auto px-6 py-8\">\n      <Card className=\"p-8 bg-hive-surface border-hive-border text-center\">\n        <div className=\"w-16 h-16 bg-[var(--hive-brand-primary)]/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n          <AlertTriangle className=\"w-8 h-8 text-[var(--hive-brand-primary)]\" />\n        </div>\n\n        <h2 className=\"text-xl font-bold text-hive-text-primary mb-3\">\n          HiveLab Tools Offline\n        </h2>\n        <p className=\"text-hive-text-secondary mb-2\">\n          The tool builder is temporarily unavailable. Your projects are safe and saved.\n        </p>\n        <p className=\"text-hive-text-tertiary text-sm mb-6\">\n          Check back soon - we're working to restore full functionality.\n        </p>\n\n        {errorId && (\n          <div className=\"mb-4 p-3 bg-hive-surface-elevated border border-hive-border rounded-lg\">\n            <p className=\"text-xs text-hive-text-tertiary mb-1\">Error ID:</p>\n            <code className=\"text-xs text-hive-text-secondary font-mono\">{errorId}</code>\n          </div>\n        )}\n\n        <div className=\"flex gap-3 justify-center flex-wrap\">\n          <Button\n            onClick={retry}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Retry Tools\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={() => window.location.href = '/feed'}\n            className=\"border-hive-border text-hive-text-secondary\"\n          >\n            <Home className=\"w-4 h-4 mr-2\" />\n            Go to Feed\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={() => window.location.href = '/tools'}\n            className=\"border-hive-border text-hive-text-secondary\"\n          >\n            <Wrench className=\"w-4 h-4 mr-2\" />\n            My Tools\n          </Button>\n        </div>\n\n        {/* Project safety assurance */}\n        <div className=\"mt-6 pt-4 border-t border-hive-border\">\n          <p className=\"text-xs text-hive-text-tertiary\">\n            All your tool projects are automatically saved. No work will be lost.\n          </p>\n        </div>\n      </Card>\n    </div>\n  );\n}\n\ninterface ToolsErrorBoundaryProps {\n  children: React.ReactNode;\n  toolId?: string;\n  context?: 'list' | 'edit' | 'run' | 'create' | 'preview' | 'deploy';\n}\n\nexport function ToolsErrorBoundary({\n  children,\n  toolId,\n  context = 'list'\n}: ToolsErrorBoundaryProps) {\n  const contextualSettings = {\n    list: { maxRetries: 4, enableRecovery: true },\n    edit: { maxRetries: 2, enableRecovery: false }, // Don't auto-retry during editing\n    run: { maxRetries: 3, enableRecovery: true },\n    create: { maxRetries: 2, enableRecovery: false },\n    preview: { maxRetries: 3, enableRecovery: true },\n    deploy: { maxRetries: 1, enableRecovery: false } // Critical operation\n  };\n\n  const settings = contextualSettings[context];\n\n  return (\n    <ErrorBoundary\n      context={`tools_${context}${toolId ? `_${toolId}` : ''}`}\n      enableRecovery={settings.enableRecovery}\n      maxRetries={settings.maxRetries}\n      fallback={ToolsErrorFallback}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { AlertTriangle, RefreshCw, Home, Bug, ExternalLink } from 'lucide-react';\nimport { Button, Card } from \"@hive/ui\";\nimport { logger } from '../lib/logger';\nimport { errorReporting } from '../lib/error-reporting';\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error?: any;\n  errorInfo?: React.ErrorInfo;\n  errorId?: string;\n  retryCount: number;\n}\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n  fallback?: React.ComponentType<{ error?: any; retry: () => void; errorId?: string }>;\n  context?: string; // 'global' | 'feed' | 'spaces' | 'profile' | 'tools'\n  enableRecovery?: boolean;\n  maxRetries?: number;\n}\n\nclass ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  private retryTimeout?: NodeJS.Timeout;\n\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false, retryCount: 0 };\n  }\n\n  static getDerivedStateFromError(error: any): Partial<ErrorBoundaryState> {\n    // Generate unique error ID for tracking\n    const errorId = `err_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    return { hasError: true, error, errorId };\n  }\n\n  componentDidCatch(error: any, errorInfo: React.ErrorInfo) {\n    const errorId = `err_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const context = this.props.context || 'global';\n\n    this.setState({ error: error instanceof Error ? error.message : String(error), errorInfo, errorId });\n\n    // Enhanced error logging with context and Firebase integration\n    logger.error('Error Boundary caught an error', {\n      errorId,\n      error: error.message,\n      stack: error.stack,\n      componentStack: errorInfo.componentStack ?? undefined,\n      errorBoundary: `${context}ErrorBoundary`,\n      context,\n      retryCount: this.state.retryCount,\n      userAgent: typeof window !== 'undefined' ? window.navigator.userAgent : undefined,\n      url: typeof window !== 'undefined' ? window.location.href : undefined,\n      timestamp: new Date().toISOString(),\n      // Production-ready metadata\n      buildVersion: process.env.NEXT_PUBLIC_APP_VERSION || 'unknown',\n      environment: process.env.NODE_ENV,\n    });\n\n    // Send to production error reporting service\n    errorReporting.reportError({\n      errorId,\n      message: error.message,\n      stack: error.stack,\n      componentStack: errorInfo.componentStack ?? undefined,\n      context: `${context}ErrorBoundary`,\n      retryCount: this.state.retryCount,\n      userAgent: typeof window !== 'undefined' ? window.navigator.userAgent : undefined,\n      url: typeof window !== 'undefined' ? window.location.href : undefined,\n    }).catch((reportingError) => {\n      logger.error('Failed to report error to external service', {\n        originalErrorId: errorId,\n        reportingError: reportingError instanceof Error ? reportingError.message : 'Unknown'\n      });\n    });\n\n    // Auto-recovery for non-critical contexts\n    if (this.props.enableRecovery && context !== 'global') {\n      const maxRetries = this.props.maxRetries || 3;\n      if (this.state.retryCount < maxRetries) {\n        this.retryTimeout = setTimeout(() => {\n          this.retry();\n        }, 5000); // Auto-retry after 5 seconds\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.retryTimeout) {\n      clearTimeout(this.retryTimeout);\n    }\n  }\n\n  retry = () => {\n    const newRetryCount = this.state.retryCount + 1;\n\n    // Log retry attempt\n    logger.info('Error boundary retry attempt', {\n      errorId: this.state.errorId,\n      retryCount: newRetryCount,\n      context: this.props.context || 'global'\n    });\n\n    if (this.retryTimeout) {\n      clearTimeout(this.retryTimeout);\n    }\n\n    this.setState({\n      hasError: false,\n      error: undefined,\n      errorInfo: undefined,\n      retryCount: newRetryCount\n    });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        const FallbackComponent = this.props.fallback;\n        return <FallbackComponent\n          error={this.state.error}\n          retry={this.retry}\n          errorId={this.state.errorId}\n        />;\n      }\n\n      return <DefaultErrorFallback\n        error={this.state.error}\n        retry={this.retry}\n        errorId={this.state.errorId}\n        context={this.props.context || 'global'}\n        retryCount={this.state.retryCount}\n        maxRetries={this.props.maxRetries || 3}\n      />;\n    }\n\n    return this.props.children;\n  }\n}\n\nfunction DefaultErrorFallback({\n  error,\n  retry,\n  errorId,\n  context = 'global',\n  retryCount = 0,\n  maxRetries = 3\n}: {\n  error?: any;\n  retry: () => void;\n  errorId?: string;\n  context?: string;\n  retryCount?: number;\n  maxRetries?: number;\n}) {\n  const isDevelopment = process.env.NODE_ENV === 'development';\n  const isGlobalError = context === 'global';\n  const canRetry = retryCount < maxRetries;\n\n  // HIVE brand voice for different contexts\n  const getContextualMessage = () => {\n    switch (context) {\n      case 'feed':\n        return {\n          title: \"Feed Temporarily Unavailable\",\n          message: \"We're having trouble loading your campus feed. Your connections are safe - this is just a temporary hiccup.\",\n          suggestion: \"Try refreshing or check your spaces directly while we fix this.\"\n        };\n      case 'spaces':\n        return {\n          title: \"Space Explorer Offline\",\n          message: \"We can't load the spaces right now, but your communities are still there waiting for you.\",\n          suggestion: \"Try again in a moment or navigate to a specific space if you know its URL.\"\n        };\n      case 'profile':\n        return {\n          title: \"Profile Temporarily Unavailable\",\n          message: \"We're having trouble accessing profile data. Don't worry - your information is safe.\",\n          suggestion: \"This usually resolves quickly. Try refreshing in a moment.\"\n        };\n      case 'tools':\n        return {\n          title: \"HiveLab Tools Offline\",\n          message: \"The tool builder is temporarily unavailable. Your projects are safe and saved.\",\n          suggestion: \"Check back soon - we're working to restore full functionality.\"\n        };\n      default:\n        return {\n          title: \"Something Unexpected Happened\",\n          message: \"We hit a snag, but HIVE is still running. This doesn't affect your data or connections.\",\n          suggestion: \"Try refreshing the page or navigate to a different section while we investigate.\"\n        };\n    }\n  };\n\n  const { title, message, suggestion } = getContextualMessage();\n\n  return (\n    <div className={`${isGlobalError ? 'min-h-screen' : 'min-h-[400px]'} bg-hive-background flex items-center justify-center p-4`}>\n      <Card className=\"max-w-lg w-full p-8 bg-hive-surface border-hive-border-default text-center\">\n        <div className=\"w-16 h-16 bg-[var(--hive-brand-primary)]/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n          <AlertTriangle className=\"w-8 h-8 text-[var(--hive-brand-primary)]\" />\n        </div>\n\n        <h1 className=\"text-xl font-bold text-hive-text-primary mb-3\">{title}</h1>\n        <p className=\"text-hive-text-secondary mb-2\">\n          {message}\n        </p>\n        <p className=\"text-hive-text-tertiary text-sm mb-6\">\n          {suggestion}\n        </p>\n\n        {/* Error ID for support */}\n        {errorId && (\n          <div className=\"mb-4 p-3 bg-hive-surface-elevated border border-hive-border rounded-lg\">\n            <p className=\"text-xs text-hive-text-tertiary mb-1\">Error ID for support:</p>\n            <code className=\"text-xs text-hive-text-secondary font-mono\">\n              {errorId}\n            </code>\n          </div>\n        )}\n\n        {/* Retry information */}\n        {retryCount > 0 && (\n          <div className=\"mb-4 p-3 bg-hive-surface-elevated border border-hive-border rounded-lg\">\n            <p className=\"text-xs text-hive-text-secondary\">\n              Retry attempt {retryCount} of {maxRetries}\n            </p>\n          </div>\n        )}\n\n        {/* Development error details */}\n        {isDevelopment && error && (\n          <div className=\"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-left\">\n            <h3 className=\"text-sm font-medium text-red-400 mb-2\">Development Error Details:</h3>\n            <pre className=\"text-xs text-red-300 overflow-auto max-h-32\">\n              {error.message}\n              {error.stack && '\\n\\nStack trace:\\n' + error.stack}\n            </pre>\n          </div>\n        )}\n\n        <div className=\"flex gap-3 justify-center flex-wrap\">\n          {canRetry && (\n            <Button\n              onClick={retry}\n              className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Try Again\n            </Button>\n          )}\n\n          {!isGlobalError && (\n            <Button\n              variant=\"outline\"\n              onClick={() => window.location.reload()}\n              className=\"border-hive-border text-hive-text-secondary\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh Page\n            </Button>\n          )}\n\n          <Button\n            variant=\"outline\"\n            onClick={() => window.location.href = '/feed'}\n            className=\"border-hive-border text-hive-text-secondary\"\n          >\n            <Home className=\"w-4 h-4 mr-2\" />\n            Go to Feed\n          </Button>\n\n          {isDevelopment && (\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                if (error && errorId) {\n                  const errorReport = {\n                    errorId,\n                    message: error.message,\n                    stack: error.stack,\n                    context,\n                    retryCount,\n                    timestamp: new Date().toISOString(),\n                    url: window.location.href\n                  };\n                  navigator.clipboard?.writeText(JSON.stringify(errorReport, null, 2));\n                }\n              }}\n              className=\"border-hive-border text-hive-text-tertiary\"\n            >\n              <Bug className=\"w-4 h-4 mr-2\" />\n              Copy Error\n            </Button>\n          )}\n        </div>\n\n        {/* Support link for production */}\n        {!isDevelopment && (\n          <div className=\"mt-6 pt-4 border-t border-hive-border\">\n            <p className=\"text-xs text-hive-text-tertiary\">\n              If this keeps happening, reach out to our team with the error ID above.\n            </p>\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n}\n\nexport { ErrorBoundary, DefaultErrorFallback };\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/error-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/events/create-event-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HiveModalFooter' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Dialog, DialogContent, Button, Input, Badge } from \"@hive/ui\";\nimport { HiveModalHeader, HiveModalTitle, HiveModalFooter } from \"@/components/temp-stubs\";\nimport { \n  MapPin, \n  Users, \n  Clock, \n  Zap, \n  Tag,\n  Eye,\n  Plus,\n  X,\n  Type,\n  FileText\n} from \"lucide-react\";\n\ninterface CreateEventModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCreateEvent: (event: CreateEventData) => void;\n  defaultSpaceId?: string;\n}\n\ninterface CreateEventData {\n  title: string;\n  description: string;\n  type: 'academic' | 'social' | 'professional' | 'recreational' | 'official';\n  datetime: {\n    start: string;\n    end: string;\n    timezone: string;\n  };\n  location: {\n    type: 'physical' | 'virtual' | 'hybrid';\n    name: string;\n    address?: string;\n    virtualLink?: string;\n  };\n  capacity: number;\n  spaceId?: string;\n  tools: string[];\n  tags: string[];\n  visibility: 'public' | 'space_only' | 'invited_only';\n  requirements?: string[];\n}\n\nconst EVENT_TYPES = [\n  { id: 'academic', label: 'Academic', icon: 'üìö', color: 'bg-blue-500' },\n  { id: 'social', label: 'Social', icon: 'üéâ', color: 'bg-pink-500' },\n  { id: 'professional', label: 'Professional', icon: 'üíº', color: 'bg-green-500' },\n  { id: 'recreational', label: 'Recreational', icon: 'üéÆ', color: 'bg-orange-500' },\n  { id: 'official', label: 'Official', icon: 'üèõÔ∏è', color: 'bg-purple-500' }\n] as const;\n\nconst AVAILABLE_TOOLS = [\n  { id: 'study-timer', name: 'Study Timer', category: 'productivity' },\n  { id: 'poll-maker', name: 'Poll Maker', category: 'engagement' },\n  { id: 'whiteboard', name: 'Whiteboard', category: 'collaboration' },\n  { id: 'file-share', name: 'File Share', category: 'collaboration' },\n  { id: 'music-queue', name: 'Music Queue', category: 'social' },\n  { id: 'group-chat', name: 'Group Chat', category: 'communication' },\n  { id: 'attendance', name: 'Attendance Tracker', category: 'organization' },\n  { id: 'feedback', name: 'Feedback Collector', category: 'engagement' }\n];\n\nexport function CreateEventModal({ isOpen, onClose, onCreateEvent, defaultSpaceId }: CreateEventModalProps) {\n  const [step, setStep] = useState(1);\n  const [formData, setFormData] = useState<CreateEventData>({\n    title: '',\n    description: '',\n    type: 'academic',\n    datetime: {\n      start: '',\n      end: '',\n      timezone: 'America/New_York'\n    },\n    location: {\n      type: 'physical',\n      name: '',\n      address: ''\n    },\n    capacity: 50,\n    spaceId: defaultSpaceId,\n    tools: [],\n    tags: [],\n    visibility: defaultSpaceId ? 'space_only' : 'public',\n    requirements: []\n  });\n  \n  const [newTag, setNewTag] = useState('');\n  const [newRequirement, setNewRequirement] = useState('');\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n\n  const handleNestedInputChange = (parentField: string, childField: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [parentField]: {\n        ...prev[parentField as keyof CreateEventData] as any,\n        [childField]: value\n      }\n    }));\n  };\n\n  const addTag = () => {\n    if (newTag.trim() && !formData.tags.includes(newTag.trim())) {\n      setFormData(prev => ({\n        ...prev,\n        tags: [...prev.tags, newTag.trim()]\n      }));\n      setNewTag('');\n    }\n  };\n\n  const removeTag = (tag: string) => {\n    setFormData(prev => ({\n      ...prev,\n      tags: prev.tags.filter(t => t !== tag)\n    }));\n  };\n\n  const addRequirement = () => {\n    if (newRequirement.trim() && !formData.requirements?.includes(newRequirement.trim())) {\n      setFormData(prev => ({\n        ...prev,\n        requirements: [...(prev.requirements || []), newRequirement.trim()]\n      }));\n      setNewRequirement('');\n    }\n  };\n\n  const removeRequirement = (requirement: string) => {\n    setFormData(prev => ({\n      ...prev,\n      requirements: prev.requirements?.filter(r => r !== requirement) || []\n    }));\n  };\n\n  const toggleTool = (toolId: string) => {\n    setFormData(prev => ({\n      ...prev,\n      tools: prev.tools.includes(toolId)\n        ? prev.tools.filter(t => t !== toolId)\n        : [...prev.tools, toolId]\n    }));\n  };\n\n  const canProceed = (currentStep: number) => {\n    switch (currentStep) {\n      case 1:\n        return formData.title.trim() && formData.description.trim() && formData.type;\n      case 2:\n        return formData.datetime.start && formData.datetime.end;\n      case 3:\n        return formData.location.name.trim() && \n               (formData.location.type !== 'virtual' || formData.location.virtualLink?.trim()) &&\n               (formData.location.type !== 'physical' || formData.location.address?.trim());\n      case 4:\n        return formData.capacity > 0;\n      default:\n        return true;\n    }\n  };\n\n  const handleSubmit = () => {\n    if (canProceed(step)) {\n      onCreateEvent(formData);\n      onClose();\n      // Reset form\n      setFormData({\n        title: '',\n        description: '',\n        type: 'academic',\n        datetime: {\n          start: '',\n          end: '',\n          timezone: 'America/New_York'\n        },\n        location: {\n          type: 'physical',\n          name: '',\n          address: ''\n        },\n        capacity: 50,\n        tools: [],\n        tags: [],\n        visibility: 'public',\n        requirements: []\n      });\n      setStep(1);\n    }\n  };\n\n  const getStepTitle = (stepNumber: number) => {\n    switch (stepNumber) {\n      case 1: return 'Event Basics';\n      case 2: return 'Date & Time';\n      case 3: return 'Location';\n      case 4: return 'Capacity & Settings';\n      case 5: return 'Tools & Features';\n      case 6: return 'Review & Create';\n      default: return 'Create Event';\n    }\n  };\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={onClose}\n    >\n      <HiveModalHeader>\n        <HiveModalTitle>Create Event - {getStepTitle(step)}</HiveModalTitle>\n      </HiveModalHeader>\n      <DialogContent>\n        <div className=\"space-y-6\">\n        {/* Progress Indicator */}\n        <div className=\"flex items-center justify-between mb-6\">\n          {[1, 2, 3, 4, 5, 6].map((stepNumber) => (\n            <div\n              key={stepNumber}\n              className={`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${\n                stepNumber === step\n                  ? 'bg-[var(--hive-brand-primary)] text-hive-obsidian'\n                  : stepNumber < step\n                  ? 'bg-green-500 text-white'\n                  : 'bg-zinc-700 text-zinc-400'\n              }`}\n            >\n              {stepNumber}\n            </div>\n          ))}\n        </div>\n\n        {/* Step 1: Event Basics */}\n        {step === 1 && (\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <Type className=\"inline h-4 w-4 mr-1\" />\n                Event Title\n              </label>\n              <Input\n                value={formData.title}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange('title', (e.target as any).value)}\n                placeholder=\"Enter event title...\"\n                className=\"w-full\"\n                maxLength={100}\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <FileText className=\"inline h-4 w-4 mr-1\" />\n                Description\n              </label>\n              <textarea\n                value={formData.description}\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleInputChange('description', (e.target as any).value)}\n                placeholder=\"Describe your event, what to expect, and any important details...\"\n                className=\"w-full p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white placeholder-zinc-400 focus:border-[var(--hive-brand-primary)] focus:outline-none resize-none\"\n                rows={4}\n                maxLength={500}\n              />\n              <div className=\"text-xs text-zinc-400 mt-1\">\n                {formData.description.length}/500 characters\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Event Type</label>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                {EVENT_TYPES.map((type) => (\n                  <button\n                    key={type.id}\n                    onClick={() => handleInputChange('type', type.id)}\n                    className={`p-3 rounded-lg border-2 transition-all ${\n                      formData.type === type.id\n                        ? 'border-[var(--hive-brand-primary)] bg-[var(--hive-brand-primary)]/10'\n                        : 'border-zinc-700 bg-zinc-800/50 hover:border-zinc-600'\n                    }`}\n                  >\n                    <div className=\"text-center\">\n                      <div className=\"text-2xl mb-1\">{type.icon}</div>\n                      <div className=\"text-sm font-medium text-white\">{type.label}</div>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 2: Date & Time */}\n        {step === 2 && (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">\n                  <Clock className=\"inline h-4 w-4 mr-1\" />\n                  Start Date & Time\n                </label>\n                <input\n                  type=\"datetime-local\"\n                  value={formData.datetime.start}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleNestedInputChange('datetime', 'start', (e.target as any).value)}\n                  className=\"w-full p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n                  min={new Date().toISOString().slice(0, 16)}\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">\n                  <Clock className=\"inline h-4 w-4 mr-1\" />\n                  End Date & Time\n                </label>\n                <input\n                  type=\"datetime-local\"\n                  value={formData.datetime.end}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleNestedInputChange('datetime', 'end', (e.target as any).value)}\n                  className=\"w-full p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n                  min={formData.datetime.start || new Date().toISOString().slice(0, 16)}\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Timezone</label>\n              <select\n                value={formData.datetime.timezone}\n                onChange={(e: React.ChangeEvent<HTMLSelectElement>) => handleNestedInputChange('datetime', 'timezone', (e.target as any).value)}\n                className=\"w-full p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n              >\n                <option value=\"America/New_York\">Eastern Time (ET)</option>\n                <option value=\"America/Chicago\">Central Time (CT)</option>\n                <option value=\"America/Denver\">Mountain Time (MT)</option>\n                <option value=\"America/Los_Angeles\">Pacific Time (PT)</option>\n              </select>\n            </div>\n          </div>\n        )}\n\n        {/* Step 3: Location */}\n        {step === 3 && (\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Location Type</label>\n              <div className=\"grid grid-cols-3 gap-3\">\n                {[\n                  { id: 'physical', label: 'In-Person', icon: 'üìç' },\n                  { id: 'virtual', label: 'Virtual', icon: 'üíª' },\n                  { id: 'hybrid', label: 'Hybrid', icon: 'üîó' }\n                ].map((locType) => (\n                  <button\n                    key={locType.id}\n                    onClick={() => handleNestedInputChange('location', 'type', locType.id)}\n                    className={`p-3 rounded-lg border-2 transition-all ${\n                      formData.location.type === locType.id\n                        ? 'border-[var(--hive-brand-primary)] bg-[var(--hive-brand-primary)]/10'\n                        : 'border-zinc-700 bg-zinc-800/50 hover:border-zinc-600'\n                    }`}\n                  >\n                    <div className=\"text-center\">\n                      <div className=\"text-xl mb-1\">{locType.icon}</div>\n                      <div className=\"text-sm font-medium text-white\">{locType.label}</div>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <MapPin className=\"inline h-4 w-4 mr-1\" />\n                Location Name\n              </label>\n              <Input\n                value={formData.location.name}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleNestedInputChange('location', 'name', (e.target as any).value)}\n                placeholder={\n                  formData.location.type === 'virtual' \n                    ? 'e.g., Zoom Meeting, Discord Channel'\n                    : 'e.g., Lockwood Library Room 301, Student Union'\n                }\n                className=\"w-full\"\n              />\n            </div>\n\n            {formData.location.type === 'physical' && (\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">Full Address</label>\n                <Input\n                  value={formData.location.address || ''}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleNestedInputChange('location', 'address', (e.target as any).value)}\n                  placeholder=\"Enter full address with building and room number...\"\n                  className=\"w-full\"\n                />\n              </div>\n            )}\n\n            {(formData.location.type === 'virtual' || formData.location.type === 'hybrid') && (\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">Virtual Link</label>\n                <Input\n                  value={formData.location.virtualLink || ''}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleNestedInputChange('location', 'virtualLink', (e.target as any).value)}\n                  placeholder=\"https://zoom.us/j/... or Discord invite link\"\n                  className=\"w-full\"\n                />\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Step 4: Capacity & Settings */}\n        {step === 4 && (\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <Users className=\"inline h-4 w-4 mr-1\" />\n                Event Capacity\n              </label>\n              <div className=\"flex items-center space-x-4\">\n                <Input\n                  type=\"number\"\n                  value={formData.capacity.toString()}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange('capacity', parseInt((e.target as any).value) || 0)}\n                  placeholder=\"50\"\n                  className=\"w-32\"\n                  min=\"1\"\n                  max=\"10000\"\n                />\n                <span className=\"text-zinc-400 text-sm\">people maximum</span>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <Eye className=\"inline h-4 w-4 mr-1\" />\n                Event Visibility\n              </label>\n              <div className=\"space-y-3\">\n                {[\n                  { id: 'public', label: 'Public', desc: 'Anyone can discover and join this event', icon: 'üåç' },\n                  { id: 'space_only', label: 'Space Members Only', desc: 'Only members of your space can see this event', icon: 'üë•' },\n                  { id: 'invited_only', label: 'Invite Only', desc: 'Only people you invite can join', icon: 'üîí' }\n                ].map((vis) => (\n                  <label\n                    key={vis.id}\n                    className={`flex items-start space-x-3 p-3 rounded-lg border cursor-pointer transition-all ${\n                      formData.visibility === vis.id\n                        ? 'border-[var(--hive-brand-primary)] bg-[var(--hive-brand-primary)]/5'\n                        : 'border-zinc-700 hover:border-zinc-600'\n                    }`}\n                  >\n                    <input\n                      type=\"radio\"\n                      name=\"visibility\"\n                      value={vis.id}\n                      checked={formData.visibility === vis.id}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange('visibility', (e.target as any).value)}\n                      className=\"mt-1\"\n                    />\n                    <div>\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-lg\">{vis.icon}</span>\n                        <span className=\"font-medium text-white\">{vis.label}</span>\n                      </div>\n                      <p className=\"text-sm text-zinc-400 mt-1\">{vis.desc}</p>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 5: Tools & Features */}\n        {step === 5 && (\n          <div className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <Zap className=\"inline h-4 w-4 mr-1\" />\n                Available Tools\n              </label>\n              <p className=\"text-sm text-zinc-400 mb-4\">\n                Select tools that attendees can use during your event\n              </p>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {AVAILABLE_TOOLS.map((tool) => (\n                  <label\n                    key={tool.id}\n                    className={`flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-all ${\n                      formData.tools.includes(tool.id)\n                        ? 'border-[var(--hive-brand-primary)] bg-[var(--hive-brand-primary)]/5'\n                        : 'border-zinc-700 hover:border-zinc-600'\n                    }`}\n                  >\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.tools.includes(tool.id)}\n                      onChange={() => toggleTool(tool.id)}\n                    />\n                    <div>\n                      <div className=\"font-medium text-white\">{tool.name}</div>\n                      <div className=\"text-xs text-zinc-400 capitalize\">{tool.category}</div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">\n                <Tag className=\"inline h-4 w-4 mr-1\" />\n                Tags\n              </label>\n              <div className=\"flex items-center space-x-2 mb-3\">\n                <Input\n                  value={newTag}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => setNewTag((e.target as any).value)}\n                  placeholder=\"Add a tag...\"\n                  className=\"flex-1\"\n                  onKeyPress={(e) => e.key === 'Enter' && addTag()}\n                />\n                <Button onClick={addTag} className=\"max-w-sm\">\n                  <Plus className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                {formData.tags.map((tag) => (\n                  <Badge key={tag} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                    <span>#{tag}</span>\n                    <button onClick={() => removeTag(tag)} className=\"ml-1\">\n                      <X className=\"h-3 w-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Requirements</label>\n              <div className=\"flex items-center space-x-2 mb-3\">\n                <Input\n                  value={newRequirement}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => setNewRequirement((e.target as any).value)}\n                  placeholder=\"e.g., Laptop, Professional attire...\"\n                  className=\"flex-1\"\n                  onKeyPress={(e) => e.key === 'Enter' && addRequirement()}\n                />\n                <Button onClick={addRequirement} className=\"max-w-sm\">\n                  <Plus className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <div className=\"space-y-2\">\n                {formData.requirements?.map((req) => (\n                  <div key={req} className=\"flex items-center justify-between p-2 bg-zinc-800 rounded\">\n                    <span className=\"text-white text-sm\">{req}</span>\n                    <button onClick={() => removeRequirement(req)}>\n                      <X className=\"h-4 w-4 text-zinc-400 hover:text-white\" />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 6: Review & Create */}\n        {step === 6 && (\n          <div className=\"space-y-6\">\n            <div className=\"bg-zinc-800/50 rounded-lg p-4\">\n              <h3 className=\"text-lg font-semibold text-white mb-4\">Event Summary</h3>\n              <div className=\"space-y-3 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Title:</span>\n                  <span className=\"text-white\">{formData.title}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Type:</span>\n                  <span className=\"text-white capitalize\">{formData.type}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Date:</span>\n                  <span className=\"text-white\">\n                    {new Date(formData.datetime.start).toLocaleDateString()} - {new Date(formData.datetime.end).toLocaleDateString()}\n                  </span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Location:</span>\n                  <span className=\"text-white\">{formData.location.name}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Capacity:</span>\n                  <span className=\"text-white\">{formData.capacity} people</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Tools:</span>\n                  <span className=\"text-white\">{formData.tools.length} selected</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-zinc-400\">Visibility:</span>\n                  <span className=\"text-white capitalize\">{formData.visibility.replace('_', ' ')}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Navigation Buttons */}\n        <div className=\"flex items-center justify-between pt-6 border-t border-zinc-800\">\n          <Button\n            variant=\"outline\"\n            onClick={() => step > 1 ? setStep(step - 1) : onClose()}\n          >\n            {step > 1 ? 'Previous' : 'Cancel'}\n          </Button>\n\n          <div className=\"flex items-center space-x-3\">\n            {step < 6 ? (\n              <Button\n                onClick={() => setStep(step + 1)}\n                disabled={!canProceed(step)}\n                className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne disabled:opacity-50\"\n              >\n                Next\n              </Button>\n            ) : (\n              <Button\n                onClick={handleSubmit}\n                className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n              >\n                Create Event\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/events/event-details-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":165,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":165,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Dialog, Button, Badge, Card } from \"@hive/ui\";\nimport { Alert } from \"@/components/temp-stubs\";\nimport { \n  Calendar, \n  MapPin, \n  Users, \n  Clock, \n  Zap, \n  Star,\n  Heart,\n  MessageCircle,\n  Share2,\n  ExternalLink,\n  Settings,\n  UserPlus,\n  AlertTriangle,\n  CheckCircle\n} from \"lucide-react\";\nimport { EventToolIntegration } from \"./event-tool-integration\";\n\ninterface EventDetailsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  event: EventData | null;\n  currentUserId?: string;\n  onRSVP: (_eventId: string, _status: 'going' | 'interested' | 'not_going') => void;\n  onBookmark: (_eventId: string) => void;\n}\n\ninterface EventData {\n  id: string;\n  title: string;\n  description: string;\n  type: 'academic' | 'social' | 'professional' | 'recreational' | 'official';\n  organizer: {\n    id: string;\n    name: string;\n    handle: string;\n    avatar?: string;\n    verified?: boolean;\n  };\n  space?: {\n    id: string;\n    name: string;\n    type: string;\n  };\n  datetime: {\n    start: string;\n    end: string;\n    timezone: string;\n  };\n  location: {\n    type: 'physical' | 'virtual' | 'hybrid';\n    name: string;\n    address?: string;\n    virtualLink?: string;\n  };\n  capacity: {\n    max: number;\n    current: number;\n    waitlist: number;\n  };\n  tools: string[];\n  tags: string[];\n  visibility: 'public' | 'space_only' | 'invited_only';\n  rsvpStatus?: 'going' | 'interested' | 'not_going' | null;\n  isBookmarked: boolean;\n  engagement: {\n    going: number;\n    interested: number;\n    comments: number;\n    shares: number;\n  };\n  requirements?: string[];\n  createdAt: string;\n  updatedAt: string;\n}\n\n\nexport function EventDetailsModal({ \n  isOpen, \n  onClose, \n  event, \n  currentUserId,\n  onRSVP, \n  onBookmark \n}: EventDetailsModalProps) {\n  const [activeTab, setActiveTab] = useState<'details' | 'tools' | 'attendees' | 'discussion'>('details');\n  const [copiedLink, setCopiedLink] = useState(false);\n\n  if (!event) return null;\n\n  const formatEventTime = (startTime: string, endTime: string) => {\n    const start = new Date(startTime);\n    const end = new Date(endTime);\n    const now = new Date();\n    \n    const isToday = start.toDateString() === now.toDateString();\n    const isTomorrow = start.toDateString() === new Date(now.getTime() + 24 * 60 * 60 * 1000).toDateString();\n    \n    let dayText = '';\n    if (isToday) dayText = 'Today';\n    else if (isTomorrow) dayText = 'Tomorrow';\n    else dayText = start.toLocaleDateString('en-US', { \n      weekday: 'long', \n      month: 'long', \n      day: 'numeric',\n      year: start.getFullYear() !== now.getFullYear() ? 'numeric' : undefined \n    });\n    \n    const timeText = `${start.toLocaleTimeString('en-US', { \n      hour: 'numeric', \n      minute: '2-digit',\n      hour12: true \n    })} - ${end.toLocaleTimeString('en-US', { \n      hour: 'numeric', \n      minute: '2-digit',\n      hour12: true \n    })}`;\n    \n    return { dayText, timeText };\n  };\n\n  const getEventTypeColor = (type: EventData['type']) => {\n    switch (type) {\n      case 'academic': return 'bg-blue-500';\n      case 'social': return 'bg-pink-500';\n      case 'professional': return 'bg-green-500';\n      case 'recreational': return 'bg-orange-500';\n      case 'official': return 'bg-purple-500';\n      default: return 'bg-gray-500';\n    }\n  };\n\n  const getEventTypeIcon = (type: EventData['type']) => {\n    switch (type) {\n      case 'academic': return 'üìö';\n      case 'social': return 'üéâ';\n      case 'professional': return 'üíº';\n      case 'recreational': return 'üéÆ';\n      case 'official': return 'üèõÔ∏è';\n      default: return 'üìÖ';\n    }\n  };\n\n\n  const { dayText, timeText } = formatEventTime(event.datetime.start, event.datetime.end);\n  const isEventFull = event.capacity.current >= event.capacity.max;\n  const isEventPast = new Date(event.datetime.end) < new Date();\n  const isEventSoon = new Date(event.datetime.start) < new Date(Date.now() + 24 * 60 * 60 * 1000);\n\n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(`${window.location.origin}/events/${event.id}`);\n      setCopiedLink(true);\n      setTimeout(() => setCopiedLink(false), 2000);\n    } catch (err) {\n      // Intentionally suppressed - non-critical error\n    }\n  };\n\n  const handleToolLaunch = (toolId: string, config?: any) => {\n    // In a real implementation, this would launch the tool in the context of the event\n    // This would integrate with the actual tool system\n    alert(`Tool \"${toolId}\" launching for event attendees...`);\n  };\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={onClose}\n     \n     \n      className=\"max-h-[90vh] overflow-hidden\"\n    >\n      <div className=\"flex flex-col h-full\">\n        {/* Event Header */}\n        <div className=\"p-6 border-b border-zinc-800\">\n          <div className=\"flex items-start space-x-4\">\n            <div className={`w-16 h-16 ${getEventTypeColor(event.type)} rounded-xl flex items-center justify-center text-2xl flex-shrink-0`}>\n              {getEventTypeIcon(event.type)}\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-start justify-between mb-2\">\n                <h2 className=\"text-2xl font-bold text-white leading-tight pr-4\">\n                  {event.title}\n                </h2>\n                <div className=\"flex items-center space-x-2 flex-shrink-0\">\n                  <Button\n                    variant=\"outline\"\n                    className={`max-w-sm ${event.isBookmarked ? 'text-[var(--hive-brand-primary)]' : 'text-zinc-400'}`}\n                    onClick={() => onBookmark(event.id)}\n                  >\n                    <Heart className={`h-5 w-5 ${event.isBookmarked ? 'fill-current' : ''}`} />\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    className=\"max-w-sm text-zinc-400 hover:text-white\"\n                    onClick={handleCopyLink}\n                    \n                  >\n                    {copiedLink ? (\n                      <CheckCircle className=\"h-5 w-5 text-green-400\" />\n                    ) : (\n                      <Share2 className=\"h-5 w-5\" />\n                    )}\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-3 text-sm text-zinc-400 mb-3\">\n                <div className=\"flex items-center space-x-1\">\n                  <span>{event.organizer.name}</span>\n                  {event.organizer.verified && (\n                    <Star className=\"h-4 w-4 text-[var(--hive-brand-primary)] fill-current\" />\n                  )}\n                </div>\n                {event.space && (\n                  <>\n                    <span>‚Ä¢</span>\n                    <span className=\"text-[var(--hive-brand-primary)]\">{event.space.name}</span>\n                  </>\n                )}\n                <span>‚Ä¢</span>\n                <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                  {event.type}\n                </Badge>\n              </div>\n\n              {/* Quick Stats */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                <div className=\"flex items-center space-x-2\">\n                  <Clock className=\"h-4 w-4 text-zinc-400\" />\n                  <div>\n                    <div className=\"text-white font-medium\">{dayText}</div>\n                    <div className=\"text-zinc-400\">{timeText}</div>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-2\">\n                  <MapPin className=\"h-4 w-4 text-zinc-400\" />\n                  <div>\n                    <div className=\"text-white font-medium\">{event.location.type === 'virtual' ? 'Virtual' : 'In-Person'}</div>\n                    <div className=\"text-zinc-400 truncate\">{event.location.name}</div>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-2\">\n                  <Users className=\"h-4 w-4 text-zinc-400\" />\n                  <div>\n                    <div className=\"text-white font-medium\">{event.capacity.current}/{event.capacity.max}</div>\n                    <div className=\"text-zinc-400\">attending</div>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-2\">\n                  <Zap className=\"h-4 w-4 text-zinc-400\" />\n                  <div>\n                    <div className=\"text-white font-medium\">{event.tools.length}</div>\n                    <div className=\"text-zinc-400\">tools</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* RSVP Actions */}\n          <div className=\"flex items-center justify-between mt-6 pt-4 border-t border-zinc-800\">\n            <div className=\"flex items-center space-x-3\">\n              {!isEventPast && (\n                <>\n                  <Button\n                    variant={event.rsvpStatus === 'going' ? 'default' : 'outline'}\n                    onClick={() => onRSVP(event.id, event.rsvpStatus === 'going' ? 'not_going' : 'going')}\n                    disabled={isEventFull && event.rsvpStatus !== 'going'}\n                    className=\"flex items-center space-x-2\"\n                  >\n                    <CheckCircle className=\"h-4 w-4\" />\n                    <span>Going ({event.engagement.going})</span>\n                  </Button>\n                  \n                  <Button\n                    variant={event.rsvpStatus === 'interested' ? 'default' : 'outline'}\n                    onClick={() => onRSVP(event.id, event.rsvpStatus === 'interested' ? 'not_going' : 'interested')}\n                  >\n                    <Star className=\"h-4 w-4\" />\n                    <span>Interested ({event.engagement.interested})</span>\n                  </Button>\n                </>\n              )}\n              \n              {isEventFull && event.rsvpStatus !== 'going' && (\n                <Badge variant=\"destructive\" className=\"flex items-center space-x-1\">\n                  <AlertTriangle className=\"h-3 w-3\" />\n                  <span>Event Full</span>\n                </Badge>\n              )}\n              \n              {isEventPast && (\n                <Badge variant=\"secondary\" className=\"flex items-center space-x-1\">\n                  <Clock className=\"h-3 w-3\" />\n                  <span>Event Ended</span>\n                </Badge>\n              )}\n            </div>\n\n            {isEventSoon && event.rsvpStatus === 'going' && (\n              <Badge variant=\"secondary\" className=\"animate-pulse\">\n                Starting Soon!\n              </Badge>\n            )}\n          </div>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"flex space-x-1 px-6 pt-4 border-b border-zinc-800\">\n          {[\n            { id: 'details', label: 'Details', icon: Calendar },\n            { id: 'tools', label: 'Tools', icon: Zap, count: event.tools.length },\n            { id: 'attendees', label: 'Attendees', icon: Users, count: event.capacity.current },\n            { id: 'discussion', label: 'Discussion', icon: MessageCircle, count: event.engagement.comments }\n          ].map((tab) => {\n            const Icon = tab.icon;\n            return (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id as any)}\n                className={`flex items-center space-x-2 px-4 py-2 rounded-t-lg transition-colors ${\n                  activeTab === tab.id\n                    ? 'bg-[var(--hive-brand-primary)] text-hive-obsidian font-medium'\n                    : 'text-zinc-400 hover:text-white hover:bg-zinc-800/50'\n                }`}\n              >\n                <Icon className=\"h-4 w-4\" />\n                <span>{tab.label}</span>\n                {tab.count !== undefined && (\n                  <Badge \n                    variant=\"secondary\" \n                    className={`text-xs ${activeTab === tab.id ? 'bg-hive-obsidian text-[var(--hive-brand-primary)]' : ''}`}\n                  >\n                    {tab.count}\n                  </Badge>\n                )}\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {/* Details Tab */}\n          {activeTab === 'details' && (\n            <div className=\"space-y-6\">\n              {/* Description */}\n              <div>\n                <h3 className=\"text-lg font-semibold text-white mb-3\">About this event</h3>\n                <p className=\"text-zinc-300 leading-relaxed\">{event.description}</p>\n              </div>\n\n              {/* Location Details */}\n              <div>\n                <h3 className=\"text-lg font-semibold text-white mb-3\">Location</h3>\n                <Card className=\"p-4 bg-zinc-800/50 border-zinc-700\">\n                  <div className=\"flex items-start space-x-3\">\n                    <MapPin className=\"h-5 w-5 text-zinc-400 mt-0.5\" />\n                    <div>\n                      <div className=\"font-medium text-white\">{event.location.name}</div>\n                      {event.location.address && (\n                        <div className=\"text-sm text-zinc-400 mt-1\">{event.location.address}</div>\n                      )}\n                      {event.location.virtualLink && (\n                        <div className=\"mt-2\">\n                          <Button\n                            variant=\"outline\"\n                            className=\"max-w-sm flex items-center space-x-2\"\n                            onClick={() => window.open(event.location.virtualLink, '_blank')}\n                          >\n                            <ExternalLink className=\"h-4 w-4\" />\n                            <span>Join Virtual Event</span>\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </Card>\n              </div>\n\n              {/* Requirements */}\n              {event.requirements && event.requirements.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-3\">Requirements</h3>\n                  <div className=\"space-y-2\">\n                    {event.requirements.map((req, index) => (\n                      <div key={index} className=\"flex items-center space-x-2 text-sm\">\n                        <CheckCircle className=\"h-4 w-4 text-green-400\" />\n                        <span className=\"text-zinc-300\">{req}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Tags */}\n              {event.tags.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-3\">Tags</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {event.tags.map((tag) => (\n                      <Badge key={tag} variant=\"secondary\">\n                        #{tag}\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Tools Tab */}\n          {activeTab === 'tools' && (\n            <EventToolIntegration\n              eventId={event.id}\n              availableTools={event.tools}\n              isEventActive={isEventSoon || (new Date(event.datetime.start) <= new Date() && new Date() <= new Date(event.datetime.end))}\n              userRole={event.organizer.id === currentUserId ? 'organizer' : event.rsvpStatus === 'going' ? 'attendee' : 'viewer'}\n              onToolLaunch={handleToolLaunch}\n            />\n          )}\n\n          {/* Attendees Tab */}\n          {activeTab === 'attendees' && (\n            <div className=\"space-y-6\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-semibold text-white\">\n                  Attendees ({event.capacity.current})\n                </h3>\n                <div className=\"flex items-center space-x-2\">\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {event.capacity.max - event.capacity.current} spots left\n                  </Badge>\n                  {event.organizer.id === currentUserId && (\n                    <Button variant=\"outline\" className=\"max-w-sm\">\n                      <UserPlus className=\"h-4 w-4 mr-1\" />\n                      Invite\n                    </Button>\n                  )}\n                </div>\n              </div>\n              \n              {/* Attendee List */}\n              <div className=\"space-y-4\">\n                {/* Going Attendees */}\n                <div>\n                  <h4 className=\"text-sm font-medium text-zinc-400 mb-3\">\n                    Going ({event.engagement.going})\n                  </h4>\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                    {/* Organizer */}\n                    <div className=\"flex items-center space-x-3 p-3 bg-zinc-800/50 rounded-lg\">\n                      <div className=\"w-10 h-10 bg-[var(--hive-brand-primary)] rounded-full flex items-center justify-center\">\n                        <span className=\"text-hive-obsidian font-semibold text-sm\">\n                          {event.organizer.name.split(' ').map(n => n[0]).join('')}\n                        </span>\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <span className=\"font-medium text-white\">{event.organizer.name}</span>\n                          {event.organizer.verified && (\n                            <Star className=\"h-3 w-3 text-[var(--hive-brand-primary)] fill-current\" />\n                          )}\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            Organizer\n                          </Badge>\n                        </div>\n                        <div className=\"text-sm text-zinc-400\">@{event.organizer.handle}</div>\n                      </div>\n                    </div>\n                    \n                    {/* Mock other attendees */}\n                    {Array.from({ length: Math.min(event.engagement.going - 1, 5) }, (_, i) => (\n                      <div key={i} className=\"flex items-center space-x-3 p-3 bg-zinc-800/50 rounded-lg\">\n                        <div className=\"w-10 h-10 bg-zinc-600 rounded-full flex items-center justify-center\">\n                          <span className=\"text-white font-semibold text-sm\">\n                            {String.fromCharCode(65 + i)}{String.fromCharCode(65 + ((i + 3) % 26))}\n                          </span>\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-white\">\n                            {['Alex Chen', 'Maria Rodriguez', 'David Kim', 'Sarah Johnson', 'Mike Wilson'][i]}\n                          </div>\n                          <div className=\"text-sm text-zinc-400\">\n                            @{['alexc', 'mariar', 'davidk', 'sarahj', 'mikew'][i]}\n                          </div>\n                        </div>\n                        {currentUserId === event.organizer.id && (\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400\">\n                            <MessageCircle className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    ))}\n                    \n                    {event.engagement.going > 6 && (\n                      <div className=\"flex items-center justify-center p-3 bg-zinc-800/30 rounded-lg border-2 border-dashed border-zinc-700\">\n                        <span className=\"text-zinc-400 text-sm\">\n                          +{event.engagement.going - 6} more attendees\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                \n                {/* Interested Attendees */}\n                {event.engagement.interested > 0 && (\n                  <div>\n                    <h4 className=\"text-sm font-medium text-zinc-400 mb-3\">\n                      Interested ({event.engagement.interested})\n                    </h4>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                      {Array.from({ length: Math.min(event.engagement.interested, 4) }, (_, i) => (\n                        <div key={i} className=\"flex items-center space-x-3 p-3 bg-zinc-800/30 rounded-lg\">\n                          <div className=\"w-10 h-10 bg-zinc-700 rounded-full flex items-center justify-center\">\n                            <Star className=\"h-4 w-4 text-yellow-400\" />\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-medium text-white\">\n                              {['Emma Davis', 'John Smith', 'Lisa Wang', 'Tom Brown'][i]}\n                            </div>\n                            <div className=\"text-sm text-zinc-400\">\n                              @{['emmad', 'johns', 'lisaw', 'tomb'][i]}\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                      \n                      {event.engagement.interested > 4 && (\n                        <div className=\"flex items-center justify-center p-3 bg-zinc-800/20 rounded-lg border-2 border-dashed border-zinc-700\">\n                          <span className=\"text-zinc-400 text-sm\">\n                            +{event.engagement.interested - 4} more interested\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n                \n                {/* Waitlist */}\n                {event.capacity.waitlist > 0 && (\n                  <div>\n                    <h4 className=\"text-sm font-medium text-zinc-400 mb-3\">\n                      Waitlist ({event.capacity.waitlist})\n                    </h4>\n                    <div className=\"text-center p-4 bg-zinc-800/30 rounded-lg border border-zinc-700\">\n                      <Clock className=\"h-8 w-8 text-zinc-500 mx-auto mb-2\" />\n                      <p className=\"text-sm text-zinc-400\">\n                        {event.capacity.waitlist} people waiting for spots to open up\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Discussion Tab */}\n          {activeTab === 'discussion' && (\n            <div className=\"space-y-6\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-semibold text-white\">\n                  Discussion ({event.engagement.comments})\n                </h3>\n                {event.organizer.id === currentUserId && (\n                  <Button variant=\"outline\" className=\"max-w-sm\">\n                    <Settings className=\"h-4 w-4 mr-1\" />\n                    Moderate\n                  </Button>\n                )}\n              </div>\n              \n              {/* Comment Input */}\n              <div className=\"flex items-start space-x-3 p-4 bg-zinc-800/30 rounded-lg\">\n                <div className=\"w-10 h-10 bg-zinc-600 rounded-full flex items-center justify-center flex-shrink-0\">\n                  <span className=\"text-white font-semibold text-sm\">You</span>\n                </div>\n                <div className=\"flex-1\">\n                  <textarea\n                    placeholder=\"Ask a question or share a comment...\"\n                    className=\"w-full p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white placeholder-zinc-400 focus:border-[var(--hive-brand-primary)] focus:outline-none resize-none\"\n                    rows={3}\n                  />\n                  <div className=\"flex items-center justify-between mt-2\">\n                    <div className=\"flex items-center space-x-2 text-xs text-zinc-400\">\n                      <span>üí° Ask about logistics, requirements, or coordination</span>\n                    </div>\n <Button className=\"max-w-sm bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\">\n                      Comment\n                    </Button>\n                  </div>\n                </div>\n              </div>\n              \n              {/* Comments List */}\n              <div className=\"space-y-4\">\n                {event.engagement.comments > 0 ? (\n                  <>\n                    {/* Sample Comments */}\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-start space-x-3 p-4 bg-zinc-800/20 rounded-lg\">\n                        <div className=\"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0\">\n                          <span className=\"text-white font-semibold text-sm\">AC</span>\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center space-x-2 mb-1\">\n                            <span className=\"font-medium text-white\">Alex Chen</span>\n                            <span className=\"text-xs text-zinc-400\">2 hours ago</span>\n                          </div>\n                          <p className=\"text-zinc-300 text-sm leading-relaxed\">\n                            Should I bring my own laptop or will there be computers available? Also, is there a specific IDE we should use for the coding exercises?\n                          </p>\n                          <div className=\"flex items-center space-x-4 mt-2\">\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              <Heart className=\"h-3 w-3 mr-1\" />\n                              3\n                            </Button>\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              Reply\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {/* Organizer Reply */}\n                      <div className=\"flex items-start space-x-3 p-4 bg-[var(--hive-brand-primary)]/5 border-l-2 border-[var(--hive-brand-primary)] rounded-lg ml-6\">\n                        <div className=\"w-10 h-10 bg-[var(--hive-brand-primary)] rounded-full flex items-center justify-center flex-shrink-0\">\n                          <span className=\"text-hive-obsidian font-semibold text-sm\">SC</span>\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center space-x-2 mb-1\">\n                            <span className=\"font-medium text-white\">{event.organizer.name}</span>\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              Organizer\n                            </Badge>\n                            <span className=\"text-xs text-zinc-400\">1 hour ago</span>\n                          </div>\n                          <p className=\"text-zinc-300 text-sm leading-relaxed\">\n                            Great question! Please bring your own laptop with your preferred IDE installed. We'll be using various languages so having your familiar setup will help. I've also added \"Laptop\" to the requirements list above.\n                          </p>\n                          <div className=\"flex items-center space-x-4 mt-2\">\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              <Heart className=\"h-3 w-3 mr-1\" />\n                              5\n                            </Button>\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              Reply\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-start space-x-3 p-4 bg-zinc-800/20 rounded-lg\">\n                        <div className=\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0\">\n                          <span className=\"text-white font-semibold text-sm\">MR</span>\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center space-x-2 mb-1\">\n                            <span className=\"font-medium text-white\">Maria Rodriguez</span>\n                            <span className=\"text-xs text-zinc-400\">45 minutes ago</span>\n                          </div>\n                          <p className=\"text-zinc-300 text-sm leading-relaxed\">\n                            Looking forward to this! I've been working through CLRS chapters 15-16. Are we focusing on any specific algorithms or should I review everything?\n                          </p>\n                          <div className=\"flex items-center space-x-4 mt-2\">\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              <Heart className=\"h-3 w-3 mr-1\" />\n                              2\n                            </Button>\n <Button variant=\"outline\" className=\"max-w-sm text-zinc-400 hover:text-white text-xs\">\n                              Reply\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {event.engagement.comments > 3 && (\n                      <div className=\"text-center\">\n                        <Button variant=\"outline\" className=\"max-w-sm\">\n                          Load {event.engagement.comments - 3} more comments\n                        </Button>\n                      </div>\n                    )}\n                  </>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <MessageCircle className=\"h-12 w-12 text-zinc-600 mx-auto mb-3\" />\n                    <p className=\"text-zinc-400\">No comments yet</p>\n                    <p className=\"text-sm text-zinc-500 mt-1\">\n                      Be the first to ask a question or share your thoughts\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/events/event-tool-integration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/events/events-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/feed/enhanced-event-card.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Heart' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatDistanceToNow' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isUpcoming' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":77,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Card, Button, Badge } from '@hive/ui';\nimport {\n  Calendar,\n  MapPin,\n  Users,\n  Clock,\n  Heart,\n  Share2,\n  Bookmark,\n  ExternalLink,\n  ChevronRight,\n  Star,\n  UserPlus\n} from 'lucide-react';\nimport { formatDistanceToNow, format } from 'date-fns';\n\ninterface EventCardProps {\n  event: {\n    id: string;\n    title: string;\n    description?: string;\n    startTime: string;\n    endTime?: string;\n    location?: string;\n    spaceName?: string;\n    spaceId?: string;\n    attendeeCount?: number;\n    isAttending?: boolean;\n    isBookmarked?: boolean;\n    tags?: string[];\n    imageUrl?: string;\n    organizer?: {\n      name: string;\n      handle?: string;\n    };\n  };\n  onRSVP: (eventId: string, attending: boolean) => Promise<void>;\n  onBookmark: (eventId: string) => Promise<void>;\n  onShare: (eventId: string) => Promise<void>;\n  onClick?: (eventId: string) => void;\n  isMobile?: boolean;\n  className?: string;\n}\n\nexport function EnhancedEventCard({\n  event,\n  onRSVP,\n  onBookmark,\n  onShare,\n  onClick,\n  isMobile = false,\n  className = ''\n}: EventCardProps) {\n  const [isHovered, setIsHovered] = useState(false);\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n  const [lastActionTime, setLastActionTime] = useState<number>(0);\n\n  // Rate limiting: Prevent actions more than once per 500ms\n  const isActionAllowed = () => {\n    const now = Date.now();\n    if (now - lastActionTime < 500) {\n      return false;\n    }\n    setLastActionTime(now);\n    return true;\n  };\n\n  // Calculate time relevance for styling\n  const eventTime = new Date(event.startTime);\n  const now = new Date();\n  const hoursUntilEvent = (eventTime.getTime() - now.getTime()) / (1000 * 60 * 60);\n\n  const isHappeningNow = hoursUntilEvent >= -1 && hoursUntilEvent <= 1;\n  const isUpcoming = hoursUntilEvent > 0 && hoursUntilEvent <= 24;\n  const isToday = hoursUntilEvent > 0 && hoursUntilEvent <= 24;\n\n  // Mobile swipe handling\n  const [touchStart, setTouchStart] = useState<number | null>(null);\n  const [touchEnd, setTouchEnd] = useState<number | null>(null);\n\n  const handleTouchStart = (e: React.TouchEvent) => {\n    // Security: Validate touch event and prevent potential injection\n    if (!e.targetTouches || e.targetTouches.length === 0) return;\n\n    const touch = e.targetTouches[0];\n    if (!touch || typeof touch.clientX !== 'number') return;\n\n    // Clamp values to screen bounds for security\n    const clampedX = Math.max(0, Math.min(touch.clientX, window.innerWidth || 2000));\n\n    setTouchEnd(null);\n    setTouchStart(clampedX);\n  };\n\n  const handleTouchMove = (e: React.TouchEvent) => {\n    // Security: Validate touch event\n    if (!e.targetTouches || e.targetTouches.length === 0) return;\n\n    const touch = e.targetTouches[0];\n    if (!touch || typeof touch.clientX !== 'number') return;\n\n    // Clamp values to screen bounds for security\n    const clampedX = Math.max(0, Math.min(touch.clientX, window.innerWidth || 2000));\n\n    setTouchEnd(clampedX);\n  };\n\n  const handleTouchEnd = () => {\n    if (!touchStart || !touchEnd) return;\n\n    const distance = touchStart - touchEnd;\n    const isLeftSwipe = distance > 50;   // Swipe left (start > end)\n    const isRightSwipe = distance < -50; // Swipe right (start < end)\n\n    // Correct swipe logic to match indicators:\n    // Left swipe (‚Üê) = bookmark, Right swipe (‚Üí) = RSVP\n    if (isLeftSwipe) {\n      handleBookmark(); // ‚Üê Swipe to bookmark\n    } else if (isRightSwipe) {\n      handleRSVP(); // Swipe to RSVP ‚Üí\n    }\n\n    // Reset touch state for security\n    setTouchStart(null);\n    setTouchEnd(null);\n  };\n\n  const handleRSVP = async () => {\n    if (!isActionAllowed() || actionLoading) return;\n\n    setActionLoading('rsvp');\n    try {\n      await onRSVP(event.id, !event.isAttending);\n    } catch (error) {\n      console.error('RSVP action failed:', error);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleBookmark = async () => {\n    if (!isActionAllowed() || actionLoading) return;\n\n    setActionLoading('bookmark');\n    try {\n      await onBookmark(event.id);\n    } catch (error) {\n      console.error('Bookmark action failed:', error);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleShare = async () => {\n    if (!isActionAllowed() || actionLoading) return;\n\n    setActionLoading('share');\n    try {\n      await onShare(event.id);\n    } catch (error) {\n      console.error('Share action failed:', error);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleCardClick = () => {\n    if (onClick && event.id) {\n      // Validate event ID to prevent XSS\n      const sanitizedId = String(event.id).replace(/[^a-zA-Z0-9_-]/g, '');\n      if (sanitizedId.length > 0 && sanitizedId.length < 100) {\n        onClick(sanitizedId);\n      }\n    }\n  };\n\n  // Sanitize display text to prevent XSS\n  const sanitizeText = (text: string | undefined): string => {\n    if (!text) return '';\n    return String(text)\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#x27;')\n      .slice(0, 500); // Limit length\n  };\n\n  const getTimeDisplay = () => {\n    if (isHappeningNow) {\n      return {\n        text: 'Happening Now',\n        color: 'text-green-400',\n        bg: 'bg-green-500/20'\n      };\n    } else if (hoursUntilEvent <= 2 && hoursUntilEvent > 0) {\n      return {\n        text: `In ${Math.round(hoursUntilEvent)}h`,\n        color: 'text-orange-400',\n        bg: 'bg-orange-500/20'\n      };\n    } else if (isToday) {\n      return {\n        text: `Today ${format(eventTime, 'h:mm a')}`,\n        color: 'text-blue-400',\n        bg: 'bg-blue-500/20'\n      };\n    } else {\n      return {\n        text: format(eventTime, 'MMM d, h:mm a'),\n        color: 'text-hive-text-secondary',\n        bg: 'bg-hive-background-overlay'\n      };\n    }\n  };\n\n  const timeDisplay = getTimeDisplay();\n\n  // Desktop hover preview\n  const renderHoverPreview = () => {\n    if (isMobile || !isHovered) return null;\n\n    return (\n      <div className=\"absolute top-full left-0 right-0 z-10 mt-2 p-4 bg-hive-surface border border-hive-border rounded-lg shadow-lg\">\n        {event.description && (\n          <p className=\"text-sm text-hive-text-secondary mb-3\">\n            {event.description}\n          </p>\n        )}\n\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <Button\n              onClick={handleRSVP}\n              disabled={actionLoading === 'rsvp'}\n              className={`max-w-sm ${\n                event.isAttending\n                  ? 'bg-green-500 hover:bg-green-600'\n                  : 'bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne'\n              }`}\n            >\n              {event.isAttending ? 'Going' : 'RSVP'}\n            </Button>\n\n            <Button\n              onClick={handleBookmark}\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              disabled={actionLoading === 'bookmark'}\n            >\n              <Bookmark className={`h-4 w-4 ${event.isBookmarked ? 'fill-current text-[var(--hive-brand-primary)]' : ''}`} />\n            </Button>\n\n            <Button\n              onClick={handleShare}\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              disabled={actionLoading === 'share'}\n            >\n              <Share2 className=\"h-4 w-4\" />\n            </Button>\n          </div>\n\n          <Button\n            onClick={handleCardClick}\n            variant=\"outline\"\n            className=\"max-w-sm\"\n          >\n            View Details\n            <ExternalLink className=\"h-4 w-4 ml-2\" />\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"relative\">\n      <Card\n        className={`group cursor-pointer transition-all duration-200 hover:border-[var(--hive-brand-primary)]/50 ${\n          isHappeningNow ? 'ring-2 ring-green-500/50' : ''\n        } ${className}`}\n        onMouseEnter={() => !isMobile && setIsHovered(true)}\n        onMouseLeave={() => !isMobile && setIsHovered(false)}\n        onTouchStart={isMobile ? handleTouchStart : undefined}\n        onTouchMove={isMobile ? handleTouchMove : undefined}\n        onTouchEnd={isMobile ? handleTouchEnd : undefined}\n        onClick={isMobile ? handleCardClick : undefined}\n      >\n        <div className=\"p-4\">\n          {/* Header */}\n          <div className=\"flex items-start justify-between mb-3\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center space-x-2 mb-1\">\n                <Badge className={`text-xs ${timeDisplay.bg} ${timeDisplay.color}`}>\n                  {timeDisplay.text}\n                </Badge>\n                {isHappeningNow && (\n                  <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\" />\n                )}\n              </div>\n\n              <h3 className=\"text-lg font-semibold text-hive-text-primary group-hover:text-[var(--hive-brand-primary)] transition-colors\">\n                {sanitizeText(event.title)}\n              </h3>\n\n              {event.spaceName && (\n                <p className=\"text-sm text-hive-text-secondary\">\n                  in {sanitizeText(event.spaceName)}\n                </p>\n              )}\n            </div>\n\n            {/* Quick Action - Mobile Only */}\n            {isMobile && (\n              <div className=\"flex items-center space-x-2\">\n                <Button\n                  onClick={(e: React.MouseEvent) => {\n                    e.stopPropagation();\n                    handleRSVP();\n                  }}\n                  className={`max-w-sm ${\n                    event.isAttending\n                      ? 'bg-green-500 hover:bg-green-600'\n                      : 'bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne'\n                  }`}\n                  disabled={actionLoading === 'rsvp'}\n                >\n                  {event.isAttending ? 'Going' : 'RSVP'}\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/* Event Details */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center text-sm text-hive-text-secondary\">\n              <Clock className=\"h-4 w-4 mr-2\" />\n              <span>\n                {format(eventTime, 'h:mm a')}\n                {event.endTime && ` - ${format(new Date(event.endTime), 'h:mm a')}`}\n              </span>\n            </div>\n\n            {event.location && (\n              <div className=\"flex items-center text-sm text-hive-text-secondary\">\n                <MapPin className=\"h-4 w-4 mr-2\" />\n                <span>{sanitizeText(event.location)}</span>\n              </div>\n            )}\n\n            {event.attendeeCount !== undefined && (\n              <div className=\"flex items-center text-sm text-hive-text-secondary\">\n                <Users className=\"h-4 w-4 mr-2\" />\n                <span>{event.attendeeCount} attending</span>\n              </div>\n            )}\n          </div>\n\n          {/* Tags */}\n          {event.tags && event.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-1 mt-3\">\n              {event.tags.slice(0, 3).map(tag => (\n                <Badge key={tag} variant=\"secondary\" className=\"text-xs\">\n                  {tag}\n                </Badge>\n              ))}\n              {event.tags.length > 3 && (\n                <Badge variant=\"secondary\" className=\"text-xs\">\n                  +{event.tags.length - 3}\n                </Badge>\n              )}\n            </div>\n          )}\n\n          {/* Mobile Swipe Indicators */}\n          {isMobile && (\n            <div className=\"flex items-center justify-between mt-3 text-xs text-hive-text-secondary\">\n              <span>‚Üê Swipe to bookmark</span>\n              <span>Swipe to RSVP ‚Üí</span>\n            </div>\n          )}\n\n          {/* Desktop Action Bar */}\n          {!isMobile && (\n            <div className=\"flex items-center justify-between mt-4 pt-3 border-t border-hive-border\">\n              <div className=\"flex items-center space-x-2\">\n                <button\n                  onClick={(e: React.MouseEvent) => {\n                    e.stopPropagation();\n                    handleBookmark();\n                  }}\n                  className={`p-2 rounded transition-colors ${\n                    event.isBookmarked\n                      ? 'text-[var(--hive-brand-primary)]'\n                      : 'text-hive-text-secondary hover:text-[var(--hive-brand-primary)]'\n                  }`}\n                  disabled={actionLoading === 'bookmark'}\n                >\n                  <Bookmark className={`h-4 w-4 ${event.isBookmarked ? 'fill-current' : ''}`} />\n                </button>\n\n                <button\n                  onClick={(e: React.MouseEvent) => {\n                    e.stopPropagation();\n                    handleShare();\n                  }}\n                  className=\"p-2 rounded text-hive-text-secondary hover:text-blue-400 transition-colors\"\n                  disabled={actionLoading === 'share'}\n                >\n                  <Share2 className=\"h-4 w-4\" />\n                </button>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Button\n                  onClick={(e: React.MouseEvent) => {\n                    e.stopPropagation();\n                    handleRSVP();\n                  }}\n                  className={`max-w-sm ${\n                    event.isAttending\n                      ? 'bg-green-500 hover:bg-green-600'\n                      : 'bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne'\n                  }`}\n                  disabled={actionLoading === 'rsvp'}\n                >\n                  {event.isAttending ? (\n                    <>\n                      <Star className=\"h-4 w-4 mr-2\" />\n                      Going\n                    </>\n                  ) : (\n                    <>\n                      <UserPlus className=\"h-4 w-4 mr-2\" />\n                      RSVP\n                    </>\n                  )}\n                </Button>\n\n                <Button\n                  onClick={handleCardClick}\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Desktop Hover Preview */}\n      {renderHoverPreview()}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/feed/ritual-horizontal-cards.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":11}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n/**\n * Ritual Horizontal Cards Component\n *\n * Displays rituals as swipeable horizontal cards instead of stories.\n * Used for competitions, collective challenges, and marketing.\n *\n * @educational This component uses the \"card\" pattern for content that needs\n * more information density than stories. Cards can show progress bars,\n * leaderboards, and multiple CTAs - perfect for complex rituals.\n */\n\nimport React, { useRef, useState } from 'react';\nimport { Card, Button, Badge, Progress } from '@hive/ui';\nimport {\n  Trophy,\n  Users,\n  Timer,\n  Sparkles,\n  ArrowRight,\n  ChevronLeft,\n  ChevronRight,\n  Zap,\n  TrendingUp,\n  Calendar,\n  Star,\n  Target,\n  Award\n} from 'lucide-react';\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Type Definitions\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nexport interface RitualCard {\n  id: string;\n  type: 'active' | 'upcoming' | 'completed' | 'marketing';\n\n  // Visual\n  title: string;\n  subtitle?: string;\n  description: string;\n  backgroundColor: string;\n  accentColor: string;\n  icon?: 'trophy' | 'users' | 'zap' | 'star' | 'target';\n  imageUrl?: string;\n\n  // Status\n  status?: 'live' | 'starting_soon' | 'ending_soon' | 'new';\n  timeRemaining?: string;\n  startTime?: Date;\n  endTime?: Date;\n\n  // Progress\n  progress?: {\n    current: number;\n    target: number;\n    percentage: number;\n    label?: string;\n  };\n\n  // Participation\n  participantCount?: number;\n  participantAvatars?: string[]; // First 3 participant avatars\n\n  // Competition specific\n  leaderboard?: Array<{\n    position: number;\n    name: string;\n    score: number;\n    avatar?: string;\n    isCurrentUser?: boolean;\n  }>;\n\n  // Collective specific\n  milestones?: Array<{\n    label: string;\n    reached: boolean;\n    value?: number;\n  }>;\n\n  // Rewards\n  rewards?: Array<{\n    icon: string;\n    label: string;\n    unlocked: boolean;\n  }>;\n\n  // Actions\n  primaryAction?: {\n    label: string;\n    onClick: () => void;\n    variant?: 'default' | 'secondary' | 'gold';\n    disabled?: boolean;\n  };\n\n  secondaryAction?: {\n    label: string;\n    onClick: () => void;\n  };\n}\n\ninterface RitualHorizontalCardsProps {\n  cards: RitualCard[];\n  className?: string;\n  onCardClick?: (card: RitualCard) => void;\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Icon Mapping\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nconst RITUAL_ICONS = {\n  trophy: Trophy,\n  users: Users,\n  zap: Zap,\n  star: Star,\n  target: Target,\n};\n\nconst STATUS_COLORS = {\n  live: 'bg-green-500',\n  starting_soon: 'bg-orange-500',\n  ending_soon: 'bg-red-500',\n  new: 'bg-purple-500',\n};\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Component\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nexport function RitualHorizontalCards({\n  cards,\n  className = '',\n  onCardClick\n}: RitualHorizontalCardsProps) {\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const [showLeftArrow, setShowLeftArrow] = useState(false);\n  const [showRightArrow, setShowRightArrow] = useState(true);\n\n  if (!cards || cards.length === 0) {\n    return null;\n  }\n\n  const handleScroll = () => {\n    if (!scrollContainerRef.current) return;\n\n    const { scrollLeft, scrollWidth, clientWidth } = scrollContainerRef.current;\n    setShowLeftArrow(scrollLeft > 0);\n    setShowRightArrow(scrollLeft < scrollWidth - clientWidth - 10);\n  };\n\n  const scroll = (direction: 'left' | 'right') => {\n    if (!scrollContainerRef.current) return;\n\n    const scrollAmount = 340; // Card width + gap\n    const currentScroll = scrollContainerRef.current.scrollLeft;\n    const newScroll = direction === 'left'\n      ? currentScroll - scrollAmount\n      : currentScroll + scrollAmount;\n\n    scrollContainerRef.current.scrollTo({\n      left: newScroll,\n      behavior: 'smooth'\n    });\n  };\n\n  const formatTimeRemaining = (time: string | Date | undefined): string => {\n    if (!time) return '';\n\n    const endTime = typeof time === 'string' ? new Date(time) : time;\n    const now = new Date();\n    const diff = endTime.getTime() - now.getTime();\n\n    if (diff <= 0) return 'Ended';\n\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const days = Math.floor(hours / 24);\n\n    if (days > 0) return `${days}d left`;\n    if (hours > 0) return `${hours}h left`;\n\n    const minutes = Math.floor(diff / (1000 * 60));\n    return `${minutes}m left`;\n  };\n\n  return (\n    <div className={`relative bg-hive-surface border-b border-hive-border ${className}`}>\n      <div className=\"max-w-7xl mx-auto px-6 py-4\">\n        {/* Section Header */}\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center gap-2\">\n            <Sparkles className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n            <h3 className=\"font-semibold text-hive-text-primary\">Active Rituals</h3>\n          </div>\n\n          {/* Navigation Arrows */}\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => scroll('left')}\n              className={`p-1 rounded-lg transition-opacity ${\n                showLeftArrow\n                  ? 'opacity-100 hover:bg-hive-background-overlay'\n                  : 'opacity-30 cursor-not-allowed'\n              }`}\n              disabled={!showLeftArrow}\n            >\n              <ChevronLeft className=\"h-5 w-5\" />\n            </button>\n            <button\n              onClick={() => scroll('right')}\n              className={`p-1 rounded-lg transition-opacity ${\n                showRightArrow\n                  ? 'opacity-100 hover:bg-hive-background-overlay'\n                  : 'opacity-30 cursor-not-allowed'\n              }`}\n              disabled={!showRightArrow}\n            >\n              <ChevronRight className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Cards Container */}\n        <div\n          ref={scrollContainerRef}\n          onScroll={handleScroll}\n          className=\"flex gap-4 overflow-x-auto scrollbar-hide scroll-smooth\"\n        >\n          {cards.map((card) => {\n            const Icon = card.icon ? RITUAL_ICONS[card.icon] : Trophy;\n\n            return (\n              <Card\n                key={card.id}\n                className=\"flex-shrink-0 w-80 overflow-hidden cursor-pointer hover:scale-[1.02] transition-transform\"\n                onClick={() => onCardClick?.(card)}\n                style={{\n                  background: `linear-gradient(135deg, ${card.backgroundColor}, ${card.accentColor})`\n                }}\n              >\n                <div className=\"p-6 text-white\">\n                  {/* Header */}\n                  <div className=\"flex justify-between items-start mb-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <Icon className=\"h-5 w-5\" />\n                        {card.status && (\n                          <Badge\n                            className={`${STATUS_COLORS[card.status]} text-white border-0 px-2 py-0.5 text-xs`}\n                          >\n                            {card.status.replace('_', ' ').toUpperCase()}\n                          </Badge>\n                        )}\n                      </div>\n                      <h3 className=\"text-lg font-bold\">{card.title}</h3>\n                      {card.subtitle && (\n                        <p className=\"text-sm opacity-90\">{card.subtitle}</p>\n                      )}\n                    </div>\n                    {card.timeRemaining && (\n                      <div className=\"flex items-center gap-1 bg-black/20 rounded-full px-2 py-1\">\n                        <Timer className=\"h-3 w-3\" />\n                        <span className=\"text-xs\">{formatTimeRemaining(card.timeRemaining)}</span>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Description */}\n                  <p className=\"text-sm opacity-90 mb-4\">{card.description}</p>\n\n                  {/* Progress Bar */}\n                  {card.progress && (\n                    <div className=\"mb-4\">\n                      <div className=\"flex justify-between text-xs mb-1 opacity-80\">\n                        <span>{card.progress.label || 'Progress'}</span>\n                        <span>{card.progress.percentage}%</span>\n                      </div>\n                      <Progress\n                        value={card.progress.percentage}\n                        className=\"h-2 bg-white/20\"\n                      />\n                      {card.progress.current !== undefined && (\n                        <p className=\"text-xs mt-1 opacity-70\">\n                          {card.progress.current.toLocaleString()} / {card.progress.target.toLocaleString()}\n                        </p>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Leaderboard */}\n                  {card.leaderboard && card.leaderboard.length > 0 && (\n                    <div className=\"mb-4 bg-black/20 rounded-lg p-3\">\n                      <div className=\"flex items-center gap-1 text-xs font-semibold mb-2 opacity-80\">\n                        <Trophy className=\"h-3 w-3\" />\n                        TOP SPACES\n                      </div>\n                      {card.leaderboard.slice(0, 3).map((entry) => (\n                        <div\n                          key={entry.position}\n                          className={`flex items-center justify-between py-1 text-sm ${\n                            entry.isCurrentUser ? 'text-[var(--hive-brand-primary)] font-semibold' : ''\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"opacity-70\">{entry.position}.</span>\n                            {entry.avatar && (\n                              <div className=\"w-4 h-4 rounded-full bg-white/30\" />\n                            )}\n                            <span className=\"truncate max-w-[140px]\">{entry.name}</span>\n                          </div>\n                          <span className=\"font-bold\">{entry.score.toLocaleString()}</span>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Milestones */}\n                  {card.milestones && card.milestones.length > 0 && (\n                    <div className=\"mb-4\">\n                      <div className=\"flex flex-wrap gap-2\">\n                        {card.milestones.map((milestone, index) => (\n                          <div\n                            key={index}\n                            className={`flex items-center gap-1 px-2 py-1 rounded-full text-xs ${\n                              milestone.reached\n                                ? 'bg-green-500/30 text-green-100'\n                                : 'bg-white/10 opacity-70'\n                            }`}\n                          >\n                            {milestone.reached ? (\n                              <Star className=\"h-3 w-3\" fill=\"currentColor\" />\n                            ) : (\n                              <Target className=\"h-3 w-3\" />\n                            )}\n                            <span>{milestone.label}</span>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Participation */}\n                  {card.participantCount !== undefined && (\n                    <div className=\"flex items-center gap-3 mb-4 text-sm\">\n                      <div className=\"flex items-center gap-1\">\n                        <Users className=\"h-4 w-4\" />\n                        <span>{card.participantCount.toLocaleString()} participating</span>\n                      </div>\n                      {card.participantAvatars && card.participantAvatars.length > 0 && (\n                        <div className=\"flex -space-x-2\">\n                          {card.participantAvatars.slice(0, 3).map((avatar, i) => (\n                            <div\n                              key={i}\n                              className=\"w-6 h-6 rounded-full bg-white/30 border-2 border-white/20\"\n                            />\n                          ))}\n                          {card.participantCount > 3 && (\n                            <div className=\"w-6 h-6 rounded-full bg-black/30 border-2 border-white/20 flex items-center justify-center\">\n                              <span className=\"text-[10px]\">+{card.participantCount - 3}</span>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Rewards */}\n                  {card.rewards && card.rewards.length > 0 && (\n                    <div className=\"mb-4\">\n                      <div className=\"flex gap-3\">\n                        {card.rewards.map((reward, index) => (\n                          <div\n                            key={index}\n                            className={`flex flex-col items-center ${\n                              reward.unlocked ? 'opacity-100' : 'opacity-50'\n                            }`}\n                          >\n                            <Award className=\"h-6 w-6 mb-1\" />\n                            <span className=\"text-[10px]\">{reward.label}</span>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Actions */}\n                  <div className=\"flex gap-2\">\n                    {card.primaryAction && (\n                      <Button\n                        onClick={(e: React.MouseEvent) => {\n                          e.stopPropagation();\n                          card.primaryAction!.onClick();\n                        }}\n                        disabled={card.primaryAction.disabled}\n                        className={`max-w-sm flex-1 ${\n                          card.primaryAction.variant === 'gold'\n                            ? 'bg-[var(--hive-brand-primary)] text-black hover:bg-hive-champagne'\n                            : 'bg-white/20 hover:bg-white/30 text-white border-white/40'\n                        }`}\n                      >\n                        {card.primaryAction.label}\n                        <ArrowRight className=\"h-4 w-4 ml-2\" />\n                      </Button>\n                    )}\n                    {card.secondaryAction && (\n                      <Button\n                        onClick={(e: React.MouseEvent) => {\n                          e.stopPropagation();\n                          card.secondaryAction!.onClick();\n                        }}\n                        variant=\"outline\"\n                        className=\"max-w-sm text-white hover:bg-white/10\"\n                      >\n                        {card.secondaryAction.label}\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n\n          {/* Marketing Card Example */}\n          <Card className=\"flex-shrink-0 w-80 bg-gradient-to-br from-hive-gold/20 to-hive-champagne/20 border-[var(--hive-brand-primary)]/30\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <Zap className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n                <Badge className=\"bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-0\">NEW</Badge>\n              </div>\n              <h3 className=\"text-lg font-bold text-hive-text-primary mb-2\">\n                Build Campus Tools\n              </h3>\n              <p className=\"text-sm text-hive-text-secondary mb-4\">\n                Create tools that affect everyone on campus with HiveLab\n              </p>\n              <Button\n                onClick={() => window.location.href = '/hivelab'}\n                className=\"max-w-sm w-full bg-[var(--hive-brand-primary)] text-black hover:bg-hive-champagne\"\n              >\n                Explore HiveLab\n                <ArrowRight className=\"h-4 w-4 ml-2\" />\n              </Button>\n            </div>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/feed/ritual-stories-strip.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timer' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedRitual' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":65,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card, Badge } from '@hive/ui';\nimport {\n  Sparkles,\n  Users,\n  Trophy,\n  Calendar,\n  Star,\n  Zap,\n  Heart,\n  Play,\n  CheckCircle,\n  Timer,\n  ChevronRight\n} from 'lucide-react';\n\ninterface Ritual {\n  id: string;\n  name: string;\n  title: string;\n  description: string;\n  type: 'onboarding' | 'seasonal' | 'achievement' | 'community' | 'creative' | 'emergency' | 'legacy';\n  status: 'active' | 'upcoming' | 'completed';\n  startTime?: string;\n  endTime?: string;\n  participation?: {\n    progressPercentage: number;\n    status: 'joined' | 'active' | 'completed';\n  };\n  metrics: {\n    participationRate: number;\n    engagementScore: number;\n  };\n}\n\ninterface RitualStoriesStripProps {\n  rituals: Ritual[];\n  onRitualClick: (ritual: Ritual) => void;\n  className?: string;\n}\n\nconst RITUAL_ICONS = {\n  onboarding: Sparkles,\n  seasonal: Calendar,\n  achievement: Trophy,\n  community: Users,\n  creative: Star,\n  emergency: Zap,\n  legacy: Heart\n};\n\nconst RITUAL_COLORS = {\n  onboarding: 'from-purple-500 to-pink-500',\n  seasonal: 'from-orange-500 to-red-500',\n  achievement: 'from-yellow-500 to-orange-500',\n  community: 'from-blue-500 to-purple-500',\n  creative: 'from-pink-500 to-purple-500',\n  emergency: 'from-red-500 to-orange-500',\n  legacy: 'from-green-500 to-blue-500'\n};\n\nexport function RitualStoriesStrip({ rituals, onRitualClick, className = '' }: RitualStoriesStripProps) {\n  const [selectedRitual, setSelectedRitual] = useState<string | null>(null);\n\n  if (!rituals || rituals.length === 0) {\n    return null; // Hide strip when no rituals\n  }\n\n  const handleRitualClick = (ritual: Ritual) => {\n    setSelectedRitual(ritual.id);\n    onRitualClick(ritual);\n  };\n\n  const formatTimeRemaining = (endTime: string) => {\n    const end = new Date(endTime);\n    const now = new Date();\n    const diff = end.getTime() - now.getTime();\n\n    if (diff <= 0) return 'Ended';\n\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const days = Math.floor(hours / 24);\n\n    if (days > 0) return `${days}d remaining`;\n    return `${hours}h remaining`;\n  };\n\n  return (\n    <div className={`bg-hive-surface border-b border-hive-border ${className}`}>\n      <div className=\"max-w-2xl mx-auto px-6 py-4\">\n        {/* Stories Strip */}\n        <div className=\"flex items-center space-x-4 overflow-x-auto scrollbar-hide\">\n          {rituals.map((ritual) => {\n            const RitualIcon = RITUAL_ICONS[ritual.type];\n            const gradientColor = RITUAL_COLORS[ritual.type];\n            const isActive = ritual.status === 'active';\n            const isCompleted = ritual.participation?.status === 'completed';\n            const hasProgress = ritual.participation && ritual.participation.progressPercentage > 0;\n\n            return (\n              <div key={ritual.id} className=\"flex-shrink-0\">\n                <button\n                  onClick={() => handleRitualClick(ritual)}\n                  className=\"relative flex flex-col items-center space-y-2 group\"\n                >\n                  {/* Story Ring */}\n                  <div className={`relative w-16 h-16 rounded-full p-0.5 ${\n                    isActive && hasProgress\n                      ? `bg-gradient-to-r ${gradientColor}`\n                      : isCompleted\n                      ? 'bg-gradient-to-r from-green-500 to-emerald-500'\n                      : 'bg-hive-border'\n                  }`}>\n                    {/* Progress Ring for Active Rituals */}\n                    {isActive && hasProgress && (\n                      <svg className=\"absolute inset-0 w-16 h-16 transform -rotate-90\">\n                        <circle\n                          cx=\"32\"\n                          cy=\"32\"\n                          r=\"28\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2\"\n                          fill=\"none\"\n                          className=\"text-hive-surface\"\n                        />\n                        <circle\n                          cx=\"32\"\n                          cy=\"32\"\n                          r=\"28\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2\"\n                          fill=\"none\"\n                          strokeDasharray={`${(ritual.participation!.progressPercentage / 100) * 175.93} 175.93`}\n                          className=\"text-white\"\n                        />\n                      </svg>\n                    )}\n\n                    {/* Icon Container */}\n                    <div className=\"w-full h-full bg-hive-background rounded-full flex items-center justify-center\">\n                      {isCompleted ? (\n                        <CheckCircle className=\"h-8 w-8 text-green-400\" />\n                      ) : (\n                        <RitualIcon className={`h-8 w-8 ${\n                          isActive ? 'text-white' : 'text-hive-text-secondary'\n                        }`} />\n                      )}\n                    </div>\n\n                    {/* Status Indicator */}\n                    {isActive && (\n                      <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-hive-surface flex items-center justify-center\">\n                        <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\" />\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Ritual Name */}\n                  <div className=\"text-center max-w-[80px]\">\n                    <p className=\"text-xs font-medium text-hive-text-primary truncate\">\n                      {ritual.name}\n                    </p>\n                    {isActive && ritual.endTime && (\n                      <p className=\"text-xs text-hive-text-secondary\">\n                        {formatTimeRemaining(ritual.endTime)}\n                      </p>\n                    )}\n                    {ritual.status === 'upcoming' && (\n                      <p className=\"text-xs text-orange-400\">\n                        Coming Soon\n                      </p>\n                    )}\n                  </div>\n                </button>\n              </div>\n            );\n          })}\n\n          {/* View All Rituals Button */}\n          <div className=\"flex-shrink-0 ml-2\">\n            <button\n              onClick={() => window.location.href = '/rituals'}\n              className=\"flex flex-col items-center space-y-2 group\"\n            >\n              <div className=\"w-16 h-16 border-2 border-dashed border-hive-border rounded-full flex items-center justify-center group-hover:border-[var(--hive-brand-primary)] transition-colors\">\n                <ChevronRight className=\"h-6 w-6 text-hive-text-secondary group-hover:text-[var(--hive-brand-primary)] transition-colors\" />\n              </div>\n              <p className=\"text-xs text-hive-text-secondary group-hover:text-[var(--hive-brand-primary)] transition-colors\">\n                View All\n              </p>\n            </button>\n          </div>\n        </div>\n\n        {/* Active Ritual Quick Info */}\n        {rituals.some(r => r.status === 'active') && (\n          <div className=\"mt-4 p-3 bg-hive-background-overlay rounded-lg\">\n            {rituals\n              .filter(r => r.status === 'active')\n              .slice(0, 1)\n              .map(ritual => (\n                <div key={ritual.id} className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Play className=\"h-4 w-4 text-[var(--hive-brand-primary)]\" />\n                      <span className=\"text-sm font-medium text-hive-text-primary\">\n                        {ritual.title}\n                      </span>\n                    </div>\n                    {ritual.metrics?.participationRate !== undefined && (\n                      <Badge className=\"text-xs bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)]\">\n                        {Math.round(ritual.metrics.participationRate)}% participating\n                      </Badge>\n                    )}\n                  </div>\n\n                  <button\n                    onClick={() => handleRitualClick(ritual)}\n                    className=\"text-sm text-[var(--hive-brand-primary)] hover:text-hive-champagne transition-colors\"\n                  >\n                    {ritual.participation?.status === 'active' ? 'Continue' : 'Join'}\n                  </button>\n                </div>\n              ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/feedback-toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/3d/CorkBoard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/3d/FloatingText.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/3d/PostItNote.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useFrame' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useRef, useState } from \"react\";\nimport { useFrame } from \"@react-three/fiber\";\nimport { Text } from \"@react-three/drei\";\nimport * as THREE from \"three\";\nimport { animated, useSpring } from \"@react-spring/three\";\n\n/**\n * PostItNote - Interactive 3D Post-It Component\n *\n * Features:\n * - Hover: Floats up and casts stronger shadow\n * - Click: Flips 180¬∞ to reveal back message\n * - Slight curl at corners (vertex displacement)\n * - Pastel color variants\n */\n\ninterface PostItNoteProps {\n  position: [number, number, number];\n  rotation?: [number, number, number];\n  color?: string;\n  frontText: string;\n  backText?: string;\n  size?: [number, number];\n}\n\nconst AnimatedMesh = animated(\"mesh\");\n\nexport function PostItNote({\n  position,\n  rotation = [0, 0, 0],\n  color = \"#FFE97F\",\n  frontText,\n  backText = \"‚ú® Easter egg!\",\n  size = [0.8, 0.8],\n}: PostItNoteProps) {\n  const meshRef = useRef<THREE.Mesh>(null);\n  const [hovered, setHovered] = useState(false);\n  const [flipped, setFlipped] = useState(false);\n\n  // Spring animation for hover and flip\n  const { positionZ, rotationY, scale } = useSpring({\n    positionZ: hovered ? position[2] + 0.3 : position[2],\n    rotationY: flipped ? Math.PI : 0,\n    scale: hovered ? 1.05 : 1,\n    config: { tension: 300, friction: 20 },\n  });\n\n  return (\n    <group position={position} rotation={rotation}>\n      {/* Post-it Note Body */}\n      <AnimatedMesh\n        ref={meshRef}\n        castShadow\n        receiveShadow\n        // @ts-ignore - react-spring types\n        position-z={positionZ}\n        // @ts-ignore\n        rotation-y={rotationY}\n        // @ts-ignore\n        scale={scale}\n        onPointerEnter={() => setHovered(true)}\n        onPointerLeave={() => setHovered(false)}\n        onClick={() => setFlipped(!flipped)}\n      >\n        {/* Thin box geometry for paper thickness */}\n        <boxGeometry args={[...size, 0.02]} />\n\n        {/* Paper material - pastel color */}\n        <meshStandardMaterial\n          color={color}\n          roughness={0.6}\n          metalness={0.0}\n          side={THREE.DoubleSide}\n        />\n      </AnimatedMesh>\n\n      {/* Front Text */}\n      <Text\n        position={[0, 0, position[2] + 0.02]}\n        rotation={rotation}\n        fontSize={0.12}\n        color=\"#333\"\n        anchorX=\"center\"\n        anchorY=\"middle\"\n        maxWidth={size[0] * 0.8}\n      >\n        {!flipped ? frontText : \"\"}\n      </Text>\n\n      {/* Back Text (visible when flipped) */}\n      <Text\n        position={[0, 0, position[2] - 0.02]}\n        rotation={[rotation[0], rotation[1] + Math.PI, rotation[2]]}\n        fontSize={0.12}\n        color=\"#333\"\n        anchorX=\"center\"\n        anchorY=\"middle\"\n        maxWidth={size[0] * 0.8}\n      >\n        {flipped ? backText : \"\"}\n      </Text>\n    </group>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/3d/PushPin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/3d/Scene.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/landing/ui/WaitlistForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/lazy-page-loader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lazy' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Suspense' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'context' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":87,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { lazy, Suspense } from 'react';\n\n// Lazy load page components for better performance\n// const LazyProfilePage = lazy(() => import('../app/(dashboard)/profile/page')); // Deleted in refactor\n// const LazySpacesPage = lazy(() => import('../app/(dashboard)/spaces/page'));\n// const LazySpaceDetailsPage = lazy(() => import('../app/(dashboard)/spaces/[spaceId]/page'));\n// const LazyToolsPage = lazy(() => import('../app/(dashboard)/tools/page'));\n// const LazyToolDetailsPage = lazy(() => import('../app/(dashboard)/tools/[toolId]/run/page'));\n// const LazyFeedPage = lazy(() => import('../app/(dashboard)/feed/page'));\n// const LazyCalendarPage = lazy(() => import('../app/(dashboard)/calendar/page'));\n// const LazySettingsPage = lazy(() => import('../app/(dashboard)/settings/page'));\n\n// Loading fallback component\nconst LoadingFallback = ({ pageName }: { pageName: string }) => (\n  <div className=\"min-h-screen flex items-center justify-center\">\n    <div className=\"text-center space-y-4\">\n      <div className=\"w-8 h-8 border-2 border-[var(--hive-brand-primary)] border-t-transparent rounded-full animate-spin mx-auto\"></div>\n      <p className=\"text-hive-text-secondary\">Loading {pageName}...</p>\n    </div>\n  </div>\n);\n\n// Lazy page components with React Suspense\n// Commented out - profile page deleted in refactor\n// export const LazyProfilePageWithSuspense = ({ userId, userName }: { userId?: string; userName?: string }) => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Profile\" />}>\n//     <LazyProfilePage />\n//   </Suspense>\n// );\n\n// Commented out - these pages have been removed\n// export const LazySpacesPageWithSuspense = () => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Spaces\" />}>\n//     <LazySpacesPage />\n//   </Suspense>\n// );\n\n// export const LazySpaceDetailsPageWithSuspense = ({ spaceId }: { spaceId: string }) => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Space Details\" />}>\n//     <LazySpaceDetailsPage params={Promise.resolve({ spaceId })} />\n//   </Suspense>\n// );\n\n// export const LazyToolsPageWithSuspense = () => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Tools\" />}>\n//     <LazyToolsPage />\n//   </Suspense>\n// );\n\n// export const LazyToolDetailsPageWithSuspense = ({ toolId }: { toolId: string }) => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Tool\" />}>\n//     <LazyToolDetailsPage />\n//   </Suspense>\n// );\n\n// export const LazyFeedPageWithSuspense = () => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Feed\" />}>\n//     <LazyFeedPage />\n//   </Suspense>\n// );\n\n// export const LazyCalendarPageWithSuspense = () => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Calendar\" />}>\n//     <LazyCalendarPage />\n//   </Suspense>\n// );\n\n// export const LazySettingsPageWithSuspense = () => (\n//   <Suspense fallback={<LoadingFallback pageName=\"Settings\" />}>\n//     <LazySettingsPage />\n//   </Suspense>\n// );\n\n// Generic lazy loader with context\ninterface LazyPageLoaderProps {\n  pageType: 'profile' | 'spaces' | 'space-details' | 'tools' | 'tool-details' | 'feed' | 'calendar' | 'settings';\n  context?: {\n    userId?: string;\n    userName?: string;\n    spaceId?: string;\n    toolId?: string;\n  };\n}\n\nexport function LazyPageLoader({ pageType, context }: LazyPageLoaderProps) {\n  switch (pageType) {\n    case 'profile':\n      return <LoadingFallback pageName=\"Profile\" />; // Profile page was deleted\n    case 'spaces':\n    case 'space-details':\n    case 'tools':\n    case 'tool-details':\n    case 'feed':\n    case 'calendar':\n    case 'settings':\n      // These pages have been removed - fallback to profile\n      return <LoadingFallback pageName=\"Page Unavailable\" />;\n    default:\n      return <LoadingFallback pageName=\"Profile\" />; // Profile page was deleted\n  }\n}\n\nexport default LazyPageLoader;","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/loading/feed-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/notifications/hive-notification-bell.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'markAsRead' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":35,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'markAllAsRead' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":36,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteNotification' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clearAll' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":38,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n/**\n * üîî HIVE Production Notification Bell\n *\n * Integrates the @hive/ui notification system with real Firebase data\n * and behavioral psychology patterns for the HIVE platform.\n */\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { NotificationSystem } from '@hive/ui';\nimport { useRealtimeNotifications } from '@/hooks/use-realtime-notifications';\nimport { logger } from '@/lib/logger';\n\nexport interface HiveNotificationBellProps {\n  /** Custom className */\n  className?: string;\n  /** Disabled state */\n  disabled?: boolean;\n}\n\nexport const HiveNotificationBell: React.FC<HiveNotificationBellProps> = ({\n  className,\n  disabled = false,\n}) => {\n  const router = useRouter();\n\n  // Real-time notification data from Firebase\n  const {\n    notifications,\n    unreadCount,\n    loading,\n    error,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n    clearAll,\n  } = useRealtimeNotifications();\n\n  // Handle navigation to notification targets\n  const handleNavigate = (url: string) => {\n    try {\n      // Log navigation for behavioral analytics\n      logger.info('Notification navigation', {\n        url,\n        source: 'notification_bell',\n        unreadCount,\n        timestamp: new Date().toISOString(),\n      });\n\n      // Navigate using Next.js router\n      router.push(url);\n    } catch (error) {\n      logger.error('Navigation error from notification', { error: error instanceof Error ? error.message : String(error), url });\n    }\n  };\n\n  // Transform Firebase notifications to UI format\n  const transformedNotifications = notifications.map(notification => ({\n    ...notification,\n    timestamp: {\n      toDate: () => notification.timestamp.toDate(),\n    },\n  }));\n\n  return (\n    <NotificationSystem\n      notifications={transformedNotifications}\n      unreadCount={unreadCount}\n      loading={loading}\n      error={error}\n      onNavigate={handleNavigate}\n      className={className}\n      disabled={disabled}\n    />\n  );\n};\n\nexport default HiveNotificationBell;","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/onboarding/space-creation-preview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/optimized-image.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/ProfileContextProvider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PresenceData' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":79,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLastSeen' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":89,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":89,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'handleToggleGhostMode'. Either include it or remove the dependency array.","line":202,"column":7,"nodeType":"ArrayExpression","endLine":202,"endColumn":90,"suggestions":[{"desc":"Update the dependencies array to be: [profileHook.profile, profileHook.dashboard, profileHook.isLoading, profileHook.isUpdating, profileHook.error, profileHook.completeness, profileHook.loadProfile, profileHook.updateProfile, profileHook.uploadAvatar, profileHook.refreshDashboard, profileHook.clearError, profileHook.createEvent, profileHook.updateEvent, profileHook.deleteEvent, profileHook.getCalendarEvents, profileHook.detectConflicts, profileHook.resolveConflict, unifiedProfile, profileSystem, presenceStatus, lastSeen, isGhostMode, handleToggleGhostMode]","fix":{"range":[6556,6639],"text":"[profileHook.profile, profileHook.dashboard, profileHook.isLoading, profileHook.isUpdating, profileHook.error, profileHook.completeness, profileHook.loadProfile, profileHook.updateProfile, profileHook.uploadAvatar, profileHook.refreshDashboard, profileHook.clearError, profileHook.createEvent, profileHook.updateEvent, profileHook.deleteEvent, profileHook.getCalendarEvents, profileHook.detectConflicts, profileHook.resolveConflict, unifiedProfile, profileSystem, presenceStatus, lastSeen, isGhostMode, handleToggleGhostMode]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\n/**\n * Unified Profile Context Provider\n * Bridges useHiveProfile hook with @hive/ui component ecosystem\n * Provides both HiveProfile and ProfileSystem formats for maximum compatibility\n */\n\nimport React, { createContext, useContext, useMemo, ReactNode, useEffect, useState } from 'react';\nimport { useHiveProfile, UseHiveProfileReturn } from '@/hooks/use-hive-profile';\nimport { toUnifiedProfile, toProfileSystem, createMockProfileSystem } from '@/lib/profile-transformers';\nimport type { HiveProfile, UnifiedHiveProfile, ProfileSystem } from '@hive/core';\nimport { presenceService, type PresenceData } from '@hive/core';\nimport { useAuth } from '@hive/auth-logic';\nimport { PresenceStatus } from \"@hive/ui\";\n\ninterface ProfileContextValue {\n  // Raw HiveProfile data (for API compatibility)\n  hiveProfile: HiveProfile | null;\n\n  // Unified profile data (modern format)\n  unifiedProfile: UnifiedHiveProfile | null;\n\n  // Transformed ProfileSystem data (for @hive/ui components)\n  profileSystem: ProfileSystem | null;\n\n  // Dashboard data\n  dashboard: UseHiveProfileReturn['dashboard'];\n\n  // Presence data\n  presenceStatus: PresenceStatus;\n  lastSeen: Date | null;\n  isGhostMode: boolean;\n\n  // State management\n  isLoading: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  completeness: number;\n\n  // Actions (pass-through from useHiveProfile)\n  loadProfile: UseHiveProfileReturn['loadProfile'];\n  updateProfile: UseHiveProfileReturn['updateProfile'];\n  uploadAvatar: UseHiveProfileReturn['uploadAvatar'];\n  toggleGhostMode: UseHiveProfileReturn['toggleGhostMode'];\n  refreshDashboard: UseHiveProfileReturn['refreshDashboard'];\n  clearError: UseHiveProfileReturn['clearError'];\n\n  // Calendar actions\n  createEvent: UseHiveProfileReturn['createEvent'];\n  updateEvent: UseHiveProfileReturn['updateEvent'];\n  deleteEvent: UseHiveProfileReturn['deleteEvent'];\n  getCalendarEvents: UseHiveProfileReturn['getCalendarEvents'];\n  detectConflicts: UseHiveProfileReturn['detectConflicts'];\n  resolveConflict: UseHiveProfileReturn['resolveConflict'];\n}\n\nconst ProfileContext = createContext<ProfileContextValue | null>(null);\n\ninterface ProfileContextProviderProps {\n  children: ReactNode;\n  /**\n   * Optional user ID for viewing other profiles\n   * If not provided, uses current authenticated user\n   */\n  userId?: string;\n  /**\n   * Whether this is a public profile view (read-only)\n   */\n  isPublicView?: boolean;\n  /**\n   * Mock data for development/testing\n   */\n  mockData?: ProfileSystem;\n}\n\nexport function ProfileContextProvider({\n  children,\n  userId,\n  isPublicView = false,\n  mockData\n}: ProfileContextProviderProps) {\n  // Use the existing useHiveProfile hook for data management\n  const profileHook = useHiveProfile();\n  const { user } = useAuth();\n\n  // Presence state\n  const [presenceStatus, setPresenceStatus] = useState<PresenceStatus>('offline');\n  const [lastSeen, setLastSeen] = useState<Date | null>(null);\n  const [isGhostMode, setIsGhostMode] = useState(false);\n\n  // Initialize presence tracking\n  useEffect(() => {\n    if (user && !isPublicView) {\n      // Initialize presence for current user\n      presenceService.initializePresence(user, 'ub-buffalo').then(() => {\n        setPresenceStatus('online');\n      });\n\n      // Set up activity monitoring\n      const handleActivity = () => {\n        if (presenceStatus === 'away' && !isGhostMode) {\n          presenceService.updateStatus('online');\n          setPresenceStatus('online');\n        }\n      };\n\n      // Monitor user activity\n      window.addEventListener('mousemove', handleActivity);\n      window.addEventListener('keypress', handleActivity);\n\n      return () => {\n        window.removeEventListener('mousemove', handleActivity);\n        window.removeEventListener('keypress', handleActivity);\n        presenceService.cleanup();\n      };\n    }\n  }, [user, isPublicView, presenceStatus, isGhostMode]);\n\n  // Create unified profile with advanced features\n  const unifiedProfile = useMemo(() => {\n    // If no profile data yet, return null\n    if (!profileHook.profile) {\n      return null;\n    }\n\n    // Convert to unified profile system\n    try {\n      return toUnifiedProfile(profileHook.profile);\n    } catch (error) {\n      console.error('Failed to create unified profile:', error);\n      return null;\n    }\n  }, [profileHook.profile]);\n\n  // Transform to ProfileSystem format for @hive/ui components\n  const profileSystem = useMemo(() => {\n    // Use mock data if provided (for development/testing)\n    if (mockData) {\n      return mockData;\n    }\n\n    // If no unified profile, return null\n    if (!unifiedProfile) {\n      return null;\n    }\n\n    // Transform UnifiedProfile to ProfileSystem\n    try {\n      return toProfileSystem(unifiedProfile);\n    } catch (error) {\n      console.error('Failed to transform to ProfileSystem:', error);\n      // Fallback to mock data structure to prevent UI crashes\n      return createMockProfileSystem(unifiedProfile.identity.id);\n    }\n  }, [unifiedProfile, mockData]);\n\n  // Handle ghost mode toggle with presence service\n  const handleToggleGhostMode = async () => {\n    const newGhostMode = !isGhostMode;\n    setIsGhostMode(newGhostMode);\n    await presenceService.toggleGhostMode(newGhostMode);\n    setPresenceStatus(newGhostMode ? 'ghost' : 'online');\n    // Also call the original toggleGhostMode for profile update\n    await profileHook.toggleGhostMode();\n  };\n\n  // Create context value with all necessary data and actions\n  const contextValue: ProfileContextValue = useMemo(() => ({\n    // Data\n    hiveProfile: profileHook.profile,\n    unifiedProfile,\n    profileSystem,\n    dashboard: profileHook.dashboard,\n\n    // Presence data\n    presenceStatus,\n    lastSeen,\n    isGhostMode,\n\n    // State\n    isLoading: profileHook.isLoading,\n    isUpdating: profileHook.isUpdating,\n    error: profileHook.error,\n    completeness: profileHook.completeness,\n\n    // Actions (pass-through from hook, with presence-aware ghost mode)\n    loadProfile: profileHook.loadProfile,\n    updateProfile: profileHook.updateProfile,\n    uploadAvatar: profileHook.uploadAvatar,\n    toggleGhostMode: handleToggleGhostMode,\n    refreshDashboard: profileHook.refreshDashboard,\n    clearError: profileHook.clearError,\n\n    // Calendar actions\n    createEvent: profileHook.createEvent,\n    updateEvent: profileHook.updateEvent,\n    deleteEvent: profileHook.deleteEvent,\n    getCalendarEvents: profileHook.getCalendarEvents,\n    detectConflicts: profileHook.detectConflicts,\n    resolveConflict: profileHook.resolveConflict\n  }), [profileHook, unifiedProfile, profileSystem, presenceStatus, lastSeen, isGhostMode]);\n\n  return (\n    <ProfileContext.Provider value={contextValue}>\n      {children}\n    </ProfileContext.Provider>\n  );\n}\n\n/**\n * Hook to access profile context\n * Provides both HiveProfile and ProfileSystem formats\n */\nexport function useProfileContext(): ProfileContextValue {\n  const context = useContext(ProfileContext);\n\n  if (!context) {\n    throw new Error('useProfileContext must be used within a ProfileContextProvider');\n  }\n\n  return context;\n}\n\n/**\n * Hook to access ProfileSystem data specifically\n * Convenience hook for @hive/ui components\n */\nexport function useProfileSystem(): ProfileSystem | null {\n  const { profileSystem } = useProfileContext();\n  return profileSystem;\n}\n\n/**\n * Hook to access HiveProfile data specifically\n * Convenience hook for API interactions\n */\nexport function useHiveProfileData(): HiveProfile | null {\n  const { hiveProfile } = useProfileContext();\n  return hiveProfile;\n}\n\n/**\n * Hook to access UnifiedHiveProfile data specifically\n * Modern hook for new development\n */\nexport function useUnifiedProfile(): UnifiedHiveProfile | null {\n  const { unifiedProfile } = useProfileContext();\n  return unifiedProfile;\n}\n\n/**\n * Hook for profile actions\n * Convenience hook for state management\n */\nexport function useProfileActions() {\n  const {\n    loadProfile,\n    updateProfile,\n    uploadAvatar,\n    toggleGhostMode,\n    refreshDashboard,\n    clearError,\n    createEvent,\n    updateEvent,\n    deleteEvent,\n    getCalendarEvents,\n    detectConflicts,\n    resolveConflict\n  } = useProfileContext();\n\n  return {\n    loadProfile,\n    updateProfile,\n    uploadAvatar,\n    toggleGhostMode,\n    refreshDashboard,\n    clearError,\n    createEvent,\n    updateEvent,\n    deleteEvent,\n    getCalendarEvents,\n    detectConflicts,\n    resolveConflict\n  };\n}\n\n/**\n * Higher-order component to wrap components with ProfileContext\n */\nexport function withProfileContext<P extends object>(\n  Component: React.ComponentType<P>,\n  options?: {\n    isPublicView?: boolean;\n    mockData?: ProfileSystem;\n  }\n) {\n  return function WrappedComponent(props: P) {\n    return (\n      <ProfileContextProvider\n        isPublicView={options?.isPublicView}\n        mockData={options?.mockData}\n      >\n        <Component {...props} />\n      </ProfileContextProvider>\n    );\n  };\n}\n\n/**\n * Development helper: ProfileContext with mock data\n */\nexport function MockProfileContextProvider({ children }: { children: React.ReactNode }) {\n  const mockData = createMockProfileSystem('mock-dev-user');\n\n  return (\n    <ProfileContextProvider mockData={mockData}>\n      {children}\n    </ProfileContextProvider>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/atoms/ProfileAvatar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":76,"column":11,"nodeType":"JSXOpeningElement","endLine":81,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Camera, User } from 'lucide-react';\n\ninterface ProfileAvatarProps {\n  user: {\n    name: string;\n    avatar?: string;\n  };\n  size?: 'sm' | 'md' | 'lg' | 'xl';\n  isEditable?: boolean;\n  onAvatarChange?: (file: File) => void;\n  className?: string;\n}\n\nconst sizeClasses = {\n  sm: 'w-8 h-8 text-xs',\n  md: 'w-12 h-12 text-sm', \n  lg: 'w-16 h-16 text-base',\n  xl: 'w-24 h-24 text-lg'\n};\n\nconst iconSizeClasses = {\n  sm: 'w-3 h-3',\n  md: 'w-4 h-4',\n  lg: 'w-5 h-5', \n  xl: 'w-6 h-6'\n};\n\nexport function ProfileAvatar({ \n  user, \n  size = 'md', \n  isEditable = false, \n  onAvatarChange,\n  className = '' \n}: ProfileAvatarProps) {\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasError, setHasError] = useState(false);\n\n  const handleFileChange = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file || !onAvatarChange) return;\n\n    setIsLoading(true);\n    setHasError(false);\n\n    try {\n      await onAvatarChange(file);\n    } catch {\n      setHasError(true);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const initials = user.name\n    .split(' ')\n    .map(n => n[0])\n    .join('')\n    .toUpperCase()\n    .slice(0, 2);\n\n  return (\n    <div className={`relative ${className}`}>\n      <div className={`\n        ${sizeClasses[size]} \n        rounded-full \n        flex items-center justify-center\n        overflow-hidden\n        ${isEditable ? 'cursor-pointer hover:opacity-80 transition-opacity touch-manipulation' : ''}\n        ${hasError ? 'ring-2 ring-red-400' : ''}\n        ${isLoading ? 'animate-pulse' : ''}\n      `}>\n        {user.avatar && !hasError ? (\n          <img\n            src={user.avatar}\n            alt={`${user.name}'s avatar`}\n            className=\"w-full h-full object-cover\"\n            onError={() => setHasError(true)}\n          />\n        ) : (\n          <div className=\"w-full h-full bg-hive-brand-secondary flex items-center justify-center text-hive-text-primary font-medium\">\n            {initials || <User className={iconSizeClasses[size]} />}\n          </div>\n        )}\n      </div>\n\n      {isEditable && (\n        <>\n          <button\n            className={`\n              absolute -bottom-1 -right-1 \n              w-8 h-8 sm:w-6 sm:h-6 bg-[var(--hive-brand-primary)] text-hive-background-primary \n              rounded-full flex items-center justify-center\n              hover:bg-[var(--hive-brand-primary)]/90 transition-colors touch-manipulation\n              ${isLoading ? 'animate-spin' : ''}\n            `}\n            onClick={() => document.getElementById('avatar-upload')?.click()}\n            disabled={isLoading}\n          >\n            <Camera className=\"w-4 h-4 sm:w-3 sm:h-3\" />\n          </button>\n          <input\n            id=\"avatar-upload\"\n            type=\"file\"\n            accept=\"image/*\"\n            className=\"hidden\"\n            onChange={handleFileChange}\n            disabled={isLoading}\n          />\n        </>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/atoms/ProfileStat.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/card-customization-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/confirmation-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter, Button } from '@hive/ui';\nimport { Alert } from \"@/components/temp-stubs\";\nimport { AlertTriangle, Trash2, Shield } from 'lucide-react';\n\ninterface ConfirmationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title: string;\n  description: string;\n  confirmText?: string;\n  cancelText?: string;\n  variant?: 'destructive' | 'warning' | 'default';\n  isLoading?: boolean;\n}\n\nexport function ConfirmationModal({\n  isOpen,\n  onClose,\n  onConfirm,\n  title,\n  description,\n  confirmText = 'Confirm',\n  cancelText = 'Cancel',\n  variant = 'default',\n  isLoading = false\n}: ConfirmationModalProps) {\n  const getVariantIcon = () => {\n    switch (variant) {\n      case 'destructive':\n        return <Trash2 className=\"h-5 w-5 text-red-400\" />;\n      case 'warning':\n        return <AlertTriangle className=\"h-5 w-5 text-yellow-400\" />;\n      default:\n        return <Shield className=\"h-5 w-5 text-blue-400\" />;\n    }\n  };\n\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'destructive':\n        return {\n          headerBg: 'bg-gradient-to-r from-red-500/10 to-red-600/10',\n          border: 'border-red-500/20',\n          buttonClass: 'bg-red-500 hover:bg-red-600 text-white'\n        };\n      case 'warning':\n        return {\n          headerBg: 'bg-gradient-to-r from-yellow-500/10 to-yellow-600/10',\n          border: 'border-yellow-500/20',\n          buttonClass: 'bg-yellow-500 hover:bg-yellow-600 text-black'\n        };\n      default:\n        return {\n          headerBg: 'bg-gradient-to-r from-blue-500/10 to-blue-600/10',\n          border: 'border-blue-500/20',\n          buttonClass: 'bg-[var(--hive-brand-primary)] hover:bg-hive-champagne text-hive-obsidian'\n        };\n    }\n  };\n\n  const styles = getVariantStyles();\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className={`max-w-md ${styles.border}`}>\n        <DialogHeader className={`p-4 rounded-t-lg ${styles.headerBg}`}>\n          <DialogTitle className=\"flex items-center space-x-3\">\n            {getVariantIcon()}\n            <span className=\"text-white\">{title}</span>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"p-6\">\n          <DialogDescription className=\"text-hive-text-mutedLight leading-relaxed\">\n            {description}\n          </DialogDescription>\n        </div>\n\n        <DialogFooter className=\"p-6 pt-0\">\n          <Button\n            onClick={onClose}\n            disabled={isLoading}\n            variant=\"outline\"\n            className=\"border-hive-border-default hover:bg-hive-background-secondary\"\n          >\n            {cancelText}\n          </Button>\n          <Button\n            onClick={onConfirm}\n            disabled={isLoading}\n            className={styles.buttonClass}\n          >\n            {isLoading ? (\n              <>\n                <span className=\"animate-spin mr-2 h-4 w-4 border-2 border-current border-t-transparent rounded-full\" />\n                Processing...\n              </>\n            ) : (\n              confirmText\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n// Preset confirmation modals for common actions\nexport function DeleteAccountModal(props: Omit<ConfirmationModalProps, 'title' | 'description' | 'variant' | 'confirmText'>) {\n  return (\n    <ConfirmationModal\n      {...props}\n      title=\"Delete Account\"\n      description=\"This action cannot be undone. Your profile, posts, and all associated data will be permanently deleted from HIVE.\"\n      confirmText=\"Delete Account\"\n      variant=\"destructive\"\n    />\n  );\n}\n\nexport function DisconnectIntegrationModal(props: Omit<ConfirmationModalProps, 'title' | 'description' | 'variant' | 'confirmText'> & { integrationName: string }) {\n  return (\n    <ConfirmationModal\n      {...props}\n      title={`Disconnect ${props.integrationName}`}\n      description={`This will remove access to your ${props.integrationName} data and disable related features. You can reconnect at any time.`}\n      confirmText=\"Disconnect\"\n      variant=\"warning\"\n    />\n  );\n}\n\nexport function EnableGhostModeModal(props: Omit<ConfirmationModalProps, 'title' | 'description' | 'confirmText'>) {\n  return (\n    <ConfirmationModal\n      {...props}\n      title=\"Enable Ghost Mode\"\n      description=\"Ghost mode will hide your activity and presence from other users. Your profile will be less discoverable, but you can still use all HIVE features.\"\n      confirmText=\"Enable Ghost Mode\"\n    />\n  );\n}\n\nexport function LeaveSpaceModal(props: Omit<ConfirmationModalProps, 'title' | 'description' | 'variant' | 'confirmText'> & { spaceName: string }) {\n  return (\n    <ConfirmationModal\n      {...props}\n      title={`Leave ${props.spaceName}`}\n      description=\"You'll lose access to this space's posts, events, and tools. You can rejoin later if the space is public.\"\n      confirmText=\"Leave Space\"\n      variant=\"warning\"\n    />\n  );\n}\n\nexport function ResetLayoutModal(props: Omit<ConfirmationModalProps, 'title' | 'description' | 'confirmText'>) {\n  return (\n    <ConfirmationModal\n      {...props}\n      title=\"Reset Layout\"\n      description=\"This will restore your profile layout to the default configuration. Your custom layout will be lost.\"\n      confirmText=\"Reset Layout\"\n    />\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/enhanced-privacy-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/hive-avatar-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/integration-connection-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/molecules/ProfileHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/molecules/ProfileStatsGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/organisms/ProfileDashboardMain.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/personal-tools-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/photo-upload-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useRef, useCallback } from 'react';\nimport Image from 'next/image';\nimport { Button, Progress } from \"@hive/ui\";\nimport { Dialog, DialogContent, Alert } from \"@hive/ui\";\nimport { HiveModalHeader, HiveModalTitle, HiveModalFooter } from \"@/components/temp-stubs\";\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Upload,\n  Camera,\n  RotateCcw,\n  Check,\n  AlertTriangle\n} from 'lucide-react';\n\ninterface PhotoUploadModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onUpload: (_file: File) => Promise<void>;\n  currentPhotoUrl?: string;\n  isUploading?: boolean;\n  uploadProgress?: number;\n}\n\nexport function PhotoUploadModal({\n  isOpen,\n  onClose,\n  onUpload,\n  currentPhotoUrl,\n  isUploading = false,\n  uploadProgress = 0\n}: PhotoUploadModalProps) {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [dragOver, setDragOver] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileSelect = useCallback((file: File) => {\n    setError(null);\n    \n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      setError('Please select an image file (PNG, JPG, GIF)');\n      return;\n    }\n    \n    // Validate file size (5MB max)\n    if (file.size > 5 * 1024 * 1024) {\n      setError('Image must be smaller than 5MB');\n      return;\n    }\n    \n    setSelectedFile(file);\n    \n    // Create preview URL\n    const url = URL.createObjectURL(file);\n    setPreviewUrl(url);\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setDragOver(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    if (files.length > 0) {\n      handleFileSelect(files[0]);\n    }\n  }, [handleFileSelect]);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setDragOver(true);\n  }, []);\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setDragOver(false);\n  }, []);\n\n  const handleFileInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  }, [handleFileSelect]);\n\n  const handleUpload = async () => {\n    if (!selectedFile) return;\n    \n    try {\n      await onUpload(selectedFile);\n      handleClose();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Upload failed');\n    }\n  };\n\n  const handleClose = () => {\n    setSelectedFile(null);\n    setPreviewUrl(null);\n    setError(null);\n    setDragOver(false);\n    onClose();\n  };\n\n  const handleReset = () => {\n    setSelectedFile(null);\n    setPreviewUrl(null);\n    setError(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-2xl\">\n        <HiveModalHeader>\n          <HiveModalTitle className=\"flex items-center space-x-2 font-sans\">\n            <Camera className=\"h-5 w-5 text-hive-brand-primary\" />\n            <span className=\"text-hive-text-primary\">Upload Profile Photo</span>\n          </HiveModalTitle>\n        </HiveModalHeader>\n\n        <div className=\"space-y-6 p-6\">\n          {/* Current Photo Display */}\n          {currentPhotoUrl && !previewUrl && (\n            <motion.div\n              className=\"text-center\"\n              initial={{ opacity: 0, scale: 0.95 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ duration: 0.25, ease: [0.23, 1, 0.32, 1] }}\n            >\n              <p className=\"text-sm text-hive-text-secondary font-sans mb-3\">Current Photo</p>\n              <div className=\"relative w-32 h-32 mx-auto rounded-full overflow-hidden bg-hive-background-tertiary border-2 border-hive-border-default\">\n                <Image src={currentPhotoUrl} alt=\"\" fill\n                  className=\"object-cover\"\n                />\n              </div>\n            </motion.div>\n          )}\n\n          {/* Upload Area */}\n          <motion.div\n            className={`\n              relative border-2 border-dashed rounded-lg p-8 text-center cursor-pointer font-sans\n              ${dragOver\n                ? 'border-hive-brand-primary bg-hive-overlay-gold-subtle'\n                : 'border-hive-border-default hover:border-hive-border-hover'\n              }\n              ${selectedFile ? 'border-hive-status-success bg-hive-overlay-gold-subtle' : ''}\n            `}\n            whileHover={{\n              scale: 1.01,\n              transition: { duration: 0.15, ease: [0.23, 1, 0.32, 1] }\n            }}\n            whileTap={{\n              scale: 0.99,\n              transition: { duration: 0.1, ease: [0.23, 1, 0.32, 1] }\n            }}\n            onDrop={handleDrop}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onClick={() => fileInputRef.current?.click()}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleFileInputChange}\n              className=\"hidden\"\n            />\n\n            <AnimatePresence mode=\"wait\">\n              {previewUrl ? (\n                <motion.div\n                  key=\"preview\"\n                  className=\"space-y-4\"\n                  initial={{ opacity: 0, scale: 0.9 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  exit={{ opacity: 0, scale: 0.9 }}\n                  transition={{ duration: 0.25, ease: [0.23, 1, 0.32, 1] }}\n                >\n                  <div className=\"relative w-48 h-48 mx-auto rounded-lg overflow-hidden bg-hive-background-tertiary border-2 border-hive-border-default shadow-hive-level2\">\n                    <Image src={previewUrl} alt=\"\" fill\n                      className=\"object-cover\"\n                    />\n                  </div>\n                  <div className=\"flex items-center justify-center space-x-4\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"max-w-sm font-sans\"\n                      onClick={(e: React.MouseEvent) => {\n                        e.stopPropagation();\n                        handleReset();\n                      }}\n                    >\n                      <RotateCcw className=\"h-4 w-4 mr-2\" />\n                      Choose Different\n                    </Button>\n                  </div>\n                </motion.div>\n              ) : (\n                <motion.div\n                  key=\"upload\"\n                  className=\"space-y-4\"\n                  initial={{ opacity: 0, scale: 0.95 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  exit={{ opacity: 0, scale: 0.95 }}\n                  transition={{ duration: 0.25, ease: [0.23, 1, 0.32, 1] }}\n                >\n                  <motion.div\n                    className=\"w-16 h-16 bg-hive-background-secondary rounded-full flex items-center justify-center mx-auto border border-hive-border-default\"\n                    whileHover={{\n                      scale: 1.05,\n                      backgroundColor: \"var(--hive-background-tertiary)\",\n                      transition: { duration: 0.15, ease: [0.23, 1, 0.32, 1] }\n                    }}\n                  >\n                    <Upload className=\"h-8 w-8 text-hive-text-secondary\" />\n                  </motion.div>\n                  <div>\n                    <p className=\"text-hive-text-primary font-medium font-sans\">Drop your photo here, or click to browse</p>\n                    <p className=\"text-sm text-hive-text-secondary font-sans mt-1\">\n                      PNG, JPG, GIF up to 5MB\n                    </p>\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </motion.div>\n\n          {/* Upload Progress */}\n          <AnimatePresence>\n            {isUploading && (\n              <motion.div\n                className=\"space-y-2\"\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                exit={{ opacity: 0, height: 0 }}\n                transition={{ duration: 0.25, ease: [0.23, 1, 0.32, 1] }}\n              >\n                <div className=\"flex items-center justify-between text-sm font-sans\">\n                  <span className=\"text-hive-text-primary\">Uploading...</span>\n                  <span className=\"text-hive-text-secondary\">{uploadProgress}%</span>\n                </div>\n                <Progress value={uploadProgress} className=\"h-2\" />\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Error Display */}\n          <AnimatePresence>\n            {error && (\n              <motion.div\n                className=\"flex items-center space-x-2 p-3 rounded-lg bg-hive-status-error/10 border border-hive-status-error/20\"\n                initial={{ opacity: 0, scale: 0.95, y: -10 }}\n                animate={{ opacity: 1, scale: 1, y: 0 }}\n                exit={{ opacity: 0, scale: 0.95, y: -10 }}\n                transition={{ duration: 0.25, ease: [0.23, 1, 0.32, 1] }}\n              >\n                <AlertTriangle className=\"h-4 w-4 text-hive-status-error\" />\n                <p className=\"text-sm text-hive-status-error font-sans\">{error}</p>\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Upload Guidelines */}\n          <div className=\"text-xs text-hive-text-tertiary font-sans space-y-1\">\n            <p>‚Ä¢ Image will be cropped to a square automatically</p>\n            <p>‚Ä¢ Recommended size: 400x400 pixels or larger</p>\n            <p>‚Ä¢ Keep your photo appropriate for campus community</p>\n          </div>\n        </div>\n\n        <HiveModalFooter>\n          <Button\n            variant=\"outline\"\n            onClick={handleClose}\n            disabled={isUploading}\n            className=\"font-sans\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleUpload}\n            disabled={!selectedFile || isUploading}\n            className=\"bg-hive-brand-primary text-hive-brand-onGold hover:bg-hive-brand-hover focus:ring-hive-brand-primary font-sans shadow-hive-gold-glow hover:shadow-hive-gold-glow-strong transition-all duration-300 ease-out\"\n          >\n            <AnimatePresence mode=\"wait\">\n              {isUploading ? (\n                <motion.div\n                  key=\"uploading\"\n                  className=\"flex items-center\"\n                  initial={{ opacity: 0, scale: 0.95 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  exit={{ opacity: 0, scale: 0.95 }}\n                  transition={{ duration: 0.15, ease: [0.23, 1, 0.32, 1] }}\n                >\n                  <motion.div\n                    animate={{ rotate: 360 }}\n                    transition={{ duration: 1, repeat: Infinity, ease: \"linear\" }}\n                  >\n                    <Upload className=\"h-4 w-4 mr-2\" />\n                  </motion.div>\n                  Uploading...\n                </motion.div>\n              ) : (\n                <motion.div\n                  key=\"upload\"\n                  className=\"flex items-center\"\n                  initial={{ opacity: 0, scale: 0.95 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  exit={{ opacity: 0, scale: 0.95 }}\n                  transition={{ duration: 0.15, ease: [0.23, 1, 0.32, 1] }}\n                >\n                  <Check className=\"h-4 w-4 mr-2\" />\n                  Upload Photo\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </Button>\n        </HiveModalFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/profile-error-boundary-enhanced.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/profile-identity-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSession' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'updateProfile' function makes the dependencies of useCallback Hook (at line 331) change on every render. Move it inside the useCallback callback. Alternatively, wrap the definition of 'updateProfile' in its own useCallback() Hook.","line":88,"column":9,"nodeType":"VariableDeclarator","endLine":91,"endColumn":4},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'uploadPhoto' function makes the dependencies of useCallback Hook (at line 144) change on every render. Move it inside the useCallback callback. Alternatively, wrap the definition of 'uploadPhoto' in its own useCallback() Hook.","line":92,"column":9,"nodeType":"VariableDeclarator","endLine":95,"endColumn":4}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useRef, useCallback } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport Image from 'next/image';\nimport { Input, Button, Textarea } from \"@hive/ui\";\nimport { useSession } from '../../hooks/use-session';\n\ninterface CampusProfile {\n  fullName: string;\n  preferredName?: string;\n  profilePhoto?: string;\n  avatarUrl?: string;\n  academicYear: 'freshman' | 'sophomore' | 'junior' | 'senior' | 'graduate' | 'other';\n  major: string;\n  housing: string;\n  pronouns?: string;\n  statusMessage?: string;\n  isBuilder?: boolean;\n  age?: number;\n}\n\ninterface ProfileIdentityModalProps {\n  profile: CampusProfile;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst ACADEMIC_YEARS = [\n  { value: 'freshman', label: 'Freshman' },\n  { value: 'sophomore', label: 'Sophomore' },\n  { value: 'junior', label: 'Junior' },\n  { value: 'senior', label: 'Senior' },\n  { value: 'graduate', label: 'Graduate' },\n  { value: 'other', label: 'Other' },\n];\n\nconst COMMON_MAJORS = [\n  'Computer Science', 'Business Administration', 'Psychology', 'Biology', \n  'Engineering', 'English', 'Mathematics', 'History', 'Economics', 'Political Science',\n  'Chemistry', 'Physics', 'Art', 'Music', 'Philosophy', 'Sociology', 'Anthropology',\n  'Environmental Science', 'Nursing', 'Education', 'Communications', 'Marketing',\n  'Finance', 'Pre-Med', 'Pre-Law', 'International Relations', 'Other'\n];\n\nexport function ProfileIdentityModal({ profile, isOpen, onClose }: ProfileIdentityModalProps) {\n  const [formData, setFormData] = useState({\n    fullName: profile.displayName || '',\n    preferredName: profile.preferredName || '',\n    age: profile.age || '',\n    academicYear: profile.metadata?.academicYear || 'freshman',\n    major: profile.major || '',\n    housing: profile.housing || '',\n    pronouns: profile.pronouns || '',\n    statusMessage: profile.statusMessage || '',\n  });\n\n  // Update form data when profile changes\n  React.useEffect(() => {\n    if (profile) {\n      setFormData({\n        fullName: profile.displayName || '',\n        preferredName: profile.preferredName || '',\n        age: profile.age || '',\n        academicYear: profile.metadata?.academicYear || 'freshman',\n        major: profile.major || '',\n        housing: profile.housing || '',\n        pronouns: profile.pronouns || '',\n        statusMessage: profile.statusMessage || '',\n      });\n    }\n  }, [profile]);\n  \n  const [photoPreview, setPhotoPreview] = useState<string | null>(profile.profilePhoto || profile.avatarUrl || null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadError, setUploadError] = useState<string | null>(null);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  \n  const [showCamera, setShowCamera] = useState(false);\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  \n  const queryClient = useQueryClient();\n  \n  // Stub profile methods (useSession doesn't provide these)\n  const updateProfile = async (data: any): Promise<any> => {\n    // Return mock data for now - implement actual API call later\n    return { success: true, ...data };\n  };\n  const uploadPhoto = async (file: File): Promise<{ avatarUrl: string }> => {\n    // Return mock data for now - implement actual API call later\n    return { avatarUrl: URL.createObjectURL(file) };\n  };\n  const isUpdating = false;\n  const _profileError = null;\n  const _clearError = () => {};\n  \n  // PWA Camera Support Detection\n  const isCameraSupported = typeof navigator !== 'undefined' && \n    navigator.mediaDevices && \n    navigator.mediaDevices.getUserMedia;\n  \n  const _isMobile = typeof window !== 'undefined' && \n    /Mobi|Android/i.test(navigator.userAgent);\n\n  // Use HIVE photo upload hook\n  const handlePhotoUpload = useCallback(async (file: File) => {\n    try {\n      setIsUploading(true);\n      setUploadError(null);\n      const result = await uploadPhoto(file);\n      setPhotoPreview(result.avatarUrl);\n      \n      // Update localStorage session data for immediate sync\n      try {\n        const sessionJson = window.localStorage.getItem('hive_session');\n        if (sessionJson) {\n          const session = JSON.parse(sessionJson);\n          session.profileData = {\n            ...session.profileData,\n            avatarUrl: result.avatarUrl\n          };\n          window.localStorage.setItem('hive_session', JSON.stringify(session));\n          \n          // Trigger storage event to update useSession\n          window.dispatchEvent(new StorageEvent('storage', {\n            key: 'hive_session',\n            newValue: JSON.stringify(session)\n          }));\n        }\n      } catch (sessionError) {\n        console.warn('Could not update session data:', sessionError);\n      }\n      \n      // Force refresh profile data across dashboard\n      queryClient.invalidateQueries({ queryKey: [\"campus-profile\"] });\n    } catch (error) {\n      setUploadError(error instanceof Error ? error.message : 'Upload failed');\n    } finally {\n      setIsUploading(false);\n    }\n  }, [uploadPhoto, queryClient]);\n\n  // Generate avatar mutation\n  const generateAvatarMutation = useMutation({\n    mutationFn: async () => {\n      const headers: Record<string, string> = {};\n      try {\n        const sessionJson = window.localStorage.getItem('hive_session');\n        if (sessionJson) {\n          const session = JSON.parse(sessionJson);\n          headers.Authorization = `Bearer ${process.env.NODE_ENV === 'development' ? 'test-token' : session.token}`;\n        } else {\n          headers.Authorization = `Bearer test-token`;\n        }\n      } catch (error) {\n        headers.Authorization = `Bearer test-token`;\n      }\n      \n      const response = await fetch('/api/profile/generate-avatar', {\n        method: 'POST',\n        headers,\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to generate avatar');\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      setPhotoPreview(data.avatarUrl);\n      setUploadError(null);\n      \n      // Update localStorage session data for immediate sync\n      try {\n        const sessionJson = window.localStorage.getItem('hive_session');\n        if (sessionJson) {\n          const session = JSON.parse(sessionJson);\n          session.profileData = {\n            ...session.profileData,\n            avatarUrl: data.avatarUrl\n          };\n          window.localStorage.setItem('hive_session', JSON.stringify(session));\n          \n          // Trigger storage event to update useSession\n          window.dispatchEvent(new StorageEvent('storage', {\n            key: 'hive_session',\n            newValue: JSON.stringify(session)\n          }));\n        }\n      } catch (sessionError) {\n        console.warn('Could not update session data:', sessionError);\n      }\n      \n      // Force refresh profile data across dashboard\n      queryClient.invalidateQueries({ queryKey: [\"campus-profile\"] });\n      queryClient.refetchQueries({ queryKey: [\"campus-profile\"] });\n    },\n    onError: (error) => {\n      setUploadError(error instanceof Error ? error.message : 'Generation failed');\n    }\n  });\n\n  // Handle file input change\n  const handleFileChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Validate file type\n      const allowedTypes = ['image/jpeg', 'image/png', 'image/webp'];\n      if (!allowedTypes.includes(file.type)) {\n        setUploadError('Invalid file type. Only JPEG, PNG, and WebP are allowed.');\n        return;\n      }\n      \n      // Validate file size (5MB limit)\n      const maxSize = 5 * 1024 * 1024; // 5MB\n      if (file.size > maxSize) {\n        setUploadError('File too large. Maximum size is 5MB.');\n        return;\n      }\n      \n      handlePhotoUpload(file);\n    }\n  }, [handlePhotoUpload]);\n\n  // PWA Camera Functions\n  const startCamera = useCallback(async () => {\n    if (!isCameraSupported) return;\n    \n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: { facingMode: 'user' },\n        audio: false\n      });\n      \n      setStream(mediaStream);\n      setShowCamera(true);\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = mediaStream;\n      }\n    } catch (error) {\n      console.error('Camera access denied:', error);\n      setUploadError('Camera access denied. Please allow camera permissions.');\n    }\n  }, [isCameraSupported]);\n\n  const stopCamera = useCallback(() => {\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n    setShowCamera(false);\n  }, [stream]);\n\n  const capturePhoto = useCallback(() => {\n    if (!videoRef.current || !canvasRef.current) return;\n    \n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    \n    if (!context) return;\n    \n    // Set canvas dimensions to match video\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    \n    // Draw video frame to canvas\n    context.drawImage(video, 0, 0);\n    \n    // Convert to blob and upload\n    canvas.toBlob((blob) => {\n      if (blob) {\n        const file = new File([blob], 'camera-photo.jpg', { type: 'image/jpeg' });\n        handlePhotoUpload(file);\n        stopCamera();\n      }\n    }, 'image/jpeg', 0.8);\n  }, [handlePhotoUpload, stopCamera]);\n\n\n  const handleUpdateProfile = useCallback(async () => {\n    try {\n      // Filter out empty strings and prepare update data\n      const updateData = Object.fromEntries(\n        Object.entries(formData).filter(([_, value]) => value !== '')\n      );\n      \n      // Convert age to number if present\n      if (updateData.age) {\n        updateData.age = parseInt(updateData.age as string);\n      }\n      \n      await updateProfile(updateData);\n      \n      // Update localStorage session data for immediate sync\n      try {\n        const sessionJson = window.localStorage.getItem('hive_session');\n        if (sessionJson) {\n          const session = JSON.parse(sessionJson);\n          session.profileData = {\n            ...session.profileData,\n            fullName: updateData.displayName || session.profileData?.displayName,\n            major: updateData.major || session.profileData?.major,\n            // Add other fields as needed\n          };\n          window.localStorage.setItem('hive_session', JSON.stringify(session));\n          \n          // Trigger storage event to update useSession\n          window.dispatchEvent(new StorageEvent('storage', {\n            key: 'hive_session',\n            newValue: JSON.stringify(session)\n          }));\n        }\n      } catch (sessionError) {\n        console.warn('Could not update session data:', sessionError);\n      }\n      \n      // Force refresh profile data across dashboard\n      queryClient.invalidateQueries({ queryKey: [\"campus-profile\"] });\n      queryClient.refetchQueries({ queryKey: [\"campus-profile\"] });\n      \n      onClose();\n    } catch (error) {\n      setUploadError(error instanceof Error ? error.message : 'Profile update failed');\n    }\n  }, [formData, updateProfile, onClose, queryClient]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center z-50 p-4 animate-in fade-in duration-300 overflow-y-auto\">\n      <div className=\"bg-hive-background-tertiary rounded-2xl border border-hive-brand-primary/20 w-full max-w-4xl my-8 animate-in slide-in-from-bottom-4 zoom-in-95 duration-300 ease-out\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 sm:p-6 border-b border-hive-border-primary sticky top-0 bg-hive-background-tertiary z-10\">\n          <h2 className=\"text-xl font-bold text-hive-text-primary\">Your Profile</h2>\n          <button\n            onClick={onClose}\n            className=\"w-8 h-8 rounded-full bg-hive-background-secondary flex items-center justify-center text-hive-text-muted hover:bg-hive-background-interactive hover:scale-110 transition-all duration-200\"\n          >\n            ‚úï\n          </button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 p-4 sm:p-6\">\n            {/* Photo Section */}\n            <div className=\"space-y-4 sm:space-y-6\">\n              <h3 className=\"text-lg font-semibold text-hive-text-primary\">Profile Photo</h3>\n              \n              {/* Photo Display */}\n              <div className=\"relative\">\n                <div className=\"aspect-square rounded-2xl overflow-hidden bg-gradient-to-br from-hive-brand-primary/20 to-hive-brand-primary/10 border-2 border-dashed border-hive-brand-primary/30\">\n                  {photoPreview ? (\n                    <Image src={photoPreview} alt=\"\" width={400}\n                      height={400}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <div className=\"text-center\">\n                        <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-hive-brand-primary/30 to-hive-brand-primary/20 border-2 border-hive-brand-primary/40 flex items-center justify-center text-2xl font-bold text-hive-text-primary mx-auto mb-4\">\n                          {formData.displayName?.split(' ').map(n => n[0]).join('').toUpperCase() || 'U'}\n                        </div>\n                        <p className=\"text-hive-text-secondary text-sm\">No photo yet</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                \n                {/* Upload Error */}\n                {uploadError && (\n                  <div className=\"mt-2 text-sm text-hive-status-error bg-hive-status-error/10 border border-hive-status-error/20 rounded-lg p-3\">\n                    {uploadError}\n                  </div>\n                )}\n              </div>\n\n              {/* Photo Actions */}\n              <div className=\"space-y-3\">\n                {/* HIVE File Upload Component - temporarily disabled */}\n                {/* <HiveFileUpload\n                  accept=\"image/*\"\n                  maxSize={5 * 1024 * 1024} // 5MB\n                  onFilesSelected={(files: File[]) => {\n                    if (files[0]) {\n                      handlePhotoUpload(files[0]);\n                    }\n                  }}\n                  multiple={false}\n                  className=\"w-full\"\n                /> */}\n                \n                {/* Fallback Upload Button */}\n                <Button\n                  onClick={() => fileInputRef.current?.click()}\n                  disabled={isUploading}\n                  className=\"w-full\"\n                  variant=\"default\"\n                >\n                  {isUploading ? (\n                    <div className=\"flex items-center justify-center animate-pulse\">\n                      <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2\" />\n                      <span className=\"animate-in slide-in-from-left-1\">Uploading...</span>\n                    </div>\n                  ) : (\n                    <span className=\"transition-all duration-200 hover:scale-105 inline-flex items-center\">\n                      üìÅ Upload Photo\n                    </span>\n                  )}\n                </Button>\n\n                {/* Take Photo (PWA) */}\n                {isCameraSupported && (\n                  <Button\n                    onClick={showCamera ? capturePhoto : startCamera}\n                    disabled={isUploading}\n                    variant=\"outline\"\n                    className=\"w-full transition-all duration-200 hover:scale-[1.02]\"\n                  >\n                    <span className=\"transition-all duration-200 hover:scale-105 inline-flex items-center\">\n                      üì± {showCamera ? 'Capture Photo' : 'Take Photo'}\n                    </span>\n                  </Button>\n                )}\n\n                {/* Generate Avatar */}\n                <Button\n                  onClick={() => generateAvatarMutation.mutate()}\n                  disabled={generateAvatarMutation.isPending}\n                  variant=\"outline\"\n                  className=\"w-full transition-all duration-200 hover:scale-[1.02]\"\n                >\n                  {generateAvatarMutation.isPending ? (\n                    <div className=\"flex items-center justify-center animate-pulse\">\n                      <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2\" />\n                      <span className=\"animate-in slide-in-from-left-1\">Generating...</span>\n                    </div>\n                  ) : (\n                    <span className=\"transition-all duration-200 hover:scale-105 inline-flex items-center\">\n                      üé® Generate Avatar\n                    </span>\n                  )}\n                </Button>\n\n                {/* Remove Photo */}\n                {photoPreview && (\n                  <Button\n                    onClick={() => setPhotoPreview(null)}\n                    variant=\"destructive\"\n                    className=\"w-full\"\n                  >\n                    üóëÔ∏è Remove Photo\n                  </Button>\n                )}\n              </div>\n\n              {/* Camera View (Hidden Canvas for Capture) */}\n              {showCamera && (\n                <div className=\"space-y-4 animate-in slide-in-from-top-4 fade-in duration-300\">\n                  <video\n                    ref={videoRef}\n                    autoPlay\n                    playsInline\n                    muted\n                    className=\"w-full aspect-square object-cover rounded-xl transition-all duration-300 hover:scale-[1.02]\"\n                  />\n                  <button\n                    onClick={stopCamera}\n                    className=\"w-full py-2 px-4 bg-[#3A3A3D] text-[#E5E5E7] rounded-lg text-sm hover:bg-[#4A4A4D] hover:scale-[1.02] transition-all duration-200\"\n                  >\n                    Cancel Camera\n                  </button>\n                </div>\n              )}\n              <canvas ref={canvasRef} className=\"hidden\" />\n            </div>\n\n            {/* Identity Section */}\n            <div className=\"space-y-4 sm:space-y-6\">\n              <h3 className=\"text-lg font-semibold text-[#E5E5E7]\">Identity & Info</h3>\n              \n              <div className=\"space-y-4\">\n                {/* Display Name */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Display Name\n                  </label>\n                  <Input\n                    value={formData.displayName}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFormData(prev => ({ ...prev, fullName: (e.target as any).value }))}\n                    placeholder=\"Your full name\"\n                    className=\"w-full\"\n                  />\n                </div>\n\n                {/* Preferred Name */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Preferred Name (Optional)\n                  </label>\n                  <Input\n                    value={formData.preferredName}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFormData(prev => ({ ...prev, preferredName: (e.target as any).value }))}\n                    placeholder=\"What should we call you?\"\n                    className=\"w-full\"\n                  />\n                </div>\n\n                {/* Age & Academic Year */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                      Age\n                    </label>\n                    <Input\n                      type=\"number\"\n                      value={formData.age}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFormData(prev => ({ ...prev, age: (e.target as any).value }))}\n                      placeholder=\"18\"\n                      className=\"w-full\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                      Academic Year\n                    </label>\n                    <select\n                      value={formData.academicYear}\n                      onChange={(e: React.ChangeEvent<HTMLSelectElement>) => setFormData(prev => ({ ...prev, academicYear: (e.target as any).value as any }))}\n                      className=\"w-full px-4 py-3 bg-hive-background-secondary border border-hive-border-primary rounded-xl text-hive-text-primary focus:border-hive-brand-primary/40 focus:outline-none transition-colors\"\n                    >\n                      {ACADEMIC_YEARS.map(year => (\n                        <option key={year.value} value={year.value}>\n                          {year.label}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n\n                {/* Major */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Major\n                  </label>\n                  <select\n                    value={formData.major}\n                    onChange={(e: React.ChangeEvent<HTMLSelectElement>) => setFormData(prev => ({ ...prev, major: (e.target as any).value }))}\n                    className=\"w-full px-4 py-3 bg-hive-background-secondary border border-hive-border-primary rounded-xl text-hive-text-primary focus:border-hive-brand-primary/40 focus:outline-none transition-colors\"\n                  >\n                    <option value=\"\">Select your major</option>\n                    {COMMON_MAJORS.map(major => (\n                      <option key={major} value={major}>\n                        {major}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Housing */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Dorm/Housing\n                  </label>\n                  <Input\n                    value={formData.housing}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFormData(prev => ({ ...prev, housing: (e.target as any).value }))}\n                    placeholder=\"e.g., Smith Hall, Room 305\"\n                    className=\"w-full\"\n                  />\n                </div>\n\n                {/* Pronouns */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Pronouns (Optional)\n                  </label>\n                  <Input\n                    value={formData.pronouns}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFormData(prev => ({ ...prev, pronouns: (e.target as any).value }))}\n                    placeholder=\"e.g., they/them, she/her, he/him\"\n                    className=\"w-full\"\n                  />\n                </div>\n\n                {/* Status Message */}\n                <div>\n                  <label className=\"block text-sm font-medium text-hive-text-secondary mb-2\">\n                    Bio/Status (Optional)\n                  </label>\n                  <Textarea\n                    value={formData.statusMessage}\n                    onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setFormData(prev => ({ ...prev, statusMessage: (e.target as any).value }))}\n                    placeholder=\"Tell your campus story...\"\n                    rows={3}\n                    maxLength={200}\n                    className=\"w-full resize-none\"\n                  />\n                  <div className=\"text-xs text-hive-text-muted mt-1\">\n                    {formData.statusMessage.length}/200 characters\n                  </div>\n                </div>\n              </div>\n\n              {/* Builder Status Info */}\n              {profile.isBuilder && (\n                <div className=\"p-4 bg-gradient-to-r from-[var(--hive-brand-primary)]/10 to-[var(--hive-brand-primary)]/5 border border-[var(--hive-brand-primary)]/20 rounded-xl\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <span className=\"text-xl\">üî®</span>\n                    <h4 className=\"font-semibold text-[#E5E5E7]\">Builder Status</h4>\n                  </div>\n                  <p className=\"text-sm text-[#C1C1C4] mb-2\">\n                    You're a recognized student leader and builder in the HIVE community.\n                  </p>\n                  <div className=\"text-xs text-[#9B9B9F]\">\n                    Member since: March 2025 ‚Ä¢ Tools created: 2 ‚Ä¢ Impact: 101 students helped\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        \n\n        {/* Footer Actions */}\n        <div className=\"p-6 border-t border-hive-border-primary flex justify-end gap-3\">\n            <Button\n              onClick={onClose}\n              variant=\"outline\"\n              className=\"px-6 py-3\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleUpdateProfile}\n              disabled={isUpdating}\n              variant=\"default\"\n              className=\"px-6 py-3\"\n            >\n              {isUpdating ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2\" />\n                  Saving...\n                </>\n              ) : (\n                'Save Changes'\n              )}\n            </Button>\n          </div>\n      </div>\n\n      {/* Hidden file input */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        onChange={handleFileChange}\n        className=\"hidden\"\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/profile-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/profile/tool-config-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconComponent' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":102,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from 'react';\nimport {\n  Dialog,\n  HiveModalHeader,\n  HiveModalTitle,\n  HiveModalDescription,\n  DialogContent,\n  Button,\n  Card,\n  Switch,\n  Badge,\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger\n} from '@hive/ui';\nimport { \n  Settings, \n  Shield, \n  Bell, \n  Share2, \n  Trash2,\n  Key,\n  Activity,\n  BarChart3,\n  Check\n} from 'lucide-react';\n\ninterface ToolPermission {\n  id: string;\n  name: string;\n  description: string;\n  required: boolean;\n  granted: boolean;\n}\n\ninterface ToolConfigModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (_config: ToolConfiguration) => Promise<void>;\n  onUninstall?: () => Promise<void>;\n  tool: {\n    id: string;\n    name: string;\n    description: string;\n    icon: any;\n    version: string;\n    isCustom?: boolean;\n    permissions: ToolPermission[];\n    settings: Record<string, any>;\n    usageStats?: {\n      timesUsed: number;\n      lastUsed: string;\n      avgSessionLength: number;\n    };\n  };\n}\n\ninterface ToolConfiguration {\n  permissions: Record<string, boolean>;\n  settings: Record<string, any>;\n  notifications: {\n    updates: boolean;\n    usage: boolean;\n    sharing: boolean;\n  };\n  sharing: {\n    allowSpaceSharing: boolean;\n    allowPublicSharing: boolean;\n    shareUsageStats: boolean;\n  };\n}\n\nexport function ToolConfigModal({\n  isOpen,\n  onClose,\n  onSave,\n  onUninstall,\n  tool\n}: ToolConfigModalProps) {\n  const [isSaving, setIsSaving] = useState(false);\n  const [config, setConfig] = useState<ToolConfiguration>({\n    permissions: tool.permissions.reduce((acc, perm) => ({\n      ...acc,\n      [perm.id]: perm.granted\n    }), {}),\n    settings: tool.settings,\n    notifications: {\n      updates: true,\n      usage: false,\n      sharing: true\n    },\n    sharing: {\n      allowSpaceSharing: true,\n      allowPublicSharing: false,\n      shareUsageStats: false\n    }\n  });\n\n  const IconComponent = tool.icon;\n\n  const handlePermissionChange = (permId: string, granted: boolean) => {\n    setConfig(prev => ({\n      ...prev,\n      permissions: {\n        ...prev.permissions,\n        [permId]: granted\n      }\n    }));\n  };\n\n  const handleNotificationChange = (key: keyof ToolConfiguration['notifications'], value: boolean) => {\n    setConfig(prev => ({\n      ...prev,\n      notifications: {\n        ...prev.notifications,\n        [key]: value\n      }\n    }));\n  };\n\n  const handleSharingChange = (key: keyof ToolConfiguration['sharing'], value: boolean) => {\n    setConfig(prev => ({\n      ...prev,\n      sharing: {\n        ...prev.sharing,\n        [key]: value\n      }\n    }));\n  };\n\n  const handleSave = async () => {\n    try {\n      setIsSaving(true);\n      await onSave(config);\n      onClose();\n    } catch (error) {\n      console.error('Failed to save tool configuration:', error);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const requiredPermissions = tool.permissions.filter(p => p.required);\n  const optionalPermissions = tool.permissions.filter(p => !p.required);\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={onClose}\n    >\n      <HiveModalHeader>\n        <HiveModalTitle>Configure {tool.name}</HiveModalTitle>\n        <HiveModalDescription>Version {tool.version} ‚Ä¢ {tool.isCustom ? 'Custom Tool' : 'Marketplace Tool'}</HiveModalDescription>\n      </HiveModalHeader>\n      <DialogContent>\n        <div className=\"p-6\">\n          <Tabs defaultValue=\"permissions\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-4\">\n              <TabsTrigger value=\"permissions\" className=\"flex items-center space-x-2\">\n                <Shield className=\"h-4 w-4\" />\n                <span>Permissions</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"notifications\" className=\"flex items-center space-x-2\">\n                <Bell className=\"h-4 w-4\" />\n                <span>Notifications</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"sharing\" className=\"flex items-center space-x-2\">\n                <Share2 className=\"h-4 w-4\" />\n                <span>Sharing</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"usage\" className=\"flex items-center space-x-2\">\n                <BarChart3 className=\"h-4 w-4\" />\n                <span>Usage</span>\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Permissions Tab */}\n            <TabsContent value=\"permissions\" className=\"space-y-4\">\n              {requiredPermissions.length > 0 && (\n                <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n                  <h3 className=\"font-medium text-white mb-3 flex items-center space-x-2\">\n                    <Key className=\"h-4 w-4\" />\n                    <span>Required Permissions</span>\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {requiredPermissions.map((permission) => (\n                      <div key={permission.id} className=\"flex items-center justify-between\">\n                        <div>\n                          <div className=\"font-medium text-white\">{permission.name}</div>\n                          <div className=\"text-sm text-hive-text-mutedLight\">{permission.description}</div>\n                        </div>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          Required\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </Card>\n              )}\n\n              {optionalPermissions.length > 0 && (\n                <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n                  <h3 className=\"font-medium text-white mb-3 flex items-center space-x-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    <span>Optional Permissions</span>\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {optionalPermissions.map((permission) => (\n                      <div key={permission.id} className=\"flex items-center justify-between\">\n                        <div>\n                          <div className=\"font-medium text-white\">{permission.name}</div>\n                          <div className=\"text-sm text-hive-text-mutedLight\">{permission.description}</div>\n                        </div>\n                        <Switch\n                          checked={config.permissions[permission.id] || false}\n                          onCheckedChange={(checked) => handlePermissionChange(permission.id, checked)}\n                        />\n                      </div>\n                    ))}\n                  </div>\n                </Card>\n              )}\n            </TabsContent>\n\n            {/* Notifications Tab */}\n            <TabsContent value=\"notifications\" className=\"space-y-4\">\n              <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n                <h3 className=\"font-medium text-white mb-3 flex items-center space-x-2\">\n                  <Bell className=\"h-4 w-4\" />\n                  <span>Notification Preferences</span>\n                </h3>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Tool Updates</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Get notified when the tool is updated</div>\n                    </div>\n                    <Switch\n                      checked={config.notifications.updates}\n                      onCheckedChange={(checked) => handleNotificationChange('updates', checked)}\n                    />\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Usage Reminders</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Remind you to use this tool regularly</div>\n                    </div>\n                    <Switch\n                      checked={config.notifications.usage}\n                      onCheckedChange={(checked) => handleNotificationChange('usage', checked)}\n                    />\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Sharing Activity</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Notify when others interact with your shared tools</div>\n                    </div>\n                    <Switch\n                      checked={config.notifications.sharing}\n                      onCheckedChange={(checked) => handleNotificationChange('sharing', checked)}\n                    />\n                  </div>\n                </div>\n              </Card>\n            </TabsContent>\n\n            {/* Sharing Tab */}\n            <TabsContent value=\"sharing\" className=\"space-y-4\">\n              <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n                <h3 className=\"font-medium text-white mb-3 flex items-center space-x-2\">\n                  <Share2 className=\"h-4 w-4\" />\n                  <span>Sharing Settings</span>\n                </h3>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Allow Space Sharing</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Let others in your spaces use this tool</div>\n                    </div>\n                    <Switch\n                      checked={config.sharing.allowSpaceSharing}\n                      onCheckedChange={(checked) => handleSharingChange('allowSpaceSharing', checked)}\n                    />\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Public Sharing</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Make this tool discoverable by all HIVE users</div>\n                    </div>\n                    <Switch\n                      checked={config.sharing.allowPublicSharing}\n                      onCheckedChange={(checked) => handleSharingChange('allowPublicSharing', checked)}\n                    />\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium text-white\">Share Usage Stats</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Allow others to see how often you use this tool</div>\n                    </div>\n                    <Switch\n                      checked={config.sharing.shareUsageStats}\n                      onCheckedChange={(checked) => handleSharingChange('shareUsageStats', checked)}\n                    />\n                  </div>\n                </div>\n              </Card>\n            </TabsContent>\n\n            {/* Usage Stats Tab */}\n            <TabsContent value=\"usage\" className=\"space-y-4\">\n              {tool.usageStats ? (\n                <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n                  <h3 className=\"font-medium text-white mb-3 flex items-center space-x-2\">\n                    <Activity className=\"h-4 w-4\" />\n                    <span>Usage Statistics</span>\n                  </h3>\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div className=\"text-center\">\n                      <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">{tool.usageStats.timesUsed}</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Times Used</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"text-2xl font-bold text-blue-400\">{tool.usageStats.avgSessionLength}m</div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Avg Session</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"text-2xl font-bold text-green-400\">\n                        {new Date(tool.usageStats.lastUsed).toLocaleDateString()}\n                      </div>\n                      <div className=\"text-sm text-hive-text-mutedLight\">Last Used</div>\n                    </div>\n                  </div>\n                </Card>\n              ) : (\n                <div className=\"text-center py-8 text-hive-text-mutedLight\">\n                  <BarChart3 className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                  <p>No usage data available yet</p>\n                  <p className=\"text-sm\">Use this tool to see your statistics</p>\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n\n        <div className=\"flex items-center justify-between w-full px-6 py-4 border-t border-white/10\">\n          <div>\n            {onUninstall && !tool.isCustom && (\n              <Button\n                variant=\"outline\"\n                onClick={onUninstall}\n                className=\"border-red-500 text-red-400 hover:bg-red-500/10\"\n                disabled={isSaving}\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                Uninstall\n              </Button>\n            )}\n          </div>\n          <div className=\"flex items-center space-x-3\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              disabled={isSaving}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSave}\n              disabled={isSaving}\n              className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n            >\n              {isSaving ? (\n                <>\n                  <Settings className=\"h-4 w-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                <>\n                  <Check className=\"h-4 w-4 mr-2\" />\n                  Save Changes\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/realtime/realtime-demo.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'commentCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":57}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { Button, Card, Badge, Input, Avatar } from '@hive/ui';\nimport { useRealtimeFeed } from '@/hooks/use-realtime-feed';\nimport { useRealtimeSpaces } from '@/hooks/use-realtime-spaces';\nimport { useRealtimeComments } from '@/hooks/use-realtime-comments';\nimport { usePresence, useOnlineUsers } from '@/hooks/use-presence';\nimport { useNotifications } from '@/hooks/use-notifications';\nimport { Bell, Users, MessageSquare, Activity, Wifi, WifiOff } from 'lucide-react';\n\n/**\n * Demo Component showing all real-time features\n * This demonstrates Firebase real-time capabilities\n */\nexport function RealtimeDemo() {\n  const [selectedPostId, setSelectedPostId] = useState<string | null>(null);\n\n  // Real-time hooks\n  const { isOnline } = usePresence();\n  const { onlineUsers } = useOnlineUsers();\n  const { notifications, unreadCount, markAllAsRead } = useNotifications();\n  const { posts, isLoading, connectionStatus, liveUpdatesCount, mergeRealtimeItems } = useRealtimeFeed({\n    limit: 10,\n    enableRealtime: true\n  });\n  const { spaces } = useRealtimeSpaces({ limitCount: 5 });\n  const { comments, addComment, totalCount: commentCount } = useRealtimeComments(selectedPostId);\n\n  const [commentText, setCommentText] = useState('');\n\n  const handleAddComment = async () => {\n    if (commentText.trim() && selectedPostId) {\n      const success = await addComment(commentText);\n      if (success) {\n        setCommentText('');\n      }\n    }\n  };\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6 space-y-6\">\n      {/* Connection Status Bar */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex items-center gap-2\">\n              {isOnline ? (\n                <>\n                  <Wifi className=\"h-5 w-5 text-green-500\" />\n                  <span className=\"text-green-600 font-medium\">Connected</span>\n                </>\n              ) : (\n                <>\n                  <WifiOff className=\"h-5 w-5 text-red-500\" />\n                  <span className=\"text-red-600 font-medium\">Offline</span>\n                </>\n              )}\n            </div>\n            <Badge variant=\"secondary\" className=\"gap-1\">\n              <Activity className=\"h-3 w-3\" />\n              {connectionStatus}\n            </Badge>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            {/* Online Users */}\n            <div className=\"flex items-center gap-2\">\n              <Users className=\"h-5 w-5 text-gray-500\" />\n              <span className=\"text-sm text-gray-600\">\n                {onlineUsers.length} online\n              </span>\n              <div className=\"flex -space-x-2\">\n                {onlineUsers.slice(0, 3).map((user) => (\n                  <Avatar\n                    key={user.userId}\n                    src={user.avatar}\n                    alt={user.name}\n                    className=\"h-8 w-8 border-2 border-white\"\n                  />\n                ))}\n                {onlineUsers.length > 3 && (\n                  <div className=\"h-8 w-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center\">\n                    <span className=\"text-xs text-gray-600\">\n                      +{onlineUsers.length - 3}\n                    </span>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Notifications */}\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm relative\"\n              onClick={markAllAsRead}\n            >\n              <Bell className=\"h-5 w-5\" />\n              {unreadCount > 0 && (\n                <span className=\"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\">\n                  {unreadCount}\n                </span>\n              )}\n            </Button>\n          </div>\n        </div>\n\n        {/* Live Updates Alert */}\n        {liveUpdatesCount > 0 && (\n          <div className=\"mt-4\">\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm w-full\"\n              onClick={mergeRealtimeItems}\n            >\n              <Activity className=\"h-4 w-4 mr-2\" />\n              {liveUpdatesCount} new updates - Click to load\n            </Button>\n          </div>\n        )}\n      </Card>\n\n      {/* Main Content Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Spaces Sidebar */}\n        <div className=\"lg:col-span-1\">\n          <Card className=\"p-4\">\n            <h3 className=\"font-semibold mb-3\">Active Spaces</h3>\n            <div className=\"space-y-2\">\n              {spaces.map((space) => (\n                <div\n                  key={space.id}\n                  className=\"p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer\"\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"font-medium\">{space.name}</p>\n                      <p className=\"text-sm text-gray-500\">\n                        {space.memberCount} members\n                      </p>\n                    </div>\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      {space.spaceType}\n                    </Badge>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </Card>\n\n          {/* Recent Notifications */}\n          <Card className=\"p-4 mt-4\">\n            <h3 className=\"font-semibold mb-3\">Recent Notifications</h3>\n            <div className=\"space-y-2\">\n              {notifications.slice(0, 5).map((notif) => (\n                <div\n                  key={notif.id}\n                  className={`p-2 rounded ${\n                    notif.read ? 'bg-gray-50' : 'bg-blue-50'\n                  }`}\n                >\n                  <p className=\"text-sm font-medium\">{notif.title}</p>\n                  <p className=\"text-xs text-gray-500\">\n                    {new Date(notif.createdAt).toLocaleTimeString()}\n                  </p>\n                </div>\n              ))}\n            </div>\n          </Card>\n        </div>\n\n        {/* Feed */}\n        <div className=\"lg:col-span-2\">\n          <Card className=\"p-4\">\n            <h3 className=\"font-semibold mb-3\">Live Feed</h3>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                Loading feed...\n              </div>\n            ) : posts.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No posts yet. Be the first to post!\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {posts.map((post) => (\n                  <div\n                    key={post.id}\n                    className=\"p-4 border rounded-lg hover:shadow-md transition\"\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <h4 className=\"font-semibold\">{post.title}</h4>\n                        {post.content && (\n                          <p className=\"text-gray-600 mt-1\">{post.content}</p>\n                        )}\n                        <div className=\"flex items-center gap-4 mt-3 text-sm text-gray-500\">\n                          <span>üëç {post.engagement.likes}</span>\n                          <button\n                            className=\"flex items-center gap-1 hover:text-blue-600\"\n                            onClick={() => setSelectedPostId(post.id)}\n                          >\n                            <MessageSquare className=\"h-4 w-4\" />\n                            {post.engagement.comments}\n                          </button>\n                          <span>üëÅ {post.engagement.views}</span>\n                        </div>\n                      </div>\n                      <span className=\"text-xs text-gray-400\">\n                        {new Date(post.createdAt).toLocaleTimeString()}\n                      </span>\n                    </div>\n\n                    {/* Comments Section */}\n                    {selectedPostId === post.id && (\n                      <div className=\"mt-4 pt-4 border-t\">\n                        <div className=\"space-y-2 mb-4\">\n                          {comments.map((comment) => (\n                            <div key={comment.id} className=\"bg-gray-50 p-2 rounded\">\n                              <p className=\"text-sm\">{comment.content}</p>\n                              <div className=\"flex items-center gap-2 mt-1\">\n                                <span className=\"text-xs text-gray-500\">\n                                  {comment.authorName}\n                                </span>\n                                <span className=\"text-xs text-gray-400\">\n                                  {new Date(comment.createdAt).toLocaleTimeString()}\n                                </span>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <Input\n                            placeholder=\"Add a comment...\"\n                            value={commentText}\n                            onChange={(e: React.ChangeEvent) => setCommentText((e.target as any).value)}\n                            onKeyPress={(e) => {\n                              if (e.key === 'Enter') {\n                                handleAddComment();\n                              }\n                            }}\n                          />\n                          <Button className=\"max-w-sm\" onClick={handleAddComment}>\n                            Post\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </Card>\n        </div>\n      </div>\n\n      {/* Real-time Status Footer */}\n      <div className=\"text-center text-sm text-gray-500\">\n        <p>\n          üî• Real-time powered by Firebase Firestore\n        </p>\n        <p className=\"mt-1\">\n          Updates appear instantly across all connected devices\n        </p>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/rituals/rituals-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/search/search-interface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { Card, Button, Input, Badge, Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@hive/ui';\nimport {\n  Search,\n  Loader2,\n  Clock,\n  Users,\n  Code,\n  Calendar,\n  FileText,\n  X,\n  Tag,\n  MessageCircle,\n  Heart,\n  CheckCircle,\n  Sparkles,\n  ArrowRight,\n  History\n} from 'lucide-react';\nimport { SearchEngine, SearchQuery, SearchResult, SearchItem } from '../../lib/search-engine';\n\ninterface SearchInterfaceProps {\n  onResultSelect?: (_item: SearchItem) => void;\n  onUserSelect?: (_userId: string) => void;\n  onSpaceSelect?: (_spaceId: string) => void;\n  onToolSelect?: (_toolId: string) => void;\n  placeholder?: string;\n  showFilters?: boolean;\n  compactMode?: boolean;\n  maxResults?: number;\n}\n\nexport function SearchInterface({\n  onResultSelect,\n  onUserSelect,\n  onSpaceSelect,\n  onToolSelect,\n  placeholder = \"Search everything on HIVE...\",\n  showFilters = true,\n  compactMode: _compactMode = false,\n  maxResults = 50\n}: SearchInterfaceProps) {\n  const [query, setQuery] = useState('');\n  const [searchType, setSearchType] = useState<'all' | 'posts' | 'users' | 'spaces' | 'tools' | 'events'>('all');\n  const [sortBy, setSortBy] = useState<'relevance' | 'recent' | 'popular' | 'trending'>('relevance');\n  const [timeRange, setTimeRange] = useState<'all' | 'hour' | 'day' | 'week' | 'month' | 'year'>('all');\n  const [isSearching, setIsSearching] = useState(false);\n  const [results, setResults] = useState<SearchResult | null>(null);\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [recentSearches, setRecentSearches] = useState<string[]>([]);\n  const [selectedFilters, setSelectedFilters] = useState<{\n    tags: string[];\n    authors: string[];\n    spaces: string[];\n  }>({\n    tags: [],\n    authors: [],\n    spaces: []\n  });\n  \n  const searchInputRef = useRef<HTMLInputElement>(null);\n  const searchEngine = useRef(SearchEngine.getInstance());\n  const searchTimeout = useRef<NodeJS.Timeout>();\n\n  // Load recent searches from localStorage\n  useEffect(() => {\n    const saved = localStorage.getItem('hive_recent_searches');\n    if (saved) {\n      try {\n        setRecentSearches(JSON.parse(saved));\n      } catch (error) {\n        console.error('Failed to load recent searches:', error);\n      }\n    }\n  }, []);\n\n  // Auto-suggest as user types\n  useEffect(() => {\n    if (query.length > 1) {\n      if (searchTimeout.current) {\n        clearTimeout(searchTimeout.current);\n      }\n      \n      searchTimeout.current = setTimeout(() => {\n        const queryResult = searchEngine.current.getSuggestions(query, 5);\n        setSuggestions(queryResult.map(s => s.query));\n      }, 300);\n    } else {\n      setSuggestions([]);\n    }\n    \n    return () => {\n      if (searchTimeout.current) {\n        clearTimeout(searchTimeout.current);\n      }\n    };\n  }, [query]);\n\n  const performSearch = useCallback(async (searchQuery: string = query) => {\n    if (!searchQuery.trim()) {\n      setResults(null);\n      return;\n    }\n\n    setIsSearching(true);\n    setShowSuggestions(false);\n\n    try {\n      const searchParams: SearchQuery = {\n        query: searchQuery,\n        filters: {\n          timeRange: timeRange === 'all' ? undefined : timeRange,\n          tags: selectedFilters.tags.length > 0 ? selectedFilters.tags : undefined,\n          authors: selectedFilters.authors.length > 0 ? selectedFilters.authors : undefined,\n          spaces: selectedFilters.spaces.length > 0 ? selectedFilters.spaces : undefined\n        },\n        pagination: {\n          page: 1,\n          limit: maxResults\n        },\n        sortBy,\n        searchType\n      };\n\n      const searchResults = searchEngine.current.search(searchParams);\n      setResults(searchResults);\n\n      // Save to recent searches\n      const updatedRecent = [searchQuery, ...recentSearches.filter(r => r !== searchQuery)].slice(0, 10);\n      setRecentSearches(updatedRecent);\n      localStorage.setItem('hive_recent_searches', JSON.stringify(updatedRecent));\n\n    } catch (error) {\n      console.error('Search failed:', error);\n    } finally {\n      setIsSearching(false);\n    }\n  }, [query, searchType, sortBy, timeRange, selectedFilters, maxResults, recentSearches]);\n\n  const handleSearchSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    performSearch();\n  };\n\n  const handleSuggestionClick = (suggestion: string) => {\n    setQuery(suggestion);\n    setShowSuggestions(false);\n    performSearch(suggestion);\n  };\n\n  const handleRecentSearchClick = (recentQuery: string) => {\n    setQuery(recentQuery);\n    performSearch(recentQuery);\n  };\n\n  const clearSearch = () => {\n    setQuery('');\n    setResults(null);\n    setSuggestions([]);\n    setShowSuggestions(false);\n    searchInputRef.current?.focus();\n  };\n\n  const removeFilter = (type: 'tags' | 'authors' | 'spaces', value: string) => {\n    setSelectedFilters(prev => ({\n      ...prev,\n      [type]: prev[type].filter(item => item !== value)\n    }));\n  };\n\n  const getResultIcon = (item: SearchItem) => {\n    switch (item.type) {\n      case 'post': return <FileText className=\"h-4 w-4\" />;\n      case 'user': return <Users className=\"h-4 w-4\" />;\n      case 'space': return <Users className=\"h-4 w-4\" />;\n      case 'tool': return <Code className=\"h-4 w-4\" />;\n      case 'event': return <Calendar className=\"h-4 w-4\" />;\n      default: return <Search className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getResultTypeColor = (type: string) => {\n    const colors = {\n      post: 'text-blue-400',\n      user: 'text-green-400',\n      space: 'text-purple-400',\n      tool: 'text-orange-400',\n      event: 'text-pink-400'\n    };\n    return colors[type as keyof typeof colors] || 'text-gray-400';\n  };\n\n  const handleResultClick = (item: SearchItem) => {\n    if (onResultSelect) {\n      onResultSelect(item);\n    }\n\n    // Type-specific handlers\n    switch (item.type) {\n      case 'user':\n        if (onUserSelect) onUserSelect(item.id);\n        break;\n      case 'space':\n        if (onSpaceSelect) onSpaceSelect(item.id);\n        break;\n      case 'tool':\n        if (onToolSelect) onToolSelect(item.id);\n        break;\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Search Input */}\n      <div className=\"relative\">\n        <form onSubmit={handleSearchSubmit} className=\"relative\">\n          <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-hive-text-mutedLight\" />\n          <Input\n            ref={searchInputRef}\n            value={query}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => setQuery((e.target as any).value)}\n            onFocus={() => setShowSuggestions(true)}\n            placeholder={placeholder}\n            className=\"pl-12 pr-12 py-3 text-lg\"\n          />\n          {query && (\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              className=\"max-w-sm absolute right-2 top-1/2 transform -translate-y-1/2\"\n              onClick={clearSearch}\n              \n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          )}\n          {isSearching && (\n            <div className=\"absolute right-4 top-1/2 transform -translate-y-1/2\">\n              <div className=\"animate-spin h-5 w-5 border-2 border-current border-t-transparent rounded-full\" />\n            </div>\n          )}\n        </form>\n\n        {/* Suggestions Dropdown */}\n        {showSuggestions && (suggestions.length > 0 || recentSearches.length > 0) && (\n          <Card className=\"absolute top-full left-0 right-0 mt-2 p-2 bg-hive-background-overlay border-hive-border-default z-50 max-h-96 overflow-y-auto\">\n            {suggestions.length > 0 && (\n              <div className=\"mb-4\">\n                <h4 className=\"text-sm font-medium text-hive-text-mutedLight mb-2 px-2\">\n                  <Sparkles className=\"h-4 w-4 inline mr-1\" />\n                  Suggestions\n                </h4>\n                {suggestions.map((suggestion, index) => (\n                  <button\n                    key={index}\n                    onClick={() => handleSuggestionClick(suggestion)}\n                    className=\"w-full text-left px-3 py-2 hover:bg-hive-background-tertiary rounded-lg transition-colors\"\n                  >\n                    <div className=\"flex items-center space-x-2\">\n                      <Search className=\"h-4 w-4 text-hive-text-mutedLight\" />\n                      <span className=\"text-white\">{suggestion}</span>\n                      <ArrowRight className=\"h-3 w-3 text-hive-text-mutedLight ml-auto\" />\n                    </div>\n                  </button>\n                ))}\n              </div>\n            )}\n            \n            {recentSearches.length > 0 && (\n              <div>\n                <h4 className=\"text-sm font-medium text-hive-text-mutedLight mb-2 px-2\">\n                  <History className=\"h-4 w-4 inline mr-1\" />\n                  Recent Searches\n                </h4>\n                {recentSearches.slice(0, 5).map((recentQuery, index) => (\n                  <button\n                    key={index}\n                    onClick={() => handleRecentSearchClick(recentQuery)}\n                    className=\"w-full text-left px-3 py-2 hover:bg-hive-background-tertiary rounded-lg transition-colors\"\n                  >\n                    <div className=\"flex items-center space-x-2\">\n                      <Clock className=\"h-4 w-4 text-hive-text-mutedLight\" />\n                      <span className=\"text-white\">{recentQuery}</span>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            )}\n          </Card>\n        )}\n      </div>\n\n      {/* Search Controls */}\n      {showFilters && (\n        <div className=\"flex flex-wrap items-center gap-3\">\n          {/* Search Type */}\n          <Select value={searchType} onValueChange={(value: any) => setSearchType(value)}>\n            <SelectTrigger className=\"w-32\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All</SelectItem>\n              <SelectItem value=\"posts\">Posts</SelectItem>\n              <SelectItem value=\"users\">Users</SelectItem>\n              <SelectItem value=\"spaces\">Spaces</SelectItem>\n              <SelectItem value=\"tools\">Tools</SelectItem>\n              <SelectItem value=\"events\">Events</SelectItem>\n            </SelectContent>\n          </Select>\n\n          {/* Sort By */}\n          <Select value={sortBy} onValueChange={(value: any) => setSortBy(value)}>\n            <SelectTrigger className=\"w-36\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"relevance\">Most Relevant</SelectItem>\n              <SelectItem value=\"recent\">Most Recent</SelectItem>\n              <SelectItem value=\"popular\">Most Popular</SelectItem>\n              <SelectItem value=\"trending\">Trending</SelectItem>\n            </SelectContent>\n          </Select>\n\n          {/* Time Range */}\n          <Select value={timeRange} onValueChange={(value: any) => setTimeRange(value)}>\n            <SelectTrigger className=\"w-32\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Time</SelectItem>\n              <SelectItem value=\"hour\">Last Hour</SelectItem>\n              <SelectItem value=\"day\">Today</SelectItem>\n              <SelectItem value=\"week\">This Week</SelectItem>\n              <SelectItem value=\"month\">This Month</SelectItem>\n              <SelectItem value=\"year\">This Year</SelectItem>\n            </SelectContent>\n          </Select>\n\n          {/* Active Filters */}\n          {(selectedFilters.tags.length > 0 || selectedFilters.authors.length > 0 || selectedFilters.spaces.length > 0) && (\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-sm text-hive-text-mutedLight\">Filters:</span>\n              {selectedFilters.tags.map(tag => (\n                <Badge key={tag} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                  <Tag className=\"h-3 w-3\" />\n                  <span>{tag}</span>\n                  <button onClick={() => removeFilter('tags', tag)}>\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </Badge>\n              ))}\n              {selectedFilters.authors.map(author => (\n                <Badge key={author} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                  <Users className=\"h-3 w-3\" />\n                  <span>{author}</span>\n                  <button onClick={() => removeFilter('authors', author)}>\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </Badge>\n              ))}\n              {selectedFilters.spaces.map(space => (\n                <Badge key={space} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                  <Users className=\"h-3 w-3\" />\n                  <span>{space}</span>\n                  <button onClick={() => removeFilter('spaces', space)}>\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </Badge>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Search Results */}\n      {results && (\n        <div className=\"space-y-4\">\n          {/* Results Header */}\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-white\">\n                {results.total.toLocaleString()} results\n              </h3>\n              <p className=\"text-sm text-hive-text-mutedLight\">\n                Found in {results.searchTime}ms\n              </p>\n            </div>\n            \n            {results.suggestions.length > 0 && (\n              <div className=\"flex items-center space-x-2\">\n                <span className=\"text-sm text-hive-text-mutedLight\">Try:</span>\n                {results.suggestions.slice(0, 3).map((suggestion, index) => (\n                  <Button\n                    key={index}\n                    variant=\"outline\"\n                    className=\"max-w-sm\"\n                    onClick={() => handleSuggestionClick(suggestion)}\n                  >\n                    {suggestion}\n                  </Button>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Results List */}\n          <div className=\"space-y-3\">\n            {results.items.map((item) => (\n              <Card\n                key={item.id}\n                className=\"p-4 bg-hive-background-overlay border-hive-border-default hover:border-hive-border-hover cursor-pointer transition-colors\"\n                onClick={() => handleResultClick(item)}\n              >\n                <div className=\"space-y-2\">\n                  {/* Result Header */}\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className={getResultTypeColor(item.type)}>\n                        {getResultIcon(item)}\n                      </div>\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {item.type}\n                      </Badge>\n                      {item.metadata.isVerified && (\n                        <CheckCircle className=\"h-4 w-4 text-blue-400\" />\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-2 text-xs text-hive-text-mutedLight\">\n                      <span>Score: {(item.score * 100).toFixed(0)}%</span>\n                      {item.metadata.engagement && (\n                        <span>‚Ä¢ {item.metadata.engagement} interactions</span>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Result Title */}\n                  <h4 className=\"font-medium text-white hover:text-[var(--hive-brand-primary)] transition-colors\">\n                    {item.title}\n                  </h4>\n\n                  {/* Result Snippet */}\n                  <p className=\"text-sm text-hive-text-mutedLight line-clamp-2\">\n                    {item.snippet}\n                  </p>\n\n                  {/* Result Metadata */}\n                  <div className=\"flex items-center justify-between text-xs text-hive-text-mutedLight\">\n                    <div className=\"flex items-center space-x-4\">\n                      {item.metadata.authorName && (\n                        <div className=\"flex items-center space-x-1\">\n                          <Users className=\"h-3 w-3\" />\n                          <span>{item.metadata.authorName}</span>\n                        </div>\n                      )}\n                      \n                      {item.metadata.spaceName && (\n                        <div className=\"flex items-center space-x-1\">\n                          <Users className=\"h-3 w-3\" />\n                          <span>in {item.metadata.spaceName}</span>\n                        </div>\n                      )}\n                      \n                      {item.metadata.tags && item.metadata.tags.length > 0 && (\n                        <div className=\"flex items-center space-x-1\">\n                          <Tag className=\"h-3 w-3\" />\n                          <span>{item.metadata.tags.slice(0, 2).join(', ')}</span>\n                        </div>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-3\">\n                      {item.type === 'post' && item.metadata.engagement && (\n                        <>\n                          <div className=\"flex items-center space-x-1\">\n                            <Heart className=\"h-3 w-3\" />\n                            <span>{item.metadata.likes || 0}</span>\n                          </div>\n                          <div className=\"flex items-center space-x-1\">\n                            <MessageCircle className=\"h-3 w-3\" />\n                            <span>{item.metadata.comments || 0}</span>\n                          </div>\n                        </>\n                      )}\n                      \n                      <time>{new Date(item.createdAt).toLocaleDateString()}</time>\n                    </div>\n                  </div>\n\n                  {/* Highlights */}\n                  {item.highlights.length > 0 && (\n                    <div className=\"mt-2 p-2 bg-hive-background-tertiary rounded text-xs\">\n                      <span className=\"text-hive-text-mutedLight\">Match: </span>\n                      <span className=\"text-white\">...{item.highlights[0].text}...</span>\n                    </div>\n                  )}\n                </div>\n              </Card>\n            ))}\n          </div>\n\n          {/* Load More */}\n          {results.hasMore && (\n            <div className=\"text-center\">\n              <Button\n                variant=\"outline\"\n                onClick={() => performSearch()}\n                disabled={isSearching}\n              >\n                {isSearching ? (\n                  <>\n                    <div className=\"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full mr-2\" />\n                    Loading...\n                  </>\n                ) : (\n                  'Load More Results'\n                )}\n              </Button>\n            </div>\n          )}\n\n          {/* No Results */}\n          {results.items.length === 0 && (\n            <Card className=\"p-8 bg-hive-background-overlay border-hive-border-default text-center\">\n              <Search className=\"h-12 w-12 mx-auto mb-4 text-hive-text-mutedLight opacity-50\" />\n              <h3 className=\"text-lg font-medium text-white mb-2\">No results found</h3>\n              <p className=\"text-hive-text-mutedLight mb-4\">\n                Try adjusting your search terms or filters\n              </p>\n              {results.suggestions.length > 0 && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-sm text-hive-text-mutedLight\">Try these suggestions:</p>\n                  <div className=\"flex flex-wrap justify-center gap-2\">\n                    {results.suggestions.map((suggestion, index) => (\n                      <Button\n                        key={index}\n                        variant=\"outline\"\n                        className=\"max-w-sm\"\n                        onClick={() => handleSuggestionClick(suggestion)}\n                      >\n                        {suggestion}\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </Card>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/search/search-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":30,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":15},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":236,"column":25,"nodeType":"JSXOpeningElement","endLine":240,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Search Modal Component\n * Universal search interface using CQRS pattern\n */\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@hive/ui';\nimport { Input, Button, Badge, Card } from '@hive/ui';\nimport {\n  Search,\n  X,\n  Users,\n  Hash,\n  FileText,\n  TrendingUp,\n  Clock,\n  Loader2\n} from 'lucide-react';\nimport { useSearch } from '@/hooks/use-search';\nimport { useAuth } from '@hive/auth-logic';\nimport { useRouter } from 'next/navigation';\n\ninterface SearchModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function SearchModal({ isOpen, onClose }: SearchModalProps) {\n  const router = useRouter();\n  const { user } = useAuth();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedType, setSelectedType] = useState<'all' | 'profiles' | 'spaces' | 'posts'>('all');\n\n  const {\n    results,\n    loading,\n    error,\n    search,\n    clearResults,\n    suggestions,\n    recentSearches,\n    clearRecentSearches\n  } = useSearch({\n    type: selectedType,\n    limit: 10,\n    debounceMs: 300,\n    minSearchLength: 2,\n    cacheResults: true\n  });\n\n  // Handle search input\n  const handleSearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const query = (e.target as any).value;\n    setSearchQuery(query);\n\n    if (query.trim().length >= 2) {\n      search(query.trim());\n    } else {\n      clearResults();\n    }\n  }, [search, clearResults]);\n\n  // Handle result click\n  const handleResultClick = useCallback((result: any) => {\n    // Navigate to the result\n    router.push(result.url);\n    onClose();\n\n    // Clear search\n    setSearchQuery('');\n    clearResults();\n  }, [router, onClose, clearResults]);\n\n  // Handle recent search click\n  const handleRecentSearchClick = useCallback((query: string) => {\n    setSearchQuery(query);\n    search(query);\n  }, [search]);\n\n  // Handle suggestion click\n  const handleSuggestionClick = useCallback((suggestion: string) => {\n    setSearchQuery(suggestion);\n    search(suggestion);\n  }, [search]);\n\n  // Clear search on modal close\n  useEffect(() => {\n    if (!isOpen) {\n      setSearchQuery('');\n      clearResults();\n      setSelectedType('all');\n    }\n  }, [isOpen, clearResults]);\n\n  // Focus on input when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setTimeout(() => {\n        document.getElementById('search-input')?.focus();\n      }, 100);\n    }\n  }, [isOpen]);\n\n  // Handle keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Close on Escape\n      if (e.key === 'Escape' && isOpen) {\n        onClose();\n      }\n\n      // Open search with Cmd/Ctrl + K\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault();\n        if (!isOpen) {\n          // Would need to trigger open from parent\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, onClose]);\n\n  const getIconForType = (type: string) => {\n    switch (type) {\n      case 'profile':\n        return <Users className=\"h-4 w-4\" />;\n      case 'space':\n        return <Hash className=\"h-4 w-4\" />;\n      case 'post':\n        return <FileText className=\"h-4 w-4\" />;\n      default:\n        return <Search className=\"h-4 w-4\" />;\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col\">\n        <DialogHeader>\n          <DialogTitle className=\"sr-only\">Search HIVE</DialogTitle>\n        </DialogHeader>\n\n        {/* Search Input */}\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-hive-text-secondary\" />\n          <Input\n            id=\"search-input\"\n            type=\"text\"\n            placeholder=\"Search for people, spaces, or posts...\"\n            value={searchQuery}\n            onChange={handleSearchChange}\n            className=\"pl-10 pr-10 py-3 text-lg\"\n            autoComplete=\"off\"\n          />\n          {searchQuery && (\n            <button\n              onClick={() => {\n                setSearchQuery('');\n                clearResults();\n              }}\n              className=\"absolute right-3 top-1/2 transform -translate-y-1/2\"\n            >\n              <X className=\"h-5 w-5 text-hive-text-secondary hover:text-hive-text-primary\" />\n            </button>\n          )}\n        </div>\n\n        {/* Search Type Filter */}\n        <div className=\"flex gap-2 mt-4\">\n          <Button\n            variant={selectedType === 'all' ? 'default' : 'ghost'}\n            className=\"max-w-sm\"\n            onClick={() => setSelectedType('all')}\n          >\n            All\n          </Button>\n          <Button\n            variant={selectedType === 'profiles' ? 'default' : 'ghost'}\n            className=\"max-w-sm\"\n            onClick={() => setSelectedType('profiles')}\n          >\n            <Users className=\"h-3 w-3 mr-1\" />\n            People\n          </Button>\n          <Button\n            variant={selectedType === 'spaces' ? 'default' : 'ghost'}\n            className=\"max-w-sm\"\n            onClick={() => setSelectedType('spaces')}\n          >\n            <Hash className=\"h-3 w-3 mr-1\" />\n            Spaces\n          </Button>\n          <Button\n            variant={selectedType === 'posts' ? 'default' : 'ghost'}\n            className=\"max-w-sm\"\n            onClick={() => setSelectedType('posts')}\n          >\n            <FileText className=\"h-3 w-3 mr-1\" />\n            Posts\n          </Button>\n        </div>\n\n        {/* Search Results */}\n        <div className=\"flex-1 overflow-y-auto mt-4 space-y-2\">\n          {loading && (\n            <div className=\"flex items-center justify-center py-8\">\n              <Loader2 className=\"h-6 w-6 animate-spin text-hive-text-secondary\" />\n            </div>\n          )}\n\n          {error && (\n            <div className=\"text-center py-8\">\n              <p className=\"text-red-400\">Failed to search. Please try again.</p>\n            </div>\n          )}\n\n          {!loading && !error && results.length === 0 && searchQuery.length >= 2 && (\n            <div className=\"text-center py-8\">\n              <p className=\"text-hive-text-secondary\">No results found for \"{searchQuery}\"</p>\n            </div>\n          )}\n\n          {results.length > 0 && (\n            <div className=\"space-y-2\">\n              {results.map((result) => (\n                <Card\n                  key={result.id}\n                  className=\"p-3 hover:bg-hive-surface-elevated cursor-pointer transition-colors\"\n                  onClick={() => handleResultClick(result)}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-10 h-10 bg-hive-surface-elevated rounded-full flex items-center justify-center flex-shrink-0\">\n                      {result.imageUrl ? (\n                        <img\n                          src={result.imageUrl}\n                          alt={result.title}\n                          className=\"w-full h-full rounded-full object-cover\"\n                        />\n                      ) : (\n                        getIconForType(result.type)\n                      )}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2\">\n                        <h4 className=\"font-medium text-hive-text-primary truncate\">\n                          {result.title}\n                        </h4>\n                        {result.metadata?.isVerified && (\n                          <Badge className=\"bg-blue-500/20 text-blue-400 text-xs\">\n                            Verified\n                          </Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-hive-text-secondary truncate\">\n                        {result.subtitle}\n                      </p>\n                      {result.description && (\n                        <p className=\"text-xs text-hive-text-secondary mt-1 line-clamp-2\">\n                          {result.description}\n                        </p>\n                      )}\n                      {result.metadata?.memberCount !== undefined && (\n                        <div className=\"flex items-center gap-3 mt-1\">\n                          <span className=\"text-xs text-hive-text-secondary\">\n                            {result.metadata.memberCount} members\n                          </span>\n                          {result.metadata.category && (\n                            <Badge className=\"text-xs\">\n                              {result.metadata.category}\n                            </Badge>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          )}\n\n          {/* Suggestions */}\n          {suggestions.length > 0 && searchQuery && (\n            <div className=\"mt-4\">\n              <h3 className=\"text-sm font-medium text-hive-text-secondary mb-2\">\n                Suggestions\n              </h3>\n              <div className=\"flex flex-wrap gap-2\">\n                {suggestions.map((suggestion) => (\n                  <Button\n                    key={suggestion}\n                    variant=\"outline\"\n                    className=\"max-w-sm text-xs\"\n                    onClick={() => handleSuggestionClick(suggestion)}\n                  >\n                    <TrendingUp className=\"h-3 w-3 mr-1\" />\n                    {suggestion}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Recent Searches */}\n          {!searchQuery && recentSearches.length > 0 && (\n            <div>\n              <div className=\"flex items-center justify-between mb-2\">\n                <h3 className=\"text-sm font-medium text-hive-text-secondary\">\n                  Recent Searches\n                </h3>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm text-xs\"\n                  onClick={clearRecentSearches}\n                >\n                  Clear\n                </Button>\n              </div>\n              <div className=\"space-y-1\">\n                {recentSearches.map((recent) => (\n                  <Button\n                    key={recent}\n                    variant=\"outline\"\n                    className=\"max-w-sm w-full justify-start text-left\"\n                    onClick={() => handleRecentSearchClick(recent)}\n                  >\n                    <Clock className=\"h-3 w-3 mr-2\" />\n                    {recent}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Keyboard Shortcut Hint */}\n        <div className=\"mt-4 pt-4 border-t border-hive-border\">\n          <p className=\"text-xs text-hive-text-secondary text-center\">\n            Press <kbd className=\"px-2 py-1 bg-hive-surface-elevated rounded text-xs\">ESC</kbd> to close\n          </p>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/social/post-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/social/post-composer.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":297,"column":15,"nodeType":"JSXOpeningElement","endLine":297,"endColumn":111},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":450,"column":52,"nodeType":"JSXOpeningElement","endLine":450,"endColumn":81},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":451,"column":52,"nodeType":"JSXOpeningElement","endLine":451,"endColumn":81},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":497,"column":40,"nodeType":"JSXOpeningElement","endLine":497,"endColumn":69}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useRef, useCallback } from 'react';\nimport { Card, Button, Textarea } from \"@hive/ui\";\nimport { Alert, AlertDescription } from \"@/components/temp-stubs\";\nimport {\n  Send,\n  Image,\n  Link,\n  Code,\n  BarChart3 as Poll,\n  Calendar,\n  X,\n  Plus,\n  Paperclip,\n  Users,\n  Lock,\n  Globe,\n  AlertTriangle\n} from 'lucide-react';\n\ninterface PostComposerProps {\n  onPost: (_post: PostData) => Promise<void>;\n  onCancel?: () => void;\n  spaceId?: string;\n  placeholder?: string;\n  maxLength?: number;\n  allowedTypes?: PostType[];\n  user: {\n    id: string;\n    name: string;\n    handle: string;\n    avatarUrl?: string;\n  };\n}\n\ninterface PostData {\n  content: string;\n  type: PostType;\n  visibility: 'public' | 'space' | 'private';\n  attachments: Attachment[];\n  mentions: string[];\n  tags: string[];\n  poll?: Poll;\n  event?: Event;\n  location?: Location;\n  spaceId?: string;\n}\n\ninterface Attachment {\n  id: string;\n  type: 'image' | 'video' | 'file' | 'link' | 'tool';\n  url: string;\n  name: string;\n  size?: number;\n  metadata?: Record<string, unknown>;\n}\n\ninterface Poll {\n  question: string;\n  options: string[];\n  allowMultiple: boolean;\n  expiresAt?: string;\n}\n\ninterface Event {\n  title: string;\n  description: string;\n  startTime: string;\n  endTime?: string;\n  location?: string;\n}\n\ninterface Location {\n  name: string;\n  coordinates?: [number, number];\n}\n\ntype PostType = 'text' | 'image' | 'video' | 'link' | 'poll' | 'event' | 'tool' | 'announcement';\n\nexport function PostComposer({\n  onPost,\n  onCancel,\n  spaceId,\n  placeholder = \"What's happening?\",\n  maxLength = 500,\n  allowedTypes = ['text', 'image', 'link', 'poll', 'event'],\n  user\n}: PostComposerProps) {\n  const [content, setContent] = useState('');\n  const [postType, setPostType] = useState<PostType>('text');\n  const [visibility, setVisibility] = useState<'public' | 'space' | 'private'>(\n    spaceId ? 'space' : 'public'\n  );\n  const [attachments, setAttachments] = useState<Attachment[]>([]);\n  const [mentions, setMentions] = useState<string[]>([]);\n  const [tags, setTags] = useState<string[]>([]);\n  const [isPosting, setIsPosting] = useState(false);\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Poll state\n  const [poll, setPoll] = useState<Poll>({\n    question: '',\n    options: ['', ''],\n    allowMultiple: false\n  });\n\n  // Event state\n  const [event, setEvent] = useState<Event>({\n    title: '',\n    description: '',\n    startTime: '',\n  });\n\n  // Location state\n  const [location, setLocation] = useState<Location | null>(null);\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  // Auto-resize textarea\n  const adjustTextareaHeight = useCallback(() => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = `${textarea.scrollHeight}px`;\n    }\n  }, []);\n\n  const handleContentChange = (value: string) => {\n    setContent(value);\n    setError(null);\n    adjustTextareaHeight();\n    \n    // Extract mentions and hashtags\n    const mentionMatches = value.match(/@(\\w+)/g) || [];\n    const tagMatches = value.match(/#(\\w+)/g) || [];\n    \n    setMentions(mentionMatches.map(m => m.slice(1)));\n    setTags(tagMatches.map(t => t.slice(1)));\n  };\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(event.target.files || []);\n    \n    files.forEach(file => {\n      const attachment: Attachment = {\n        id: `attachment_${Date.now()}_${Math.random()}`,\n        type: file.type.startsWith('image/') ? 'image' : \n              file.type.startsWith('video/') ? 'video' : 'file',\n        url: URL.createObjectURL(file),\n        name: file.name,\n        size: file.size,\n        metadata: { originalFile: file }\n      };\n      \n      setAttachments(prev => [...prev, attachment]);\n    });\n  };\n\n  const removeAttachment = (id: string) => {\n    setAttachments(prev => {\n      const attachment = prev.find(a => a.id === id);\n      if (attachment && attachment.url.startsWith('blob:')) {\n        URL.revokeObjectURL(attachment.url);\n      }\n      return prev.filter(a => a.id !== id);\n    });\n  };\n\n  const addPollOption = () => {\n    setPoll(prev => ({\n      ...prev,\n      options: [...prev.options, '']\n    }));\n  };\n\n  const updatePollOption = (index: number, value: string) => {\n    setPoll(prev => ({\n      ...prev,\n      options: prev.options.map((opt, i) => i === index ? value : opt)\n    }));\n  };\n\n  const removePollOption = (index: number) => {\n    if (poll.options.length > 2) {\n      setPoll(prev => ({\n        ...prev,\n        options: prev.options.filter((_, i) => i !== index)\n      }));\n    }\n  };\n\n  const validatePost = (): string | null => {\n    if (!content.trim() && attachments.length === 0) {\n      return 'Post cannot be empty';\n    }\n    \n    if (content.length > maxLength) {\n      return `Post is too long (${content.length}/${maxLength} characters)`;\n    }\n    \n    if (postType === 'poll') {\n      if (!poll.question.trim()) {\n        return 'Poll question is required';\n      }\n      const validOptions = poll.options.filter(opt => opt.trim());\n      if (validOptions.length < 2) {\n        return 'Poll must have at least 2 options';\n      }\n    }\n    \n    if (postType === 'event') {\n      if (!event.title.trim()) {\n        return 'Event title is required';\n      }\n      if (!event.startTime) {\n        return 'Event start time is required';\n      }\n    }\n    \n    return null;\n  };\n\n  const handlePost = async () => {\n    const validationError = validatePost();\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    setIsPosting(true);\n    setError(null);\n\n    try {\n      const postData: PostData = {\n        content: content.trim(),\n        type: postType,\n        visibility,\n        attachments,\n        mentions,\n        tags,\n        spaceId,\n        ...(postType === 'poll' && { poll }),\n        ...(postType === 'event' && { event }),\n        ...(location && { location })\n      };\n\n      await onPost(postData);\n      \n      // Reset form\n      setContent('');\n      setAttachments([]);\n      setMentions([]);\n      setTags([]);\n      setPoll({ question: '', options: ['', ''], allowMultiple: false });\n      setEvent({ title: '', description: '', startTime: '' });\n      setLocation(null);\n      setPostType('text');\n      setShowAdvanced(false);\n      \n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create post');\n    } finally {\n      setIsPosting(false);\n    }\n  };\n\n  const getVisibilityIcon = () => {\n    switch (visibility) {\n      case 'public': return <Globe className=\"h-4 w-4\" />;\n      case 'space': return <Users className=\"h-4 w-4\" />;\n      case 'private': return <Lock className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getVisibilityLabel = () => {\n    switch (visibility) {\n      case 'public': return 'Everyone on HIVE';\n      case 'space': return spaceId ? 'Space members only' : 'Space members';\n      case 'private': return 'Only you';\n    }\n  };\n\n  const characterCount = content.length;\n  const isOverLimit = characterCount > maxLength;\n  const isNearLimit = characterCount > maxLength * 0.8;\n\n  return (\n    <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n      <div className=\"space-y-4\">\n        {/* Header */}\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-10 h-10 bg-[var(--hive-brand-primary)] text-hive-obsidian font-semibold rounded-full flex items-center justify-center\">\n            {user.avatarUrl ? (\n              <img src={user.avatarUrl} alt={user.name} className=\"w-full h-full rounded-full object-cover\" />\n            ) : (\n              user.name.charAt(0).toUpperCase()\n            )}\n          </div>\n          <div className=\"flex-1\">\n            <p className=\"font-medium text-white\">{user.name}</p>\n            <div className=\"flex items-center space-x-2 text-sm text-hive-text-mutedLight\">\n              {getVisibilityIcon()}\n              <span>{getVisibilityLabel()}</span>\n            </div>\n          </div>\n          {onCancel && (\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={onCancel}\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          )}\n        </div>\n\n        {/* Content Area */}\n        <div className=\"space-y-3\">\n          <Textarea\n            ref={textareaRef}\n            value={content}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleContentChange((e.target as any).value)}\n            placeholder={placeholder}\n            className={`min-h-[80px] resize-none border-none bg-transparent text-white placeholder:text-hive-text-mutedLight focus:outline-none ${\n              isOverLimit ? 'text-red-400' : ''\n            }`}\n            maxLength={maxLength + 50} // Allow slightly over for better UX\n          />\n\n          {/* Character Count */}\n          <div className=\"flex justify-end\">\n            <span className={`text-xs ${\n              isOverLimit ? 'text-red-400' : \n              isNearLimit ? 'text-yellow-400' : \n              'text-hive-text-mutedLight'\n            }`}>\n              {characterCount}/{maxLength}\n            </span>\n          </div>\n\n          {/* Post Type Specific Content */}\n          {postType === 'poll' && (\n            <div className=\"space-y-3 p-3 bg-hive-background-tertiary rounded-lg\">\n              <input\n                type=\"text\"\n                value={poll.question}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setPoll(prev => ({ ...prev, question: (e.target as any).value }))}\n                placeholder=\"Ask a question...\"\n                className=\"w-full bg-transparent text-white placeholder:text-hive-text-mutedLight border-none outline-none\"\n              />\n              \n              <div className=\"space-y-2\">\n                {poll.options.map((option, index) => (\n                  <div key={index} className=\"flex items-center space-x-2\">\n                    <div className=\"w-4 h-4 rounded-full border-2 border-hive-text-mutedLight\" />\n                    <input\n                      type=\"text\"\n                      value={option}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => updatePollOption(index, (e.target as any).value)}\n                      placeholder={`Option ${index + 1}`}\n                      className=\"flex-1 bg-transparent text-white placeholder:text-hive-text-mutedLight border-none outline-none\"\n                    />\n                    {poll.options.length > 2 && (\n                      <Button\n                        variant=\"outline\"\n                        className=\"max-w-sm text-red-400 border-red-400\"\n                        onClick={() => removePollOption(index)}\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </Button>\n                    )}\n                  </div>\n                ))}\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                  onClick={addPollOption}\n                  disabled={poll.options.length >= 4}\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Add Option\n                </Button>\n                \n                <label className=\"flex items-center space-x-2 text-sm text-hive-text-mutedLight\">\n                  <input\n                    type=\"checkbox\"\n                    checked={poll.allowMultiple}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setPoll(prev => ({ ...prev, allowMultiple: e.target.checked }))}\n                    className=\"rounded\"\n                  />\n                  <span>Allow multiple choices</span>\n                </label>\n              </div>\n            </div>\n          )}\n\n          {postType === 'event' && (\n            <div className=\"space-y-3 p-3 bg-hive-background-tertiary rounded-lg\">\n              <input\n                type=\"text\"\n                value={event.title}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setEvent(prev => ({ ...prev, title: (e.target as any).value }))}\n                placeholder=\"Event title\"\n                className=\"w-full bg-transparent text-white placeholder:text-hive-text-mutedLight border-none outline-none font-medium\"\n              />\n              \n              <textarea\n                value={event.description}\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setEvent(prev => ({ ...prev, description: (e.target as any).value }))}\n                placeholder=\"Event description\"\n                rows={2}\n                className=\"w-full bg-transparent text-white placeholder:text-hive-text-mutedLight border-none outline-none resize-none\"\n              />\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                <div>\n                  <label className=\"text-xs text-hive-text-mutedLight\">Start Time</label>\n                  <input\n                    type=\"datetime-local\"\n                    value={event.startTime}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setEvent(prev => ({ ...prev, startTime: (e.target as any).value }))}\n                    className=\"w-full mt-1 bg-transparent text-white border border-hive-border-default rounded px-2 py-1\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-xs text-hive-text-mutedLight\">End Time (Optional)</label>\n                  <input\n                    type=\"datetime-local\"\n                    value={event.endTime || ''}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => setEvent(prev => ({ ...prev, endTime: (e.target as any).value }))}\n                    className=\"w-full mt-1 bg-transparent text-white border border-hive-border-default rounded px-2 py-1\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Attachments */}\n          {attachments.length > 0 && (\n            <div className=\"space-y-2\">\n              {attachments.map(attachment => (\n                <div key={attachment.id} className=\"flex items-center justify-between p-2 bg-hive-background-tertiary rounded\">\n                  <div className=\"flex items-center space-x-2\">\n                    {attachment.type === 'image' ? <Image className=\"h-4 w-4\" /> :\n                     attachment.type === 'video' ? <Image className=\"h-4 w-4\" /> :\n                     <Paperclip className=\"h-4 w-4\" />}\n                    <span className=\"text-sm text-white\">{attachment.name}</span>\n                    {attachment.size && (\n                      <span className=\"text-xs text-hive-text-mutedLight\">\n                        ({(attachment.size / 1024).toFixed(1)}KB)\n                      </span>\n                    )}\n                  </div>\n                  <Button\n                    variant=\"outline\"\n                    className=\"max-w-sm text-red-400 border-red-400\"\n                    onClick={() => removeAttachment(attachment.id)}\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Error Display */}\n          {error && (\n            <Alert className=\"border-red-500/20 bg-red-500/10\">\n              <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n              <AlertDescription className=\"text-red-200\">\n                {error}\n              </AlertDescription>\n            </Alert>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            {/* Post Type Selector */}\n            <div className=\"flex items-center space-x-1\">\n              {allowedTypes.map(type => (\n                <Button\n                  key={type}\n                  variant=\"outline\"\n                  className={`max-w-sm ${postType === type ? 'bg-[var(--hive-brand-primary)]/20 border-[var(--hive-brand-primary)]' : ''}`}\n                  onClick={() => setPostType(type)}\n                  title={`Create ${type} post`}\n                >\n                  {type === 'text' && <span className=\"h-4 w-4 flex items-center justify-center text-xs\">üìÑ</span>}\n                  {type === 'image' && <Image className=\"h-4 w-4\" />}\n                  {type === 'link' && <Link className=\"h-4 w-4\" />}\n                  {type === 'poll' && <Poll className=\"h-4 w-4\" />}\n                  {type === 'event' && <Calendar className=\"h-4 w-4\" />}\n                  {type === 'tool' && <Code className=\"h-4 w-4\" />}\n                </Button>\n              ))}\n            </div>\n\n            {/* Media Upload */}\n            {allowedTypes.includes('image') && (\n              <>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                  onClick={() => fileInputRef.current?.click()}\n                >\n                  <Paperclip className=\"h-4 w-4\" />\n                </Button>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  multiple\n                  accept=\"image/*,video/*,.pdf,.doc,.docx\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                />\n              </>\n            )}\n\n            {/* Additional Tools */}\n            <Button\n              variant=\"outline\"\n              className={`max-w-sm ${showAdvanced ? 'bg-[var(--hive-brand-primary)]/20 border-[var(--hive-brand-primary)]' : ''}`}\n              onClick={() => setShowAdvanced(!showAdvanced)}\n            >\n              <Plus className=\"h-4 w-4\" />\n            </Button>\n          </div>\n\n          {/* Post Button */}\n          <Button\n            onClick={handlePost}\n            disabled={isPosting || isOverLimit || (!content.trim() && attachments.length === 0)}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            <Send className=\"h-4 w-4 mr-2\" />\n            {isPosting ? 'Posting...' : 'Post'}\n          </Button>\n        </div>\n\n        {/* Advanced Options */}\n        {showAdvanced && (\n          <div className=\"pt-3 border-t border-hive-border-default space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-white\">Visibility</span>\n              <div className=\"flex items-center space-x-2\">\n                {['public', 'space', 'private'].map(vis => (\n                  <Button\n                    key={vis}\n                    variant=\"outline\"\n                    className={`max-w-sm ${visibility === vis ? 'bg-[var(--hive-brand-primary)]/20 border-[var(--hive-brand-primary)]' : ''}`}\n                    onClick={() => setVisibility(vis as 'public' | 'space' | 'private')}\n                    disabled={vis === 'space' && !spaceId}\n                  >\n                    {vis === 'public' && <Globe className=\"h-4 w-4\" />}\n                    {vis === 'space' && <Users className=\"h-4 w-4\" />}\n                    {vis === 'private' && <Lock className=\"h-4 w-4\" />}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/social/social-feed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/create-space-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Dialog, Button, Card, Badge, Input, Alert } from \"@hive/ui\";\nimport { \n  ArrowRight, \n  ArrowLeft,\n  Check,\n  Users,\n  Lock,\n  Globe,\n  Shield,\n  Settings,\n  Mail,\n  Plus,\n  X,\n  AlertCircle,\n  BookOpen,\n  Home,\n  Briefcase,\n  Trophy,\n  Hammer\n} from \"lucide-react\";\n\ninterface CreateSpaceModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCreateSpace: (_spaceData: CreateSpaceData) => void;\n  isLoading?: boolean;\n  error?: string | null;\n}\n\ninterface CreateSpaceData {\n  type: SpaceType;\n  name: string;\n  description: string;\n  avatar?: string;\n  banner?: string;\n  visibility: 'public' | 'private' | 'invite_only';\n  joinProcess: 'instant' | 'approval' | 'invite_only';\n  rules: string[];\n  tools: string[];\n  foundingMembers: string[];\n  customizations: {\n    primaryColor?: string;\n    category?: string;\n    tags?: string[];\n  };\n}\n\ntype SpaceType = 'academic' | 'residential' | 'professional' | 'recreational' | 'project';\n\ntype CreateStep = 'type' | 'details' | 'privacy' | 'rules' | 'tools' | 'members' | 'review';\n\nconst SPACE_TYPES = {\n  academic: {\n    name: 'Academic',\n    icon: BookOpen,\n    emoji: 'üìö',\n    description: 'Study groups, research teams, course collaboration',\n    examples: ['CS Study Group', 'Physics Research Lab', 'Writing Circle'],\n    suggestedTools: ['study-timer', 'file-share', 'whiteboard', 'poll-maker'],\n    color: 'bg-blue-500',\n    features: ['Study scheduling', 'Resource sharing', 'Progress tracking', 'Academic calendar integration']\n  },\n  residential: {\n    name: 'Residential',\n    icon: Home,\n    emoji: 'üè†',\n    description: 'Residence halls, floors, building communities',\n    examples: ['Floor 3 Community', 'Building A Residents', 'Roommate Group'],\n    suggestedTools: ['group-chat', 'poll-maker', 'file-share', 'attendance'],\n    color: 'bg-green-500',\n    features: ['Room coordination', 'Floor events', 'Maintenance requests', 'Quiet hours scheduling']\n  },\n  professional: {\n    name: 'Professional',\n    icon: Briefcase,\n    emoji: 'üíº',\n    description: 'Career clubs, networking, professional development',\n    examples: ['Engineering Career Club', 'Pre-Med Society', 'Startup Network'],\n    suggestedTools: ['group-chat', 'file-share', 'poll-maker', 'whiteboard'],\n    color: 'bg-purple-500',\n    features: ['Job sharing', 'Networking events', 'Mentorship matching', 'Professional development']\n  },\n  recreational: {\n    name: 'Recreational',\n    icon: Trophy,\n    emoji: 'üéÆ',\n    description: 'Sports teams, hobby groups, gaming communities',\n    examples: ['Intramural Soccer', 'Board Game Club', 'Photography Group'],\n    suggestedTools: ['group-chat', 'poll-maker', 'attendance', 'file-share'],\n    color: 'bg-orange-500',\n    features: ['Event coordination', 'Resource booking', 'Tournament brackets', 'Activity planning']\n  },\n  project: {\n    name: 'Project',\n    icon: Hammer,\n    emoji: 'üõ†Ô∏è',\n    description: 'Hackathon teams, student orgs, volunteer groups',\n    examples: ['Hackathon Team Alpha', 'Community Service Club', 'App Development Group'],\n    suggestedTools: ['whiteboard', 'file-share', 'group-chat', 'poll-maker'],\n    color: 'bg-red-500',\n    features: ['Project management', 'Deadline tracking', 'Resource allocation', 'Outcome sharing']\n  }\n};\n\nconst SUGGESTED_TOOLS = {\n  'study-timer': { name: 'Study Timer', icon: '‚è±Ô∏è', description: 'Synchronized focus sessions' },\n  'poll-maker': { name: 'Live Polls', icon: 'üìä', description: 'Real-time polling and voting' },\n  'whiteboard': { name: 'Whiteboard', icon: 'üìù', description: 'Collaborative drawing space' },\n  'file-share': { name: 'File Share', icon: 'üìÅ', description: 'Document sharing hub' },\n  'group-chat': { name: 'Group Chat', icon: 'üí¨', description: 'Dedicated chat channel' },\n  'attendance': { name: 'Attendance', icon: '‚úÖ', description: 'Event attendance tracking' }\n};\n\nexport function CreateSpaceModal({ isOpen, onClose, onCreateSpace, isLoading = false, error = null }: CreateSpaceModalProps) {\n  const [currentStep, setCurrentStep] = useState<CreateStep>('type');\n  const [spaceData, setSpaceData] = useState<CreateSpaceData>({\n    type: 'academic',\n    name: '',\n    description: '',\n    visibility: 'public',\n    joinProcess: 'instant',\n    rules: [],\n    tools: [],\n    foundingMembers: [],\n    customizations: {}\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [newRule, setNewRule] = useState('');\n\n  const steps: CreateStep[] = ['type', 'details', 'privacy', 'rules', 'tools', 'members', 'review'];\n  const currentStepIndex = steps.indexOf(currentStep);\n\n  const validateStep = (step: CreateStep): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    switch (step) {\n      case 'type':\n        if (!spaceData.type) newErrors.type = 'Please select a space type';\n        break;\n      case 'details':\n        if (!spaceData.name.trim()) newErrors.name = 'Space name is required';\n        if (spaceData.name.length > 50) newErrors.name = 'Space name must be 50 characters or less';\n        if (!spaceData.description.trim()) newErrors.description = 'Description is required';\n        if (spaceData.description.length > 200) newErrors.description = 'Description must be 200 characters or less';\n        break;\n      case 'privacy':\n        if (!spaceData.visibility) newErrors.visibility = 'Please select visibility';\n        if (!spaceData.joinProcess) newErrors.joinProcess = 'Please select join process';\n        break;\n      case 'rules':\n        if (spaceData.rules.length === 0) newErrors.rules = 'Please add at least one community guideline';\n        break;\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const nextStep = () => {\n    if (validateStep(currentStep)) {\n      const nextIndex = currentStepIndex + 1;\n      if (nextIndex < steps.length) {\n        setCurrentStep(steps[nextIndex]);\n      }\n    }\n  };\n\n  const prevStep = () => {\n    const prevIndex = currentStepIndex - 1;\n    if (prevIndex >= 0) {\n      setCurrentStep(steps[prevIndex]);\n    }\n  };\n\n  const handleCreateSpace = () => {\n    if (validateStep('review') && !isLoading) {\n      onCreateSpace(spaceData);\n      // Don't close modal or reset form here - parent will handle it\n    }\n  };\n\n  // Reset form when modal closes\n  const handleClose = () => {\n    if (!isLoading) {\n      onClose();\n      setCurrentStep('type');\n      setSpaceData({\n        type: 'academic',\n        name: '',\n        description: '',\n        visibility: 'public',\n        joinProcess: 'instant',\n        rules: [],\n        tools: [],\n        foundingMembers: [],\n        customizations: {}\n      });\n      setErrors({});\n    }\n  };\n\n  const updateSpaceData = (updates: Partial<CreateSpaceData>) => {\n    setSpaceData(prev => ({ ...prev, ...updates }));\n    setErrors({});\n  };\n\n  const addRule = (rule: string) => {\n    if (rule.trim() && !spaceData.rules.includes(rule.trim())) {\n      updateSpaceData({ rules: [...spaceData.rules, rule.trim()] });\n    }\n  };\n\n  const removeRule = (index: number) => {\n    updateSpaceData({ rules: spaceData.rules.filter((_, i) => i !== index) });\n  };\n\n  const toggleTool = (toolId: string) => {\n    const tools = spaceData.tools.includes(toolId)\n      ? spaceData.tools.filter(t => t !== toolId)\n      : [...spaceData.tools, toolId];\n    updateSpaceData({ tools });\n  };\n\n  const getStepTitle = (step: CreateStep) => {\n    switch (step) {\n      case 'type': return 'Choose Space Type';\n      case 'details': return 'Space Details';\n      case 'privacy': return 'Privacy & Access';\n      case 'rules': return 'Community Guidelines';\n      case 'tools': return 'Tools & Features';\n      case 'members': return 'Founding Members';\n      case 'review': return 'Review & Launch';\n      default: return '';\n    }\n  };\n\n  const renderStepContent = () => {\n    switch (currentStep) {\n      case 'type':\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-xl font-semibold text-white mb-2\">What type of space are you creating?</h3>\n              <p className=\"text-zinc-400\">Choose the category that best fits your community's purpose</p>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {Object.entries(SPACE_TYPES).map(([type, config]) => {\n                const _Icon = config.icon;\n                const isSelected = spaceData.type === type;\n                \n                return (\n                  <Card\n                    key={type}\n                    className={`p-4 cursor-pointer transition-all duration-200 ${\n                      isSelected \n                        ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]' \n                        : 'bg-zinc-800/50 border-zinc-700 hover:bg-zinc-800'\n                    }`}\n                    onClick={() => updateSpaceData({ type: type as SpaceType })}\n                  >\n                    <div className=\"flex items-start space-x-3\">\n                      <div className={`w-12 h-12 ${config.color} rounded-lg flex items-center justify-center text-xl flex-shrink-0`}>\n                        {config.emoji}\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <h4 className=\"font-semibold text-white\">{config.name}</h4>\n                          {isSelected && <Check className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />}\n                        </div>\n                        <p className=\"text-sm text-zinc-400 mb-3 leading-tight\">{config.description}</p>\n                        <div className=\"space-y-2\">\n                          <div className=\"text-xs text-zinc-500 font-medium\">Examples:</div>\n                          <div className=\"flex flex-wrap gap-1\">\n                            {config.examples.slice(0, 2).map((example) => (\n                              <Badge key={example} variant=\"secondary\" className=\"text-xs\">\n                                {example}\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </Card>\n                );\n              })}\n            </div>\n\n            {errors.type && (\n              <div className=\"flex items-center space-x-2 text-red-400 text-sm\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <span>{errors.type}</span>\n              </div>\n            )}\n          </div>\n        );\n\n      case 'details':\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <div className={`w-16 h-16 ${SPACE_TYPES[spaceData.type].color} rounded-xl flex items-center justify-center text-2xl mx-auto mb-3`}>\n                {SPACE_TYPES[spaceData.type].emoji}\n              </div>\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Space Identity</h3>\n              <p className=\"text-zinc-400\">Give your {SPACE_TYPES[spaceData.type].name.toLowerCase()} space a name and description</p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">Space Name *</label>\n                <Input\n                  value={spaceData.name}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => updateSpaceData({ name: (e.target as any).value })}\n                  placeholder=\"Enter a clear, descriptive name...\"\n                  maxLength={50}\n                  error={errors.name}\n                />\n                <div className=\"text-xs text-zinc-500 mt-1\">{spaceData.name.length}/50 characters</div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">Description *</label>\n                <textarea\n                  value={spaceData.description}\n                  onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => updateSpaceData({ description: (e.target as any).value })}\n                  placeholder=\"Describe the purpose and goals of your space...\"\n                  maxLength={200}\n                  rows={4}\n                  className={`w-full p-3 bg-zinc-800 border rounded-lg text-white placeholder-zinc-400 focus:outline-none focus:ring-2 focus:ring-[var(--hive-brand-primary)]/50 resize-none ${\n                    errors.description ? 'border-red-500' : 'border-zinc-700 focus:border-[var(--hive-brand-primary)]'\n                  }`}\n                />\n                <div className=\"flex items-center justify-between mt-1\">\n                  <div className=\"text-xs text-zinc-500\">{spaceData.description.length}/200 characters</div>\n                  {errors.description && (\n                    <div className=\"text-red-400 text-xs\">{errors.description}</div>\n                  )}\n                </div>\n              </div>\n\n              {/* Category Tags */}\n              <div>\n                <label className=\"block text-sm font-medium text-white mb-2\">Category Tags (Optional)</label>\n                <div className=\"flex flex-wrap gap-2\">\n                  {['study-group', 'social', 'academic', 'project', 'community', 'networking'].map((tag) => (\n                    <Badge\n                      key={tag}\n                      variant=\"secondary\"\n                      className={`cursor-pointer transition-colors ${\n                        spaceData.customizations.tags?.includes(tag) ? 'bg-[var(--hive-brand-primary)] text-hive-obsidian' : ''\n                      }`}\n                      onClick={() => {\n                        const currentTags = spaceData.customizations.tags || [];\n                        const newTags = currentTags.includes(tag)\n                          ? currentTags.filter(t => t !== tag)\n                          : [...currentTags, tag];\n                        updateSpaceData({\n                          customizations: { ...spaceData.customizations, tags: newTags }\n                        });\n                      }}\n                    >\n                      #{tag}\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'privacy':\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Privacy & Access Settings</h3>\n              <p className=\"text-zinc-400\">Configure who can see and join your space</p>\n            </div>\n\n            {/* Visibility Settings */}\n            <div>\n              <h4 className=\"font-medium text-white mb-3\">Space Visibility</h4>\n              <div className=\"space-y-3\">\n                {[\n                  {\n                    value: 'public',\n                    icon: Globe,\n                    title: 'Public',\n                    description: 'Anyone on campus can discover and view this space'\n                  },\n                  {\n                    value: 'private',\n                    icon: Lock,\n                    title: 'Private',\n                    description: 'Only members can see the space and its content'\n                  },\n                  {\n                    value: 'invite_only',\n                    icon: Shield,\n                    title: 'Invite Only',\n                    description: 'Only invited users can see and access the space'\n                  }\n                ].map((option) => {\n                  const Icon = option.icon;\n                  const isSelected = spaceData.visibility === option.value;\n                  \n                  return (\n                    <Card\n                      key={option.value}\n                      className={`p-4 cursor-pointer transition-all duration-200 ${\n                        isSelected \n                          ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]' \n                          : 'bg-zinc-800/50 border-zinc-700 hover:bg-zinc-800'\n                      }`}\n                      onClick={() => updateSpaceData({ visibility: option.value as any })}\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        <Icon className={`h-5 w-5 ${isSelected ? 'text-[var(--hive-brand-primary)]' : 'text-zinc-400'}`} />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-white\">{option.title}</div>\n                          <div className=\"text-sm text-zinc-400\">{option.description}</div>\n                        </div>\n                        {isSelected && <Check className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />}\n                      </div>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Join Process */}\n            <div>\n              <h4 className=\"font-medium text-white mb-3\">Join Process</h4>\n              <div className=\"space-y-3\">\n                {[\n                  {\n                    value: 'instant',\n                    icon: Users,\n                    title: 'Instant Join',\n                    description: 'Anyone can join immediately without approval'\n                  },\n                  {\n                    value: 'approval',\n                    icon: Settings,\n                    title: 'Requires Approval',\n                    description: 'Admins must approve new member requests'\n                  },\n                  {\n                    value: 'invite_only',\n                    icon: Mail,\n                    title: 'Invite Only',\n                    description: 'New members can only join via invitation'\n                  }\n                ].map((option) => {\n                  const Icon = option.icon;\n                  const isSelected = spaceData.joinProcess === option.value;\n                  \n                  return (\n                    <Card\n                      key={option.value}\n                      className={`p-4 cursor-pointer transition-all duration-200 ${\n                        isSelected \n                          ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]' \n                          : 'bg-zinc-800/50 border-zinc-700 hover:bg-zinc-800'\n                      }`}\n                      onClick={() => updateSpaceData({ joinProcess: option.value as any })}\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        <Icon className={`h-5 w-5 ${isSelected ? 'text-[var(--hive-brand-primary)]' : 'text-zinc-400'}`} />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-white\">{option.title}</div>\n                          <div className=\"text-sm text-zinc-400\">{option.description}</div>\n                        </div>\n                        {isSelected && <Check className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />}\n                      </div>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'rules': {\n        const defaultRules = [\n          'Be respectful and constructive in all interactions',\n          'Stay on topic and contribute meaningfully',\n          'No spam, harassment, or inappropriate content',\n          'Help maintain a positive learning environment'\n        ];\n\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Community Guidelines</h3>\n              <p className=\"text-zinc-400\">Set clear expectations for your space members</p>\n            </div>\n\n            {/* Add Rule Input */}\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Add Custom Rule</label>\n              <div className=\"flex space-x-2\">\n                <input\n                  type=\"text\"\n                  value={newRule}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => setNewRule((e.target as any).value)}\n                  placeholder=\"Enter a community guideline...\"\n                  className=\"flex-1 p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white placeholder-zinc-400 focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n                  onKeyPress={(e) => {\n                    if (e.key === 'Enter') {\n                      addRule(newRule);\n                      setNewRule('');\n                    }\n                  }}\n                />\n                <Button\n                  onClick={() => {\n                    addRule(newRule);\n                    setNewRule('');\n                  }}\n                  disabled={!newRule.trim()}\n                  className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n                >\n                  <Plus className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n\n            {/* Suggested Rules */}\n            <div>\n              <h4 className=\"font-medium text-white mb-3\">Suggested Guidelines</h4>\n              <div className=\"space-y-2\">\n                {defaultRules.map((rule, index) => (\n                  <div\n                    key={index}\n                    className={`p-3 rounded-lg border cursor-pointer transition-colors ${\n                      spaceData.rules.includes(rule)\n                        ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)] text-white'\n                        : 'bg-zinc-800/50 border-zinc-700 text-zinc-300 hover:bg-zinc-800'\n                    }`}\n                    onClick={() => {\n                      if (spaceData.rules.includes(rule)) {\n                        removeRule(spaceData.rules.indexOf(rule));\n                      } else {\n                        addRule(rule);\n                      }\n                    }}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm\">{rule}</span>\n                      {spaceData.rules.includes(rule) ? (\n                        <Check className=\"h-4 w-4 text-[var(--hive-brand-primary)]\" />\n                      ) : (\n                        <Plus className=\"h-4 w-4 text-zinc-400\" />\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Current Rules */}\n            {spaceData.rules.length > 0 && (\n              <div>\n                <h4 className=\"font-medium text-white mb-3\">Your Community Guidelines ({spaceData.rules.length})</h4>\n                <div className=\"space-y-2\">\n                  {spaceData.rules.map((rule, index) => (\n                    <div key={index} className=\"flex items-center justify-between p-3 bg-[var(--hive-brand-primary)]/10 border border-[var(--hive-brand-primary)] rounded-lg\">\n                      <span className=\"text-sm text-white\">{rule}</span>\n                      <Button\n                        variant=\"outline\"\n                        className=\"max-w-sm text-red-400 hover:text-red-300\"\n                        onClick={() => removeRule(index)}\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {errors.rules && (\n              <div className=\"flex items-center space-x-2 text-red-400 text-sm\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <span>{errors.rules}</span>\n              </div>\n            )}\n          </div>\n        );\n      }\n\n      case 'tools': {\n        const suggestedTools = SPACE_TYPES[spaceData.type].suggestedTools;\n        \n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Tools & Features</h3>\n              <p className=\"text-zinc-400\">Choose tools that will help your {SPACE_TYPES[spaceData.type].name.toLowerCase()} space coordinate effectively</p>\n            </div>\n\n            {/* Recommended Tools */}\n            <div>\n              <h4 className=\"font-medium text-white mb-3\">Recommended for {SPACE_TYPES[spaceData.type].name} Spaces</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {suggestedTools.map((toolId) => {\n                  const tool = SUGGESTED_TOOLS[toolId as keyof typeof SUGGESTED_TOOLS];\n                  const isSelected = spaceData.tools.includes(toolId);\n                  \n                  return (\n                    <Card\n                      key={toolId}\n                      className={`p-4 cursor-pointer transition-all duration-200 ${\n                        isSelected \n                          ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]' \n                          : 'bg-zinc-800/50 border-zinc-700 hover:bg-zinc-800'\n                      }`}\n                      onClick={() => toggleTool(toolId)}\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        <div className=\"text-2xl\">{tool.icon}</div>\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-white\">{tool.name}</div>\n                          <div className=\"text-sm text-zinc-400\">{tool.description}</div>\n                        </div>\n                        {isSelected && <Check className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />}\n                      </div>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Other Available Tools */}\n            <div>\n              <h4 className=\"font-medium text-white mb-3\">Other Available Tools</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {Object.entries(SUGGESTED_TOOLS)\n                  .filter(([toolId]) => !suggestedTools.includes(toolId))\n                  .map(([toolId, tool]) => {\n                    const isSelected = spaceData.tools.includes(toolId);\n                    \n                    return (\n                      <Card\n                        key={toolId}\n                        className={`p-4 cursor-pointer transition-all duration-200 ${\n                          isSelected \n                            ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]' \n                            : 'bg-zinc-800/50 border-zinc-700 hover:bg-zinc-800'\n                        }`}\n                        onClick={() => toggleTool(toolId)}\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"text-2xl\">{tool.icon}</div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-medium text-white\">{tool.name}</div>\n                            <div className=\"text-sm text-zinc-400\">{tool.description}</div>\n                          </div>\n                          {isSelected && <Check className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />}\n                        </div>\n                      </Card>\n                    );\n                  })}\n              </div>\n            </div>\n\n            {spaceData.tools.length > 0 && (\n              <div className=\"p-4 bg-zinc-800/30 rounded-lg\">\n                <div className=\"text-sm text-zinc-400 mb-2\">Selected Tools:</div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {spaceData.tools.map((toolId) => (\n                    <Badge key={toolId} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                      <span>{SUGGESTED_TOOLS[toolId as keyof typeof SUGGESTED_TOOLS]?.icon}</span>\n                      <span>{SUGGESTED_TOOLS[toolId as keyof typeof SUGGESTED_TOOLS]?.name}</span>\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        );\n      }\n\n      case 'members':\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Founding Members</h3>\n              <p className=\"text-zinc-400\">Invite initial members to help establish your space (optional)</p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-2\">Invite by Handle or Email</label>\n              <div className=\"flex space-x-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"@handle or email@university.edu\"\n                  className=\"flex-1 p-3 bg-zinc-800 border border-zinc-700 rounded-lg text-white placeholder-zinc-400 focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n                />\n                <Button className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Invite\n                </Button>\n              </div>\n              <div className=\"text-xs text-zinc-500 mt-1\">\n                You can invite more members after creating the space\n              </div>\n            </div>\n\n            <div className=\"p-4 bg-zinc-800/30 rounded-lg\">\n              <div className=\"flex items-center space-x-2 text-sm text-zinc-400\">\n                <Users className=\"h-4 w-4\" />\n                <span>You'll be automatically added as the space admin</span>\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'review':\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <div className={`w-16 h-16 ${SPACE_TYPES[spaceData.type].color} rounded-xl flex items-center justify-center text-2xl mx-auto mb-3`}>\n                {SPACE_TYPES[spaceData.type].emoji}\n              </div>\n              <h3 className=\"text-xl font-semibold text-white mb-2\">Ready to Launch!</h3>\n              <p className=\"text-zinc-400\">Review your space details before creating</p>\n            </div>\n\n            <div className=\"space-y-4\">\n              {/* Basic Info */}\n              <Card className=\"p-4 bg-zinc-800/50 border-zinc-700\">\n                <h4 className=\"font-medium text-white mb-3\">Basic Information</h4>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-zinc-400\">Type:</span>\n                    <Badge variant=\"secondary\">{SPACE_TYPES[spaceData.type].name}</Badge>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-zinc-400\">Name:</span>\n                    <span className=\"text-white font-medium\">{spaceData.name}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-zinc-400\">Visibility:</span>\n                    <span className=\"text-white capitalize\">{spaceData.visibility.replace('_', ' ')}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-zinc-400\">Join Process:</span>\n                    <span className=\"text-white capitalize\">{spaceData.joinProcess.replace('_', ' ')}</span>\n                  </div>\n                </div>\n              </Card>\n\n              {/* Description */}\n              <Card className=\"p-4 bg-zinc-800/50 border-zinc-700\">\n                <h4 className=\"font-medium text-white mb-2\">Description</h4>\n                <p className=\"text-zinc-300 text-sm leading-relaxed\">{spaceData.description}</p>\n              </Card>\n\n              {/* Guidelines */}\n              <Card className=\"p-4 bg-zinc-800/50 border-zinc-700\">\n                <h4 className=\"font-medium text-white mb-3\">Community Guidelines ({spaceData.rules.length})</h4>\n                <div className=\"space-y-2\">\n                  {spaceData.rules.map((rule, index) => (\n                    <div key={index} className=\"flex items-start space-x-2 text-sm\">\n                      <Check className=\"h-4 w-4 text-green-400 mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-zinc-300\">{rule}</span>\n                    </div>\n                  ))}\n                </div>\n              </Card>\n\n              {/* Tools */}\n              {spaceData.tools.length > 0 && (\n                <Card className=\"p-4 bg-zinc-800/50 border-zinc-700\">\n                  <h4 className=\"font-medium text-white mb-3\">Enabled Tools ({spaceData.tools.length})</h4>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {spaceData.tools.map((toolId) => (\n                      <Badge key={toolId} variant=\"secondary\" className=\"flex items-center space-x-1\">\n                        <span>{SUGGESTED_TOOLS[toolId as keyof typeof SUGGESTED_TOOLS]?.icon}</span>\n                        <span>{SUGGESTED_TOOLS[toolId as keyof typeof SUGGESTED_TOOLS]?.name}</span>\n                      </Badge>\n                    ))}\n                  </div>\n                </Card>\n              )}\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={handleClose}\n     \n     \n      className=\"max-h-[90vh] overflow-hidden\"\n    >\n      <div className=\"flex flex-col h-full\">\n        {/* Header with Progress */}\n        <div className=\"p-6 border-b border-zinc-800\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-2xl font-bold text-white\">Create New Space</h2>\n            <div className=\"text-sm text-zinc-400\">\n              Step {currentStepIndex + 1} of {steps.length}\n            </div>\n          </div>\n          \n          {/* Progress Bar */}\n          <div className=\"flex items-center space-x-2\">\n            {steps.map((step, index) => (\n              <div key={step} className=\"flex-1\">\n                <div className={`h-2 rounded-full transition-colors ${\n                  index <= currentStepIndex ? 'bg-[var(--hive-brand-primary)]' : 'bg-zinc-700'\n                }`} />\n              </div>\n            ))}\n          </div>\n          \n          <div className=\"mt-3\">\n            <h3 className=\"text-lg font-semibold text-white\">{getStepTitle(currentStep)}</h3>\n          </div>\n        </div>\n\n        {/* Step Content */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {renderStepContent()}\n        </div>\n\n        {/* Footer Actions */}\n        <div className=\"p-6 border-t border-zinc-800\">\n          {/* Error Display */}\n          {error && (\n            <div className=\"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/20 flex items-center gap-2\">\n              <AlertCircle className=\"h-4 w-4 text-red-400 flex-shrink-0\" />\n              <span className=\"text-sm text-red-400\">{error}</span>\n            </div>\n          )}\n          <div className=\"flex items-center justify-between\">\n            <Button\n              variant=\"outline\"\n              onClick={currentStepIndex === 0 ? handleClose : prevStep}\n              className=\"flex items-center space-x-2\"\n              disabled={isLoading}\n            >\n              <ArrowLeft className=\"h-4 w-4\" />\n              <span>{currentStepIndex === 0 ? 'Cancel' : 'Back'}</span>\n            </Button>\n\n            <Button\n              onClick={currentStep === 'review' ? handleCreateSpace : nextStep}\n              className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne flex items-center space-x-2\"\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-hive-obsidian/20 border-t-hive-obsidian rounded-full animate-spin\" />\n                  <span>Creating...</span>\n                </>\n              ) : (\n                <>\n                  <span>{currentStep === 'review' ? 'Create Space' : 'Continue'}</span>\n                  {currentStep !== 'review' && <ArrowRight className=\"h-4 w-4\" />}\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/leader-toolbar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":9}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Shield, \n  Users, \n  Settings, \n  BarChart3, \n  Crown,\n  ChevronUp,\n  ChevronDown,\n  Pin,\n  Trash2,\n  Lock,\n  UserCog,\n  Eye,\n  EyeOff\n} from 'lucide-react';\nimport { Button, Badge } from \"@hive/ui\";\nimport { cn } from '../../lib/utils';\n\nexport type LeaderMode = 'moderate' | 'manage' | 'configure' | 'insights' | null;\n\ninterface LeaderToolbarProps {\n  isVisible: boolean;\n  currentMode: LeaderMode;\n  onModeChange: (mode: LeaderMode) => void;\n  spaceRole: 'owner' | 'admin' | 'moderator';\n  className?: string;\n}\n\nconst LEADER_MODES = {\n  moderate: {\n    icon: Shield,\n    label: 'Moderate',\n    description: 'Pin, delete, and manage content',\n    color: 'text-red-400',\n    bgColor: 'bg-red-500/20',\n    borderColor: 'border-red-500/30'\n  },\n  manage: {\n    icon: Users,\n    label: 'Manage',\n    description: 'Member roles and permissions',\n    color: 'text-blue-400',\n    bgColor: 'bg-blue-500/20',\n    borderColor: 'border-blue-500/30'\n  },\n  configure: {\n    icon: Settings,\n    label: 'Configure',\n    description: 'Space settings and rules',\n    color: 'text-green-400',\n    bgColor: 'bg-green-500/20',\n    borderColor: 'border-green-500/30'\n  },\n  insights: {\n    icon: BarChart3,\n    label: 'Insights',\n    description: 'Analytics and engagement data',\n    color: 'text-purple-400',\n    bgColor: 'bg-purple-500/20',\n    borderColor: 'border-purple-500/30'\n  }\n} as const;\n\nexport function LeaderToolbar({ \n  isVisible, \n  currentMode, \n  onModeChange, \n  spaceRole,\n  className \n}: LeaderToolbarProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  const availableModes = Object.entries(LEADER_MODES).filter(([mode]) => {\n    // All roles can moderate and manage\n    if (mode === 'moderate' || mode === 'manage') return true;\n    // Only admin+ can configure and view insights\n    if (mode === 'configure' || mode === 'insights') return spaceRole === 'owner' || spaceRole === 'admin';\n    return true;\n  });\n\n  if (!isVisible) return null;\n\n  return (\n    <motion.div\n      className={cn(\n        \"fixed bottom-6 right-6 z-50\",\n        className\n      )}\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: 20 }}\n    >\n      {/* Main Toolbar */}\n      <div className=\"relative\">\n        {/* Expanded Mode Buttons */}\n        <AnimatePresence>\n          {isExpanded && (\n            <motion.div\n              className=\"absolute bottom-16 right-0 space-y-2 w-48\"\n              initial={{ opacity: 0, y: 10, scale: 0.9 }}\n              animate={{ opacity: 1, y: 0, scale: 1 }}\n              exit={{ opacity: 0, y: 10, scale: 0.9 }}\n              transition={{ duration: 0.2 }}\n            >\n              {availableModes.map(([modeKey, modeConfig]) => {\n                const mode = modeKey as LeaderMode;\n                const ModeIcon = modeConfig.icon;\n                const isActive = currentMode === mode;\n                \n                return (\n                  <motion.button\n                    key={mode}\n                    className={cn(\n                      \"w-full flex items-center gap-3 p-3 rounded-xl bg-[#0A0A0A] border transition-all text-left\",\n                      isActive \n                        ? `${modeConfig.borderColor} ${modeConfig.bgColor}` \n                        : \"border-white/10 hover:border-white/20 hover:bg-white/5\"\n                    )}\n                    onClick={() => {\n                      onModeChange(isActive ? null : mode);\n                      setIsExpanded(false);\n                    }}\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                  >\n                    <ModeIcon className={cn(\n                      \"w-5 h-5\",\n                      isActive ? modeConfig.color : \"text-neutral-400\"\n                    )} />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className={cn(\n                        \"font-medium text-sm\",\n                        isActive ? \"text-white\" : \"text-neutral-300\"\n                      )}>\n                        {modeConfig.label}\n                      </div>\n                      <div className=\"text-xs text-neutral-400 truncate\">\n                        {modeConfig.description}\n                      </div>\n                    </div>\n                    {isActive && (\n                      <motion.div\n                        className={cn(\"w-2 h-2 rounded-full\", modeConfig.color.replace('text-', 'bg-'))}\n                        initial={{ scale: 0 }}\n                        animate={{ scale: 1 }}\n                      />\n                    )}\n                  </motion.button>\n                );\n              })}\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Main Toggle Button */}\n        <motion.button\n          className={cn(\n            \"flex items-center gap-3 p-4 rounded-xl backdrop-blur-sm border transition-all shadow-lg\",\n            currentMode \n              ? `${LEADER_MODES[currentMode].borderColor} ${LEADER_MODES[currentMode].bgColor}` \n              : \"bg-[#0A0A0A]/90 border-white/10 hover:border-white/20\"\n          )}\n          onClick={() => {\n            if (currentMode) {\n              onModeChange(null);\n            } else {\n              setIsExpanded(!isExpanded);\n            }\n          }}\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n        >\n          {currentMode ? (\n            // Active Mode Display\n            <>\n              {React.createElement(LEADER_MODES[currentMode].icon, {\n                className: cn(\"w-5 h-5\", LEADER_MODES[currentMode].color)\n              })}\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-white font-medium text-sm\">\n                  {LEADER_MODES[currentMode].label} Mode\n                </span>\n                <Badge variant=\"secondary\" className=\"text-xs px-2 py-0.5 bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-[var(--hive-brand-primary)]/30\">\n                  Active\n                </Badge>\n              </div>\n              <motion.div\n                className=\"w-2 h-2 rounded-full bg-[var(--hive-brand-primary)]\"\n                animate={{ scale: [1, 1.2, 1] }}\n                transition={{ duration: 2, repeat: Infinity }}\n              />\n            </>\n          ) : (\n            // Default Leadership Button\n            <>\n              <Crown className=\"w-5 h-5 text-[var(--hive-brand-primary)]\" />\n              <span className=\"text-white font-medium text-sm\">Leadership</span>\n              <motion.div\n                animate={{ rotate: isExpanded ? 180 : 0 }}\n                transition={{ duration: 0.2 }}\n              >\n                <ChevronUp className=\"w-4 h-4 text-neutral-400\" />\n              </motion.div>\n            </>\n          )}\n        </motion.button>\n\n        {/* Mode Indicator Help */}\n        {currentMode && (\n          <motion.div\n            className=\"absolute -top-12 right-0 bg-[#0A0A0A] border border-white/10 rounded-lg px-3 py-2 text-xs text-neutral-300 whitespace-nowrap\"\n            initial={{ opacity: 0, y: 5 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 5 }}\n          >\n            {LEADER_MODES[currentMode].description}\n            <div className=\"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white/10\" />\n          </motion.div>\n        )}\n      </div>\n\n      {/* Quick Actions (when in active mode) */}\n      {currentMode && (\n        <motion.div\n          className=\"absolute -top-16 right-0 flex items-center gap-2\"\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          exit={{ opacity: 0, x: 20 }}\n        >\n          {currentMode === 'moderate' && (\n            <>\n <Button className=\"max-w-sm border-red-400/30 text-red-400 hover:bg-red-400/10\" variant=\"outline\">\n                <Pin className=\"w-3 h-3 mr-1\" />\n                Pin\n              </Button>\n <Button className=\"max-w-sm border-red-400/30 text-red-400 hover:bg-red-400/10\" variant=\"outline\">\n                <Lock className=\"w-3 h-3 mr-1\" />\n                Lock\n              </Button>\n            </>\n          )}\n          \n          {currentMode === 'manage' && (\n            <>\n <Button className=\"max-w-sm border-blue-400/30 text-blue-400 hover:bg-blue-400/10\" variant=\"outline\">\n                <UserCog className=\"w-3 h-3 mr-1\" />\n                Roles\n              </Button>\n <Button className=\"max-w-sm border-blue-400/30 text-blue-400 hover:bg-blue-400/10\" variant=\"outline\">\n                <Users className=\"w-3 h-3 mr-1\" />\n                Members\n              </Button>\n            </>\n          )}\n          \n          {currentMode === 'insights' && (\n <Button className=\"max-w-sm border-purple-400/30 text-purple-400 hover:bg-purple-400/10\" variant=\"outline\">\n              <Eye className=\"w-3 h-3 mr-1\" />\n              Analytics\n            </Button>\n          )}\n        </motion.div>\n      )}\n    </motion.div>\n  );\n}\n\n// Helper hook for leader mode context\nexport function useLeaderMode() {\n  const [currentMode, setCurrentMode] = useState<LeaderMode>(null);\n  \n  const toggleMode = (mode: LeaderMode) => {\n    setCurrentMode(currentMode === mode ? null : mode);\n  };\n  \n  const exitMode = () => {\n    setCurrentMode(null);\n  };\n  \n  return {\n    currentMode,\n    toggleMode,\n    exitMode,\n    isInMode: (mode: LeaderMode) => currentMode === mode,\n    isInAnyMode: currentMode !== null\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/leave-space-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getWarningMessage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":94,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":94,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from 'react';\nimport { Button } from \"@hive/ui\";\nimport { LogOut } from \"lucide-react\";\nimport { useConfirm } from '@hive/ui';\nimport { useAuth } from \"@hive/auth-logic\";\n\ninterface LeaveSpaceButtonProps {\n  spaceId: string;\n  spaceName: string;\n  spaceType: string;\n  userRole?: string;\n  onLeave?: () => void;\n  className?: string;\n}\n\nexport function LeaveSpaceButton({\n  spaceId,\n  spaceName,\n  spaceType,\n  userRole = 'member',\n  onLeave,\n  className\n}: LeaveSpaceButtonProps) {\n  const [isLeaving, setIsLeaving] = useState(false);\n  const confirm = useConfirm();\n  const { user } = useAuth();\n\n  const isGreekLife = spaceType === 'greek_life';\n  const isImportantRole = userRole === 'owner' || userRole === 'admin';\n\n  const handleLeaveClick = async () => {\n    const variant = isGreekLife || isImportantRole ? 'warning' : 'info';\n\n    let message = `Are you sure you want to leave \"${spaceName}\"?`;\n\n    if (isGreekLife) {\n      message += '\\n\\nAs this is a Greek Life organization, you may need special permission to rejoin.';\n    }\n\n    if (isImportantRole) {\n      message += `\\n\\nYou are currently ${userRole === 'owner' ? 'the owner' : 'an admin'} of this space. Consider transferring your role before leaving.`;\n    }\n\n    const confirmed = await confirm({\n      title: 'Leave Space',\n      message,\n      confirmLabel: 'Leave Space',\n      cancelLabel: 'Stay',\n      variant\n    });\n\n    if (confirmed) {\n      handleConfirmLeave();\n    }\n  };\n\n  const handleConfirmLeave = async () => {\n    if (!user) return;\n    \n    setIsLeaving(true);\n    \n    try {\n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${user.id === 'dev_user_123' ? 'test-token' : 'user-token'}`\n      };\n\n      const response = await fetch('/api/spaces/leave', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ spaceId })\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to leave space');\n      }\n\n      // Call onLeave callback if provided\n      onLeave?.();\n      \n      // Redirect to spaces page\n      window.location.href = '/spaces';\n    } catch (error: any) {\n      // Use alert for now, could use toast notification system later\n      alert(error.message || 'Failed to leave space');\n    } finally {\n      setIsLeaving(false);\n    }\n  };\n\n  const getWarningMessage = () => {\n    if (isGreekLife) {\n      return \"Leaving this Greek life organization will allow you to join a different one. This action cannot be undone.\";\n    }\n    \n    if (isImportantRole) {\n      return `As a ${userRole}, leaving this space may affect its management. Consider transferring your role first.`;\n    }\n    \n    return \"Are you sure you want to leave this space? You can rejoin later if the space allows it.\";\n  };\n\n  return (\n    <>\n      <Button\n        variant=\"outline\"\n        className={`max-w-sm border-red-500/30 text-red-400 hover:bg-red-500/10 hover:border-red-500/50 ${className}`}\n        onClick={handleLeaveClick}\n        disabled={isLeaving}\n      >\n        <LogOut className=\"h-4 w-4 mr-2\" />\n        Leave Space\n      </Button>\n\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/panels/events-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":8}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n  Calendar,\n  Clock,\n  Users,\n  MapPin,\n  Plus,\n  Grid,\n  List,\n  Star\n} from 'lucide-react';\nimport {\n  Button,\n  Card,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  Input\n} from '@hive/ui';\nimport { api } from '@/lib/api-client';\n\ninterface Event {\n  id: string;\n  title: string;\n  description: string;\n  startTime: Date;\n  endTime: Date;\n  location?: string;\n  attendeeCount: number;\n  maxAttendees?: number;\n  isRsvpRequired: boolean;\n  userRsvp?: 'going' | 'maybe' | 'not_going';\n  createdBy: string;\n  creatorName: string;\n  type: 'meeting' | 'social' | 'workshop' | 'deadline' | 'other';\n}\n\ninterface EventsPanelProps {\n  spaceId: string;\n  userRole: 'owner' | 'leader' | 'moderator' | 'member' | 'guest';\n  canCreateEvents: boolean;\n}\n\nexport function EventsPanel({ spaceId, userRole, canCreateEvents }: EventsPanelProps) {\n  const [events, setEvents] = useState<Event[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [view, setView] = useState<'list' | 'week' | 'month'>('list');\n  const [filter, setFilter] = useState<'all' | 'events' | 'deadlines'>('all');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n\n  const canManageEvents = canCreateEvents || ['owner', 'leader', 'moderator'].includes(userRole);\n\n  const loadEvents = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await api.get<{ events?: Event[] }>(`/api/spaces/${spaceId}/events`, {\n        params: {\n          filter,\n          startDate: new Date().toISOString(),\n          limit: 50\n        }\n      });\n      setEvents(response.events || []);\n    } catch (error) {\n      console.error('Failed to load events:', error);\n      setEvents([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [filter, spaceId]);\n\n  useEffect(() => {\n    loadEvents();\n  }, [loadEvents]);\n\n  const handleRsvp = useCallback(async (eventId: string, rsvp: 'going' | 'maybe' | 'not_going') => {\n    try {\n      await api.post(`/api/spaces/${spaceId}/events/${eventId}/rsvp`, { rsvp });\n      // Update local state\n      setEvents(prevEvents =>\n        prevEvents.map(event =>\n          event.id === eventId ? { ...event, userRsvp: rsvp } : event\n        )\n      );\n    } catch (error) {\n      console.error('Failed to RSVP:', error);\n    }\n  }, [spaceId]);\n\n  const handleOpenCreate = useCallback(() => {\n    setShowCreateModal(true);\n  }, []);\n\n  const handleCloseCreate = useCallback(() => {\n    setShowCreateModal(false);\n  }, []);\n\n  const upcomingEvents = events.filter(event => event.startTime > new Date()).slice(0, 10);\n  const todayEvents = events.filter(event => {\n    const today = new Date();\n    return event.startTime.toDateString() === today.toDateString();\n  });\n\n  if (loading) {\n    return (\n      <div className=\"p-4\">\n        <div className=\"animate-pulse space-y-4\">\n          {[1, 2, 3].map(i => (\n            <div key={i} className=\"h-20 bg-gray-800 rounded-lg\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-800\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-white\">Events & Schedule</h3>\n          {canManageEvents && (\n            <Button\n              className=\"max-w-sm bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n              onClick={handleOpenCreate}\n            >\n              <Plus className=\"w-4 h-4 mr-1\" />\n              Create\n            </Button>\n          )}\n        </div>\n\n        {showCreateModal && (\n          <div className=\"mb-4 flex items-center justify-between rounded-lg border border-yellow-500/40 bg-yellow-500/10 px-3 py-2 text-xs text-yellow-100\">\n            <span>Event creation is coming soon. Ping #product-events if you want to help pilot the workflow.</span>\n            <Button variant=\"ghost\" className=\"h-6 px-2 text-yellow-100 hover:text-yellow-200\" onClick={handleCloseCreate}>\n              Dismiss\n            </Button>\n          </div>\n        )}\n\n        {/* View Controls */}\n        <div className=\"flex items-center gap-2\">\n          <Tabs value={view} onValueChange={(v) => setView(v as any)}>\n            <TabsList className=\"bg-gray-800 border-gray-700\">\n              <TabsTrigger value=\"list\" className=\"text-xs\">\n                <List className=\"w-3 h-3 mr-1\" />\n                List\n              </TabsTrigger>\n              <TabsTrigger value=\"week\" className=\"text-xs\">\n                <Calendar className=\"w-3 h-3 mr-1\" />\n                Week\n              </TabsTrigger>\n              <TabsTrigger value=\"month\" className=\"text-xs\">\n                <Grid className=\"w-3 h-3 mr-1\" />\n                Month\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <Tabs value={filter} onValueChange={(f) => setFilter(f as any)}>\n            <TabsList className=\"bg-gray-800 border-gray-700\">\n              <TabsTrigger value=\"all\" className=\"text-xs\">All</TabsTrigger>\n              <TabsTrigger value=\"events\" className=\"text-xs\">Events</TabsTrigger>\n              <TabsTrigger value=\"deadlines\" className=\"text-xs\">Deadlines</TabsTrigger>\n            </TabsList>\n          </Tabs>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {view === 'list' && (\n          <>\n            {/* Happening Today */}\n            {todayEvents.length > 0 && (\n              <div>\n                <h4 className=\"text-sm font-medium text-[var(--hive-brand-primary)] mb-3 flex items-center gap-2\">\n                  <Star className=\"w-4 h-4\" />\n                  Happening Today\n                </h4>\n                <div className=\"space-y-2\">\n                  {todayEvents.map(event => (\n                    <EventCard\n                      key={event.id}\n                      event={event}\n                      onRsvp={handleRsvp}\n                      isToday\n                    />\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Upcoming Events */}\n            <div>\n              <h4 className=\"text-sm font-medium text-white mb-3\">\n                Upcoming ({upcomingEvents.length})\n              </h4>\n              <div className=\"space-y-2\">\n                {upcomingEvents.length > 0 ? (\n                  upcomingEvents.map(event => (\n                    <EventCard\n                      key={event.id}\n                      event={event}\n                      onRsvp={handleRsvp}\n                    />\n                  ))\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Calendar className=\"w-12 h-12 text-gray-600 mx-auto mb-3\" />\n                    <p className=\"text-gray-400 text-sm\">No upcoming events</p>\n                    {canManageEvents && (\n                      <Button\n                        className=\"max-w-sm mt-3\"\n                        variant=\"outline\"\n                        onClick={handleOpenCreate}\n                      >\n                        Create First Event\n                      </Button>\n                    )}\n                  </div>\n                )}\n              </div>\n            </div>\n          </>\n        )}\n\n        {view === 'week' && (\n          <div className=\"text-center py-8 text-gray-400\">\n            <Calendar className=\"w-12 h-12 mx-auto mb-3\" />\n            <p>Week view coming soon</p>\n          </div>\n        )}\n\n        {view === 'month' && (\n          <div className=\"text-center py-8 text-gray-400\">\n            <Grid className=\"w-12 h-12 mx-auto mb-3\" />\n            <p>Month view coming soon</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction EventCard({\n  event,\n  onRsvp,\n  isToday = false\n}: {\n  event: Event;\n  onRsvp: (eventId: string, rsvp: 'going' | 'maybe' | 'not_going') => void;\n  isToday?: boolean;\n}) {\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  };\n\n  const formatDate = (date: Date) => {\n    const today = new Date();\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n\n    if (date.toDateString() === today.toDateString()) {\n      return 'Today';\n    } else if (date.toDateString() === tomorrow.toDateString()) {\n      return 'Tomorrow';\n    } else {\n      return date.toLocaleDateString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        weekday: 'short'\n      });\n    }\n  };\n\n  const getRsvpColor = (rsvp?: string) => {\n    switch (rsvp) {\n      case 'going': return 'bg-green-500';\n      case 'maybe': return 'bg-yellow-500';\n      case 'not_going': return 'bg-red-500';\n      default: return 'bg-gray-600';\n    }\n  };\n\n  return (\n    <Card className={`p-3 border-gray-800 hover:border-gray-700 transition-colors ${\n      isToday ? 'border-[var(--hive-brand-primary)]/30 bg-[var(--hive-brand-primary)]/5' : 'bg-gray-900/50'\n    }`}>\n      <div className=\"flex items-start justify-between mb-2\">\n        <div className=\"flex-1\">\n          <h5 className=\"font-medium text-white text-sm mb-1\">{event.title}</h5>\n          <div className=\"flex items-center gap-3 text-xs text-gray-400\">\n            <div className=\"flex items-center gap-1\">\n              <Clock className=\"w-3 h-3\" />\n              {isToday ? formatTime(event.startTime) : `${formatDate(event.startTime)} ${formatTime(event.startTime)}`}\n            </div>\n            {event.location && (\n              <div className=\"flex items-center gap-1\">\n                <MapPin className=\"w-3 h-3\" />\n                {event.location}\n              </div>\n            )}\n          </div>\n        </div>\n\n        <Badge\n          className={`text-xs ${\n            event.type === 'deadline' ? 'bg-red-500/20 text-red-400' :\n            event.type === 'meeting' ? 'bg-blue-500/20 text-blue-400' :\n            'bg-purple-500/20 text-purple-400'\n          }`}\n        >\n          {event.type}\n        </Badge>\n      </div>\n\n      {event.description && (\n        <p className=\"text-xs text-gray-400 mb-3 line-clamp-2\">\n          {event.description}\n        </p>\n      )}\n\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2 text-xs text-gray-400\">\n          <Users className=\"w-3 h-3\" />\n          <span>{event.attendeeCount}</span>\n          {event.maxAttendees && <span>/ {event.maxAttendees}</span>}\n          {event.userRsvp && (\n            <div className={`w-2 h-2 rounded-full ${getRsvpColor(event.userRsvp)}`} />\n          )}\n        </div>\n\n        {event.isRsvpRequired && (\n          <div className=\"flex gap-1\">\n            <Button\n              className={`max-w-sm text-xs h-6 px-2 ${\n                event.userRsvp === 'going'\n                  ? 'bg-green-600 hover:bg-green-700'\n                  : 'border-green-600 text-green-400 hover:bg-green-600/10'\n              }`}\n              variant={event.userRsvp === 'going' ? 'default' : 'outline'}\n              onClick={() => onRsvp(event.id, 'going')}\n            >\n              Going\n            </Button>\n            <Button\n              className={`max-w-sm text-xs h-6 px-2 ${\n                event.userRsvp === 'maybe'\n                  ? 'bg-yellow-600 hover:bg-yellow-700'\n                  : 'border-yellow-600 text-yellow-400 hover:bg-yellow-600/10'\n              }`}\n              variant={event.userRsvp === 'maybe' ? 'default' : 'outline'}\n              onClick={() => onRsvp(event.id, 'maybe')}\n            >\n              Maybe\n            </Button>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/panels/members-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedMembers' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":72,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":45},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMembers'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [spaceId, activeTab, sortBy, loadMembers]","fix":{"range":[1610,1638],"text":"[spaceId, activeTab, sortBy, loadMembers]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport {\n  Users,\n  Search,\n  Crown,\n  Shield,\n  UserCheck,\n  MoreVertical,\n  Download,\n  UserMinus,\n  UserPlus,\n  Settings,\n  Activity,\n  Calendar,\n  MessageSquare,\n  Filter\n} from 'lucide-react';\nimport {\n  Button,\n  Card,\n  Input,\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger\n} from '@hive/ui';\nimport { api } from '@/lib/api-client';\n\ninterface Member {\n  id: string;\n  userId: string;\n  name: string;\n  handle: string;\n  avatar?: string;\n  role: 'owner' | 'leader' | 'moderator' | 'member';\n  joinedAt: Date;\n  lastActive: Date;\n  isOnline: boolean;\n  stats: {\n    posts: number;\n    comments: number;\n    events: number;\n    activeDays: number;\n  };\n  email?: string; // Only visible to leaders\n  major?: string;\n  year?: string;\n}\n\ninterface MembersPanelProps {\n  spaceId: string;\n  userRole: 'owner' | 'leader' | 'moderator' | 'member' | 'guest';\n  isLeader: boolean;\n}\n\nexport function MembersPanel({ spaceId, userRole, isLeader }: MembersPanelProps) {\n  const [members, setMembers] = useState<Member[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [activeTab, setActiveTab] = useState<'online' | 'all' | 'leaders'>('online');\n  const [sortBy, setSortBy] = useState<'recent' | 'active' | 'name' | 'role'>('recent');\n  const [selectedMembers, setSelectedMembers] = useState<string[]>([]);\n\n  useEffect(() => {\n    loadMembers();\n  }, [spaceId, activeTab, sortBy]);\n\n  const loadMembers = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get<{ members?: Member[] }>(`/api/spaces/${spaceId}/members`, {\n        params: {\n          tab: activeTab,\n          sort: sortBy,\n          includeStats: true,\n          includePrivate: isLeader\n        }\n      });\n      setMembers(response.members || []);\n    } catch (error) {\n      console.error('Failed to load members:', error);\n      setMembers([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRemoveMember = async (memberId: string) => {\n    if (!confirm('Remove this member from the space?')) return;\n\n    try {\n      await api.delete(`/api/spaces/${spaceId}/members/${memberId}`);\n      setMembers(members.filter(m => m.id !== memberId));\n    } catch (error) {\n      console.error('Failed to remove member:', error);\n    }\n  };\n\n  const handlePromoteMember = async (memberId: string, newRole: string) => {\n    try {\n      await api.patch(`/api/spaces/${spaceId}/members/${memberId}`, { role: newRole });\n      setMembers(members.map(m =>\n        m.id === memberId ? { ...m, role: newRole as any } : m\n      ));\n    } catch (error) {\n      console.error('Failed to promote member:', error);\n    }\n  };\n\n  const exportMembers = async () => {\n    try {\n      const blob = await api.get<Blob>(`/api/spaces/${spaceId}/members/export`, {\n        responseType: 'blob'\n      });\n\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `space-members-${spaceId}.csv`;\n      link.click();\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      console.error('Failed to export members:', error);\n    }\n  };\n\n  const filteredMembers = members.filter(member => {\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      return (\n        member.name.toLowerCase().includes(query) ||\n        member.handle.toLowerCase().includes(query) ||\n        (member.major?.toLowerCase().includes(query))\n      );\n    }\n    return true;\n  });\n\n  const getMembersByTab = () => {\n    switch (activeTab) {\n      case 'online':\n        return filteredMembers.filter(m => m.isOnline);\n      case 'leaders':\n        return filteredMembers.filter(m => ['owner', 'leader', 'moderator'].includes(m.role));\n      default:\n        return filteredMembers;\n    }\n  };\n\n  const membersToShow = getMembersByTab();\n  const onlineCount = members.filter(m => m.isOnline).length;\n  const totalCount = members.length;\n\n  if (loading) {\n    return (\n      <div className=\"p-4\">\n        <div className=\"animate-pulse space-y-3\">\n          {[1, 2, 3, 4, 5].map(i => (\n            <div key={i} className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-gray-800 rounded-full\" />\n              <div className=\"flex-1\">\n                <div className=\"h-4 bg-gray-800 rounded w-24 mb-1\" />\n                <div className=\"h-3 bg-gray-800 rounded w-16\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-800\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-white\">Members</h3>\n            <p className=\"text-sm text-gray-400\">\n              {totalCount} total ‚Ä¢ {onlineCount} online\n            </p>\n          </div>\n          {isLeader && (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n <Button className=\"max-w-sm border-gray-700\" variant=\"outline\">\n                  <MoreVertical className=\"w-4 h-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"bg-gray-900 border-gray-700\">\n                <DropdownMenuItem onClick={exportMembers}>\n                  <Download className=\"w-4 h-4 mr-2\" />\n                  Export CSV\n                </DropdownMenuItem>\n                <DropdownMenuItem>\n                  <UserPlus className=\"w-4 h-4 mr-2\" />\n                  Invite Members\n                </DropdownMenuItem>\n                <DropdownMenuItem>\n                  <Settings className=\"w-4 h-4 mr-2\" />\n                  Member Settings\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          )}\n        </div>\n\n        {/* Search */}\n        <div className=\"relative mb-4\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4\" />\n          <Input\n            placeholder=\"Search members...\"\n            value={searchQuery}\n            onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n            className=\"pl-10 bg-gray-800 border-gray-700\"\n          />\n        </div>\n\n        {/* Tabs */}\n        <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as any)}>\n          <TabsList className=\"bg-gray-800 border-gray-700 w-full\">\n            <TabsTrigger value=\"online\" className=\"text-xs flex-1\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full mr-1\" />\n              Online ({onlineCount})\n            </TabsTrigger>\n            <TabsTrigger value=\"all\" className=\"text-xs flex-1\">\n              All ({totalCount})\n            </TabsTrigger>\n            <TabsTrigger value=\"leaders\" className=\"text-xs flex-1\">\n              <Crown className=\"w-3 h-3 mr-1\" />\n              Leaders\n            </TabsTrigger>\n          </TabsList>\n        </Tabs>\n\n        {/* Sort */}\n        <div className=\"flex items-center gap-2 mt-3\">\n          <Filter className=\"w-4 h-4 text-gray-400\" />\n          <select\n            value={sortBy}\n            onChange={(e: React.ChangeEvent) => setSortBy((e.target as any).value as any)}\n            className=\"bg-gray-800 border border-gray-700 rounded px-2 py-1 text-xs text-white\"\n          >\n            <option value=\"recent\">Recently Joined</option>\n            <option value=\"active\">Most Active</option>\n            <option value=\"name\">Name A-Z</option>\n            <option value=\"role\">By Role</option>\n          </select>\n        </div>\n      </div>\n\n      {/* Members List */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-2\">\n        {membersToShow.length > 0 ? (\n          membersToShow.map(member => (\n            <MemberCard\n              key={member.id}\n              member={member}\n              isLeader={isLeader}\n              userRole={userRole}\n              onRemove={() => handleRemoveMember(member.id)}\n              onPromote={(role) => handlePromoteMember(member.id, role)}\n            />\n          ))\n        ) : (\n          <div className=\"text-center py-8\">\n            <Users className=\"w-12 h-12 text-gray-600 mx-auto mb-3\" />\n            <p className=\"text-gray-400\">\n              {searchQuery ? `No members found for \"${searchQuery}\"` : 'No members found'}\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* Bulk Actions */}\n      {isLeader && selectedMembers.length > 0 && (\n        <div className=\"p-4 border-t border-gray-800 bg-gray-900/50\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-400\">\n              {selectedMembers.length} selected\n            </span>\n            <div className=\"flex gap-2\">\n <Button className=\"max-w-sm border-red-600 text-red-400\" variant=\"outline\">\n                <UserMinus className=\"w-4 h-4 mr-1\" />\n                Remove\n              </Button>\n <Button className=\"max-w-sm border-blue-600 text-blue-400\" variant=\"outline\">\n                <MessageSquare className=\"w-4 h-4 mr-1\" />\n                Message\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction MemberCard({\n  member,\n  isLeader,\n  userRole,\n  onRemove,\n  onPromote\n}: {\n  member: Member;\n  isLeader: boolean;\n  userRole: string;\n  onRemove: () => void;\n  onPromote: (role: string) => void;\n}) {\n  const getRoleIcon = (role: string) => {\n    switch (role) {\n      case 'owner': return <Crown className=\"w-3 h-3 text-yellow-400\" />;\n      case 'leader': return <Shield className=\"w-3 h-3 text-blue-400\" />;\n      case 'moderator': return <UserCheck className=\"w-3 h-3 text-green-400\" />;\n      default: return null;\n    }\n  };\n\n  const getRoleBadgeColor = (role: string) => {\n    switch (role) {\n      case 'owner': return 'bg-yellow-500/20 text-yellow-400 border-yellow-500/30';\n      case 'leader': return 'bg-blue-500/20 text-blue-400 border-blue-500/30';\n      case 'moderator': return 'bg-green-500/20 text-green-400 border-green-500/30';\n      default: return 'bg-gray-500/20 text-gray-400 border-gray-500/30';\n    }\n  };\n\n  const formatLastActive = (date: Date) => {\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    if (minutes < 5) return 'Just now';\n    if (minutes < 60) return `${minutes}m ago`;\n    if (hours < 24) return `${hours}h ago`;\n    return `${days}d ago`;\n  };\n\n  return (\n    <Card className=\"p-3 bg-gray-900/50 border-gray-800 hover:border-gray-700 transition-colors\">\n      <div className=\"flex items-center gap-3\">\n        <div className=\"relative\">\n          <Avatar className=\"w-10 h-10\">\n            <AvatarImage src={member.avatar} />\n            <AvatarFallback className=\"bg-[var(--hive-brand-primary)] text-black text-sm\">\n              {member.name[0]}\n            </AvatarFallback>\n          </Avatar>\n          {member.isOnline && (\n            <div className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-gray-900 rounded-full\" />\n          )}\n        </div>\n\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <span className=\"font-medium text-white text-sm truncate\">\n              {member.name}\n            </span>\n            {getRoleIcon(member.role)}\n            <Badge className={`text-xs px-1.5 py-0.5 ${getRoleBadgeColor(member.role)}`}>\n              {member.role}\n            </Badge>\n          </div>\n          <div className=\"flex items-center gap-3 text-xs text-gray-400\">\n            <span>@{member.handle}</span>\n            {member.major && <span>{member.major}</span>}\n            {!member.isOnline && (\n              <span>Active {formatLastActive(member.lastActive)}</span>\n            )}\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"hidden md:flex items-center gap-3 text-xs text-gray-400\">\n          <div className=\"flex items-center gap-1\">\n            <MessageSquare className=\"w-3 h-3\" />\n            {member.stats.posts}\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <Activity className=\"w-3 h-3\" />\n            {member.stats.activeDays}d\n          </div>\n        </div>\n\n        {/* Actions */}\n        {isLeader && member.role !== 'owner' && userRole !== member.role && (\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button className=\"max-w-sm\" variant=\"outline\">\n                <MoreVertical className=\"w-4 h-4\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"bg-gray-900 border-gray-700\">\n              <DropdownMenuItem>\n                <MessageSquare className=\"w-4 h-4 mr-2\" />\n                View Profile\n              </DropdownMenuItem>\n              {member.role === 'member' && (\n                <DropdownMenuItem onClick={() => onPromote('moderator')}>\n                  <UserPlus className=\"w-4 h-4 mr-2\" />\n                  Make Moderator\n                </DropdownMenuItem>\n              )}\n              {(member.role === 'member' || member.role === 'moderator') && userRole === 'owner' && (\n                <DropdownMenuItem onClick={() => onPromote('leader')}>\n                  <Crown className=\"w-4 h-4 mr-2\" />\n                  Make Leader\n                </DropdownMenuItem>\n              )}\n              <DropdownMenuItem\n                onClick={onRemove}\n                className=\"text-red-400 focus:text-red-400\"\n              >\n                <UserMinus className=\"w-4 h-4 mr-2\" />\n                Remove Member\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        )}\n      </div>\n\n      {/* Expanded stats for leaders */}\n      {isLeader && (\n        <div className=\"mt-3 pt-3 border-t border-gray-800 grid grid-cols-4 gap-2 text-xs\">\n          <div className=\"text-center\">\n            <div className=\"text-white font-medium\">{member.stats.posts}</div>\n            <div className=\"text-gray-400\">Posts</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-white font-medium\">{member.stats.comments}</div>\n            <div className=\"text-gray-400\">Comments</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-white font-medium\">{member.stats.events}</div>\n            <div className=\"text-gray-400\">Events</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-white font-medium\">{member.stats.activeDays}</div>\n            <div className=\"text-gray-400\">Active Days</div>\n          </div>\n        </div>\n      )}\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/panels/resources-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":14},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":94,"column":11,"nodeType":"JSXOpeningElement","endLine":94,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userRole' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":102,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":51},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadResources'. Either include it or remove the dependency array.","line":114,"column":6,"nodeType":"ArrayExpression","endLine":114,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [spaceId, typeFilter, sortBy, showArchived, loadResources]","fix":{"range":[2790,2833],"text":"[spaceId, typeFilter, sortBy, showArchived, loadResources]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'loadResources'. Either include it or remove the dependency array.","line":168,"column":6,"nodeType":"ArrayExpression","endLine":168,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [canUpload, loadResources, spaceId]","fix":{"range":[4457,4477],"text":"[canUpload, loadResources, spaceId]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":429,"column":13,"nodeType":"JSXOpeningElement","endLine":433,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n  FileText,\n  Link2,\n  Image,\n  Video,\n  Download,\n  Upload,\n  Search,\n  Filter,\n  Star,\n  Archive,\n  Eye,\n  MoreVertical,\n  Plus,\n  Trash2,\n  Edit,\n  ExternalLink,\n  Calendar,\n  User,\n  File,\n  Folder\n} from 'lucide-react';\nimport {\n  Button,\n  Card,\n  Input,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  Progress\n} from '@hive/ui';\nimport { api } from '@/lib/api-client';\n\ninterface Resource {\n  id: string;\n  title: string;\n  description?: string;\n  type: 'document' | 'link' | 'media' | 'form';\n  fileType?: string;\n  url: string;\n  thumbnailUrl?: string;\n  size?: number;\n  isPinned: boolean;\n  isArchived: boolean;\n  downloadCount: number;\n  viewCount: number;\n  createdBy: string;\n  creatorName: string;\n  createdAt: Date;\n  updatedAt: Date;\n  tags: string[];\n  versions?: {\n    id: string;\n    version: number;\n    createdAt: Date;\n    createdBy: string;\n    changeNote?: string;\n  }[];\n}\n\ninterface ResourcesPanelProps {\n  spaceId: string;\n  userRole: 'owner' | 'leader' | 'moderator' | 'member' | 'guest';\n  canUpload: boolean;\n  isLeader: boolean;\n}\n\n// Helper functions (moved outside components for reusability)\nconst formatFileSize = (bytes?: number) => {\n  if (!bytes) return '';\n  const sizes = ['B', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(1024));\n  return `${(bytes / Math.pow(1024, i)).toFixed(1)} ${sizes[i]}`;\n};\n\nconst getFileIcon = (type: string, fileType?: string) => {\n  switch (type) {\n    case 'document':\n      return <FileText className=\"w-5 h-5 text-blue-400\" />;\n    case 'link':\n      return <Link2 className=\"w-5 h-5 text-green-400\" />;\n    case 'media':\n      return fileType?.startsWith('video/')\n        ? <Video className=\"w-5 h-5 text-purple-400\" />\n        : <Image className=\"w-5 h-5 text-pink-400\" />;\n    case 'form':\n      return <File className=\"w-5 h-5 text-orange-400\" />;\n    default:\n      return <File className=\"w-5 h-5 text-gray-400\" />;\n  }\n};\n\nexport function ResourcesPanel({ spaceId, userRole, canUpload, isLeader }: ResourcesPanelProps) {\n  const [resources, setResources] = useState<Resource[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [typeFilter, setTypeFilter] = useState<'all' | 'documents' | 'links' | 'media' | 'forms'>('all');\n  const [sortBy, setSortBy] = useState<'recent' | 'popular' | 'alphabetical' | 'size'>('recent');\n  const [showArchived, setShowArchived] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n\n  useEffect(() => {\n    loadResources();\n  }, [spaceId, typeFilter, sortBy, showArchived]);\n\n  const loadResources = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get<{ resources?: Resource[] }>(`/api/spaces/${spaceId}/resources`, {\n        params: {\n          type: typeFilter !== 'all' ? typeFilter : undefined,\n          sort: sortBy,\n          includeArchived: showArchived,\n          includeStats: true\n        }\n      });\n      setResources(response.resources || []);\n    } catch (error) {\n      console.error('Failed to load resources:', error);\n      setResources([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileUpload = useCallback(async (files: FileList) => {\n    if (!files.length || !canUpload) return;\n\n    setUploading(true);\n    setUploadProgress(0);\n\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('title', file.name.split('.')[0]);\n        formData.append('type', getFileType(file.type));\n\n        await api.post(`/api/spaces/${spaceId}/resources`, formData, {\n          headers: { 'Content-Type': 'multipart/form-data' },\n          onUploadProgress: (progressEvent) => {\n            const progress = Math.round(\n              ((i / files.length) + (progressEvent.loaded / progressEvent.total!) / files.length) * 100\n            );\n            setUploadProgress(progress);\n          }\n        });\n      }\n\n      loadResources();\n    } catch (error) {\n      console.error('Failed to upload files:', error);\n    } finally {\n      setUploading(false);\n      setUploadProgress(0);\n    }\n  }, [spaceId, canUpload]);\n\n  const getFileType = (mimeType: string): Resource['type'] => {\n    if (mimeType.startsWith('image/') || mimeType.startsWith('video/')) return 'media';\n    if (mimeType.includes('pdf') || mimeType.includes('document') || mimeType.includes('text')) return 'document';\n    return 'document';\n  };\n\n  const handlePinResource = async (resourceId: string, isPinned: boolean) => {\n    try {\n      await api.patch(`/api/spaces/${spaceId}/resources/${resourceId}`, { isPinned });\n      setResources(resources.map(r => r.id === resourceId ? { ...r, isPinned } : r));\n    } catch (error) {\n      console.error('Failed to pin resource:', error);\n    }\n  };\n\n  const handleArchiveResource = async (resourceId: string, isArchived: boolean) => {\n    try {\n      await api.patch(`/api/spaces/${spaceId}/resources/${resourceId}`, { isArchived });\n      setResources(resources.map(r => r.id === resourceId ? { ...r, isArchived } : r));\n    } catch (error) {\n      console.error('Failed to archive resource:', error);\n    }\n  };\n\n  const handleDeleteResource = async (resourceId: string) => {\n    if (!confirm('Delete this resource permanently?')) return;\n\n    try {\n      await api.delete(`/api/spaces/${spaceId}/resources/${resourceId}`);\n      setResources(resources.filter(r => r.id !== resourceId));\n    } catch (error) {\n      console.error('Failed to delete resource:', error);\n    }\n  };\n\n  const filteredResources = resources.filter(resource => {\n    if (!showArchived && resource.isArchived) return false;\n\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      return (\n        resource.title.toLowerCase().includes(query) ||\n        resource.description?.toLowerCase().includes(query) ||\n        resource.tags.some(tag => tag.toLowerCase().includes(query))\n      );\n    }\n    return true;\n  });\n\n  const pinnedResources = filteredResources.filter(r => r.isPinned && !r.isArchived);\n  const regularResources = filteredResources.filter(r => !r.isPinned);\n\n  if (loading) {\n    return (\n      <div className=\"p-4\">\n        <div className=\"animate-pulse space-y-3\">\n          {[1, 2, 3, 4].map(i => (\n            <div key={i} className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 bg-gray-800 rounded-lg\" />\n              <div className=\"flex-1\">\n                <div className=\"h-4 bg-gray-800 rounded w-3/4 mb-2\" />\n                <div className=\"h-3 bg-gray-800 rounded w-1/2\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-800\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-white\">Resources</h3>\n          {canUpload && (\n            <Button\n              className=\"max-w-sm bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n              onClick={() => document.getElementById('file-upload')?.click()}\n              disabled={uploading}\n            >\n              <Plus className=\"w-4 h-4 mr-1\" />\n              Add\n            </Button>\n          )}\n        </div>\n\n        {/* Upload Progress */}\n        {uploading && (\n          <div className=\"mb-4\">\n            <div className=\"flex items-center justify-between text-sm mb-1\">\n              <span className=\"text-gray-400\">Uploading...</span>\n              <span className=\"text-[var(--hive-brand-primary)]\">{uploadProgress}%</span>\n            </div>\n            <Progress value={uploadProgress} className=\"h-2\" />\n          </div>\n        )}\n\n        {/* Search */}\n        <div className=\"relative mb-4\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4\" />\n          <Input\n            placeholder=\"Search resources...\"\n            value={searchQuery}\n            onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n            className=\"pl-10 bg-gray-800 border-gray-700\"\n          />\n        </div>\n\n        {/* Filters */}\n        <div className=\"flex items-center gap-2 mb-4\">\n          <Tabs value={typeFilter} onValueChange={(v) => setTypeFilter(v as any)}>\n            <TabsList className=\"bg-gray-800 border-gray-700\">\n              <TabsTrigger value=\"all\" className=\"text-xs\">All</TabsTrigger>\n              <TabsTrigger value=\"documents\" className=\"text-xs\">Docs</TabsTrigger>\n              <TabsTrigger value=\"links\" className=\"text-xs\">Links</TabsTrigger>\n              <TabsTrigger value=\"media\" className=\"text-xs\">Media</TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <select\n            value={sortBy}\n            onChange={(e: React.ChangeEvent) => setSortBy((e.target as any).value as any)}\n            className=\"bg-gray-800 border border-gray-700 rounded px-2 py-1 text-xs text-white\"\n          >\n            <option value=\"recent\">Recent</option>\n            <option value=\"popular\">Popular</option>\n            <option value=\"alphabetical\">A-Z</option>\n            <option value=\"size\">Size</option>\n          </select>\n        </div>\n\n        {/* Toggle Archive */}\n        <label className=\"flex items-center gap-2 text-sm text-gray-400 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={showArchived}\n            onChange={(e: React.ChangeEvent) => setShowArchived(e.target.checked)}\n            className=\"rounded\"\n          />\n          Show archived\n        </label>\n\n        {/* Hidden file input */}\n        <input\n          id=\"file-upload\"\n          type=\"file\"\n          multiple\n          className=\"hidden\"\n          onChange={(e: React.ChangeEvent) => e.target.files && handleFileUpload(e.target.files)}\n          accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.png,.gif,.mp4,.mp3\"\n        />\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-6\">\n        {/* Pinned Resources */}\n        {pinnedResources.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-medium text-[var(--hive-brand-primary)] mb-3 flex items-center gap-2\">\n              <Star className=\"w-4 h-4\" />\n              Pinned\n            </h4>\n            <div className=\"space-y-2\">\n              {pinnedResources.map(resource => (\n                <ResourceCard\n                  key={resource.id}\n                  resource={resource}\n                  isLeader={isLeader}\n                  onPin={handlePinResource}\n                  onArchive={handleArchiveResource}\n                  onDelete={handleDeleteResource}\n                />\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Regular Resources */}\n        <div>\n          <h4 className=\"text-sm font-medium text-white mb-3\">\n            {typeFilter === 'all' ? 'All Resources' : typeFilter.charAt(0).toUpperCase() + typeFilter.slice(1)}\n            ({regularResources.length})\n          </h4>\n          <div className=\"space-y-2\">\n            {regularResources.length > 0 ? (\n              regularResources.map(resource => (\n                <ResourceCard\n                  key={resource.id}\n                  resource={resource}\n                  isLeader={isLeader}\n                  onPin={handlePinResource}\n                  onArchive={handleArchiveResource}\n                  onDelete={handleDeleteResource}\n                />\n              ))\n            ) : (\n              <div className=\"text-center py-8\">\n                <Folder className=\"w-12 h-12 text-gray-600 mx-auto mb-3\" />\n                <p className=\"text-gray-400 text-sm\">\n                  {searchQuery ? `No resources found for \"${searchQuery}\"` : 'No resources yet'}\n                </p>\n                {canUpload && !searchQuery && (\n                  <Button\n                    className=\"max-w-sm mt-3\"\n                    variant=\"outline\"\n                    \n                    onClick={() => document.getElementById('file-upload')?.click()}\n                  >\n                    Add First Resource\n                  </Button>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ResourceCard({\n  resource,\n  isLeader,\n  onPin,\n  onArchive,\n  onDelete\n}: {\n  resource: Resource;\n  isLeader: boolean;\n  onPin: (id: string, isPinned: boolean) => void;\n  onArchive: (id: string, isArchived: boolean) => void;\n  onDelete: (id: string) => void;\n}) {\n  const handleDownload = async () => {\n    try {\n      const blob = await api.get<Blob>(resource.url, { responseType: 'blob' });\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = resource.title;\n      link.click();\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      console.error('Failed to download resource:', error);\n    }\n  };\n\n  const isOwnResource = resource.createdBy === 'current-user-id'; // TODO: get from auth context\n\n  return (\n    <Card className={`p-3 border-gray-800 hover:border-gray-700 transition-colors ${\n      resource.isPinned ? 'border-[var(--hive-brand-primary)]/30 bg-[var(--hive-brand-primary)]/5' : 'bg-gray-900/50'\n    } ${resource.isArchived ? 'opacity-60' : ''}`}>\n      <div className=\"flex items-start gap-3\">\n        {/* File Icon/Thumbnail */}\n        <div className=\"flex-shrink-0\">\n          {resource.thumbnailUrl ? (\n            <img\n              src={resource.thumbnailUrl}\n              alt=\"\"\n              className=\"w-12 h-12 object-cover rounded-lg\"\n            />\n          ) : (\n            <div className=\"w-12 h-12 bg-gray-800 rounded-lg flex items-center justify-center\">\n              {getFileIcon(resource.type, resource.fileType)}\n            </div>\n          )}\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-start justify-between mb-2\">\n            <div>\n              <h5 className=\"font-medium text-white text-sm mb-1 flex items-center gap-2\">\n                {resource.title}\n                {resource.isPinned && <Star className=\"w-3 h-3 text-[var(--hive-brand-primary)]\" />}\n                {resource.isArchived && <Archive className=\"w-3 h-3 text-gray-500\" />}\n              </h5>\n              <div className=\"flex items-center gap-3 text-xs text-gray-400\">\n                <span>by {resource.creatorName}</span>\n                <span>{new Date(resource.createdAt).toLocaleDateString()}</span>\n                {resource.size && <span>{formatFileSize(resource.size)}</span>}\n              </div>\n            </div>\n\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button className=\"max-w-sm\" variant=\"outline\">\n                  <MoreVertical className=\"w-4 h-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"bg-gray-900 border-gray-700\">\n                {resource.type === 'link' ? (\n                  <DropdownMenuItem asChild>\n                    <a href={resource.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <ExternalLink className=\"w-4 h-4 mr-2\" />\n                      Open Link\n                    </a>\n                  </DropdownMenuItem>\n                ) : (\n                  <DropdownMenuItem onClick={handleDownload}>\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Download\n                  </DropdownMenuItem>\n                )}\n                {isLeader && (\n                  <>\n                    <DropdownMenuItem\n                      onClick={() => onPin(resource.id, !resource.isPinned)}\n                    >\n                      <Star className=\"w-4 h-4 mr-2\" />\n                      {resource.isPinned ? 'Unpin' : 'Pin'}\n                    </DropdownMenuItem>\n                    <DropdownMenuItem\n                      onClick={() => onArchive(resource.id, !resource.isArchived)}\n                    >\n                      <Archive className=\"w-4 h-4 mr-2\" />\n                      {resource.isArchived ? 'Unarchive' : 'Archive'}\n                    </DropdownMenuItem>\n                  </>\n                )}\n                {(isLeader || isOwnResource) && (\n                  <DropdownMenuItem\n                    onClick={() => onDelete(resource.id)}\n                    className=\"text-red-400 focus:text-red-400\"\n                  >\n                    <Trash2 className=\"w-4 h-4 mr-2\" />\n                    Delete\n                  </DropdownMenuItem>\n                )}\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n\n          {resource.description && (\n            <p className=\"text-xs text-gray-400 mb-2 line-clamp-2\">\n              {resource.description}\n            </p>\n          )}\n\n          {/* Tags */}\n          {resource.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-1 mb-2\">\n              {resource.tags.slice(0, 3).map(tag => (\n                <Badge\n                  key={tag}\n                  className=\"text-xs px-1.5 py-0.5 bg-gray-800 text-gray-300\"\n                >\n                  {tag}\n                </Badge>\n              ))}\n              {resource.tags.length > 3 && (\n                <Badge className=\"text-xs px-1.5 py-0.5 bg-gray-800 text-gray-300\">\n                  +{resource.tags.length - 3}\n                </Badge>\n              )}\n            </div>\n          )}\n\n          {/* Stats */}\n          <div className=\"flex items-center gap-4 text-xs text-gray-500\">\n            <div className=\"flex items-center gap-1\">\n              <Eye className=\"w-3 h-3\" />\n              {resource.viewCount}\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <Download className=\"w-3 h-3\" />\n              {resource.downloadCount}\n            </div>\n            {resource.versions && resource.versions.length > 1 && (\n              <div>v{resource.versions.length}</div>\n            )}\n          </div>\n        </div>\n      </div>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-chat-board.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MoreHorizontal' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onOpenContext' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":68,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadPosts' and 'subscribeToUpdates'. Either include them or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [loadPosts, spaceId, subscribeToUpdates, threadId]","fix":{"range":[1983,2002],"text":"[loadPosts, spaceId, subscribeToUpdates, threadId]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'response' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":151,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":151,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'analyzeForEnhancements'. Either include it or remove the dependency array.","line":221,"column":6,"nodeType":"ArrayExpression","endLine":221,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [analyzeForEnhancements, newPostContent]","fix":{"range":[5810,5826],"text":"[analyzeForEnhancements, newPostContent]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { Button, Card, Badge, Input } from '@hive/ui';\nimport {\n  Send,\n  Pin,\n  TrendingUp,\n  MessageSquare,\n  Vote,\n  Calendar,\n  Users,\n  AlertCircle,\n  Star,\n  MoreHorizontal,\n  Reply,\n  Sparkles\n} from 'lucide-react';\nimport { api } from '@/lib/api-client';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface Post {\n  id: string;\n  content: string;\n  type: 'regular' | 'announcement' | 'poll' | 'event' | 'volunteer' | 'system';\n  authorId: string;\n  authorName: string;\n  authorAvatar?: string;\n  createdAt: Date;\n  updatedAt?: Date;\n\n  // Threading\n  isThread: boolean;\n  threadId?: string;\n  replyCount: number;\n  lastReplyAt?: Date;\n\n  // Enhancements\n  pinned: boolean;\n  promoted: boolean;\n  isTab: boolean;\n\n  // Reactions\n  reactions: { [emoji: string]: string[] };\n  engagementScore: number;\n\n  // Type-specific data\n  pollData?: any;\n  eventData?: any;\n  volunteerData?: any;\n}\n\ninterface SpaceChatBoardProps {\n  spaceId: string;\n  threadId?: string;\n  membership: any;\n  isLeader: boolean;\n  isModerator: boolean;\n  onOpenContext: (panel: string) => void;\n}\n\nexport function SpaceChatBoard({\n  spaceId,\n  threadId,\n  membership,\n  isLeader,\n  isModerator,\n  onOpenContext\n}: SpaceChatBoardProps) {\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [newPostContent, setNewPostContent] = useState('');\n  const [postType, setPostType] = useState<Post['type']>('regular');\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // ChatGPT-like enhancement suggestions\n  const [showEnhancements, setShowEnhancements] = useState(false);\n  const [enhancementSuggestion, setEnhancementSuggestion] = useState('');\n\n  useEffect(() => {\n    loadPosts();\n    // Set up real-time subscription\n    const unsubscribe = subscribeToUpdates();\n    return () => unsubscribe();\n  }, [spaceId, threadId]);\n\n  const loadPosts = async () => {\n    try {\n      setLoading(true);\n      const endpoint = threadId\n        ? `/api/spaces/${spaceId}/posts/${threadId}/replies`\n        : `/api/spaces/${spaceId}/posts`;\n\n      const response = await api.get<{ posts?: Post[] }>(endpoint, {\n        params: { limit: 50 }\n      });\n\n      setPosts(response.posts || []);\n    } catch (error) {\n      console.error('Failed to load posts:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const subscribeToUpdates = () => {\n    // Real-time subscription via SSE\n    const eventSource = new EventSource(\n      `/api/realtime/sse?channels=space:${spaceId}:posts`\n    );\n\n    eventSource.onmessage = (event) => {\n      const eventData = JSON.parse(event.data);\n\n      // Handle SSE message format\n      if (eventData.type === 'message' && eventData.data) {\n        const message = eventData.data;\n        if (message.content?.type === 'new_post' && message.content?.post) {\n          setPosts(prev => [...prev, message.content.post]);\n          scrollToBottom();\n        } else if (message.content?.type === 'update_post' && message.content?.post) {\n          setPosts(prev => prev.map(p =>\n            p.id === message.content.post.id ? message.content.post : p\n          ));\n        }\n      }\n\n      // Handle direct message format (backward compatibility)\n      else if (eventData.type === 'new_post') {\n        setPosts(prev => [...prev, eventData.post]);\n        scrollToBottom();\n      } else if (eventData.type === 'update_post') {\n        setPosts(prev => prev.map(p =>\n          p.id === eventData.post.id ? eventData.post : p\n        ));\n      }\n    };\n\n    return () => eventSource.close();\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleSendPost = async () => {\n    if (!newPostContent.trim() || !membership) return;\n\n    try {\n      const response = await api.post<{ post?: Post }>(`/api/spaces/${spaceId}/posts`, {\n        content: newPostContent,\n        type: postType,\n        threadId: replyingTo || undefined\n      });\n\n      setNewPostContent('');\n      setReplyingTo(null);\n      setPostType('regular');\n      scrollToBottom();\n    } catch (error) {\n      console.error('Failed to send post:', error);\n    }\n  };\n\n  const handlePinPost = async (postId: string) => {\n    if (!isLeader && !isModerator) return;\n\n    try {\n      await api.post(`/api/spaces/${spaceId}/posts/${postId}/pin`);\n      loadPosts();\n    } catch (error) {\n      console.error('Failed to pin post:', error);\n    }\n  };\n\n  const handlePromotePost = async (postId: string) => {\n    if (!isLeader) return;\n\n    try {\n      await api.post(`/api/spaces/${spaceId}/posts/${postId}/promote`);\n      loadPosts();\n    } catch (error) {\n      console.error('Failed to promote post:', error);\n    }\n  };\n\n  const handleMakeTab = async (postId: string) => {\n    if (!isLeader) return;\n\n    try {\n      await api.post(`/api/spaces/${spaceId}/posts/${postId}/tab`);\n      // This will trigger parent to update tabs\n      loadPosts();\n    } catch (error) {\n      console.error('Failed to make tab:', error);\n    }\n  };\n\n  const handleReaction = async (postId: string, emoji: string) => {\n    try {\n      await api.post(`/api/spaces/${spaceId}/posts/${postId}/react`, {\n        emoji\n      });\n      loadPosts();\n    } catch (error) {\n      console.error('Failed to react:', error);\n    }\n  };\n\n  // SPEC.md: ChatGPT-like enhancement suggestions\n  useEffect(() => {\n    if (newPostContent.length > 20) {\n      // Analyze content for enhancements\n      const suggestions = analyzeForEnhancements(newPostContent);\n      setEnhancementSuggestion(suggestions);\n      setShowEnhancements(!!suggestions);\n    } else {\n      setShowEnhancements(false);\n    }\n  }, [newPostContent]);\n\n  const analyzeForEnhancements = (content: string): string => {\n    // Simple analysis for demo\n    if (content.includes('?') && !postType) {\n      return 'This looks like a question. Consider making it a poll!';\n    }\n    if (content.includes('meeting') || content.includes('event')) {\n      return 'Create an event with RSVP?';\n    }\n    if (content.includes('need') || content.includes('help')) {\n      return 'Create a volunteer request?';\n    }\n    return '';\n  };\n\n  // Group posts by time periods (SPEC.md)\n  const groupedPosts = groupPostsByTime(posts);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <p className=\"text-gray-400\">Loading messages...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* Pinned Posts (max 3) */}\n      {posts.filter(p => p.pinned).slice(0, 3).map(post => (\n        <div key={post.id} className=\"border-b border-gray-800 bg-yellow-900/10 p-3\">\n          <div className=\"flex items-start gap-2\">\n            <Pin className=\"w-4 h-4 text-[var(--hive-brand-primary)] mt-1\" />\n            <div className=\"flex-1\">\n              <p className=\"text-sm text-white\">{post.content}</p>\n              <p className=\"text-xs text-gray-500 mt-1\">\n                Pinned by {post.authorName}\n              </p>\n            </div>\n          </div>\n        </div>\n      ))}\n\n      {/* Messages Area */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {Object.entries(groupedPosts).map(([period, periodPosts]) => (\n          <div key={period}>\n            {/* Time Period Divider */}\n            <div className=\"flex items-center gap-4 my-4\">\n              <div className=\"flex-1 h-px bg-gray-800\" />\n              <span className=\"text-xs text-gray-500\">{period}</span>\n              <div className=\"flex-1 h-px bg-gray-800\" />\n            </div>\n\n            {/* Posts in this period */}\n            {periodPosts.map((post) => (\n              <PostMessage\n                key={post.id}\n                post={post}\n                isLeader={isLeader}\n                isModerator={isModerator}\n                onPin={() => handlePinPost(post.id)}\n                onPromote={() => handlePromotePost(post.id)}\n                onMakeTab={() => handleMakeTab(post.id)}\n                onReply={() => setReplyingTo(post.id)}\n                onReact={(emoji) => handleReaction(post.id, emoji)}\n              />\n            ))}\n          </div>\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Input Area - ChatGPT Style */}\n      <div className=\"border-t border-gray-800 p-4\">\n        {/* Reply Indicator */}\n        {replyingTo && (\n          <div className=\"flex items-center justify-between mb-2 p-2 bg-gray-900 rounded\">\n            <span className=\"text-sm text-gray-400\">\n              Replying to post...\n            </span>\n            <button\n              onClick={() => setReplyingTo(null)}\n              className=\"text-gray-500 hover:text-white\"\n            >\n              ‚úï\n            </button>\n          </div>\n        )}\n\n        {/* Enhancement Suggestion */}\n        {showEnhancements && (\n          <div className=\"mb-2 p-2 bg-[var(--hive-brand-primary)]/10 border border-[var(--hive-brand-primary)]/30 rounded\">\n            <div className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-4 h-4 text-[var(--hive-brand-primary)]\" />\n              <span className=\"text-sm text-[var(--hive-brand-primary)]\">{enhancementSuggestion}</span>\n              <Button\n                className=\"max-w-sm ml-auto text-[var(--hive-brand-primary)]\"\n                variant=\"outline\"\n                \n                onClick={() => {\n                  if (enhancementSuggestion.includes('poll')) setPostType('poll');\n                  if (enhancementSuggestion.includes('event')) setPostType('event');\n                  if (enhancementSuggestion.includes('volunteer')) setPostType('volunteer');\n                }}\n              >\n                Apply\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* Post Type Selector */}\n        <div className=\"flex gap-2 mb-2\">\n          {['regular', 'announcement', 'poll', 'event', 'volunteer'].map((type) => (\n            <button\n              key={type}\n              onClick={() => setPostType(type as Post['type'])}\n              className={`px-3 py-1 rounded text-xs ${\n                postType === type\n                  ? 'bg-[var(--hive-brand-primary)] text-black'\n                  : 'bg-gray-800 text-gray-400 hover:bg-gray-700'\n              }`}\n            >\n              {type}\n            </button>\n          ))}\n        </div>\n\n        {/* Input Field */}\n        <div className=\"flex gap-2\">\n          <Input\n            value={newPostContent}\n            onChange={(e: React.ChangeEvent) => setNewPostContent((e.target as any).value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                handleSendPost();\n              }\n            }}\n            placeholder={\n              membership\n                ? \"Type a message... (Shift+Enter for new line)\"\n                : \"Join the space to participate\"\n            }\n            disabled={!membership}\n            className=\"flex-1 bg-gray-900 border-gray-700\"\n          />\n          <Button\n            onClick={handleSendPost}\n            disabled={!membership || !newPostContent.trim()}\n            className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            <Send className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Individual post component\nfunction PostMessage({\n  post,\n  isLeader,\n  isModerator,\n  onPin,\n  onPromote,\n  onMakeTab,\n  onReply,\n  onReact\n}: {\n  post: Post;\n  isLeader: boolean;\n  isModerator: boolean;\n  onPin: () => void;\n  onPromote: () => void;\n  onMakeTab: () => void;\n  onReply: () => void;\n  onReact: (emoji: string) => void;\n}) {\n  const [showActions, setShowActions] = useState(false);\n\n  const getTypeIcon = () => {\n    switch (post.type) {\n      case 'announcement': return <AlertCircle className=\"w-4 h-4 text-yellow-400\" />;\n      case 'poll': return <Vote className=\"w-4 h-4 text-blue-400\" />;\n      case 'event': return <Calendar className=\"w-4 h-4 text-green-400\" />;\n      case 'volunteer': return <Users className=\"w-4 h-4 text-purple-400\" />;\n      default: return null;\n    }\n  };\n\n  return (\n    <div\n      className={`group flex gap-3 p-3 rounded hover:bg-gray-900/50 ${\n        post.promoted ? 'border-l-2 border-[var(--hive-brand-primary)]' : ''\n      }`}\n      onMouseEnter={() => setShowActions(true)}\n      onMouseLeave={() => setShowActions(false)}\n    >\n      {/* Avatar */}\n      <div className=\"w-8 h-8 rounded-full bg-gray-700 flex-shrink-0\" />\n\n      {/* Content */}\n      <div className=\"flex-1\">\n        <div className=\"flex items-center gap-2 mb-1\">\n          <span className=\"font-semibold text-white text-sm\">{post.authorName}</span>\n          <span className=\"text-xs text-gray-500\">\n            {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}\n          </span>\n          {getTypeIcon()}\n          {post.pinned && <Pin className=\"w-3 h-3 text-[var(--hive-brand-primary)]\" />}\n          {post.promoted && <TrendingUp className=\"w-3 h-3 text-green-400\" />}\n        </div>\n\n        <p className=\"text-sm text-gray-200 whitespace-pre-wrap\">{post.content}</p>\n\n        {/* Thread Indicator */}\n        {post.isThread && post.replyCount > 0 && (\n          <button\n            onClick={onReply}\n            className=\"mt-2 flex items-center gap-1 text-xs text-blue-400 hover:text-blue-300\"\n          >\n            <MessageSquare className=\"w-3 h-3\" />\n            {post.replyCount} replies\n          </button>\n        )}\n\n        {/* Reactions */}\n        {Object.keys(post.reactions || {}).length > 0 && (\n          <div className=\"flex gap-1 mt-2\">\n            {Object.entries(post.reactions).map(([emoji, users]) => (\n              <button\n                key={emoji}\n                onClick={() => onReact(emoji)}\n                className=\"px-2 py-1 bg-gray-800 rounded text-xs hover:bg-gray-700\"\n              >\n                {emoji} {users.length}\n              </button>\n            ))}\n          </div>\n        )}\n\n        {/* Leader Actions (inline, SPEC.md) */}\n        {showActions && (isLeader || isModerator) && (\n          <div className=\"flex gap-2 mt-2\">\n            {!post.pinned && (\n              <button\n                onClick={onPin}\n                className=\"text-xs text-gray-500 hover:text-[var(--hive-brand-primary)]\"\n              >\n                [Pin]\n              </button>\n            )}\n            {isLeader && !post.promoted && (\n              <button\n                onClick={onPromote}\n                className=\"text-xs text-gray-500 hover:text-green-400\"\n              >\n                [Promote]\n              </button>\n            )}\n            {isLeader && post.replyCount >= 10 && !post.isTab && (\n              <button\n                onClick={onMakeTab}\n                className=\"text-xs text-gray-500 hover:text-blue-400\"\n              >\n                [Make Tab]\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Quick Actions */}\n      <div className=\"opacity-0 group-hover:opacity-100 transition-opacity flex items-start gap-1\">\n        <button\n          onClick={onReply}\n          className=\"p-1 hover:bg-gray-800 rounded\"\n        >\n          <Reply className=\"w-3 h-3 text-gray-400\" />\n        </button>\n        <button\n          onClick={() => onReact('üëç')}\n          className=\"p-1 hover:bg-gray-800 rounded\"\n        >\n          üëç\n        </button>\n      </div>\n    </div>\n  );\n}\n\n// Group posts by time periods (SPEC.md)\nfunction groupPostsByTime(posts: Post[]): { [key: string]: Post[] } {\n  const now = new Date();\n  const groups: { [key: string]: Post[] } = {};\n\n  posts.forEach(post => {\n    const postDate = new Date(post.createdAt);\n    const hoursDiff = (now.getTime() - postDate.getTime()) / (1000 * 60 * 60);\n\n    let period: string;\n    if (hoursDiff < 1) {\n      period = 'Last hour';\n    } else if (hoursDiff < 24) {\n      period = 'Today';\n    } else if (hoursDiff < 48) {\n      period = 'Yesterday';\n    } else if (hoursDiff < 168) {\n      period = 'This week';\n    } else {\n      period = postDate.toLocaleDateString();\n    }\n\n    if (!groups[period]) {\n      groups[period] = [];\n    }\n    groups[period].push(post);\n  });\n\n  return groups;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-context-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Progress' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toggleSection' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":69,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from 'react';\nimport {\n  Users,\n  Calendar,\n  Bell,\n  Settings,\n  Plus,\n  Activity,\n  Clock,\n  MapPin,\n  Star,\n  TrendingUp,\n  Zap\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Badge,\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n  Progress\n} from '@hive/ui';\nimport type { Space, User } from '@hive/core';\nimport { SpaceToolRenderer } from './space-tool-renderer';\nimport type { SpaceTypeRules } from '@/lib/space-type-rules';\n\ninterface SpaceContextPanelProps {\n  space: Space;\n  userMembership: any;\n  onlineMembers: User[];\n  contextualTools: any[];\n  userPermissions: {\n    isMember: boolean;\n    isAdmin: boolean;\n    isModerator?: boolean;\n    role?: string;\n  };\n  spaceRules: SpaceTypeRules | null;\n  onToolInteraction: (toolId: string, action: string) => void;\n}\n\nexport function SpaceContextPanel({\n  space,\n  userMembership,\n  onlineMembers,\n  contextualTools,\n  userPermissions,\n  spaceRules,\n  onToolInteraction\n}: SpaceContextPanelProps) {\n  const [expandedSection, setExpandedSection] = useState<string | null>('quick-info');\n\n  // Mock recent activity - in real app, this would come from API\n  const recentActivity = [\n    { type: 'member_joined', user: 'Sarah Chen', time: '2 min ago' },\n    { type: 'post_created', user: 'Mike Johnson', time: '15 min ago' },\n    { type: 'event_created', user: 'Alex Rivera', time: '1 hour ago' }\n  ];\n\n  // Mock upcoming events - in real app, this would come from API\n  const upcomingEvents = [\n    { id: '1', title: 'Weekly Meeting', time: 'Today 3:00 PM', attendees: 12 },\n    { id: '2', title: 'Project Presentation', time: 'Tomorrow 10:00 AM', attendees: 8 }\n  ];\n\n  const toggleSection = (section: string) => {\n    setExpandedSection(expandedSection === section ? null : section);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n\n      {/* Quick Space Info */}\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"text-lg font-semibold text-white\">Space Info</h3>\n          {userPermissions.isAdmin && (\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => onToolInteraction('space-settings', 'open')}\n            >\n              <Settings className=\"w-4 h-4\" />\n            </Button>\n          )}\n        </div>\n\n        <div className=\"space-y-3\">\n          {/* Space Stats */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"text-center p-3 bg-gray-800/50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-[var(--hive-brand-primary)]\">{space.memberCount || 0}</div>\n              <div className=\"text-xs text-gray-400\">Members</div>\n            </div>\n            <div className=\"text-center p-3 bg-gray-800/50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-green-400\">{onlineMembers.length}</div>\n              <div className=\"text-xs text-gray-400\">Online</div>\n            </div>\n          </div>\n\n          {/* Space Type Info */}\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Badge variant=\"secondary\" className=\"border-[var(--hive-brand-primary)]/30 text-[var(--hive-brand-primary)]\">\n              {space.spaceType?.replace('_', ' ') || 'Community'}\n            </Badge>\n            {space.status === 'activated' && (\n              <div className=\"flex items-center gap-1\">\n                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n                <span className=\"text-xs text-green-400\">Active</span>\n              </div>\n            )}\n          </div>\n\n          {/* Join/Leave Button */}\n          {!userPermissions.isMember ? (\n            <Button\n              className=\"w-full bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n              onClick={() => onToolInteraction('space-membership', 'join')}\n            >\n              Join Space\n            </Button>\n          ) : userPermissions.isAdmin ? (\n            <Button\n              variant=\"outline\"\n              className=\"w-full border-[var(--hive-brand-primary)]/30 text-[var(--hive-brand-primary)]\"\n              onClick={() => onToolInteraction('space-management', 'open')}\n            >\n              <Settings className=\"w-4 h-4 mr-2\" />\n              Manage Space\n            </Button>\n          ) : null}\n        </div>\n      </Card>\n\n      {/* Online Members */}\n      {onlineMembers.length > 0 && (\n        <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h4 className=\"font-semibold text-white flex items-center gap-2\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n              Online Now\n            </h4>\n            <span className=\"text-xs text-gray-400\">{onlineMembers.length}</span>\n          </div>\n          <div className=\"space-y-2\">\n            {onlineMembers.slice(0, 5).map((member, index) => (\n              <div key={index} className=\"flex items-center gap-3\">\n                <Avatar className=\"w-8 h-8\">\n                  <AvatarImage src={(member as any).avatarUrl} />\n                  <AvatarFallback className=\"bg-[var(--hive-brand-primary)] text-black text-xs\">\n                    {(member as any).name?.[0] || '?'}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"text-sm font-medium text-white truncate\">\n                    {(member as any).name || 'Unknown User'}\n                  </div>\n                  <div className=\"text-xs text-gray-400\">\n                    {(member as any).role || 'Member'}\n                  </div>\n                </div>\n                <div className=\"w-2 h-2 bg-green-500 rounded-full\" />\n              </div>\n            ))}\n            {onlineMembers.length > 5 && (\n              <div className=\"text-xs text-gray-400 text-center pt-2\">\n                +{onlineMembers.length - 5} more online\n              </div>\n            )}\n          </div>\n        </Card>\n      )}\n\n      {/* Contextual Tools */}\n      {contextualTools.length > 0 && (\n        <div className=\"space-y-3\">\n          {contextualTools.map(tool => (\n            <Card key={tool.id} className=\"bg-gray-900/50 border-gray-800 p-4\">\n              <SpaceToolRenderer\n                tool={tool}\n                spaceId={space.id}\n                spaceType={space.spaceType as string}\n                userPermissions={{\n                  userId: userMembership?.userId || '',\n                  spaceId: space.id,\n                  role: userPermissions.role || 'guest'\n                } as any}\n                spaceRules={spaceRules}\n                position=\"contextual\"\n              />\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {/* Quick Actions */}\n      {userPermissions.isMember && (\n        <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n          <h4 className=\"font-semibold text-white mb-3\">Quick Actions</h4>\n          <div className=\"grid grid-cols-2 gap-2\">\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n              onClick={() => onToolInteraction('create-post', 'open')}\n            >\n              <Plus className=\"w-4 h-4 mr-1\" />\n              Post\n            </Button>\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n              onClick={() => onToolInteraction('create-event', 'open')}\n            >\n              <Calendar className=\"w-4 h-4 mr-1\" />\n              Event\n            </Button>\n            {userPermissions.isAdmin && (\n              <>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n                  onClick={() => onToolInteraction('invite-members', 'open')}\n                >\n                  <Users className=\"w-4 h-4 mr-1\" />\n                  Invite\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n                  onClick={() => onToolInteraction('space-analytics', 'open')}\n                >\n                  <TrendingUp className=\"w-4 h-4 mr-1\" />\n                  Stats\n                </Button>\n              </>\n            )}\n          </div>\n        </Card>\n      )}\n\n      {/* Upcoming Events */}\n      {upcomingEvents.length > 0 && (\n        <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h4 className=\"font-semibold text-white flex items-center gap-2\">\n              <Calendar className=\"w-4 h-4\" />\n              Upcoming\n            </h4>\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => onToolInteraction('view-calendar', 'open')}\n            >\n              <span className=\"text-xs text-[var(--hive-brand-primary)]\">View All</span>\n            </Button>\n          </div>\n          <div className=\"space-y-3\">\n            {upcomingEvents.slice(0, 2).map(event => (\n              <div\n                key={event.id}\n                className=\"p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800/70 transition-colors\"\n                onClick={() => onToolInteraction('view-event', event.id)}\n              >\n                <div className=\"text-sm font-medium text-white mb-1\">\n                  {event.title}\n                </div>\n                <div className=\"flex items-center justify-between text-xs text-gray-400\">\n                  <div className=\"flex items-center gap-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    {event.time}\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Users className=\"w-3 h-3\" />\n                    {event.attendees}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* Recent Activity */}\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h4 className=\"font-semibold text-white flex items-center gap-2\">\n            <Activity className=\"w-4 h-4\" />\n            Recent Activity\n          </h4>\n        </div>\n        <div className=\"space-y-2\">\n          {recentActivity.map((activity, index) => (\n            <div key={index} className=\"flex items-center gap-3 text-sm\">\n              <div className=\"w-2 h-2 bg-[var(--hive-brand-primary)] rounded-full flex-shrink-0\" />\n              <div className=\"flex-1 min-w-0\">\n                <span className=\"text-white font-medium\">{activity.user}</span>\n                <span className=\"text-gray-400 ml-1\">\n                  {activity.type === 'member_joined' && 'joined the space'}\n                  {activity.type === 'post_created' && 'created a post'}\n                  {activity.type === 'event_created' && 'created an event'}\n                </span>\n              </div>\n              <span className=\"text-xs text-gray-500 flex-shrink-0\">\n                {activity.time}\n              </span>\n            </div>\n          ))}\n        </div>\n      </Card>\n\n      {/* Space Rules/Guidelines (for Greek Life and Residential) */}\n      {((space.spaceType as string) === 'greek_life_spaces' || (space.spaceType as string) === 'residential_spaces') && (\n        <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n          <h4 className=\"font-semibold text-white mb-3 flex items-center gap-2\">\n            <Star className=\"w-4 h-4 text-[var(--hive-brand-primary)]\" />\n            {(space.spaceType as string) === 'greek_life_spaces' ? 'Chapter Guidelines' : 'Community Guidelines'}\n          </h4>\n          <div className=\"space-y-2 text-sm text-gray-300\">\n            <div className=\"p-2 bg-gray-800/30 rounded\">\n              <div className=\"text-[var(--hive-brand-primary)] font-medium mb-1\">\n                {(space.spaceType as string) === 'greek_life_spaces' ? 'Brotherhood/Sisterhood Values' : 'Respectful Living'}\n              </div>\n              <div className=\"text-xs text-gray-400\">\n                {(space.spaceType as string) === 'greek_life_spaces'\n                  ? 'Honor our traditions and support each other'\n                  : 'Be considerate of your neighbors and shared spaces'\n                }\n              </div>\n            </div>\n          </div>\n        </Card>\n      )}\n\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-discovery-hub.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserPlus' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tabs' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsList' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsTrigger' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadSpaces' and 'setupRealtimeTracking'. Either include them or remove the dependency array.","line":112,"column":6,"nodeType":"ArrayExpression","endLine":112,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [loadSpaces, selectedCategory, setupRealtimeTracking]","fix":{"range":[2814,2832],"text":"[loadSpaces, selectedCategory, setupRealtimeTracking]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'idx' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":389,"column":72,"nodeType":null,"messageId":"unusedVar","endLine":389,"endColumn":75}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport {\n  Search,\n  Users,\n  Building2,\n  Home,\n  GraduationCap,\n  TrendingUp,\n  Clock,\n  Sparkles,\n  Activity,\n  ChevronRight,\n  Filter,\n  Eye,\n  UserPlus,\n  Calendar,\n  MessageSquare\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Badge,\n  Input,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent\n} from '@hive/ui';\nimport type { Space } from '@hive/core';\nimport { api } from '@/lib/api-client';\nimport type { SpaceType } from '@/lib/space-type-rules';\n\ninterface SpaceWithActivity extends Space {\n  activeNow: number;\n  recentPosts: number;\n  upcomingEvents: number;\n  memberGrowth: number;\n  lastActivityAt: Date;\n  topMembers?: Array<{\n    id: string;\n    name: string;\n    avatar?: string;\n  }>;\n}\n\ninterface CategoryConfig {\n  id: SpaceType;\n  label: string;\n  icon: React.ElementType;\n  color: string;\n  bgGradient: string;\n  description: string;\n  searchPlaceholder: string;\n}\n\nconst CATEGORIES: CategoryConfig[] = [\n  {\n    id: 'student_organizations',\n    label: 'Student Orgs',\n    icon: Users,\n    color: 'text-blue-400',\n    bgGradient: 'from-blue-500/20 to-blue-600/10',\n    description: 'Clubs, organizations, and student groups',\n    searchPlaceholder: 'Search clubs and organizations...'\n  },\n  {\n    id: 'university_organizations',\n    label: 'University',\n    icon: GraduationCap,\n    color: 'text-purple-400',\n    bgGradient: 'from-purple-500/20 to-purple-600/10',\n    description: 'Classes, departments, and academic programs',\n    searchPlaceholder: 'Search classes and departments...'\n  },\n  {\n    id: 'residential_spaces',\n    label: 'Residential',\n    icon: Home,\n    color: 'text-green-400',\n    bgGradient: 'from-green-500/20 to-green-600/10',\n    description: 'Dorms, residence halls, and living communities',\n    searchPlaceholder: 'Search dorms and halls...'\n  },\n  {\n    id: 'greek_life_spaces',\n    label: 'Greek Life',\n    icon: Building2,\n    color: 'text-orange-400',\n    bgGradient: 'from-orange-500/20 to-orange-600/10',\n    description: 'Fraternities and sororities',\n    searchPlaceholder: 'Search Greek organizations...'\n  }\n];\n\nexport function SpaceDiscoveryHub() {\n  const router = useRouter();\n  const [selectedCategory, setSelectedCategory] = useState<SpaceType>('student_organizations');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [spaces, setSpaces] = useState<SpaceWithActivity[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activityView, setActivityView] = useState<'trending' | 'active' | 'new'>('trending');\n\n  // Real-time activity tracking\n  const [realtimeActivity, setRealtimeActivity] = useState<Map<string, number>>(new Map());\n\n  useEffect(() => {\n    loadSpaces();\n    setupRealtimeTracking();\n  }, [selectedCategory]);\n\n  const loadSpaces = async () => {\n    try {\n      setLoading(true);\n      const result = await api.spaces.browse<{ spaces: SpaceWithActivity[] }>({\n        category: selectedCategory,\n        includeActivity: true,\n        limit: 50\n      });\n      setSpaces(result.spaces || []);\n    } catch (error) {\n      console.error('Error loading spaces:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const setupRealtimeTracking = () => {\n    // Connect to SSE for real-time activity updates\n    const eventSource = new EventSource(`/api/spaces/activity-stream?category=${selectedCategory}`);\n\n    eventSource.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'activity_update') {\n        setRealtimeActivity(prev => {\n          const newMap = new Map(prev);\n          newMap.set(data.spaceId, data.activeUsers);\n          return newMap;\n        });\n      }\n    };\n\n    return () => eventSource.close();\n  };\n\n  // Filter and sort spaces based on search and activity view\n  const filteredSpaces = useMemo(() => {\n    const filtered = spaces.filter(space =>\n      space.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      space.description?.toLowerCase().includes(searchQuery.toLowerCase())\n    );\n\n    // Apply activity-based sorting\n    switch (activityView) {\n      case 'trending':\n        return filtered.sort((a, b) => b.memberGrowth - a.memberGrowth);\n      case 'active':\n        return filtered.sort((a, b) => {\n          const aActive = realtimeActivity.get(a.id) || a.activeNow;\n          const bActive = realtimeActivity.get(b.id) || b.activeNow;\n          return bActive - aActive;\n        });\n      case 'new':\n        return filtered.sort((a, b) =>\n          new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n        );\n      default:\n        return filtered;\n    }\n  }, [spaces, searchQuery, activityView, realtimeActivity]);\n\n  const currentCategory = CATEGORIES.find(c => c.id === selectedCategory)!;\n\n  const getActivityIndicator = (space: SpaceWithActivity) => {\n    const activeCount = realtimeActivity.get(space.id) || space.activeNow;\n\n    if (activeCount > 20) return { label: 'üî• Very Active', color: 'text-red-500' };\n    if (activeCount > 10) return { label: '‚ú® Active', color: 'text-orange-500' };\n    if (activeCount > 5) return { label: 'üí¨ Some Activity', color: 'text-yellow-500' };\n    if (activeCount > 0) return { label: 'üëÄ Few Online', color: 'text-green-500' };\n    return { label: 'üò¥ Quiet', color: 'text-gray-500' };\n  };\n\n  const handleSpaceClick = (spaceId: string) => {\n    router.push(`/spaces/${spaceId}`);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-black to-gray-900\">\n      {/* Header */}\n      <div className=\"bg-black/80 backdrop-blur-md border-b border-gray-800\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex flex-col gap-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-white mb-2\">Discover Spaces</h1>\n              <p className=\"text-gray-400\">Find your community at UB</p>\n            </div>\n\n            {/* Category Tabs */}\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n              {CATEGORIES.map(category => (\n                <button\n                  key={category.id}\n                  onClick={() => setSelectedCategory(category.id)}\n                  className={`\n                    flex items-center gap-2 px-4 py-2 rounded-lg transition-all\n                    ${selectedCategory === category.id\n                      ? `bg-gradient-to-r ${category.bgGradient} border-2 border-gray-700`\n                      : 'bg-gray-800/50 border-2 border-transparent hover:bg-gray-800'\n                    }\n                  `}\n                >\n                  <category.icon className={`w-5 h-5 ${category.color}`} />\n                  <span className=\"text-white font-medium whitespace-nowrap\">\n                    {category.label}\n                  </span>\n                  <Badge className=\"bg-gray-700 text-gray-300\">\n                    {spaces.length}\n                  </Badge>\n                </button>\n              ))}\n            </div>\n\n            {/* Search and Filters */}\n            <div className=\"flex gap-3\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <Input\n                  value={searchQuery}\n                  onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n                  placeholder={currentCategory.searchPlaceholder}\n                  className=\"pl-10 bg-gray-800 border-gray-700 text-white\"\n                />\n              </div>\n\n              {/* Activity View Toggle */}\n              <div className=\"flex gap-2\">\n                <Button\n                  variant={activityView === 'trending' ? 'default' : 'outline'}\n                  className={`max-w-sm ${activityView === 'trending' ? 'bg-[var(--hive-brand-primary)] text-black' : ''}`}\n                  onClick={() => setActivityView('trending')}\n                >\n                  <TrendingUp className=\"w-4 h-4 mr-1\" />\n                  Trending\n                </Button>\n                <Button\n                  variant={activityView === 'active' ? 'default' : 'outline'}\n                  className={`max-w-sm ${activityView === 'active' ? 'bg-[var(--hive-brand-primary)] text-black' : ''}`}\n                  onClick={() => setActivityView('active')}\n                >\n                  <Activity className=\"w-4 h-4 mr-1\" />\n                  Active Now\n                </Button>\n                <Button\n                  variant={activityView === 'new' ? 'default' : 'outline'}\n                  className={`max-w-sm ${activityView === 'new' ? 'bg-[var(--hive-brand-primary)] text-black' : ''}`}\n                  onClick={() => setActivityView('new')}\n                >\n                  <Sparkles className=\"w-4 h-4 mr-1\" />\n                  New\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Activity Heat Map */}\n        <div className=\"mb-8 bg-gradient-to-r from-gray-800/50 to-gray-900/50 rounded-xl p-6 border border-gray-800\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-xl font-semibold text-white\">Campus Activity Right Now</h2>\n            <span className=\"text-sm text-gray-400\">\n              {Array.from(realtimeActivity.values()).reduce((a, b) => a + b, 0)} people active\n            </span>\n          </div>\n\n          {/* Activity bars visualization */}\n          <div className=\"grid grid-cols-4 gap-4\">\n            {CATEGORIES.map(cat => {\n              const categorySpaces = spaces.filter(s => s.type === cat.id);\n              const totalActive = categorySpaces.reduce((sum, space) =>\n                sum + (realtimeActivity.get(space.id) || space.activeNow), 0\n              );\n\n              return (\n                <div key={cat.id} className=\"relative\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <cat.icon className={`w-4 h-4 ${cat.color}`} />\n                    <span className=\"text-sm text-gray-300\">{cat.label}</span>\n                  </div>\n                  <div className=\"h-2 bg-gray-700 rounded-full overflow-hidden\">\n                    <div\n                      className={`h-full bg-gradient-to-r ${cat.bgGradient} transition-all duration-500`}\n                      style={{ width: `${Math.min(100, totalActive * 2)}%` }}\n                    />\n                  </div>\n                  <span className=\"text-xs text-gray-500 mt-1\">{totalActive} active</span>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* Spaces Grid */}\n        {loading ? (\n          <div className=\"flex items-center justify-center py-20\">\n            <div className=\"text-center\">\n              <div className=\"text-6xl animate-pulse mb-4\">üçØ</div>\n              <span className=\"text-xl text-[var(--hive-brand-primary)]\">Loading spaces...</span>\n            </div>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredSpaces.map(space => {\n              const activity = getActivityIndicator(space);\n              const activeCount = realtimeActivity.get(space.id) || space.activeNow;\n\n              return (\n                <Card\n                  key={space.id}\n                  className=\"bg-gray-900/50 border-gray-800 hover:border-[var(--hive-brand-primary)]/50 transition-all cursor-pointer group\"\n                  onClick={() => handleSpaceClick(space.id)}\n                >\n                  <div className=\"p-6\">\n                    {/* Space Header */}\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-12 h-12 bg-gray-800 rounded-lg flex items-center justify-center\">\n                          <span className=\"text-2xl\">{(space as any).avatar || 'üèõÔ∏è'}</span>\n                        </div>\n                        <div>\n                          <h3 className=\"font-semibold text-white group-hover:text-[var(--hive-brand-primary)] transition-colors\">\n                            {space.name}\n                          </h3>\n                          <div className={`text-xs ${activity.color} font-medium`}>\n                            {activity.label}\n                          </div>\n                        </div>\n                      </div>\n                      <ChevronRight className=\"w-5 h-5 text-gray-500 group-hover:text-[var(--hive-brand-primary)] transition-colors\" />\n                    </div>\n\n                    {/* Description */}\n                    <p className=\"text-sm text-gray-400 mb-4 line-clamp-2\">\n                      {space.description}\n                    </p>\n\n                    {/* Stats */}\n                    <div className=\"grid grid-cols-3 gap-2 mb-4\">\n                      <div className=\"text-center p-2 bg-gray-800/50 rounded\">\n                        <div className=\"text-lg font-semibold text-white\">{space.memberCount || 0}</div>\n                        <div className=\"text-xs text-gray-500\">members</div>\n                      </div>\n                      <div className=\"text-center p-2 bg-gray-800/50 rounded\">\n                        <div className=\"text-lg font-semibold text-green-400\">{activeCount}</div>\n                        <div className=\"text-xs text-gray-500\">online</div>\n                      </div>\n                      <div className=\"text-center p-2 bg-gray-800/50 rounded\">\n                        <div className=\"text-lg font-semibold text-blue-400\">{space.upcomingEvents}</div>\n                        <div className=\"text-xs text-gray-500\">events</div>\n                      </div>\n                    </div>\n\n                    {/* Activity Indicators */}\n                    <div className=\"flex items-center gap-3 text-xs text-gray-400\">\n                      {space.recentPosts > 0 && (\n                        <div className=\"flex items-center gap-1\">\n                          <MessageSquare className=\"w-3 h-3\" />\n                          <span>{space.recentPosts} new posts</span>\n                        </div>\n                      )}\n                      {space.memberGrowth > 0 && (\n                        <div className=\"flex items-center gap-1 text-green-400\">\n                          <TrendingUp className=\"w-3 h-3\" />\n                          <span>+{space.memberGrowth}% growth</span>\n                        </div>\n                      )}\n                    </div>\n\n                    {/* Top Members Preview */}\n                    {space.topMembers && space.topMembers.length > 0 && (\n                      <div className=\"mt-4 pt-4 border-t border-gray-800\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex -space-x-2\">\n                            {space.topMembers.slice(0, 4).map((member, idx) => (\n                              <div\n                                key={member.id}\n                                className=\"w-6 h-6 bg-gray-700 rounded-full border-2 border-gray-900 flex items-center justify-center\"\n                                title={member.name}\n                              >\n                                <span className=\"text-xs\">\n                                  {member.avatar || member.name.charAt(0)}\n                                </span>\n                              </div>\n                            ))}\n                          </div>\n                          <span className=\"text-xs text-gray-500\">\n                            +{Math.max(0, space.memberCount - 4)} more\n                          </span>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </Card>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Empty State */}\n        {!loading && filteredSpaces.length === 0 && (\n          <div className=\"text-center py-20\">\n            <div className=\"text-6xl mb-4\">üîç</div>\n            <h3 className=\"text-xl font-semibold text-white mb-2\">No spaces found</h3>\n            <p className=\"text-gray-400\">Try adjusting your search or filters</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-error-boundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-event-calendar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setFilter' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":91,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'canEdit' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":396,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":396,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isUpcoming' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":404,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":404,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, type ChangeEvent, type FormEvent } from 'react';\nimport {\n  addMonths,\n  eachDayOfInterval,\n  endOfMonth,\n  format,\n  isSameDay,\n  isToday,\n  startOfMonth,\n  subMonths\n} from 'date-fns';\nimport {\n  AlertCircle,\n  Calendar,\n  Check,\n  ChevronLeft,\n  ChevronRight,\n  Clock,\n  Filter,\n  Grid3X3,\n  List,\n  MapPin,\n  MoreHorizontal,\n  Plus,\n  Repeat,\n  Users,\n  Video,\n  X\n} from 'lucide-react';\nimport {\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n  Badge,\n  Button,\n  Card,\n  Dialog,\n  DialogContent,\n  Input\n} from '@hive/ui';\nimport type { User } from '@hive/core';\nimport type { SpaceTypeRules } from '@/lib/space-type-rules';\n\n// Define missing types that should be in @hive/core\ninterface SpaceEvent {\n  id: string;\n  title: string;\n  description: string;\n  startTime: Date | string;\n  endTime: Date | string;\n  location?: string;\n  spaceId: string;\n  organizerId: string;\n  createdAt: Date | string;\n  isRecurring?: boolean;\n  isVirtual?: boolean;\n}\n\ninterface EventRSVP {\n  id: string;\n  eventId: string;\n  userId: string;\n  response: 'yes' | 'no' | 'maybe';\n  createdAt: Date | string;\n  user?: User;\n}\n\ninterface SpaceEventCalendarProps {\n  spaceId: string;\n  canCreateEvents: boolean;\n  spaceRules?: SpaceTypeRules | null;\n}\n\ninterface EventWithDetails extends SpaceEvent {\n  rsvps: EventRSVP[];\n  attendeeCount: number;\n  userRSVP?: 'yes' | 'no' | 'maybe' | null;\n  organizer: User;\n}\n\ntype ViewMode = 'calendar' | 'list';\ntype EventFilter = 'all' | 'upcoming' | 'attending' | 'organizing';\n\nexport function SpaceEventCalendar({ spaceId, canCreateEvents, spaceRules }: SpaceEventCalendarProps) {\n  const [events, setEvents] = useState<EventWithDetails[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [viewMode, setViewMode] = useState<ViewMode>('calendar');\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [filter, setFilter] = useState<EventFilter>('all');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedEvent, setSelectedEvent] = useState<EventWithDetails | null>(null);\n\n  // Space rules-based event features\n  const isGreekLife = spaceRules?.membership.joinMethod === 'invitation_only';\n  const isResidential = spaceRules?.membership.maxSpaces === 1;\n\n  const createEventButtonText = isGreekLife\n    ? 'Plan Chapter Event'\n    : isResidential\n    ? 'Schedule Community Event'\n    : 'Create Event';\n\n  // Fetch events\n  useEffect(() => {\n    const fetchEvents = async () => {\n      try {\n        const response = await fetch(`/api/spaces/${spaceId}/events`);\n        const data = await response.json();\n\n        if (data.success) {\n          setEvents(data.data || []);\n        }\n      } catch (error) {\n        console.error('Failed to fetch events:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchEvents();\n  }, [spaceId]);\n\n  // Handle RSVP\n  const handleRSVP = async (eventId: string, response: 'yes' | 'no' | 'maybe') => {\n    try {\n      await fetch(`/api/spaces/${spaceId}/events/${eventId}/rsvp`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ response })\n      });\n\n      // Update local state\n      setEvents(prev => prev.map(event => {\n        if (event.id === eventId) {\n          return {\n            ...event,\n            userRSVP: response,\n            attendeeCount: response === 'yes'\n              ? event.attendeeCount + (event.userRSVP === 'yes' ? 0 : 1)\n              : event.attendeeCount - (event.userRSVP === 'yes' ? 1 : 0)\n          };\n        }\n        return event;\n      }));\n    } catch (error) {\n      console.error('Failed to RSVP:', error);\n    }\n  };\n\n  // Filter events\n  const filteredEvents = events.filter(event => {\n    switch (filter) {\n      case 'upcoming':\n        return new Date(event.startTime) > new Date();\n      case 'attending':\n        return event.userRSVP === 'yes';\n      case 'organizing':\n        return event.organizer.id === 'current-user-id'; // Replace with actual user ID\n      default:\n        return true;\n    }\n  });\n\n  // Get events for current month (calendar view)\n  const monthStart = startOfMonth(currentDate);\n  const monthEnd = endOfMonth(currentDate);\n  const calendarDays = eachDayOfInterval({ start: monthStart, end: monthEnd });\n\n  const getEventsForDay = (day: Date) => {\n    return filteredEvents.filter(event =>\n      isSameDay(new Date(event.startTime), day)\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"animate-pulse space-y-4\">\n          <div className=\"bg-gray-800 h-8 rounded w-1/3\"></div>\n          <div className=\"bg-gray-800 h-64 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4\">\n        <div>\n          <h3 className=\"text-xl font-semibold text-white mb-1\">Events</h3>\n          <p className=\"text-gray-400 text-sm\">Coordinate and attend space activities</p>\n        </div>\n\n        <div className=\"flex items-center space-x-3\">\n          {/* View Toggle */}\n          <div className=\"flex bg-gray-800 rounded-lg p-1\">\n            <button\n              onClick={() => setViewMode('calendar')}\n              className={`p-2 rounded-md transition-colors ${\n                viewMode === 'calendar' ? 'bg-[var(--hive-brand-primary)] text-black' : 'text-gray-400 hover:text-white'\n              }`}\n            >\n              <Grid3X3 className=\"w-4 h-4\" />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={`p-2 rounded-md transition-colors ${\n                viewMode === 'list' ? 'bg-[var(--hive-brand-primary)] text-black' : 'text-gray-400 hover:text-white'\n              }`}\n            >\n              <List className=\"w-4 h-4\" />\n            </button>\n          </div>\n\n          {/* Filter */}\n          <div className=\"relative\">\n            <Button variant=\"outline\" className=\"max-w-sm\">\n              <Filter className=\"w-4 h-4 mr-2\" />\n              {filter === 'all' ? 'All Events' :\n               filter === 'upcoming' ? 'Upcoming' :\n               filter === 'attending' ? 'Attending' : 'Organizing'}\n            </Button>\n            {/* Simplified filter - would need proper dropdown */}\n          </div>\n\n          {/* Create Event */}\n          {canCreateEvents && (\n            <Button\n              onClick={() => setShowCreateModal(true)}\n              className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              {createEventButtonText}\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Calendar View */}\n      {viewMode === 'calendar' && (\n        <div>\n          {/* Calendar Header */}\n          <div className=\"flex items-center justify-between mb-6\">\n            <h4 className=\"text-lg font-semibold text-white\">\n              {format(currentDate, 'MMMM yyyy')}\n            </h4>\n            <div className=\"flex items-center space-x-2\">\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={() => setCurrentDate(subMonths(currentDate, 1))}\n              >\n                <ChevronLeft className=\"w-4 h-4\" />\n              </Button>\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={() => setCurrentDate(new Date())}\n              >\n                Today\n              </Button>\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={() => setCurrentDate(addMonths(currentDate, 1))}\n              >\n                <ChevronRight className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Calendar Grid */}\n          <div className=\"grid grid-cols-7 gap-2\">\n            {/* Day headers */}\n            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n              <div key={day} className=\"p-2 text-center text-sm font-medium text-gray-400\">\n                {day}\n              </div>\n            ))}\n\n            {/* Calendar days */}\n            {calendarDays.map((day) => {\n              const dayEvents = getEventsForDay(day);\n              const isCurrentDay = isToday(day);\n\n              return (\n                <div\n                  key={day.toISOString()}\n                  className={`min-h-24 p-2 border border-gray-800 rounded-lg ${\n                    isCurrentDay ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]/30' : 'bg-gray-900/50'\n                  }`}\n                >\n                  <div className={`text-sm font-medium mb-1 ${\n                    isCurrentDay ? 'text-[var(--hive-brand-primary)]' : 'text-white'\n                  }`}>\n                    {format(day, 'd')}\n                  </div>\n\n                  <div className=\"space-y-1\">\n                    {dayEvents.slice(0, 3).map((event) => (\n                      <div\n                        key={event.id}\n                        onClick={() => setSelectedEvent(event)}\n                        className=\"text-xs p-1 bg-blue-500/20 text-blue-300 rounded cursor-pointer hover:bg-blue-500/30 transition-colors truncate\"\n                      >\n                        {format(new Date(event.startTime), 'HH:mm')} {event.title}\n                      </div>\n                    ))}\n\n                    {dayEvents.length > 3 && (\n                      <div className=\"text-xs text-gray-400\">\n                        +{dayEvents.length - 3} more\n                      </div>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* List View */}\n      {viewMode === 'list' && (\n        <div className=\"space-y-4\">\n          {filteredEvents.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <Calendar className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <h4 className=\"text-lg font-semibold text-white mb-2\">No events found</h4>\n              <p className=\"text-gray-400 mb-4\">\n                {filter === 'all'\n                  ? \"No events have been created yet\"\n                  : `No events match your current filter`\n                }\n              </p>\n              {canCreateEvents && filter === 'all' && (\n                <Button\n                  onClick={() => setShowCreateModal(true)}\n                  className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n                >\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  {createEventButtonText}\n                </Button>\n              )}\n            </div>\n          ) : (\n            filteredEvents.map((event) => (\n              <EventCard\n                key={event.id}\n                event={event}\n                onRSVP={handleRSVP}\n                onView={() => setSelectedEvent(event)}\n                canEdit={canCreateEvents}\n              />\n            ))\n          )}\n        </div>\n      )}\n\n      {/* Event Detail Modal */}\n      {selectedEvent && (\n        <EventDetailModal\n          event={selectedEvent}\n          isOpen={!!selectedEvent}\n          onClose={() => setSelectedEvent(null)}\n          onRSVP={handleRSVP}\n          canEdit={canCreateEvents}\n        />\n      )}\n\n      {/* Create Event Modal */}\n      {showCreateModal && (\n        <CreateEventModal\n          spaceId={spaceId}\n          isOpen={showCreateModal}\n          onClose={() => setShowCreateModal(false)}\n          createEventLabel={createEventButtonText}\n          onEventCreated={(newEvent) => {\n            setEvents(prev => [...prev, newEvent]);\n            setShowCreateModal(false);\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\n// Event Card Component\nfunction EventCard({\n  event,\n  onRSVP,\n  onView,\n  canEdit\n}: {\n  event: EventWithDetails;\n  onRSVP: (eventId: string, response: 'yes' | 'no' | 'maybe') => void;\n  onView: () => void;\n  canEdit: boolean;\n}) {\n  const isPast = new Date(event.endTime) < new Date();\n  const isUpcoming = new Date(event.startTime) > new Date();\n\n  return (\n    <Card className=\"p-4 hover:border-[var(--hive-brand-primary)]/50 transition-colors\">\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex-1\">\n          <div className=\"flex items-center space-x-2 mb-1\">\n            <h4 className=\"font-semibold text-white cursor-pointer hover:text-[var(--hive-brand-primary)]\" onClick={onView}>\n              {event.title}\n            </h4>\n            {isPast && <Badge variant=\"secondary\" className=\"text-xs\">Past</Badge>}\n            {event.isRecurring && <Repeat className=\"w-4 h-4 text-gray-400\" />}\n            {event.isVirtual && <Video className=\"w-4 h-4 text-blue-400\" />}\n          </div>\n\n          <div className=\"flex items-center space-x-4 text-sm text-gray-400 mb-2\">\n            <div className=\"flex items-center space-x-1\">\n              <Clock className=\"w-4 h-4\" />\n              <span>\n                {format(new Date(event.startTime), 'MMM d, HH:mm')} - {format(new Date(event.endTime), 'HH:mm')}\n              </span>\n            </div>\n\n            {event.location && (\n              <div className=\"flex items-center space-x-1\">\n                <MapPin className=\"w-4 h-4\" />\n                <span>{event.location}</span>\n              </div>\n            )}\n          </div>\n\n          {event.description && (\n            <p className=\"text-sm text-gray-300 mb-3 line-clamp-2\">{event.description}</p>\n          )}\n\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-1 text-sm text-gray-400\">\n              <Users className=\"w-4 h-4\" />\n              <span>{event.attendeeCount} attending</span>\n            </div>\n\n            <div className=\"flex items-center space-x-1 text-sm text-gray-400\">\n              <Users className=\"w-4 h-4\" />\n              <span>by {event.organizer.displayName}</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex items-center space-x-2 ml-4\">\n          {/* RSVP Status */}\n          {!isPast && (\n            <div className=\"flex bg-gray-800 rounded-lg p-1\">\n              <button\n                onClick={() => onRSVP(event.id, 'yes')}\n                className={`p-1 rounded text-xs transition-colors ${\n                  event.userRSVP === 'yes'\n                    ? 'bg-green-500 text-white'\n                    : 'text-gray-400 hover:text-green-400'\n                }`}\n                title=\"Going\"\n              >\n                <Check className=\"w-4 h-4\" />\n              </button>\n              <button\n                onClick={() => onRSVP(event.id, 'maybe')}\n                className={`p-1 rounded text-xs transition-colors ${\n                  event.userRSVP === 'maybe'\n                    ? 'bg-yellow-500 text-white'\n                    : 'text-gray-400 hover:text-yellow-400'\n                }`}\n                title=\"Maybe\"\n              >\n                <AlertCircle className=\"w-4 h-4\" />\n              </button>\n              <button\n                onClick={() => onRSVP(event.id, 'no')}\n                className={`p-1 rounded text-xs transition-colors ${\n                  event.userRSVP === 'no'\n                    ? 'bg-red-500 text-white'\n                    : 'text-gray-400 hover:text-red-400'\n                }`}\n                title=\"Not Going\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n          )}\n\n          {/* Actions */}\n          <button\n            onClick={onView}\n            className=\"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors\"\n            title=\"View details\"\n          >\n            <MoreHorizontal className=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n    </Card>\n  );\n}\n\n// Event Detail Modal Component\nfunction EventDetailModal({\n  event,\n  isOpen,\n  onClose,\n  onRSVP,\n  canEdit\n}: {\n  event: EventWithDetails;\n  isOpen: boolean;\n  onClose: () => void;\n  onRSVP: (eventId: string, response: 'yes' | 'no' | 'maybe') => void;\n  canEdit: boolean;\n}) {\n  const isPast = new Date(event.endTime) < new Date();\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <DialogContent className=\"max-w-2xl\">\n        <div className=\"p-6\">\n          {/* Header */}\n          <div className=\"flex items-start justify-between mb-4\">\n            <div>\n              <h2 className=\"text-2xl font-bold text-white mb-2\">{event.title}</h2>\n              <div className=\"flex items-center space-x-4 text-sm text-gray-400\">\n                <div className=\"flex items-center space-x-1\">\n                  <Clock className=\"w-4 h-4\" />\n                  <span>\n                    {format(new Date(event.startTime), 'EEEE, MMMM d, yyyy ‚Ä¢ HH:mm')} - {format(new Date(event.endTime), 'HH:mm')}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {canEdit && (\n              <button className=\"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors\">\n                <MoreHorizontal className=\"w-4 h-4\" />\n              </button>\n            )}\n          </div>\n\n          {/* Event Info */}\n          <div className=\"space-y-4 mb-6\">\n            {event.location && (\n              <div className=\"flex items-center space-x-2\">\n                <MapPin className=\"w-5 h-5 text-gray-400\" />\n                <span className=\"text-white\">{event.location}</span>\n              </div>\n            )}\n\n            <div className=\"flex items-center space-x-2\">\n              <Users className=\"w-5 h-5 text-gray-400\" />\n              <span className=\"text-white\">{event.attendeeCount} people attending</span>\n            </div>\n\n            {event.description && (\n              <div>\n                <h4 className=\"font-medium text-white mb-2\">Description</h4>\n                <p className=\"text-gray-300 whitespace-pre-wrap\">{event.description}</p>\n              </div>\n            )}\n          </div>\n\n          {/* RSVP Section */}\n          {!isPast && (\n            <div className=\"mb-6\">\n              <h4 className=\"font-medium text-white mb-3\">Will you attend?</h4>\n              <div className=\"flex space-x-3\">\n                <Button\n                  variant={event.userRSVP === 'yes' ? 'default' : 'secondary'}\n                  onClick={() => onRSVP(event.id, 'yes')}\n                  className={event.userRSVP === 'yes' ? 'bg-green-500 hover:bg-green-600' : ''}\n                >\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Going\n                </Button>\n                <Button\n                  variant={event.userRSVP === 'maybe' ? 'default' : 'secondary'}\n                  onClick={() => onRSVP(event.id, 'maybe')}\n                  className={event.userRSVP === 'maybe' ? 'bg-yellow-500 hover:bg-yellow-600' : ''}\n                >\n                  <AlertCircle className=\"w-4 h-4 mr-2\" />\n                  Maybe\n                </Button>\n                <Button\n                  variant={event.userRSVP === 'no' ? 'default' : 'secondary'}\n                  onClick={() => onRSVP(event.id, 'no')}\n                  className={event.userRSVP === 'no' ? 'bg-red-500 hover:bg-red-600' : ''}\n                >\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Can't Go\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Attendees */}\n          <div>\n            <h4 className=\"font-medium text-white mb-3\">Attendees ({event.attendeeCount})</h4>\n            <div className=\"flex flex-wrap gap-2\">\n              {event.rsvps\n                .filter(rsvp => rsvp.response === 'yes')\n                .slice(0, 12)\n                .map((rsvp) => (\n                  <div key={rsvp.id} className=\"flex items-center space-x-2 bg-gray-800 rounded-lg p-2\">\n                    <Avatar className=\"w-6 h-6\">\n                      <AvatarImage\n                        src={rsvp.user?.avatarUrl ?? undefined}\n                        alt={rsvp.user?.displayName ?? 'Attendee'}\n                      />\n                      <AvatarFallback className=\"text-xs\">\n                        {rsvp.user?.displayName?.[0] ?? 'U'}\n                      </AvatarFallback>\n                    </Avatar>\n                    <span className=\"text-sm text-white\">{rsvp.user?.displayName}</span>\n                  </div>\n                ))}\n\n              {event.attendeeCount > 12 && (\n                <div className=\"flex items-center justify-center bg-gray-800 rounded-lg p-2 min-w-16\">\n                  <span className=\"text-sm text-gray-400\">+{event.attendeeCount - 12}</span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n// Create Event Modal Component (simplified version)\nfunction CreateEventModal({\n  spaceId,\n  isOpen,\n  onClose,\n  onEventCreated,\n  createEventLabel\n}: {\n  spaceId: string;\n  isOpen: boolean;\n  onClose: () => void;\n  onEventCreated: (event: EventWithDetails) => void;\n  createEventLabel: string;\n}) {\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    location: '',\n    startTime: '',\n    endTime: '',\n    isVirtual: false\n  });\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n\n    try {\n      const response = await fetch(`/api/spaces/${spaceId}/events`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(formData)\n      });\n\n      if (response.ok) {\n        const newEvent = await response.json();\n        onEventCreated(newEvent.data);\n      }\n    } catch (error) {\n      console.error('Failed to create event:', error);\n    }\n  };\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <DialogContent className=\"max-w-lg\">\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">Create Event</h2>\n\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">Event Title</label>\n          <Input\n            value={formData.title}\n            onChange={(e: ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, title: e.target.value }))}\n            placeholder=\"Enter event title\"\n            required\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">Description</label>\n          <textarea\n            value={formData.description}\n            onChange={(e: ChangeEvent<HTMLTextAreaElement>) =>\n              setFormData(prev => ({ ...prev, description: e.target.value }))}\n            placeholder=\"Describe your event\"\n            rows={3}\n            className=\"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-[var(--hive-brand-primary)] focus:outline-none resize-none\"\n          />\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-2\">Start Time</label>\n            <input\n              type=\"datetime-local\"\n              value={formData.startTime}\n              onChange={(e: ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, startTime: e.target.value }))}\n              className=\"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-2\">End Time</label>\n            <input\n              type=\"datetime-local\"\n              value={formData.endTime}\n              onChange={(e: ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, endTime: e.target.value }))}\n              className=\"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-[var(--hive-brand-primary)] focus:outline-none\"\n              required\n            />\n          </div>\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">Location</label>\n          <Input\n            value={formData.location}\n            onChange={(e: ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, location: e.target.value }))}\n            placeholder=\"Event location or virtual link\"\n          />\n        </div>\n\n        <div className=\"flex justify-end space-x-3 pt-4\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onClose}\n          >\n            Cancel\n          </Button>\n          <Button type=\"submit\" className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\">\n            {createEventLabel}\n          </Button>\n        </div>\n      </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-loading-states.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-member-list.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserX' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wifi' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WifiOff' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ban' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Volume2' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'VolumeX' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showInviteModal' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":94,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":94,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isAdmin' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":96,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'canViewMemberProfiles' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":99,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":99,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getMemberSectionTitle' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":105,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":105,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getInviteButtonText' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":111,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onKick' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":336,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":336,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onChangeRole' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":337,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":337,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport {\n  Users,\n  Crown,\n  Shield,\n  User,\n  MoreVertical,\n  UserPlus,\n  UserX,\n  Settings,\n  MessageCircle,\n  Search,\n  X,\n  Wifi,\n  WifiOff,\n  Clock,\n  Star,\n  Ban,\n  Volume2,\n  VolumeX\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Avatar,\n  Badge,\n  Input\n} from '@hive/ui';\nimport type { User as UserType } from '@hive/core';\n\n// Define missing types that should be in @hive/core\ninterface SpaceMember {\n  id: string;\n  userId: string;\n  spaceId: string;\n  role: 'owner' | 'admin' | 'moderator' | 'member';\n  joinedAt: Date;\n  isActive: boolean;\n}\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface MemberWithUser extends SpaceMember {\n  user: UserType;\n  isOnline?: boolean;\n  lastSeen?: Date;\n}\n\ninterface SpaceMemberListProps {\n  spaceId: string;\n  userMembership: SpaceMember | null;\n  onlineMembers: UserType[];\n  onClose: () => void;\n  spaceRules?: import('@/lib/space-type-rules').SpaceTypeRules | null;\n}\n\nconst ROLE_CONFIGS = {\n  owner: {\n    label: 'Owner',\n    icon: Crown,\n    color: 'text-yellow-500',\n    bgColor: 'bg-yellow-500/10',\n    priority: 1\n  },\n  admin: {\n    label: 'Admin',\n    icon: Shield,\n    color: 'text-red-500',\n    bgColor: 'bg-red-500/10',\n    priority: 2\n  },\n  moderator: {\n    label: 'Mod',\n    icon: Settings,\n    color: 'text-blue-500',\n    bgColor: 'bg-blue-500/10',\n    priority: 3\n  },\n  member: {\n    label: 'Member',\n    icon: User,\n    color: 'text-gray-400',\n    bgColor: 'bg-gray-500/10',\n    priority: 4\n  }\n};\n\nexport function SpaceMemberList({ spaceId, userMembership, onlineMembers, onClose, spaceRules }: SpaceMemberListProps) {\n  const [members, setMembers] = useState<MemberWithUser[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [activeTab, setActiveTab] = useState<'all' | 'online' | 'offline'>('online');\n  const [showInviteModal, setShowInviteModal] = useState(false);\n\n  const isAdmin = userMembership?.role === 'admin' || userMembership?.role === 'owner';\n\n  // Space rules-based permissions and features\n  const canViewMemberProfiles = spaceRules?.visibility.memberProfiles !== 'limited_external' || !!userMembership;\n  const isGreekLife = spaceRules?.membership.joinMethod === 'invitation_only';\n  const isResidential = spaceRules?.membership.maxSpaces === 1;\n  const requiresApproval = spaceRules?.membership.joinMethod === 'approval';\n\n  // Customize member list based on space type\n  const getMemberSectionTitle = () => {\n    if (isGreekLife) return \"Chapter Members\";\n    if (isResidential) return \"Residents\";\n    return \"Community Members\";\n  };\n\n  const getInviteButtonText = () => {\n    if (isGreekLife) return \"Send Invitation\";\n    if (requiresApproval) return \"Invite to Apply\";\n    return \"Invite Member\";\n  };\n  const canManageMembers = userMembership?.role === 'admin' || userMembership?.role === 'owner';\n\n  // Fetch members\n  useEffect(() => {\n    const fetchMembers = async () => {\n      try {\n        const response = await fetch(`/api/spaces/${spaceId}/members`);\n        const data = await response.json();\n\n        if (data.success) {\n          const membersWithOnlineStatus = data.data.map((member: MemberWithUser) => ({\n            ...member,\n            isOnline: onlineMembers.some(om => om.id === member.user.id)\n          }));\n\n          // Sort by role priority, then online status, then alphabetically\n          membersWithOnlineStatus.sort((a: MemberWithUser, b: MemberWithUser) => {\n            const roleA = ROLE_CONFIGS[a.role as keyof typeof ROLE_CONFIGS] || ROLE_CONFIGS.member;\n            const roleB = ROLE_CONFIGS[b.role as keyof typeof ROLE_CONFIGS] || ROLE_CONFIGS.member;\n\n            if (roleA.priority !== roleB.priority) {\n              return roleA.priority - roleB.priority;\n            }\n\n            if (a.isOnline !== b.isOnline) {\n              return a.isOnline ? -1 : 1;\n            }\n\n            return a.user.displayName.localeCompare(b.user.displayName);\n          });\n\n          setMembers(membersWithOnlineStatus);\n        }\n      } catch (error) {\n        console.error('Failed to fetch members:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchMembers();\n  }, [spaceId, onlineMembers]);\n\n  // Filter members based on search and tab\n  const filteredMembers = members.filter(member => {\n    const matchesSearch = member.user.displayName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                         member.user.handle?.toLowerCase().includes(searchQuery.toLowerCase());\n\n    const matchesTab = activeTab === 'all' ||\n                      (activeTab === 'online' && member.isOnline) ||\n                      (activeTab === 'offline' && !member.isOnline);\n\n    return matchesSearch && matchesTab;\n  });\n\n  // Handle member actions\n  const handleKickMember = async (memberId: string) => {\n    try {\n      await fetch(`/api/spaces/${spaceId}/members/${memberId}`, {\n        method: 'DELETE'\n      });\n\n      setMembers(prev => prev.filter(m => m.id !== memberId));\n    } catch (error) {\n      console.error('Failed to kick member:', error);\n    }\n  };\n\n  const handleChangeRole = async (memberId: string, newRole: 'owner' | 'admin' | 'moderator' | 'member') => {\n    try {\n      await fetch(`/api/spaces/${spaceId}/members/${memberId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ role: newRole })\n      });\n\n      setMembers(prev => prev.map(m =>\n        m.id === memberId ? { ...m, role: newRole } : m\n      ));\n    } catch (error) {\n      console.error('Failed to change role:', error);\n    }\n  };\n\n  const onlineCount = members.filter(m => m.isOnline).length;\n  const totalCount = members.length;\n\n  return (\n    <div className=\"h-full flex flex-col bg-gray-950\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-800\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center space-x-2\">\n            <Users className=\"w-5 h-5 text-[var(--hive-brand-primary)]\" />\n            <h3 className=\"text-lg font-semibold text-white\">Members</h3>\n            <Badge variant=\"secondary\" className=\"text-xs\">\n              {totalCount}\n            </Badge>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            {canManageMembers && (\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={() => setShowInviteModal(true)}\n              >\n                <UserPlus className=\"w-4 h-4\" />\n              </Button>\n            )}\n\n            <button\n              onClick={onClose}\n              className=\"p-1 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors lg:hidden\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Search */}\n        <div className=\"relative mb-4\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n          <Input\n            value={searchQuery}\n            onChange={(e: React.ChangeEvent) => setSearchQuery((e.target as any).value)}\n            placeholder=\"Search members...\"\n            className=\"pl-10 bg-gray-800 border-gray-700 text-white text-sm\"\n          />\n        </div>\n\n        {/* Tabs */}\n        <div className=\"flex space-x-1 bg-gray-800 rounded-lg p-1\">\n          <button\n            onClick={() => setActiveTab('online')}\n            className={`flex-1 text-xs font-medium py-2 px-3 rounded-md transition-colors ${\n              activeTab === 'online'\n                ? 'bg-green-500/20 text-green-400'\n                : 'text-gray-400 hover:text-white'\n            }`}\n          >\n            Online ‚Äî {onlineCount}\n          </button>\n          <button\n            onClick={() => setActiveTab('offline')}\n            className={`flex-1 text-xs font-medium py-2 px-3 rounded-md transition-colors ${\n              activeTab === 'offline'\n                ? 'bg-gray-600/20 text-gray-300'\n                : 'text-gray-400 hover:text-white'\n            }`}\n          >\n            Offline ‚Äî {totalCount - onlineCount}\n          </button>\n          <button\n            onClick={() => setActiveTab('all')}\n            className={`flex-1 text-xs font-medium py-2 px-3 rounded-md transition-colors ${\n              activeTab === 'all'\n                ? 'bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)]'\n                : 'text-gray-400 hover:text-white'\n            }`}\n          >\n            All\n          </button>\n        </div>\n      </div>\n\n      {/* Member List */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {loading ? (\n          <div className=\"p-4 space-y-3\">\n            {Array.from({ length: 8 }).map((_, i) => (\n              <div key={i} className=\"animate-pulse flex items-center space-x-3\">\n                <div className=\"w-8 h-8 bg-gray-700 rounded-full\"></div>\n                <div className=\"flex-1\">\n                  <div className=\"h-4 bg-gray-700 rounded w-3/4 mb-1\"></div>\n                  <div className=\"h-3 bg-gray-800 rounded w-1/2\"></div>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : filteredMembers.length === 0 ? (\n          <div className=\"p-4 text-center\">\n            <Users className=\"w-8 h-8 text-gray-500 mx-auto mb-2\" />\n            <p className=\"text-gray-400 text-sm\">\n              {searchQuery ? 'No members found' : 'No members in this category'}\n            </p>\n          </div>\n        ) : (\n          <div className=\"p-2\">\n            {filteredMembers.map((member) => (\n              <MemberItem\n                key={member.id}\n                member={member}\n                currentUserMembership={userMembership}\n                onKick={handleKickMember}\n                onChangeRole={handleChangeRole}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Online Status Summary */}\n      <div className=\"p-4 border-t border-gray-800 bg-gray-900/50\">\n        <div className=\"flex items-center justify-between text-xs text-gray-400\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n            <span>{onlineCount} online</span>\n          </div>\n          <span>{totalCount} total members</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Individual Member Item Component\nfunction MemberItem({\n  member,\n  currentUserMembership,\n  onKick,\n  onChangeRole\n}: {\n  member: MemberWithUser;\n  currentUserMembership: SpaceMember | null;\n  onKick: (memberId: string) => void;\n  onChangeRole: (memberId: string, role: 'owner' | 'admin' | 'moderator' | 'member') => void;\n}) {\n  const roleConfig = ROLE_CONFIGS[member.role as keyof typeof ROLE_CONFIGS] || ROLE_CONFIGS.member;\n  const RoleIcon = roleConfig.icon;\n\n  const canManageThisMember = currentUserMembership &&\n    (currentUserMembership.role === 'owner' ||\n     (currentUserMembership.role === 'admin' && member.role === 'member'));\n\n  const isCurrentUser = currentUserMembership?.userId === member.userId;\n\n  return (\n    <div className=\"group flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-800/50 transition-colors\">\n      {/* Avatar with status */}\n      <div className=\"relative\">\n        <Avatar\n          src={member.user.avatarUrl}\n          fallback={member.user.displayName?.[0]}\n          className=\"w-8 h-8\"\n        />\n\n        {/* Online status indicator */}\n        <div className={`absolute -bottom-0.5 -right-0.5 w-3 h-3 border-2 border-gray-950 rounded-full ${\n          member.isOnline ? 'bg-green-500' : 'bg-gray-500'\n        }`} />\n      </div>\n\n      {/* Member info */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-sm font-medium text-white truncate\">\n            {member.user.displayName}\n            {isCurrentUser && (\n              <span className=\"text-xs text-gray-400 ml-1\">(you)</span>\n            )}\n          </span>\n\n          {/* Role badge */}\n          <div className={`flex items-center space-x-1 px-2 py-0.5 rounded text-xs ${roleConfig.bgColor}`}>\n            <RoleIcon className={`w-3 h-3 ${roleConfig.color}`} />\n            <span className={roleConfig.color}>{roleConfig.label}</span>\n          </div>\n        </div>\n\n        <div className=\"flex items-center space-x-2 text-xs text-gray-400\">\n          {member.user.handle && (\n            <span>@{member.user.handle}</span>\n          )}\n\n          {!member.isOnline && member.lastSeen && (\n            <span className=\"flex items-center space-x-1\">\n              <Clock className=\"w-3 h-3\" />\n              <span>\n                Last seen {formatDistanceToNow(new Date(member.lastSeen), { addSuffix: true })}\n              </span>\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n        {/* Direct message */}\n        <button className=\"p-1 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-700 rounded transition-colors\">\n          <MessageCircle className=\"w-4 h-4\" />\n        </button>\n\n        {/* Member management menu */}\n        {canManageThisMember && !isCurrentUser && (\n          <div className=\"relative\">\n            <button className=\"p-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors\">\n              <MoreVertical className=\"w-4 h-4\" />\n            </button>\n            {/* Simplified menu - would need proper dropdown implementation */}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-member-management.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":449,"column":23,"nodeType":"JSXOpeningElement","endLine":453,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Users,\n  Crown,\n  Shield,\n  User,\n  UserPlus,\n  UserMinus,\n  Search,\n  Settings,\n  AlertTriangle,\n  CheckCircle,\n  Eye,\n  Ban,\n  UserCheck,\n  X\n} from 'lucide-react';\nimport { Button, Badge } from \"@hive/ui\";\n// Space Member Management Interface for Claimed Leaders\nexport interface MemberManagementProps {\n  spaceId: string;\n  spaceName: string;\n  currentUserRole: 'admin' | 'owner' | 'moderator';\n  onClose?: () => void;\n}\n\ninterface MemberData {\n  id: string;\n  name: string;\n  username: string;\n  email?: string;\n  avatar?: string;\n  role: 'owner' | 'admin' | 'moderator' | 'member';\n  status: 'active' | 'inactive' | 'suspended';\n  joinedAt: Date;\n  lastActive: Date;\n  stats: {\n    postsCount: number;\n    eventsAttended: number;\n    contributionScore: number;\n  };\n  permissions: {\n    canPost: boolean;\n    canCreateEvents: boolean;\n    canInviteMembers: boolean;\n    canModerate: boolean;\n  };\n  flags?: {\n    isReported: boolean;\n    warningCount: number;\n    isSuspended: boolean;\n  };\n}\n\nconst roleHierarchy = {\n  owner: 4,\n  admin: 3,\n  moderator: 2,\n  member: 1\n};\n\nconst roleConfig = {\n  owner: {\n    label: 'Owner',\n    color: 'text-yellow-400',\n    bg: 'bg-yellow-500/20',\n    icon: Crown,\n    description: 'Full space control'\n  },\n  admin: {\n    label: 'Admin',\n    color: 'text-purple-400',\n    bg: 'bg-purple-500/20',\n    icon: Shield,\n    description: 'Management permissions'\n  },\n  moderator: {\n    label: 'Moderator',\n    color: 'text-blue-400',\n    bg: 'bg-blue-500/20',\n    icon: UserCheck,\n    description: 'Content moderation'\n  },\n  member: {\n    label: 'Member',\n    color: 'text-green-400',\n    bg: 'bg-green-500/20',\n    icon: User,\n    description: 'Standard access'\n  }\n};\n\nexport function SpaceMemberManagement({ spaceId, spaceName, currentUserRole, onClose }: MemberManagementProps) {\n  const [members, setMembers] = useState<MemberData[]>([]);\n  const [filteredMembers, setFilteredMembers] = useState<MemberData[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedRole, setSelectedRole] = useState<string>('all');\n  const [selectedStatus, setSelectedStatus] = useState<string>('all');\n  const [selectedMember, setSelectedMember] = useState<MemberData | null>(null);\n  const [_showMemberDetails, setShowMemberDetails] = useState(false);\n  const [showRoleChangeModal, setShowRoleChangeModal] = useState(false);\n  const [_showInviteModal, setShowInviteModal] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [_error, setError] = useState<string | null>(null);\n\n  // Permission checks\n  const canChangeRoles = currentUserRole === 'owner' || currentUserRole === 'admin';\n  const canRemoveMembers = currentUserRole === 'owner' || currentUserRole === 'admin';\n  const _canSuspendMembers = true; // currentUserRole is always admin/owner/moderator\n  const canInviteMembers = true; // currentUserRole is always admin/owner/moderator\n\n  // Fetch members from API\n  useEffect(() => {\n    const fetchMembers = async () => {\n      try {\n        setIsLoading(true);\n        const token = localStorage.getItem('hive_session');\n        const session = token ? JSON.parse(token) : null;\n        \n        const response = await fetch(`/api/spaces/${spaceId}/members?management=true`, {\n          headers: {\n            'Authorization': `Bearer ${process.env.NODE_ENV === 'development' ? 'test-token' : session?.token}`,\n            'Content-Type': 'application/json',\n          },\n        });\n        \n        if (!response.ok) {\n          throw new Error('Failed to fetch members');\n        }\n        \n        const data = await response.json();\n        const membersWithStats = data.members.map((member: any) => ({\n          ...member,\n          joinedAt: new Date(member.joinedAt),\n          lastActive: new Date(member.lastActive || member.joinedAt),\n          stats: member.stats || {\n            postsCount: 0,\n            eventsAttended: 0,\n            contributionScore: 0,\n          },\n          permissions: member.permissions || {\n            canPost: true,\n            canCreateEvents: member.role !== 'member',\n            canInviteMembers: member.role !== 'member',\n            canModerate: ['owner', 'admin', 'moderator'].includes(member.role),\n          },\n          flags: member.flags || {\n            isReported: false,\n            warningCount: 0,\n            isSuspended: false,\n          }\n        }));\n        \n        setMembers(membersWithStats);\n      } catch (error) {\n        console.error('Failed to fetch members:', error);\n        setError(error instanceof Error ? error.message : 'Failed to fetch members');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchMembers();\n  }, [spaceId]);\n\n  // Filter members based on search and filters\n  useEffect(() => {\n    let filtered = members;\n\n    // Search filter\n    if (searchQuery) {\n      filtered = filtered.filter(member =>\n        member.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        member.username.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        member.email?.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n\n    // Role filter\n    if (selectedRole !== 'all') {\n      filtered = filtered.filter(member => member.role === selectedRole);\n    }\n\n    // Status filter\n    if (selectedStatus !== 'all') {\n      filtered = filtered.filter(member => member.status === selectedStatus);\n    }\n\n    // Sort by role hierarchy, then by join date\n    filtered.sort((a, b) => {\n      const roleA = roleHierarchy[a.role as keyof typeof roleHierarchy];\n      const roleB = roleHierarchy[b.role as keyof typeof roleHierarchy];\n      \n      if (roleA !== roleB) {\n        return roleB - roleA; // Higher roles first\n      }\n      \n      return a.joinedAt.getTime() - b.joinedAt.getTime(); // Earlier joiners first\n    });\n\n    setFilteredMembers(filtered);\n  }, [members, searchQuery, selectedRole, selectedStatus]);\n\n  const handleRoleChange = async (memberId: string, newRole: string) => {\n    try {\n      const token = localStorage.getItem('hive_session');\n      const session = token ? JSON.parse(token) : null;\n      \n      const response = await fetch(`/api/spaces/${spaceId}/members/${memberId}/role`, {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${process.env.NODE_ENV === 'development' ? 'test-token' : session?.token}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ role: newRole }),\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to change role');\n      }\n      \n      // Update local state\n      setMembers(prev => prev.map(member =>\n        member.id === memberId \n          ? { ...member, role: newRole as any }\n          : member\n      ));\n      \n      setShowRoleChangeModal(false);\n      setSelectedMember(null);\n    } catch (error) {\n      console.error('Failed to change role:', error);\n      alert('Failed to change member role');\n    }\n  };\n\n  const handleRemoveMember = async (memberId: string) => {\n    if (!confirm('Are you sure you want to remove this member from the space?')) {\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('hive_session');\n      const session = token ? JSON.parse(token) : null;\n      \n      const response = await fetch(`/api/spaces/${spaceId}/members/${memberId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${process.env.NODE_ENV === 'development' ? 'test-token' : session?.token}`,\n          'Content-Type': 'application/json',\n        },\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to remove member');\n      }\n      \n      // Update local state\n      setMembers(prev => prev.filter(member => member.id !== memberId));\n    } catch (error) {\n      console.error('Failed to remove member:', error);\n      alert('Failed to remove member');\n    }\n  };\n\n  const handleSuspendMember = async (memberId: string, suspend: boolean) => {\n    try {\n      const token = localStorage.getItem('hive_session');\n      const session = token ? JSON.parse(token) : null;\n      \n      const response = await fetch(`/api/spaces/${spaceId}/members/${memberId}/suspend`, {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${process.env.NODE_ENV === 'development' ? 'test-token' : session?.token}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ suspended: suspend }),\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to update suspension status');\n      }\n      \n      // Update local state\n      setMembers(prev => prev.map(member =>\n        member.id === memberId\n          ? {\n              ...member,\n              status: (suspend ? 'suspended' : 'active') as MemberData['status'],\n              flags: { ...member.flags, isSuspended: suspend }\n            } as MemberData\n          : member\n      ));\n    } catch (error) {\n      console.error('Failed to update suspension:', error);\n      alert('Failed to update member status');\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n        <div className=\"bg-[#0A0A0A] border border-white/[0.1] rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\n          <div className=\"p-6\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-6 bg-gray-600 rounded w-48 mb-4\"></div>\n              <div className=\"space-y-4\">\n                {Array.from({ length: 5 }).map((_, i) => (\n                  <div key={i} className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-gray-600 rounded-full\"></div>\n                    <div className=\"flex-1\">\n                      <div className=\"h-4 bg-gray-600 rounded w-32 mb-2\"></div>\n                      <div className=\"h-3 bg-gray-700 rounded w-24\"></div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n      <motion.div\n        className=\"bg-[#0A0A0A] border border-white/[0.1] rounded-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden\"\n        initial={{ scale: 0.9, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0.9, opacity: 0 }}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-white/[0.06]\">\n          <div className=\"flex items-center gap-3\">\n            <Users className=\"h-6 w-6 text-[var(--hive-brand-primary)]\" />\n            <div>\n              <h2 className=\"text-xl font-semibold text-white\">Member Management</h2>\n              <p className=\"text-sm text-gray-400\">{spaceName} ‚Ä¢ {members.length} members</p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            {canInviteMembers && (\n              <Button\n                className=\"max-w-sm bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-[var(--hive-brand-primary)]/30 hover:bg-[var(--hive-brand-primary)]/30\"\n                onClick={() => setShowInviteModal(true)}\n              >\n                <UserPlus className=\"h-4 w-4 mr-2\" />\n                Invite Members\n              </Button>\n            )}\n            \n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm border-white/[0.2] text-white hover:bg-white/[0.1]\"\n              onClick={onClose}\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <div className=\"p-6 border-b border-white/[0.06]\">\n          <div className=\"flex items-center gap-4 mb-4\">\n            {/* Search */}\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n              <input\n                type=\"text\"\n                placeholder=\"Search members...\"\n                value={searchQuery}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setSearchQuery((e.target as any).value)}\n                className=\"w-full pl-10 pr-4 py-2 bg-white/[0.02] border border-white/[0.06] rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[var(--hive-brand-primary)]/50 focus:border-[var(--hive-brand-primary)]/30\"\n              />\n            </div>\n\n            {/* Role Filter */}\n            <select\n              value={selectedRole}\n              onChange={(e: React.ChangeEvent<HTMLSelectElement>) => setSelectedRole((e.target as any).value)}\n              className=\"px-3 py-2 bg-white/[0.02] border border-white/[0.06] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[var(--hive-brand-primary)]/50\"\n            >\n              <option value=\"all\">All Roles</option>\n              <option value=\"owner\">Owners</option>\n              <option value=\"admin\">Admins</option>\n              <option value=\"moderator\">Moderators</option>\n              <option value=\"member\">Members</option>\n            </select>\n\n            {/* Status Filter */}\n            <select\n              value={selectedStatus}\n              onChange={(e: React.ChangeEvent<HTMLSelectElement>) => setSelectedStatus((e.target as any).value)}\n              className=\"px-3 py-2 bg-white/[0.02] border border-white/[0.06] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[var(--hive-brand-primary)]/50\"\n            >\n              <option value=\"all\">All Status</option>\n              <option value=\"active\">Active</option>\n              <option value=\"inactive\">Inactive</option>\n              <option value=\"suspended\">Suspended</option>\n            </select>\n          </div>\n\n          {/* Stats */}\n          <div className=\"flex items-center gap-6 text-sm text-gray-400\">\n            <div className=\"flex items-center gap-2\">\n              <Users className=\"w-4 h-4\" />\n              <span>{filteredMembers.length} showing</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Crown className=\"w-4 h-4 text-yellow-400\" />\n              <span>{members.filter(m => m.role === 'owner').length} owners</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Shield className=\"w-4 h-4 text-purple-400\" />\n              <span>{members.filter(m => m.role === 'admin').length} admins</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"w-4 h-4 text-red-400\" />\n              <span>{members.filter(m => m.flags?.isSuspended).length} suspended</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Members List */}\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-300px)]\">\n          <div className=\"space-y-3\">\n            {filteredMembers.map((member) => {\n              const config = roleConfig[member.role];\n              const RoleIcon = config.icon;\n              const canManageMember = canChangeRoles && \n                roleHierarchy[currentUserRole as keyof typeof roleHierarchy] > roleHierarchy[member.role as keyof typeof roleHierarchy];\n\n              return (\n                <motion.div\n                  key={member.id}\n                  className=\"flex items-center gap-4 p-4 bg-white/[0.02] border border-white/[0.06] rounded-xl hover:border-white/[0.1] transition-all\"\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  layout\n                >\n                  {/* Avatar */}\n                  <div className=\"flex-shrink-0\">\n                    {member.avatar ? (\n                      <img\n                        src={member.avatar}\n                        alt=\"\"\n                        className=\"w-12 h-12 rounded-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-12 h-12 bg-gradient-to-br from-gray-500/20 to-gray-700/20 rounded-full flex items-center justify-center\">\n                        <span className=\"text-sm font-medium text-white\">\n                          {member.name.charAt(0).toUpperCase()}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Member Info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <h4 className=\"font-medium text-white truncate\">{member.name}</h4>\n                      <span className=\"text-sm text-gray-400\">@{member.username}</span>\n                      \n                      {/* Role Badge */}\n                      <div className={`flex items-center gap-1 px-2 py-1 rounded-full text-xs ${config.bg} ${config.color}`}>\n                        <RoleIcon className=\"w-3 h-3\" />\n                        <span>{config.label}</span>\n                      </div>\n\n                      {/* Status Indicators */}\n                      {member.flags?.isSuspended && (\n                        <Badge variant=\"secondary\" className=\"border-red-500/30 text-red-400\">\n                          Suspended\n                        </Badge>\n                      )}\n                      \n                      {member.flags?.isReported && (\n                        <Badge variant=\"secondary\" className=\"border-orange-500/30 text-orange-400\">\n                          Reported\n                        </Badge>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center gap-4 text-xs text-gray-400\">\n                      <span>Joined {member.joinedAt.toLocaleDateString()}</span>\n                      <span>‚Ä¢</span>\n                      <span>{member.stats.postsCount} posts</span>\n                      <span>‚Ä¢</span>\n                      <span>{member.stats.eventsAttended} events</span>\n                      <span>‚Ä¢</span>\n                      <span>Score: {member.stats.contributionScore}</span>\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2\">\n                    {/* View Details */}\n                    <Button\n                      variant=\"outline\"\n                      className=\"max-w-sm border-white/[0.2] text-white hover:bg-white/[0.1]\"\n                      onClick={() => {\n                        setSelectedMember(member);\n                        setShowMemberDetails(true);\n                      }}\n                    >\n                      <Eye className=\"h-4 w-4\" />\n                    </Button>\n\n                    {canManageMember && (\n                      <>\n                        {/* Change Role */}\n                        <Button\n                          variant=\"outline\"\n                          className=\"max-w-sm border-blue-500/30 text-blue-400 hover:bg-blue-500/10\"\n                          onClick={() => {\n                            setSelectedMember(member);\n                            setShowRoleChangeModal(true);\n                          }}\n                        >\n                          <Settings className=\"h-4 w-4\" />\n                        </Button>\n\n                        {/* Suspend/Unsuspend */}\n                        <Button\n                          variant=\"outline\"\n                          className={`max-w-sm ${member.flags?.isSuspended \n                            ? \"border-green-500/30 text-green-400 hover:bg-green-500/10\"\n                            : \"border-orange-500/30 text-orange-400 hover:bg-orange-500/10\"\n                          }`}\n                          onClick={() => handleSuspendMember(member.id, !member.flags?.isSuspended)}\n                        >\n                          {member.flags?.isSuspended ? <CheckCircle className=\"h-4 w-4\" /> : <Ban className=\"h-4 w-4\" />}\n                        </Button>\n\n                        {/* Remove Member */}\n                        {canRemoveMembers && member.role !== 'owner' && (\n                          <Button\n                            variant=\"outline\"\n                            className=\"max-w-sm border-red-500/30 text-red-400 hover:bg-red-500/10\"\n                            onClick={() => handleRemoveMember(member.id)}\n                          >\n                            <UserMinus className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </motion.div>\n              );\n            })}\n          </div>\n        </div>\n      </motion.div>\n\n      {/* Role Change Modal */}\n      <AnimatePresence>\n        {showRoleChangeModal && selectedMember && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-60 flex items-center justify-center p-4\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            <motion.div\n              className=\"bg-[#0A0A0A] border border-white/[0.1] rounded-2xl p-6 w-full max-w-md\"\n              initial={{ scale: 0.9 }}\n              animate={{ scale: 1 }}\n              exit={{ scale: 0.9 }}\n            >\n              <h3 className=\"text-lg font-semibold text-white mb-4\">Change Member Role</h3>\n              <p className=\"text-sm text-gray-400 mb-6\">\n                Change role for <strong>{selectedMember.name}</strong>\n              </p>\n\n              <div className=\"space-y-3 mb-6\">\n                {Object.entries(roleConfig).map(([role, config]) => {\n                  const Icon = config.icon;\n                  const canAssign = roleHierarchy[currentUserRole as keyof typeof roleHierarchy] > roleHierarchy[role as keyof typeof roleHierarchy];\n                  \n                  return (\n                    <button\n                      key={role}\n                      className={`w-full flex items-center gap-3 p-3 rounded-lg border transition-all ${\n                        selectedMember.role === role\n                          ? 'bg-blue-500/20 border-blue-500/30 text-blue-400'\n                          : canAssign\n                          ? 'bg-white/[0.02] border-white/[0.06] text-white hover:border-white/[0.1]'\n                          : 'bg-gray-500/10 border-gray-500/20 text-gray-500 cursor-not-allowed'\n                      }`}\n                      onClick={() => canAssign && handleRoleChange(selectedMember.id, role)}\n                      disabled={!canAssign}\n                    >\n                      <Icon className=\"w-5 h-5\" />\n                      <div className=\"text-left\">\n                        <div className=\"font-medium\">{config.label}</div>\n                        <div className=\"text-xs opacity-70\">{config.description}</div>\n                      </div>\n                    </button>\n                  );\n                })}\n              </div>\n\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1 border-white/[0.2] text-white hover:bg-white/[0.1]\"\n                  onClick={() => {\n                    setShowRoleChangeModal(false);\n                    setSelectedMember(null);\n                  }}\n                >\n                  Cancel\n                </Button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-post-feed.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bookmark' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flag' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Hash' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'editingPost' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":75,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showEmojiPicker' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":76,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setShowEmojiPicker' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":76,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'allowsPublicPosts' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":85,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getPostPlaceholder' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":88,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":27},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":294,"column":21,"nodeType":"JSXOpeningElement","endLine":294,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport {\n  Plus,\n  Image,\n  Paperclip,\n  Smile,\n  Send,\n  MoreHorizontal,\n  Pin,\n  Reply,\n  Heart,\n  MessageCircle,\n  Bookmark,\n  Flag,\n  Edit,\n  Trash2,\n  Calendar,\n  AtSign,\n  Hash\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Avatar,\n  Badge,\n  Input\n} from '@hive/ui';\nimport type { User } from '@hive/core';\nimport { useRealtimePosts } from '@/hooks/use-realtime-posts';\nimport { useToast } from '@/hooks/use-toast';\n\n// Define missing types that should be in @hive/core\ninterface Post {\n  id: string;\n  content: string;\n  authorId: string;\n  spaceId: string;\n  createdAt: Date;\n  updatedAt: Date;\n  isPinned?: boolean;\n  author: User;\n}\n\ninterface PostReaction {\n  id: string;\n  postId: string;\n  userId: string;\n  emoji: string;\n  createdAt: Date;\n}\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface SpacePostFeedProps {\n  spaceId: string;\n  canPost: boolean;\n  pinnedPosts?: Post[];\n  spaceRules?: import('@/lib/space-type-rules').SpaceTypeRules | null;\n}\n\ninterface PostWithAuthor extends Post {\n  author: User;\n  reactions: PostReaction[];\n  replyCount: number;\n  isBookmarked?: boolean;\n  canEdit?: boolean;\n  canDelete?: boolean;\n}\n\nexport function SpacePostFeed({ spaceId, canPost, pinnedPosts = [], spaceRules }: SpacePostFeedProps) {\n  const [posting, setPosting] = useState(false);\n  const [newPostContent, setNewPostContent] = useState('');\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [editingPost, setEditingPost] = useState<string | null>(null);\n  const [showEmojiPicker, setShowEmojiPicker] = useState<string | null>(null);\n\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const feedRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n\n  // Space rules-based visibility and features\n  const isGreekLife = spaceRules?.membership.joinMethod === 'invitation_only';\n  const isResidential = spaceRules?.membership.maxSpaces === 1;\n  const allowsPublicPosts = spaceRules?.visibility.posts !== 'members_only';\n\n  // Customize post composer based on space type\n  const getPostPlaceholder = () => {\n    if (isGreekLife) return \"Share with your brothers/sisters...\";\n    if (isResidential) return \"Connect with your neighbors...\";\n    return \"Share with your community...\";\n  };\n\n  // Use real-time posts hook\n  const {\n    posts: realtimePosts,\n    loading,\n    error,\n    createPost,\n    reactToPost\n  } = useRealtimePosts({\n    spaceId,\n    enabled: true,\n    limitCount: 100\n  });\n\n  // Combine pinned posts with real-time posts\n  const posts = [...pinnedPosts, ...realtimePosts.filter(p => !p.isPinned)] as PostWithAuthor[];\n\n  // Auto-resize textarea\n  const adjustTextareaHeight = () => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = `${Math.min(textarea.scrollHeight, 120)}px`;\n    }\n  };\n\n  // Show error if posts fail to load\n  useEffect(() => {\n    if (error) {\n      toast({\n        title: 'Failed to load posts',\n        description: 'Please refresh the page to try again',\n        type: 'error'\n      });\n    }\n  }, [error, toast]);\n\n  // Handle post creation with real-time updates\n  const handleCreatePost = async () => {\n    if (!newPostContent.trim() || posting) return;\n\n    setPosting(true);\n    try {\n      await createPost(newPostContent, replyingTo || undefined);\n      setNewPostContent('');\n      setReplyingTo(null);\n\n      toast({\n        title: 'Post created!',\n        description: 'Your message has been shared with the space',\n        type: 'success'\n      });\n\n      // Auto-scroll to top to see new post\n      if (feedRef.current) {\n        feedRef.current.scrollTop = 0;\n      }\n    } catch (error) {\n      console.error('Failed to create post:', error);\n      toast({\n        title: 'Failed to create post',\n        description: 'Please try again',\n        type: 'error'\n      });\n    } finally {\n      setPosting(false);\n    }\n  };\n\n  // Handle reactions with real-time updates\n  const handleReaction = async (postId: string, emoji: string) => {\n    try {\n      await reactToPost(postId, emoji);\n      // Real-time listener will handle the UI update\n    } catch (error) {\n      console.error('Failed to react to post:', error);\n      toast({\n        title: 'Failed to react',\n        description: 'Please try again',\n        type: 'error'\n      });\n    }\n  };\n\n  // Common emoji reactions\n  const quickReactions = ['üëç', '‚ù§Ô∏è', 'üòÑ', 'üòÆ', 'üò¢', 'üî•'];\n\n  if (loading) {\n    return (\n      <div className=\"p-8 text-center\">\n        <div className=\"animate-pulse space-y-4\">\n          {Array.from({ length: 3 }).map((_, i) => (\n            <div key={i} className=\"bg-gray-800 h-24 rounded-lg\"></div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col min-h-[400px] max-h-[calc(100vh-300px)] md:max-h-[calc(100vh-200px)]\">\n      {/* Pinned Posts */}\n      {pinnedPosts.length > 0 && (\n        <div className=\"border-b border-gray-800 bg-yellow-500/5\">\n          <div className=\"p-4\">\n            <div className=\"flex items-center space-x-2 mb-3\">\n              <Pin className=\"w-4 h-4 text-yellow-500\" />\n              <span className=\"text-sm font-medium text-yellow-500\">Pinned Posts</span>\n            </div>\n            <div className=\"space-y-2\">\n              {pinnedPosts.map((post) => (\n                <div key={post.id} className=\"text-sm text-gray-300 bg-gray-800/50 p-3 rounded-lg\">\n                  <div className=\"font-medium\">{post.author?.displayName}</div>\n                  <div className=\"truncate\">{post.content}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Post Feed */}\n      <div ref={feedRef} className=\"flex-1 overflow-y-auto\">\n        {posts.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <div className=\"text-6xl mb-4\">üí¨</div>\n            <h3 className=\"text-xl font-semibold text-white mb-2\">No messages yet</h3>\n            <p className=\"text-gray-400\">\n              {canPost ? \"Start the conversation!\" : \"Be the first to share something with the space.\"}\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-1\">\n            {posts.map((post, index) => {\n              const prevPost = posts[index - 1];\n              const showAvatar = !prevPost ||\n                prevPost.author.id !== post.author.id ||\n                new Date(post.createdAt).getTime() - new Date(prevPost.createdAt).getTime() > 300000; // 5 minutes\n\n              return (\n                <PostMessage\n                  key={post.id}\n                  post={post}\n                  showAvatar={showAvatar}\n                  onReaction={handleReaction}\n                  onReply={() => setReplyingTo(post.id)}\n                  onEdit={() => setEditingPost(post.id)}\n                  quickReactions={quickReactions}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Post Composer */}\n      {canPost && (\n        <div className=\"border-t border-gray-800 bg-gray-950/50 p-4\">\n          {replyingTo && (\n            <div className=\"flex items-center space-x-2 mb-2 text-sm text-gray-400\">\n              <Reply className=\"w-4 h-4\" />\n              <span>Replying to message</span>\n              <button\n                onClick={() => setReplyingTo(null)}\n                className=\"text-gray-500 hover:text-gray-300\"\n              >\n                Cancel\n              </button>\n            </div>\n          )}\n\n          <div className=\"flex space-x-3\">\n            <Avatar\n              src=\"/current-user-avatar.jpg\"\n              fallback=\"You\"\n              className=\"w-8 h-8 mt-1\"\n            />\n\n            <div className=\"flex-1 space-y-3\">\n              <div className=\"relative\">\n                <textarea\n                  ref={textareaRef}\n                  value={newPostContent}\n                  onChange={(e: React.ChangeEvent) => {\n                    setNewPostContent((e.target as any).value);\n                    adjustTextareaHeight();\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !e.shiftKey) {\n                      e.preventDefault();\n                      handleCreatePost();\n                    }\n                  }}\n                  placeholder={replyingTo ? \"Reply to this message...\" : \"Share with the space...\"}\n                  className=\"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white placeholder-gray-400 resize-none focus:border-[var(--hive-brand-primary)] focus:outline-none min-h-[40px] max-h-[120px]\"\n                />\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <button className=\"p-2 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded-lg transition-colors\">\n                    <Image className=\"w-4 h-4\" />\n                  </button>\n                  <button className=\"p-2 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded-lg transition-colors\">\n                    <Paperclip className=\"w-4 h-4\" />\n                  </button>\n                  <button className=\"p-2 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded-lg transition-colors\">\n                    <Smile className=\"w-4 h-4\" />\n                  </button>\n                  <button className=\"p-2 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded-lg transition-colors\">\n                    <AtSign className=\"w-4 h-4\" />\n                  </button>\n                </div>\n\n                <Button\n                  onClick={handleCreatePost}\n                  disabled={!newPostContent.trim() || posting}\n                  className=\"max-w-sm bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400 disabled:opacity-50\"\n                >\n                  {posting ? (\n                    <div className=\"w-4 h-4 border-2 border-black/20 border-t-black rounded-full animate-spin\" />\n                  ) : (\n                    <Send className=\"w-4 h-4\" />\n                  )}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Individual Post Message Component\nfunction PostMessage({\n  post,\n  showAvatar,\n  onReaction,\n  onReply,\n  onEdit,\n  quickReactions\n}: {\n  post: PostWithAuthor;\n  showAvatar: boolean;\n  onReaction: (postId: string, emoji: string) => void;\n  onReply: () => void;\n  onEdit: () => void;\n  quickReactions: string[];\n}) {\n  const [showActions, setShowActions] = useState(false);\n  const [showReactions, setShowReactions] = useState(false);\n\n  // Group reactions by emoji\n  const groupedReactions = post.reactions.reduce((acc, reaction) => {\n    if (!acc[reaction.emoji]) {\n      acc[reaction.emoji] = [];\n    }\n    acc[reaction.emoji].push(reaction);\n    return acc;\n  }, {} as Record<string, PostReaction[]>);\n\n  return (\n    <div\n      className=\"group hover:bg-gray-900/50 px-4 py-2 transition-colors relative\"\n      onMouseEnter={() => setShowActions(true)}\n      onMouseLeave={() => setShowActions(false)}\n    >\n      <div className=\"flex space-x-3\">\n        {showAvatar ? (\n          <Avatar\n            src={post.author.avatarUrl}\n            fallback={post.author.displayName?.[0]}\n            className=\"w-8 h-8 mt-1\"\n          />\n        ) : (\n          <div className=\"w-8 h-8 mt-1 flex items-center justify-center\">\n            <div className=\"text-xs text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity\">\n              {formatDistanceToNow(new Date(post.createdAt), { addSuffix: false })}\n            </div>\n          </div>\n        )}\n\n        <div className=\"flex-1 min-w-0\">\n          {showAvatar && (\n            <div className=\"flex items-center space-x-2 mb-1\">\n              <span className=\"font-medium text-white\">{post.author.displayName}</span>\n              <span className=\"text-xs text-gray-500\">\n                {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}\n              </span>\n              {post.isPinned && (\n                <Pin className=\"w-3 h-3 text-yellow-500\" />\n              )}\n            </div>\n          )}\n\n          <div className=\"text-gray-100 leading-relaxed whitespace-pre-wrap break-words\">\n            {post.content}\n          </div>\n\n          {/* Attachments - placeholder for future implementation */}\n\n          {/* Reactions */}\n          {Object.keys(groupedReactions).length > 0 && (\n            <div className=\"flex flex-wrap gap-1 mt-2\">\n              {Object.entries(groupedReactions).map(([emoji, reactions]) => (\n                <button\n                  key={emoji}\n                  onClick={() => onReaction(post.id, emoji)}\n                  className=\"flex items-center space-x-1 bg-gray-800 hover:bg-gray-700 rounded-full px-2 py-1 text-sm transition-colors\"\n                >\n                  <span>{emoji}</span>\n                  <span className=\"text-gray-400\">{reactions.length}</span>\n                </button>\n              ))}\n\n              <button\n                onClick={() => setShowReactions(!showReactions)}\n                className=\"w-7 h-7 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-[var(--hive-brand-primary)] transition-colors\"\n              >\n                <Plus className=\"w-4 h-4\" />\n              </button>\n            </div>\n          )}\n\n          {/* Quick reaction picker */}\n          {showReactions && (\n            <div className=\"flex gap-1 mt-2 p-2 bg-gray-800 rounded-lg\">\n              {quickReactions.map((emoji) => (\n                <button\n                  key={emoji}\n                  onClick={() => {\n                    onReaction(post.id, emoji);\n                    setShowReactions(false);\n                  }}\n                  className=\"w-8 h-8 hover:bg-gray-700 rounded flex items-center justify-center text-lg transition-colors\"\n                >\n                  {emoji}\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Action buttons */}\n        {showActions && (\n          <div className=\"flex items-center space-x-1 absolute right-4 top-2\">\n            <button\n              onClick={() => onReaction(post.id, 'üëç')}\n              className=\"p-1 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded transition-colors\"\n            >\n              <Heart className=\"w-4 h-4\" />\n            </button>\n            <button\n              onClick={onReply}\n              className=\"p-1 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded transition-colors\"\n            >\n              <Reply className=\"w-4 h-4\" />\n            </button>\n            {post.canEdit && (\n              <button\n                onClick={onEdit}\n                className=\"p-1 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded transition-colors\"\n              >\n                <Edit className=\"w-4 h-4\" />\n              </button>\n            )}\n            <button className=\"p-1 text-gray-400 hover:text-[var(--hive-brand-primary)] hover:bg-gray-800 rounded transition-colors\">\n              <MoreHorizontal className=\"w-4 h-4\" />\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-settings-modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserPlus' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Crown' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ban' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":8},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":275,"column":25,"nodeType":"JSXOpeningElement","endLine":275,"endColumn":83},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":286,"column":25,"nodeType":"JSXOpeningElement","endLine":286,"endColumn":83}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport {\n  Settings,\n  Users,\n  Shield,\n  Trash2,\n  Image,\n  Globe,\n  Lock,\n  UserPlus,\n  Edit,\n  Save,\n  X,\n  AlertTriangle,\n  Crown,\n  Archive,\n  Download,\n  Upload,\n  Palette,\n  Bell,\n  Ban,\n  MessageSquare\n} from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  Button,\n  Input,\n  Textarea,\n  Card,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent\n} from '@hive/ui';\nimport type { Space } from '@hive/core';\n\ninterface SpaceSettingsModalProps {\n  space: Space;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\ninterface SpaceSettings {\n  name: string;\n  description: string;\n  isPrivate: boolean;\n  allowInvites: boolean;\n  requireApproval: boolean;\n  allowGuestPosts: boolean;\n  slowMode: number;\n  defaultNotifications: boolean;\n  customEmojis: boolean;\n  bannerUrl?: string;\n  primaryColor?: string;\n  welcomeMessage?: string;\n}\n\nexport function SpaceSettingsModal({ space, isOpen, onClose }: SpaceSettingsModalProps) {\n  const resolveString = (value: unknown): string => {\n    if (typeof value === 'string') return value;\n    if (\n      value &&\n      typeof value === 'object' &&\n      'value' in value &&\n      typeof (value as Record<string, unknown>).value === 'string'\n    ) {\n      return (value as Record<string, string>).value;\n    }\n    return '';\n  };\n\n  const spaceName = resolveString(space.name);\n  const spaceDescription = resolveString((space as unknown as { description?: unknown }).description);\n  const spaceBannerUrl = (space as unknown as { bannerUrl?: string }).bannerUrl;\n\n  const [activeTab, setActiveTab] = useState('general');\n  const [settings, setSettings] = useState<SpaceSettings>({\n    name: spaceName,\n    description: spaceDescription,\n    isPrivate: false, // Default to public\n    allowInvites: true,\n    requireApproval: false,\n    allowGuestPosts: false,\n    slowMode: 0,\n    defaultNotifications: true,\n    customEmojis: false,\n    bannerUrl: spaceBannerUrl,\n    primaryColor: '#F59E0B', // hive-gold\n    welcomeMessage: ''\n  });\n\n  const [saving, setSaving] = useState(false);\n  const [deleteConfirm, setDeleteConfirm] = useState('');\n  const [showDeleteWarning, setShowDeleteWarning] = useState(false);\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      const response = await fetch(`/api/spaces/${space.id}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(settings)\n      });\n\n      if (response.ok) {\n        onClose();\n        window.location.reload(); // Refresh to show changes\n      }\n    } catch (error) {\n      console.error('Failed to save settings:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteSpace = async () => {\n    if (deleteConfirm !== spaceName) return;\n\n    try {\n      const response = await fetch(`/api/spaces/${space.id}`, {\n        method: 'DELETE'\n      });\n\n      if (response.ok) {\n        window.location.href = '/spaces';\n      }\n    } catch (error) {\n      console.error('Failed to delete space:', error);\n    }\n  };\n\n  const updateSettings = (updates: Partial<SpaceSettings>) => {\n    setSettings(prev => ({ ...prev, ...updates }));\n  };\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-hidden p-0\">\n        <div className=\"flex flex-col h-full\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-gray-800\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Settings className=\"w-6 h-6 text-[var(--hive-brand-primary)]\" />\n              <div>\n                <h2 className=\"text-2xl font-bold text-white\">Space Settings</h2>\n                <p className=\"text-gray-400\">Manage {spaceName}</p>\n              </div>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-hidden\">\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex h-full\">\n            {/* Sidebar */}\n            <div className=\"w-64 border-r border-gray-800 bg-gray-950/50\">\n              <TabsList className=\"flex flex-col w-full h-full bg-transparent p-4 space-y-2\">\n                <TabsTrigger\n                  value=\"general\"\n                  className=\"w-full justify-start data-[state=active]:bg-[var(--hive-brand-primary)]/10 data-[state=active]:text-[var(--hive-brand-primary)]\"\n                >\n                  <Edit className=\"w-4 h-4 mr-3\" />\n                  General\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"privacy\"\n                  className=\"w-full justify-start data-[state=active]:bg-[var(--hive-brand-primary)]/10 data-[state=active]:text-[var(--hive-brand-primary)]\"\n                >\n                  <Lock className=\"w-4 h-4 mr-3\" />\n                  Privacy & Access\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"moderation\"\n                  className=\"w-full justify-start data-[state=active]:bg-[var(--hive-brand-primary)]/10 data-[state=active]:text-[var(--hive-brand-primary)]\"\n                >\n                  <Shield className=\"w-4 h-4 mr-3\" />\n                  Moderation\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"appearance\"\n                  className=\"w-full justify-start data-[state=active]:bg-[var(--hive-brand-primary)]/10 data-[state=active]:text-[var(--hive-brand-primary)]\"\n                >\n                  <Palette className=\"w-4 h-4 mr-3\" />\n                  Appearance\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"notifications\"\n                  className=\"w-full justify-start data-[state=active]:bg-[var(--hive-brand-primary)]/10 data-[state=active]:text-[var(--hive-brand-primary)]\"\n                >\n                  <Bell className=\"w-4 h-4 mr-3\" />\n                  Notifications\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"danger\"\n                  className=\"w-full justify-start data-[state=active]:bg-red-500/10 data-[state=active]:text-red-400\"\n                >\n                  <AlertTriangle className=\"w-4 h-4 mr-3\" />\n                  Danger Zone\n                </TabsTrigger>\n              </TabsList>\n            </div>\n\n            {/* Main content */}\n            <div className=\"flex-1 overflow-y-auto\">\n              <TabsContent value=\"general\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Basic Information</h3>\n\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-white mb-2\">Space Name</label>\n                      <Input\n                        value={settings.name}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ name: e.target.value })}\n                        placeholder=\"Enter space name\"\n                        maxLength={50}\n                      />\n                      <p className=\"text-xs text-gray-400 mt-1\">{settings.name.length}/50 characters</p>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-white mb-2\">Description</label>\n                      <Textarea\n                        value={settings.description}\n                        onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                          updateSettings({ description: e.target.value })}\n                        placeholder=\"Describe your space\"\n                        maxLength={500}\n                        rows={4}\n                        className=\"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-[var(--hive-brand-primary)] focus:outline-none resize-none\"\n                      />\n                      <p className=\"text-xs text-gray-400 mt-1\">{settings.description.length}/500 characters</p>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-white mb-2\">Welcome Message</label>\n                      <Textarea\n                        value={settings.welcomeMessage}\n                        onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                          updateSettings({ welcomeMessage: e.target.value })}\n                        placeholder=\"Message shown to new members (optional)\"\n                        maxLength={200}\n                        rows={3}\n                        className=\"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-[var(--hive-brand-primary)] focus:outline-none resize-none\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Space Icon & Banner</h3>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <Card className=\"p-4 bg-gray-800/50 border-gray-700\">\n                      <div className=\"text-center\">\n                        <Image className=\"w-12 h-12 text-gray-400 mx-auto mb-3\" />\n                        <h4 className=\"font-medium text-white mb-2\">Space Icon</h4>\n                        <Button variant=\"outline\" className=\"max-w-sm\">\n                          <Upload className=\"w-4 h-4 mr-2\" />\n                          Upload Icon\n                        </Button>\n                      </div>\n                    </Card>\n\n                    <Card className=\"p-4 bg-gray-800/50 border-gray-700\">\n                      <div className=\"text-center\">\n                        <Image className=\"w-12 h-12 text-gray-400 mx-auto mb-3\" />\n                        <h4 className=\"font-medium text-white mb-2\">Cover Banner</h4>\n                        <Button variant=\"outline\" className=\"max-w-sm\">\n                          <Upload className=\"w-4 h-4 mr-2\" />\n                          Upload Banner\n                        </Button>\n                      </div>\n                    </Card>\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"privacy\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Privacy Settings</h3>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Private Space</div>\n                        <div className=\"text-sm text-gray-400\">Only members can see the space and its content</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.isPrivate}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ isPrivate: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Require Approval</div>\n                        <div className=\"text-sm text-gray-400\">New members must be approved by admins</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.requireApproval}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ requireApproval: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Member Invites</div>\n                        <div className=\"text-sm text-gray-400\">Allow members to invite others</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.allowInvites}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ allowInvites: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"moderation\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Moderation Settings</h3>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Slow Mode</div>\n                        <div className=\"text-sm text-gray-400\">Limit how often members can post</div>\n                      </div>\n                      <select\n                        value={settings.slowMode}\n                        onChange={(e: React.ChangeEvent<HTMLSelectElement>) =>\n                          updateSettings({ slowMode: Number(e.target.value) })}\n                        className=\"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white\"\n                      >\n                        <option value={0}>Off</option>\n                        <option value={5}>5 seconds</option>\n                        <option value={15}>15 seconds</option>\n                        <option value={30}>30 seconds</option>\n                        <option value={60}>1 minute</option>\n                        <option value={300}>5 minutes</option>\n                      </select>\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Guest Posts</div>\n                        <div className=\"text-sm text-gray-400\">Allow non-members to post in public spaces</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.allowGuestPosts}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ allowGuestPosts: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Content Filters</h3>\n                  <Card className=\"p-4 bg-gray-800/50 border-gray-700\">\n                    <p className=\"text-gray-400 text-sm\">\n                      Automatic content filtering is enabled for all spaces.\n                      Content that violates community guidelines will be automatically flagged for review.\n                    </p>\n                  </Card>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"appearance\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Space Theme</h3>\n\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-white mb-2\">Primary Color</label>\n                      <div className=\"flex items-center space-x-3\">\n                        <div\n                          className=\"w-10 h-10 rounded-lg border border-gray-600\"\n                          style={{ backgroundColor: settings.primaryColor }}\n                        />\n                        <Input\n                          type=\"color\"\n                          value={settings.primaryColor}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                            updateSettings({ primaryColor: e.target.value })}\n                          className=\"w-20\"\n                        />\n                        <span className=\"text-gray-400\">{settings.primaryColor}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">Custom Emojis</div>\n                        <div className=\"text-sm text-gray-400\">Allow space-specific emoji reactions</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.customEmojis}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ customEmojis: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"notifications\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-white mb-4\">Default Notification Settings</h3>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium text-white\">New Member Notifications</div>\n                        <div className=\"text-sm text-gray-400\">Members get notified by default for new posts</div>\n                      </div>\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.defaultNotifications}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                          updateSettings({ defaultNotifications: e.target.checked })}\n                        className=\"w-4 h-4 text-[var(--hive-brand-primary)] bg-gray-700 border-gray-600 rounded focus:ring-[var(--hive-brand-primary)]\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"danger\" className=\"p-6 space-y-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-red-400 mb-4\">Danger Zone</h3>\n\n                  <div className=\"space-y-4\">\n                    <Card className=\"p-4 border-red-500/20 bg-red-500/5\">\n                      <div className=\"flex items-start space-x-3\">\n                        <Archive className=\"w-5 h-5 text-red-400 mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-white mb-2\">Archive Space</h4>\n                          <p className=\"text-sm text-gray-400 mb-3\">\n                            Archive this space. It will be hidden from discovery but data will be preserved.\n                          </p>\n                          <Button variant=\"outline\" className=\"border-red-500 text-red-400 hover:bg-red-500/10\">\n                            Archive Space\n                          </Button>\n                        </div>\n                      </div>\n                    </Card>\n\n                    <Card className=\"p-4 border-red-500/20 bg-red-500/5\">\n                      <div className=\"flex items-start space-x-3\">\n                        <Trash2 className=\"w-5 h-5 text-red-400 mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-white mb-2\">Delete Space</h4>\n                          <p className=\"text-sm text-gray-400 mb-3\">\n                            Permanently delete this space and all its content. This action cannot be undone.\n                          </p>\n\n                          {!showDeleteWarning ? (\n                            <Button\n                              variant=\"outline\"\n                              className=\"border-red-500 text-red-400 hover:bg-red-500/10\"\n                              onClick={() => setShowDeleteWarning(true)}\n                            >\n                              Delete Space\n                            </Button>\n                          ) : (\n                            <div className=\"space-y-3\">\n                              <div className=\"p-3 border border-red-500/20 bg-red-500/10 rounded-lg flex items-start space-x-2\">\n                                <AlertTriangle className=\"h-4 w-4 text-red-400 mt-0.5\" />\n                                <div>\n                                  <p className=\"text-sm font-medium text-red-400\">This action is irreversible!</p>\n                                  <p className=\"text-sm text-red-300\">\n                                    Type <strong>{spaceName}</strong> to confirm deletion.\n                                  </p>\n                                </div>\n                              </div>\n\n                              <Input\n                                value={deleteConfirm}\n                                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setDeleteConfirm(e.target.value)}\n                                placeholder={`Type \"${spaceName}\" to confirm`}\n                                className=\"border-red-500/50\"\n                              />\n\n                              <div className=\"flex space-x-2\">\n                                <Button\n                                  onClick={handleDeleteSpace}\n                                  disabled={deleteConfirm !== spaceName}\n                                  className=\"bg-red-500 hover:bg-red-600 text-white disabled:opacity-50\"\n                                >\n                                  Delete Forever\n                                </Button>\n                                <Button\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    setShowDeleteWarning(false);\n                                    setDeleteConfirm('');\n                                  }}\n                                >\n                                  Cancel\n                                </Button>\n                              </div>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </Card>\n                  </div>\n                </div>\n              </TabsContent>\n            </div>\n          </Tabs>\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-6 border-t border-gray-800 bg-gray-950/50\">\n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSave}\n              disabled={saving}\n              className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n            >\n              {saving ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-black/20 border-t-black rounded-full animate-spin mr-2\" />\n                  Saving...\n                </>\n              ) : (\n                <>\n                  <Save className=\"w-4 h-4 mr-2\" />\n                  Save Changes\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatDistanceToNow' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'installedTools' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":66,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSidebarData'. Either include it or remove the dependency array.","line":74,"column":6,"nodeType":"ArrayExpression","endLine":74,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [loadSidebarData, spaceId]","fix":{"range":[1604,1613],"text":"[loadSidebarData, spaceId]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toolType' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":315,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":315,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Card, Button, Badge } from '@hive/ui';\nimport {\n  Users,\n  Calendar,\n  FileText,\n  Wrench,\n  ChevronLeft,\n  ChevronRight,\n  Clock,\n  Link,\n  File,\n  Video,\n  ClipboardList,\n  Archive,\n  Eye\n} from 'lucide-react';\nimport { api } from '@/lib/api-client';\nimport { formatDistanceToNow } from 'date-fns';\nimport { ToolsWidget } from './tools-widget';\n\ninterface SpaceSidebarProps {\n  spaceId: string;\n  collapsed: boolean;\n  onToggleCollapse: () => void;\n  onOpenPanel: (panel: string) => void;\n  membership: any;\n}\n\ninterface OnlineMember {\n  id: string;\n  name: string;\n  avatar?: string;\n  lastActive: Date;\n}\n\ninterface UpcomingEvent {\n  id: string;\n  title: string;\n  type: 'event' | 'deadline' | 'meeting';\n  startTime: Date;\n  endTime: Date;\n  attendees: number;\n}\n\ninterface Resource {\n  id: string;\n  title: string;\n  type: 'document' | 'link' | 'media' | 'form';\n  viewCount: number;\n  uploadedBy: string;\n}\n\nexport function SpaceSidebar({\n  spaceId,\n  collapsed,\n  onToggleCollapse,\n  onOpenPanel,\n  membership\n}: SpaceSidebarProps) {\n  const [onlineMembers, setOnlineMembers] = useState<OnlineMember[]>([]);\n  const [upcomingEvents, setUpcomingEvents] = useState<UpcomingEvent[]>([]);\n  const [pinnedResources, setPinnedResources] = useState<Resource[]>([]);\n  const [installedTools, setInstalledTools] = useState<any[]>([]);\n\n  useEffect(() => {\n    if (spaceId) {\n      loadSidebarData();\n      const interval = setInterval(loadSidebarData, 30000); // Refresh every 30s\n      return () => clearInterval(interval);\n    }\n  }, [spaceId]);\n\n  const loadSidebarData = async () => {\n    try {\n      // Load online members\n      const membersResponse = await api.get<{ members?: OnlineMember[] }>(`/api/spaces/${spaceId}/members`, {\n        params: { online: true, limit: 10 }\n      });\n      setOnlineMembers(membersResponse.members || []);\n\n      // Load upcoming events\n      const eventsResponse = await api.get<{ events?: UpcomingEvent[] }>(`/api/spaces/${spaceId}/events`, {\n        params: { upcoming: true, limit: 3 }\n      });\n      setUpcomingEvents(eventsResponse.events || []);\n\n      // Load pinned resources\n      const resourcesResponse = await api.get<{ resources?: Resource[] }>(`/api/spaces/${spaceId}/resources`, {\n        params: { pinned: true, limit: 5 }\n      });\n      setPinnedResources(resourcesResponse.resources || []);\n\n      // Load installed tools\n      const toolsResponse = await api.get<{ tools?: any[] }>(`/api/spaces/${spaceId}/tools`);\n      setInstalledTools(toolsResponse.tools || []);\n    } catch (error) {\n      console.error('Failed to load sidebar data:', error);\n    }\n  };\n\n  if (collapsed) {\n    return (\n      <div className=\"p-2\">\n        <Button\n          className=\"max-w-sm mb-4\"\n          variant=\"outline\"\n          onClick={onToggleCollapse}\n          \n        >\n          <ChevronRight className=\"w-4 h-4\" />\n        </Button>\n\n        {/* Collapsed icons */}\n        <div className=\"space-y-4\">\n          <button\n            onClick={() => onOpenPanel('members')}\n            className=\"relative p-2 hover:bg-gray-800 rounded\"\n          >\n            <Users className=\"w-5 h-5 text-gray-400\" />\n            <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full\" />\n          </button>\n\n          <button\n            onClick={() => onOpenPanel('events')}\n            className=\"p-2 hover:bg-gray-800 rounded\"\n          >\n            <Calendar className=\"w-5 h-5 text-gray-400\" />\n          </button>\n\n          <button\n            onClick={() => onOpenPanel('resources')}\n            className=\"p-2 hover:bg-gray-800 rounded\"\n          >\n            <FileText className=\"w-5 h-5 text-gray-400\" />\n          </button>\n\n          <button\n            onClick={() => onOpenPanel('tools')}\n            className=\"p-2 hover:bg-gray-800 rounded\"\n          >\n            <Wrench className=\"w-5 h-5 text-gray-400\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-4 space-y-4\">\n      {/* Collapse Button */}\n      <Button\n        className=\"max-w-sm mb-2\"\n        variant=\"outline\"\n        onClick={onToggleCollapse}\n        \n      >\n        <ChevronLeft className=\"w-4 h-4 mr-2\" />\n        Collapse\n      </Button>\n\n      {/* Members Widget */}\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-white flex items-center gap-2\">\n            <Users className=\"w-4 h-4\" />\n            Members\n          </h3>\n          <button\n            onClick={() => onOpenPanel('members')}\n            className=\"text-xs text-gray-400 hover:text-white\"\n          >\n            View all\n          </button>\n        </div>\n\n        {/* Online Count */}\n        <div className=\"flex items-center gap-2 mb-3\">\n          <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n          <span className=\"text-sm text-gray-400\">\n            {onlineMembers.length} online now\n          </span>\n        </div>\n\n        {/* Avatar Stack */}\n        <div className=\"flex -space-x-2\">\n          {onlineMembers.slice(0, 8).map((member) => (\n            <div\n              key={member.id}\n              className=\"w-8 h-8 rounded-full bg-gray-700 border-2 border-gray-900\"\n              title={member.name}\n            />\n          ))}\n          {onlineMembers.length > 8 && (\n            <div className=\"w-8 h-8 rounded-full bg-gray-800 border-2 border-gray-900 flex items-center justify-center\">\n              <span className=\"text-xs text-gray-400\">\n                +{onlineMembers.length - 8}\n              </span>\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Events Widget */}\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-white flex items-center gap-2\">\n            <Calendar className=\"w-4 h-4\" />\n            Events\n          </h3>\n          <button\n            onClick={() => onOpenPanel('events')}\n            className=\"text-xs text-gray-400 hover:text-white\"\n          >\n            View all\n          </button>\n        </div>\n\n        {upcomingEvents.length === 0 ? (\n          <p className=\"text-sm text-gray-500\">No upcoming events</p>\n        ) : (\n          <div className=\"space-y-2\">\n            {upcomingEvents.map((event) => (\n              <div\n                key={event.id}\n                className=\"p-2 bg-gray-800/50 rounded cursor-pointer hover:bg-gray-800\"\n                onClick={() => onOpenPanel(`event-${event.id}`)}\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-white line-clamp-1\">\n                      {event.title}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                      {getEventTimeDisplay(event)}\n                    </p>\n                  </div>\n                  <Badge\n                    className={`text-xs ${\n                      event.type === 'deadline'\n                        ? 'bg-red-500/20 text-red-400'\n                        : event.type === 'meeting'\n                        ? 'bg-blue-500/20 text-blue-400'\n                        : 'bg-green-500/20 text-green-400'\n                    }`}\n                  >\n                    {event.type}\n                  </Badge>\n                </div>\n\n                {/* Countdown for today's events */}\n                {isToday(event.startTime) && (\n                  <div className=\"mt-1 flex items-center gap-1\">\n                    <Clock className=\"w-3 h-3 text-[var(--hive-brand-primary)]\" />\n                    <span className=\"text-xs text-[var(--hive-brand-primary)]\">\n                      {getCountdown(event.startTime)}\n                    </span>\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </Card>\n\n      {/* Resources Widget */}\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-white flex items-center gap-2\">\n            <FileText className=\"w-4 h-4\" />\n            Resources\n          </h3>\n          <button\n            onClick={() => onOpenPanel('resources')}\n            className=\"text-xs text-gray-400 hover:text-white\"\n          >\n            View all\n          </button>\n        </div>\n\n        {pinnedResources.length === 0 ? (\n          <p className=\"text-sm text-gray-500\">No pinned resources</p>\n        ) : (\n          <div className=\"space-y-2\">\n            {pinnedResources.map((resource) => (\n              <div\n                key={resource.id}\n                className=\"flex items-center gap-2 p-2 bg-gray-800/50 rounded hover:bg-gray-800 cursor-pointer\"\n              >\n                {getResourceIcon(resource.type)}\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-sm text-white truncate\">\n                    {resource.title}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    {resource.viewCount} views\n                  </p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </Card>\n\n      {/* Tools Widget */}\n      <ToolsWidget\n        spaceId={spaceId}\n        userRole={membership?.role || 'guest'}\n        canCreateEvents={['owner', 'leader', 'moderator'].includes(membership?.role)}\n        canCreatePolls={Boolean(membership)}\n        canCreateTasks={['owner', 'leader', 'moderator'].includes(membership?.role)}\n        canCreateResources={Boolean(membership)}\n        onToolUsed={(toolType, data) => {\n          // Refresh sidebar data after tool usage\n          loadSidebarData();\n        }}\n      />\n    </div>\n  );\n}\n\n// Helper functions\nfunction getEventTimeDisplay(event: UpcomingEvent): string {\n  const now = new Date();\n  const start = new Date(event.startTime);\n  const hoursDiff = (start.getTime() - now.getTime()) / (1000 * 60 * 60);\n\n  if (hoursDiff < 0) {\n    return 'Happening now';\n  } else if (hoursDiff < 24) {\n    return `Today at ${start.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit'\n    })}`;\n  } else if (hoursDiff < 48) {\n    return `Tomorrow at ${start.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit'\n    })}`;\n  } else {\n    return start.toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit'\n    });\n  }\n}\n\nfunction isToday(date: Date): boolean {\n  const today = new Date();\n  const d = new Date(date);\n  return d.getDate() === today.getDate() &&\n    d.getMonth() === today.getMonth() &&\n    d.getFullYear() === today.getFullYear();\n}\n\nfunction getCountdown(date: Date): string {\n  const now = new Date();\n  const target = new Date(date);\n  const diff = target.getTime() - now.getTime();\n\n  if (diff < 0) return 'Started';\n\n  const hours = Math.floor(diff / (1000 * 60 * 60));\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n  if (hours > 0) {\n    return `${hours}h ${minutes}m`;\n  }\n  return `${minutes}m`;\n}\n\nfunction getResourceIcon(type: string) {\n  switch (type) {\n    case 'document':\n      return <File className=\"w-4 h-4 text-blue-400\" />;\n    case 'link':\n      return <Link className=\"w-4 h-4 text-green-400\" />;\n    case 'media':\n      return <Video className=\"w-4 h-4 text-purple-400\" />;\n    case 'form':\n      return <ClipboardList className=\"w-4 h-4 text-yellow-400\" />;\n    default:\n      return <Archive className=\"w-4 h-4 text-gray-400\" />;\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-tool-renderer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'renderElement' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ToolPermissions' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeTool'. Either include it or remove the dependency array.","line":79,"column":6,"nodeType":"ArrayExpression","endLine":79,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [tool.id, spaceId, permissionResult, initializeTool]","fix":{"range":[2093,2129],"text":"[tool.id, spaceId, permissionResult, initializeTool]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleElementChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":130,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":130,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { renderElement } from \"../tools/element-renderers\";\nimport { Card, Button, Badge } from \"@hive/ui\";\nimport { Settings, Maximize2, Minimize2, RefreshCw } from \"lucide-react\";\nimport type { SpaceTypeRules } from \"@/lib/space-type-rules\";\nimport {\n  canUseToolInSpace,\n  getToolPermissions,\n  type UserPermissions,\n  type ToolPermissions,\n} from \"@/lib/permission-system\";\n\ninterface SpaceToolRendererProps {\n  tool: {\n    id: string;\n    toolId: string;\n    name: string;\n    description: string;\n    category: string;\n    status: string;\n    icon?: string;\n    position: \"inline\" | \"contextual\" | \"both\";\n    configuration?: any;\n    permissions?: any;\n    deployer?: any;\n    deployedAt?: string;\n    lastUsed?: string;\n    usageCount?: number;\n  };\n  spaceId: string;\n  spaceType?: string; // Add spaceType prop\n  userPermissions: UserPermissions;\n  spaceRules: SpaceTypeRules | null;\n  position: \"inline\" | \"contextual\";\n}\n\nexport function SpaceToolRenderer({\n  tool,\n  spaceId,\n  spaceType,\n  userPermissions,\n  spaceRules,\n  position,\n}: SpaceToolRendererProps) {\n  const [toolState, setToolState] = useState<any>({});\n  const [loading, setLoading] = useState(false);\n  const [expanded, setExpanded] = useState(position === \"inline\");\n  const [error, setError] = useState<string | null>(null);\n\n  // Check if user has permission to use this tool using unified permission system\n  const canUseTool = () => {\n    if (!spaceRules) return false;\n\n    const toolPermissions = getToolPermissions(tool.category, {\n      toolId: tool.toolId,\n      requiredRole:\n        tool.permissions?.isPublic === false ? \"moderator\" : \"member\",\n    });\n\n    const permission = canUseToolInSpace(\n      userPermissions,\n      (spaceType || \"student_organizations\") as any, // Use spaceType prop or default\n      spaceRules,\n      toolPermissions\n    );\n\n    return permission.canUse;\n  };\n\n  const permissionResult = canUseTool();\n\n  // Initialize tool state\n  useEffect(() => {\n    if (permissionResult) {\n      initializeTool();\n    }\n  }, [tool.id, spaceId, permissionResult]);\n\n  const initializeTool = async () => {\n    try {\n      setLoading(true);\n\n      // Load tool data from API or initialize with defaults\n      const initialState = {\n        spaceId,\n        toolId: tool.toolId,\n        deploymentId: tool.id,\n        config: tool.configuration || {},\n        data: {},\n        position,\n        lastUsed: tool.lastUsed,\n        usageCount: tool.usageCount || 0,\n        status: tool.status,\n      };\n\n      setToolState(initialState);\n    } catch (err) {\n      setError(\"Failed to initialize tool\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleToolAction = (action: string, data?: any) => {\n    // Handle common tool actions\n    switch (action) {\n      case \"refresh\":\n        initializeTool();\n        break;\n      case \"expand\":\n        setExpanded(true);\n        break;\n      case \"collapse\":\n        setExpanded(false);\n        break;\n      case \"configure\":\n        // Open tool configuration modal\n        break;\n      default:\n        // Handle tool-specific actions\n        setToolState((prev: any) => ({\n          ...prev,\n          lastAction: { action, data, timestamp: Date.now() },\n        }));\n    }\n  };\n\n  const handleElementChange = (elementId: string, data: any) => {\n    setToolState((prev: any) => ({\n      ...prev,\n      elements: {\n        ...prev.elements,\n        [elementId]: data,\n      },\n    }));\n  };\n\n  if (!permissionResult) {\n    return (\n      <div className=\"p-4 text-center text-gray-500 bg-gray-800/30 rounded-lg\">\n        <div className=\"text-sm\">\n          You don't have permission to use this tool\n        </div>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"p-4 text-center\">\n        <RefreshCw className=\"w-6 h-6 animate-spin mx-auto mb-2 text-[var(--hive-brand-primary)]\" />\n        <div className=\"text-sm text-gray-400\">Loading {tool.name}...</div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-4 text-center text-red-400 bg-red-500/10 border border-red-500/20 rounded-lg\">\n        <div className=\"text-sm\">{error}</div>\n        <Button\n          variant=\"outline\"\n          className=\"max-w-sm mt-2 border-red-500/30 text-red-400\"\n          onClick={() => initializeTool()}\n        >\n          Retry\n        </Button>\n      </div>\n    );\n  }\n\n  // Render tool based on position\n  if (position === \"contextual\") {\n    return (\n      <div className=\"space-y-3\">\n        {/* Contextual Tool Header */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-lg\">{tool.icon || \"üîß\"}</span>\n            <div>\n              <h4 className=\"font-semibold text-white text-sm\">{tool.name}</h4>\n              <Badge\n                variant=\"secondary\"\n                className=\"text-xs border-gray-600 text-gray-400\"\n              >\n                {tool.category}\n              </Badge>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-1\">\n            {(userPermissions.role === \"admin\" ||\n              userPermissions.role === \"owner\") && (\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={() => handleToolAction(\"configure\")}\n              >\n                <Settings className=\"w-3 h-3\" />\n              </Button>\n            )}\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? (\n                <Minimize2 className=\"w-3 h-3\" />\n              ) : (\n                <Maximize2 className=\"w-3 h-3\" />\n              )}\n            </Button>\n          </div>\n        </div>\n\n        {/* Contextual Tool Content */}\n        {expanded && (\n          <div className=\"space-y-2\">\n            {/* Show tool description and status */}\n            <div className=\"text-xs text-gray-400\">{tool.description}</div>\n            {tool.status === \"active\" ? (\n              <div className=\"p-3 bg-gray-800/30 rounded text-center text-gray-300\">\n                <div className=\"text-2xl mb-2\">{tool.icon || \"üîß\"}</div>\n                <div className=\"text-sm\">Tool ready for use</div>\n                {tool.lastUsed && (\n                  <div className=\"text-xs text-gray-500 mt-1\">\n                    Last used: {new Date(tool.lastUsed).toLocaleDateString()}\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded text-center text-yellow-400\">\n                <div className=\"text-sm\">Tool is being configured</div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  // Inline tool rendering\n  return (\n    <div className=\"space-y-4\">\n      {/* Inline Tool Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <span className=\"text-2xl\">{tool.icon || \"üîß\"}</span>\n          <div>\n            <h3 className=\"text-xl font-semibold text-white\">{tool.name}</h3>\n            <p className=\"text-sm text-gray-400\">\n              {tool.description || `${tool.category} tool for this space`}\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <Badge className=\"bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-[var(--hive-brand-primary)]/30\">\n            {tool.category}\n          </Badge>\n\n          {(userPermissions.role === \"admin\" ||\n            userPermissions.role === \"owner\") && (\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm border-gray-700 text-gray-300\"\n              onClick={() => handleToolAction(\"configure\")}\n            >\n              <Settings className=\"w-4 h-4 mr-2\" />\n              Configure\n            </Button>\n          )}\n\n          <Button\n            variant=\"outline\"\n            className=\"max-w-sm border-gray-700 text-gray-300\"\n            onClick={() => handleToolAction(\"refresh\")}\n          >\n            <RefreshCw className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n\n      {/* Inline Tool Content */}\n      <div className=\"grid grid-cols-1 gap-4\">\n        {tool.status === \"active\" ? (\n          <div className=\"bg-gray-800/30 rounded-lg p-6 text-center\">\n            <div className=\"text-4xl mb-4\">{tool.icon || \"üîß\"}</div>\n            <div className=\"text-lg font-medium text-white mb-2\">\n              {tool.name}\n            </div>\n            <div className=\"text-sm text-gray-400 mb-4\">{tool.description}</div>\n\n            {/* Tool Metrics */}\n            <div className=\"grid grid-cols-3 gap-4 mb-4\">\n              <div className=\"text-center\">\n                <div className=\"text-xl font-bold text-[var(--hive-brand-primary)]\">\n                  {tool.usageCount || 0}\n                </div>\n                <div className=\"text-xs text-gray-500\">Uses</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-xl font-bold text-green-400\">Active</div>\n                <div className=\"text-xs text-gray-500\">Status</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-xl font-bold text-blue-400\">\n                  {tool.deployer?.name?.split(\" \")[0] || \"Admin\"}\n                </div>\n                <div className=\"text-xs text-gray-500\">Deployed by</div>\n              </div>\n            </div>\n\n            {tool.lastUsed && (\n              <div className=\"text-xs text-gray-500\">\n                Last used: {new Date(tool.lastUsed).toLocaleDateString()}\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-8 text-gray-400\">\n            <div className=\"text-4xl mb-3\">{tool.icon || \"üîß\"}</div>\n            <div className=\"text-lg font-medium text-white mb-2\">\n              {tool.name}\n            </div>\n            <div className=\"text-sm\">\n              This tool is being configured for your space.\n            </div>\n            {(userPermissions.role === \"admin\" ||\n              userPermissions.role === \"owner\") && (\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm mt-4 border-[var(--hive-brand-primary)]/30 text-[var(--hive-brand-primary)]\"\n                onClick={() => handleToolAction(\"configure\")}\n              >\n                Configure Tool\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Tool Actions Bar */}\n      {tool.configuration?.elements &&\n        tool.configuration.elements.length > 0 && (\n          <div className=\"flex items-center justify-between pt-4 border-t border-gray-700\">\n            <div className=\"text-xs text-gray-400\">\n              Last updated:{\" \"}\n              {new Date(\n                toolState.lastAction?.timestamp || Date.now()\n              ).toLocaleTimeString()}\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              {tool.configuration?.actions?.map(\n                (action: any, index: number) => (\n                  <Button\n                    key={index}\n                    variant=\"outline\"\n                    className=\"max-w-sm border-gray-700 text-gray-300 text-xs\"\n                    onClick={() => handleToolAction(action.id, action.data)}\n                  >\n                    {action.label}\n                  </Button>\n                )\n              )}\n            </div>\n          </div>\n        )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-tools-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Maximize2' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Minimize2' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Camera' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Music' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Code' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Map' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gamepad2' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tool' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, type ChangeEvent } from 'react';\nimport {\n  Plus,\n  Settings,\n  Maximize2,\n  Minimize2,\n  MoreVertical,\n  Timer,\n  BarChart3,\n  FileText,\n  MessageSquare,\n  CheckSquare,\n  PenTool,\n  Calculator,\n  Calendar,\n  Camera,\n  Music,\n  Code,\n  Map,\n  Gamepad2,\n  Brain,\n  Book,\n  Target,\n  Activity,\n  Users,\n  Zap,\n  Star,\n  Edit,\n  Trash2,\n  Share,\n  Copy,\n  Download,\n  ExternalLink\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Badge,\n  Dialog,\n  DialogContent,\n  Input\n} from '@hive/ui';\nimport type { Space } from '@hive/core';\n\n// Define missing types that should be in @hive/core\ninterface SpaceMember {\n  id: string;\n  userId: string;\n  spaceId: string;\n  role: 'owner' | 'admin' | 'moderator' | 'member';\n  joinedAt: Date;\n  isActive: boolean;\n}\n\ninterface Tool {\n  id: string;\n  name: string;\n  type: string;\n  spaceId: string;\n  createdBy: string;\n  createdAt: Date;\n}\n\ninterface SpaceToolsPanelProps {\n  space: Space;\n  userMembership: SpaceMember | null;\n}\n\ninterface SpaceTool {\n  id: string;\n  name: string;\n  type: ToolType;\n  description: string;\n  icon: React.ComponentType<any>;\n  isActive: boolean;\n  config?: any;\n  createdBy: string;\n  createdAt: Date;\n  lastUsed?: Date;\n  usageCount: number;\n  isExpanded?: boolean;\n}\n\ntype ToolType =\n  | 'timer'\n  | 'poll'\n  | 'whiteboard'\n  | 'file-share'\n  | 'attendance'\n  | 'calculator'\n  | 'todo-list'\n  | 'scheduler'\n  | 'flashcards'\n  | 'study-room'\n  | 'quick-vote'\n  | 'shared-notes';\n\nconst AVAILABLE_TOOLS: Record<ToolType, {\n  name: string;\n  description: string;\n  icon: React.ComponentType<any>;\n  category: string;\n  color: string;\n  features: string[];\n}> = {\n  timer: {\n    name: 'Study Timer',\n    description: 'Synchronized Pomodoro sessions for group study',\n    icon: Timer,\n    category: 'Academic',\n    color: 'bg-blue-500',\n    features: ['Pomodoro cycles', 'Group sync', 'Break notifications', 'Session history']\n  },\n  poll: {\n    name: 'Live Polls',\n    description: 'Real-time voting and decision making',\n    icon: BarChart3,\n    category: 'Coordination',\n    color: 'bg-green-500',\n    features: ['Multiple choice', 'Anonymous voting', 'Live results', 'Export data']\n  },\n  whiteboard: {\n    name: 'Collaborative Whiteboard',\n    description: 'Shared drawing and brainstorming space',\n    icon: PenTool,\n    category: 'Creative',\n    color: 'bg-purple-500',\n    features: ['Real-time collaboration', 'Drawing tools', 'Text notes', 'Save/export']\n  },\n  'file-share': {\n    name: 'File Hub',\n    description: 'Centralized file sharing and organization',\n    icon: FileText,\n    category: 'Productivity',\n    color: 'bg-orange-500',\n    features: ['File upload', 'Folder organization', 'Version control', 'Access permissions']\n  },\n  attendance: {\n    name: 'Attendance Tracker',\n    description: 'Event check-ins and participation tracking',\n    icon: CheckSquare,\n    category: 'Coordination',\n    color: 'bg-red-500',\n    features: ['QR code check-in', 'Manual entry', 'Attendance reports', 'Regular events']\n  },\n  calculator: {\n    name: 'Scientific Calculator',\n    description: 'Advanced calculator with equation sharing',\n    icon: Calculator,\n    category: 'Academic',\n    color: 'bg-teal-500',\n    features: ['Scientific functions', 'Equation history', 'Share calculations', 'Unit conversion']\n  },\n  'todo-list': {\n    name: 'Shared Tasks',\n    description: 'Collaborative task management',\n    icon: CheckSquare,\n    category: 'Productivity',\n    color: 'bg-indigo-500',\n    features: ['Task assignment', 'Due dates', 'Progress tracking', 'Priority levels']\n  },\n  scheduler: {\n    name: 'Group Scheduler',\n    description: 'Find common availability for meetings',\n    icon: Calendar,\n    category: 'Coordination',\n    color: 'bg-pink-500',\n    features: ['Availability polling', 'Calendar integration', 'Meeting proposals', 'Time zones']\n  },\n  flashcards: {\n    name: 'Study Cards',\n    description: 'Collaborative flashcard creation and study',\n    icon: Brain,\n    category: 'Academic',\n    color: 'bg-yellow-500',\n    features: ['Card creation', 'Study modes', 'Progress tracking', 'Shared decks']\n  },\n  'study-room': {\n    name: 'Virtual Study Room',\n    description: 'Focus sessions with ambient sounds',\n    icon: Book,\n    category: 'Academic',\n    color: 'bg-cyan-500',\n    features: ['Focus timer', 'Ambient sounds', 'Study goals', 'Progress sharing']\n  },\n  'quick-vote': {\n    name: 'Quick Vote',\n    description: 'Instant yes/no decisions',\n    icon: Target,\n    category: 'Coordination',\n    color: 'bg-lime-500',\n    features: ['One-click voting', 'Anonymous options', 'Quick results', 'Decision history']\n  },\n  'shared-notes': {\n    name: 'Shared Notes',\n    description: 'Collaborative note-taking',\n    icon: Edit,\n    category: 'Academic',\n    color: 'bg-rose-500',\n    features: ['Real-time editing', 'Rich formatting', 'Version history', 'Export options']\n  }\n};\n\nexport function SpaceToolsPanel({ space, userMembership }: SpaceToolsPanelProps) {\n  const [tools, setTools] = useState<SpaceTool[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [expandedTool, setExpandedTool] = useState<string | null>(null);\n\n  const canAddTools = userMembership?.role === 'admin' || userMembership?.role === 'owner';\n\n  // Fetch space tools\n  useEffect(() => {\n    const fetchTools = async () => {\n      try {\n        const response = await fetch(`/api/spaces/${space.id}/tools`);\n        const data = await response.json();\n\n        if (data.success) {\n          setTools(data.data || []);\n        }\n      } catch (error) {\n        console.error('Failed to fetch tools:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchTools();\n  }, [space.id]);\n\n  // Add a new tool\n  const handleAddTool = async (toolType: ToolType) => {\n    try {\n      const response = await fetch(`/api/spaces/${space.id}/tools`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ type: toolType })\n      });\n\n      if (response.ok) {\n        const newTool = await response.json();\n        setTools(prev => [...prev, newTool.data]);\n        setShowAddModal(false);\n      }\n    } catch (error) {\n      console.error('Failed to add tool:', error);\n    }\n  };\n\n  // Remove a tool\n  const handleRemoveTool = async (toolId: string) => {\n    try {\n      await fetch(`/api/spaces/${space.id}/tools/${toolId}`, {\n        method: 'DELETE'\n      });\n\n      setTools(prev => prev.filter(t => t.id !== toolId));\n    } catch (error) {\n      console.error('Failed to remove tool:', error);\n    }\n  };\n\n  // Get unique categories\n  const categories = ['all', ...new Set(Object.values(AVAILABLE_TOOLS).map(t => t.category))];\n\n  // Filter tools by category\n  const filteredTools = selectedCategory === 'all'\n    ? tools\n    : tools.filter(tool => AVAILABLE_TOOLS[tool.type]?.category === selectedCategory);\n\n  if (loading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"animate-pulse space-y-4\">\n          {Array.from({ length: 3 }).map((_, i) => (\n            <div key={i} className=\"bg-gray-800 h-32 rounded-lg\"></div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div>\n          <h3 className=\"text-xl font-semibold text-white mb-1\">Space Tools</h3>\n          <p className=\"text-gray-400 text-sm\">Interactive tools to enhance collaboration</p>\n        </div>\n\n        {canAddTools && (\n          <Button\n            onClick={() => setShowAddModal(true)}\n            className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Add Tool\n          </Button>\n        )}\n      </div>\n\n      {/* Category Filter */}\n      <div className=\"flex space-x-2 mb-6 overflow-x-auto pb-2\">\n        {categories.map((category) => (\n          <button\n            key={category}\n            onClick={() => setSelectedCategory(category)}\n            className={`px-4 py-2 rounded-lg whitespace-nowrap text-sm font-medium transition-colors ${\n              selectedCategory === category\n                ? 'bg-[var(--hive-brand-primary)] text-black'\n                : 'bg-gray-800 text-gray-300 hover:bg-gray-700'\n            }`}\n          >\n            {category === 'all' ? 'All Tools' : category}\n          </button>\n        ))}\n      </div>\n\n      {/* Tools Grid */}\n      {filteredTools.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <div className=\"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Zap className=\"w-8 h-8 text-gray-400\" />\n          </div>\n          <h4 className=\"text-lg font-semibold text-white mb-2\">No tools yet</h4>\n          <p className=\"text-gray-400 mb-4\">\n            {canAddTools\n              ? \"Add interactive tools to enhance your space's functionality\"\n              : \"Ask an admin to add some tools to get started\"\n            }\n          </p>\n          {canAddTools && (\n            <Button\n              onClick={() => setShowAddModal(true)}\n              className=\"bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Your First Tool\n            </Button>\n          )}\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {filteredTools.map((tool) => (\n            <ToolCard\n              key={tool.id}\n              tool={tool}\n              isExpanded={expandedTool === tool.id}\n              onExpand={() => setExpandedTool(expandedTool === tool.id ? null : tool.id)}\n              onRemove={canAddTools ? () => handleRemoveTool(tool.id) : undefined}\n              canManage={canAddTools}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Add Tool Modal */}\n      {showAddModal && (\n        <AddToolModal\n          isOpen={showAddModal}\n          onClose={() => setShowAddModal(false)}\n          onAddTool={handleAddTool}\n          existingTools={tools.map(t => t.type)}\n        />\n      )}\n    </div>\n  );\n}\n\n// Individual Tool Card Component\nfunction ToolCard({\n  tool,\n  isExpanded,\n  onExpand,\n  onRemove,\n  canManage\n}: {\n  tool: SpaceTool;\n  isExpanded: boolean;\n  onExpand: () => void;\n  onRemove?: () => void;\n  canManage: boolean;\n}) {\n  const toolConfig = AVAILABLE_TOOLS[tool.type];\n  const ToolIcon = toolConfig?.icon || Zap;\n\n  return (\n    <Card\n      className={`transition-all duration-300 cursor-pointer hover:border-[var(--hive-brand-primary)]/50 ${\n        isExpanded ? 'md:col-span-2 lg:col-span-3' : ''\n      }`}\n      onClick={onExpand}\n    >\n      <div className=\"p-4\">\n        {/* Tool Header */}\n        <div className=\"flex items-start justify-between mb-3\">\n          <div className=\"flex items-center space-x-3\">\n            <div className={`w-10 h-10 ${toolConfig?.color || 'bg-gray-600'} rounded-lg flex items-center justify-center`}>\n              <ToolIcon className=\"w-5 h-5 text-white\" />\n            </div>\n            <div>\n              <h4 className=\"font-semibold text-white\">{tool.name}</h4>\n              <p className=\"text-xs text-gray-400\">{toolConfig?.category}</p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            {tool.isActive && (\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n            )}\n\n            {canManage && (\n              <button\n                onClick={(e: React.MouseEvent) => {\n                  e.stopPropagation();\n                  onRemove?.();\n                }}\n                className=\"p-1 text-gray-400 hover:text-red-400 hover:bg-gray-700 rounded transition-colors\"\n                title=\"Remove tool\"\n              >\n                <MoreVertical className=\"w-4 h-4\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Tool Description */}\n        <p className=\"text-sm text-gray-300 mb-3\">{tool.description}</p>\n\n        {/* Usage Stats */}\n        <div className=\"flex items-center justify-between text-xs text-gray-400\">\n          <span>Used {tool.usageCount} times</span>\n          {tool.lastUsed && (\n            <span>Last used {new Date(tool.lastUsed).toLocaleDateString()}</span>\n          )}\n        </div>\n\n        {/* Expanded Content */}\n        {isExpanded && (\n          <div className=\"mt-4 pt-4 border-t border-gray-700\">\n            <div className=\"mb-4\">\n              <h5 className=\"font-medium text-white mb-2\">Features</h5>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {toolConfig?.features.map((feature) => (\n                  <div key={feature} className=\"flex items-center space-x-2 text-sm text-gray-300\">\n                    <Star className=\"w-3 h-3 text-[var(--hive-brand-primary)]\" />\n                    <span>{feature}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"flex space-x-2\">\n              <Button\n                className=\"max-w-sm flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n                onClick={(e: React.MouseEvent) => e.stopPropagation()}\n              >\n                <ExternalLink className=\"w-4 h-4 mr-2\" />\n                Open Tool\n              </Button>\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={(e: React.MouseEvent) => e.stopPropagation()}\n              >\n                <Copy className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n}\n\n// Add Tool Modal Component\nfunction AddToolModal({\n  isOpen,\n  onClose,\n  onAddTool,\n  existingTools\n}: {\n  isOpen: boolean;\n  onClose: () => void;\n  onAddTool: (toolType: ToolType) => void;\n  existingTools: ToolType[];\n}) {\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const categories = ['all', ...new Set(Object.values(AVAILABLE_TOOLS).map(t => t.category))];\n\n  const filteredTools = Object.entries(AVAILABLE_TOOLS).filter(([type, config]) => {\n    const matchesCategory = selectedCategory === 'all' || config.category === selectedCategory;\n    const matchesSearch = config.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                         config.description.toLowerCase().includes(searchQuery.toLowerCase());\n    const notAlreadyAdded = !existingTools.includes(type as ToolType);\n\n    return matchesCategory && matchesSearch && notAlreadyAdded;\n  });\n\n  return (\n    <Dialog\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <DialogContent className=\"max-w-4xl max-h-[90vh]\">\n        <h2 className=\"text-2xl font-bold text-white mb-2\">Add Tool to Space</h2>\n        <p className=\"text-gray-400 mb-6\">Choose from our collection of interactive tools</p>\n\n        {/* Search and Filter */}\n        <div className=\"flex flex-col md:flex-row gap-4 mb-6\">\n          <div className=\"flex-1\">\n            <Input\n              value={searchQuery}\n              onChange={(e: ChangeEvent<HTMLInputElement>) => setSearchQuery(e.target.value)}\n              placeholder=\"Search tools...\"\n              className=\"w-full\"\n            />\n          </div>\n\n          <div className=\"flex space-x-2 overflow-x-auto\">\n            {categories.map((category) => (\n              <button\n                key={category}\n                onClick={() => setSelectedCategory(category)}\n                className={`px-4 py-2 rounded-lg whitespace-nowrap text-sm font-medium transition-colors ${\n                  selectedCategory === category\n                    ? 'bg-[var(--hive-brand-primary)] text-black'\n                    : 'bg-gray-800 text-gray-300 hover:bg-gray-700'\n                }`}\n              >\n                {category === 'all' ? 'All' : category}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tools Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto\">\n          {filteredTools.map(([type, config]) => {\n            const ToolIcon = config.icon;\n            return (\n              <Card\n                key={type}\n                className=\"p-4 cursor-pointer hover:border-[var(--hive-brand-primary)]/50 transition-all\"\n                onClick={() => onAddTool(type as ToolType)}\n              >\n                <div className=\"flex items-start space-x-3 mb-3\">\n                  <div className={`w-10 h-10 ${config.color} rounded-lg flex items-center justify-center flex-shrink-0`}>\n                    <ToolIcon className=\"w-5 h-5 text-white\" />\n                  </div>\n                  <div className=\"min-w-0 flex-1\">\n                    <h4 className=\"font-semibold text-white truncate\">{config.name}</h4>\n                    <p className=\"text-xs text-gray-400\">{config.category}</p>\n                  </div>\n                </div>\n\n                <p className=\"text-sm text-gray-300 mb-3 line-clamp-2\">{config.description}</p>\n\n                <div className=\"flex flex-wrap gap-1\">\n                  {config.features.slice(0, 2).map((feature) => (\n                    <Badge key={feature} variant=\"secondary\" className=\"text-xs\">\n                      {feature}\n                    </Badge>\n                  ))}\n                  {config.features.length > 2 && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      +{config.features.length - 2} more\n                    </Badge>\n                  )}\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n\n        {filteredTools.length === 0 && (\n          <div className=\"text-center py-8\">\n            <p className=\"text-gray-400\">No tools found matching your criteria</p>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/space-transfer-interface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MovementRestriction' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect as _useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { authenticatedFetch } from '../../lib/auth-utils';\nimport { Button, Badge, Alert } from \"@hive/ui\";\nimport { \n  ArrowRight, \n  Clock, \n  Shield, \n  AlertTriangle, \n  CheckCircle, \n  Calendar,\n  Users,\n  Home,\n  GraduationCap,\n  Building\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\ninterface SpaceInfo {\n  id: string;\n  name: string;\n  type: string;\n  memberCount: number;\n  description?: string;\n}\n\ninterface MovementRestriction {\n  canMove: boolean;\n  reason?: string;\n  nextAvailableDate?: string;\n  currentCooldownDays?: number;\n  movementsThisPeriod?: number;\n}\n\ninterface MovementRecord {\n  fromSpaceId: string;\n  toSpaceId: string;\n  spaceType: string;\n  movementType: string;\n  timestamp: string;\n  reason?: string;\n  adminOverride?: boolean;\n}\n\ninterface SpaceTransferInterfaceProps {\n  currentSpace: SpaceInfo;\n  availableSpaces: SpaceInfo[];\n  spaceType: 'campus_living' | 'cohort' | 'fraternity_and_sorority';\n  onTransferComplete?: () => void;\n}\n\nexport function SpaceTransferInterface({ \n  currentSpace, \n  availableSpaces, \n  spaceType,\n  onTransferComplete \n}: SpaceTransferInterfaceProps) {\n  const [selectedTargetSpace, setSelectedTargetSpace] = useState<SpaceInfo | null>(null);\n  const [transferReason, setTransferReason] = useState('');\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const queryClient = useQueryClient();\n\n  // Get movement restrictions and history\n  const { data: movementInfo } = useQuery({\n    queryKey: ['space-movement-info'],\n    queryFn: async () => {\n      const response = await authenticatedFetch('/api/spaces/transfer');\n      if (!response.ok) throw new Error('Failed to fetch movement info');\n      return response.json();\n    }\n  });\n\n  // Check specific transfer restrictions\n  const { data: transferValidation, isLoading: validationLoading } = useQuery({\n    queryKey: ['transfer-validation', currentSpace.id, selectedTargetSpace?.id],\n    queryFn: async () => {\n      if (!selectedTargetSpace) return null;\n      \n      const params = new URLSearchParams({\n        spaceType,\n        fromSpaceId: currentSpace.id,\n        toSpaceId: selectedTargetSpace.id\n      });\n      \n      const response = await authenticatedFetch(`/api/spaces/transfer?${params}`);\n      if (!response.ok) throw new Error('Failed to validate transfer');\n      return response.json();\n    },\n    enabled: !!selectedTargetSpace\n  });\n\n  // Transfer mutation\n  const transferMutation = useMutation({\n    mutationFn: async ({ toSpaceId, reason }: { toSpaceId: string; reason: string }) => {\n      const response = await authenticatedFetch('/api/spaces/transfer', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          fromSpaceId: currentSpace.id,\n          toSpaceId,\n          reason\n        })\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Transfer failed');\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['space-movement-info'] });\n      queryClient.invalidateQueries({ queryKey: ['user-spaces'] });\n      setShowConfirmation(false);\n      setSelectedTargetSpace(null);\n      setTransferReason('');\n      onTransferComplete?.();\n    }\n  });\n\n  const getSpaceTypeIcon = (type: string) => {\n    switch (type) {\n      case 'campus_living': return <Home className=\"h-4 w-4\" />;\n      case 'cohort': return <GraduationCap className=\"h-4 w-4\" />;\n      case 'fraternity_and_sorority': return <Building className=\"h-4 w-4\" />;\n      default: return <Users className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getSpaceTypeName = (type: string) => {\n    switch (type) {\n      case 'campus_living': return 'Housing';\n      case 'cohort': return 'Academic';\n      case 'fraternity_and_sorority': return 'Greek Life';\n      default: return 'Community';\n    }\n  };\n\n  const getRestrictionInfo = () => {\n    const restrictions = {\n      campus_living: {\n        cooldown: '1 month',\n        limit: '1 transfer per month',\n        description: 'You can change your housing space once per month'\n      },\n      cohort: {\n        cooldown: '1 month for major, 1 year for graduation year',\n        limit: '1 transfer per month',\n        description: 'Major changes: once per month. Graduation year changes: locked for 1 year'\n      },\n      fraternity_and_sorority: {\n        cooldown: 'No cooldown',\n        limit: '1 organization at a time',\n        description: 'You can only be a member of one Greek organization at a time'\n      }\n    };\n\n    return restrictions[spaceType] || restrictions.campus_living;\n  };\n\n  const handleTransfer = () => {\n    if (!selectedTargetSpace) return;\n    \n    transferMutation.mutate({\n      toSpaceId: selectedTargetSpace.id,\n      reason: transferReason\n    });\n  };\n\n  const restrictionInfo = getRestrictionInfo();\n  const currentRestriction = movementInfo?.currentRestrictions?.[spaceType];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Current Space */}\n      <div className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-white\">Current Space</h3>\n          <Badge variant=\"secondary\" className=\"border-[var(--hive-brand-primary)]/30 text-[var(--hive-brand-primary)]\">\n            {getSpaceTypeName(spaceType)}\n          </Badge>\n        </div>\n        \n        <div className=\"flex items-center gap-4 p-4 rounded-lg bg-white/[0.02] border border-white/[0.06]\">\n          {getSpaceTypeIcon(spaceType)}\n          <div className=\"flex-1\">\n            <h4 className=\"font-medium text-white\">{currentSpace.name}</h4>\n            <p className=\"text-sm text-neutral-400\">\n              {currentSpace.memberCount.toLocaleString()} members\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Movement Restrictions */}\n      <div className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <Shield className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n          <h3 className=\"text-lg font-semibold text-white\">Movement Restrictions</h3>\n        </div>\n        \n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-neutral-400\">Cooldown Period:</span>\n            <span className=\"text-white\">{restrictionInfo.cooldown}</span>\n          </div>\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-neutral-400\">Transfer Limit:</span>\n            <span className=\"text-white\">{restrictionInfo.limit}</span>\n          </div>\n          <p className=\"text-xs text-neutral-400 leading-relaxed\">\n            {restrictionInfo.description}\n          </p>\n          \n          {currentRestriction && !currentRestriction.canMove && (\n            <div className=\"mt-4 p-4 rounded-lg bg-red-500/10 border border-red-500/20\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n                <span className=\"text-sm font-medium text-red-400\">Transfer Restricted</span>\n              </div>\n              <p className=\"text-xs text-red-300\">\n                {currentRestriction.reason}\n              </p>\n              {currentRestriction.nextAvailableDate && (\n                <div className=\"flex items-center gap-2 mt-2 text-xs text-red-300\">\n                  <Calendar className=\"h-3 w-3\" />\n                  <span>\n                    Available: {new Date(currentRestriction.nextAvailableDate).toLocaleDateString()}\n                  </span>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Available Spaces */}\n      {(!currentRestriction || currentRestriction.canMove) && (\n        <div className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\">\n          <h3 className=\"text-lg font-semibold text-white mb-4\">Transfer to</h3>\n          \n          <div className=\"grid gap-3\">\n            {availableSpaces.filter(space => space.id !== currentSpace.id).map((space) => (\n              <motion.div\n                key={space.id}\n                className={`p-4 rounded-lg border transition-all cursor-pointer ${\n                  selectedTargetSpace?.id === space.id\n                    ? 'bg-[var(--hive-brand-primary)]/10 border-[var(--hive-brand-primary)]/30'\n                    : 'bg-white/[0.02] border-white/[0.06] hover:border-white/[0.1]'\n                }`}\n                onClick={() => setSelectedTargetSpace(space)}\n                whileHover={{ scale: 1.01 }}\n                whileTap={{ scale: 0.99 }}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    {getSpaceTypeIcon(space.spaceType)}\n                    <div>\n                      <h4 className=\"font-medium text-white\">{space.name}</h4>\n                      <p className=\"text-sm text-neutral-400\">\n                        {space.memberCount.toLocaleString()} members\n                      </p>\n                    </div>\n                  </div>\n                  \n                  {selectedTargetSpace?.id === space.id && (\n                    <CheckCircle className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n                  )}\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Transfer Reason */}\n      {selectedTargetSpace && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\"\n        >\n          <h3 className=\"text-lg font-semibold text-white mb-4\">Transfer Reason</h3>\n          <textarea\n            value={transferReason}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setTransferReason((e.target as any).value)}\n            placeholder=\"Why are you transferring? (optional)\"\n            className=\"w-full h-24 px-4 py-3 rounded-lg bg-white/[0.02] border border-white/[0.06] text-white placeholder-neutral-400 resize-none focus:outline-none focus:border-[var(--hive-brand-primary)]/30\"\n            maxLength={200}\n          />\n          <p className=\"text-xs text-neutral-400 mt-2\">\n            {transferReason.length}/200 characters\n          </p>\n        </motion.div>\n      )}\n\n      {/* Transfer Validation */}\n      {selectedTargetSpace && transferValidation && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\"\n        >\n          <h3 className=\"text-lg font-semibold text-white mb-4\">Transfer Preview</h3>\n          \n          <div className=\"flex items-center justify-between p-4 rounded-lg bg-white/[0.02] border border-white/[0.06]\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"text-center\">\n                <div className=\"font-medium text-white\">{currentSpace.name}</div>\n                <div className=\"text-xs text-neutral-400\">Current</div>\n              </div>\n              \n              <ArrowRight className=\"h-5 w-5 text-[var(--hive-brand-primary)]\" />\n              \n              <div className=\"text-center\">\n                <div className=\"font-medium text-white\">{selectedTargetSpace.name}</div>\n                <div className=\"text-xs text-neutral-400\">New</div>\n              </div>\n            </div>\n            \n            {transferValidation.canMove ? (\n              <div className=\"flex items-center gap-2 text-green-400\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span className=\"text-sm\">Allowed</span>\n              </div>\n            ) : (\n              <div className=\"flex items-center gap-2 text-red-400\">\n                <AlertTriangle className=\"h-4 w-4\" />\n                <span className=\"text-sm\">Restricted</span>\n              </div>\n            )}\n          </div>\n\n          {!transferValidation.canMove && (\n            <div className=\"mt-4 p-4 rounded-lg bg-red-500/10 border border-red-500/20\">\n              <p className=\"text-sm text-red-300\">\n                {transferValidation.restrictions?.reason}\n              </p>\n            </div>\n          )}\n          \n          <div className=\"flex gap-4 mt-6\">\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSelectedTargetSpace(null);\n                setTransferReason('');\n              }}\n              className=\"flex-1\"\n            >\n              Cancel\n            </Button>\n            \n            <Button\n              variant=\"default\"\n              onClick={() => setShowConfirmation(true)}\n              disabled={!transferValidation.canMove || validationLoading}\n              className=\"flex-1 bg-[var(--hive-brand-primary)] text-[#0A0A0A] hover:bg-[#FFE255]\"\n            >\n              {validationLoading ? 'Validating...' : 'Transfer Space'}\n            </Button>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Confirmation Modal */}\n      <AnimatePresence>\n        {showConfirmation && selectedTargetSpace && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            <motion.div\n              className=\"bg-[#0A0A0A] border border-white/[0.1] rounded-2xl p-6 w-full max-w-md\"\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n            >\n              <h3 className=\"text-xl font-semibold text-white mb-4\">Confirm Transfer</h3>\n              \n              <div className=\"space-y-4 mb-6\">\n                <div className=\"p-4 rounded-lg bg-white/[0.02] border border-white/[0.06]\">\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"text-neutral-400\">From:</span>\n                    <span className=\"text-white\">{currentSpace.name}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm mt-2\">\n                    <span className=\"text-neutral-400\">To:</span>\n                    <span className=\"text-white\">{selectedTargetSpace.name}</span>\n                  </div>\n                </div>\n                \n                <p className=\"text-sm text-neutral-400\">\n                  This action cannot be undone. You will lose access to {currentSpace.name} \n                  and gain access to {selectedTargetSpace.name}.\n                </p>\n                \n                {spaceType === 'campus_living' && (\n                  <div className=\"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20\">\n                    <p className=\"text-xs text-yellow-300\">\n                      Housing transfers may affect your physical room assignment. \n                      Contact housing services separately for room changes.\n                    </p>\n                  </div>\n                )}\n              </div>\n              \n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setShowConfirmation(false)}\n                  className=\"flex-1\"\n                  disabled={transferMutation.isPending}\n                >\n                  Cancel\n                </Button>\n                \n                <Button\n                  variant=\"default\"\n                  onClick={handleTransfer}\n                  className=\"flex-1 bg-[var(--hive-brand-primary)] text-[#0A0A0A] hover:bg-[#FFE255]\"\n                  disabled={transferMutation.isPending}\n                >\n                  {transferMutation.isPending ? (\n                    <div className=\"flex items-center gap-2\">\n                      <Clock className=\"h-4 w-4 animate-spin\" />\n                      <span>Transferring...</span>\n                    </div>\n                  ) : (\n                    'Confirm Transfer'\n                  )}\n                </Button>\n              </div>\n              \n              {transferMutation.isError && (\n                <div className=\"mt-4 p-3 rounded-lg bg-red-500/10 border border-red-500/20\">\n                  <p className=\"text-sm text-red-300\">\n                    {transferMutation.error?.message || 'Transfer failed'}\n                  </p>\n                </div>\n              )}\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Recent Movement History */}\n      {movementInfo?.movementHistory && movementInfo.movementHistory.length > 0 && (\n        <div className=\"rounded-xl bg-white/[0.02] border border-white/[0.06] p-6\">\n          <h3 className=\"text-lg font-semibold text-white mb-4\">Recent Transfers</h3>\n          \n          <div className=\"space-y-3\">\n            {movementInfo.movementHistory.slice(0, 5).map((record: MovementRecord, index: number) => (\n              <div key={index} className=\"flex items-center justify-between p-3 rounded-lg bg-white/[0.02] border border-white/[0.06]\">\n                <div className=\"flex items-center gap-3\">\n                  {getSpaceTypeIcon(record.spaceType)}\n                  <div>\n                    <div className=\"text-sm text-white\">\n                      {record.movementType === 'transfer' ? 'Transferred' : 'Left'} space\n                    </div>\n                    <div className=\"text-xs text-neutral-400\">\n                      {new Date(record.timestamp).toLocaleDateString()}\n                    </div>\n                  </div>\n                </div>\n                \n                <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                  {record.spaceType.replace('_', ' ')}\n                </Badge>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/spaces-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/tools-widget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userRole' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":88,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'template' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":326,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":326,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, ReactNode } from 'react';\nimport {\n  Calendar,\n  BarChart3,\n  CheckSquare,\n  FileText,\n  Plus,\n  X,\n  MapPin,\n  Clock,\n  Users,\n  Settings,\n  Zap\n} from 'lucide-react';\nimport {\n  Button,\n  Card,\n  Input,\n  Textarea,\n  Dialog,\n  DialogContent,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent\n} from '@hive/ui';\nimport { api } from '@/lib/api-client';\n\ninterface ToolsWidgetProps {\n  spaceId: string;\n  userRole: 'owner' | 'leader' | 'moderator' | 'member' | 'guest';\n  canCreateEvents: boolean;\n  canCreatePolls: boolean;\n  canCreateTasks: boolean;\n  canCreateResources: boolean;\n  onToolUsed?: (toolType: string, data: any) => void;\n}\n\ninterface Tool {\n  id: string;\n  name: string;\n  icon: React.ElementType;\n  description: string;\n  color: string;\n  permission: keyof Pick<ToolsWidgetProps, 'canCreateEvents' | 'canCreatePolls' | 'canCreateTasks' | 'canCreateResources'>;\n}\n\nconst DEFAULT_TOOLS: Tool[] = [\n  {\n    id: 'event',\n    name: 'Event',\n    icon: Calendar,\n    description: 'Create an event with RSVP',\n    color: 'text-blue-400',\n    permission: 'canCreateEvents'\n  },\n  {\n    id: 'poll',\n    name: 'Poll',\n    icon: BarChart3,\n    description: 'Quick poll with 2-5 options',\n    color: 'text-green-400',\n    permission: 'canCreatePolls'\n  },\n  {\n    id: 'task',\n    name: 'Task',\n    icon: CheckSquare,\n    description: 'Assign task with deadline',\n    color: 'text-orange-400',\n    permission: 'canCreateTasks'\n  },\n  {\n    id: 'resource',\n    name: 'Resource',\n    icon: FileText,\n    description: 'Upload file or add link',\n    color: 'text-purple-400',\n    permission: 'canCreateResources'\n  }\n];\n\nexport function ToolsWidget({\n  spaceId,\n  userRole,\n  canCreateEvents,\n  canCreatePolls,\n  canCreateTasks,\n  canCreateResources,\n  onToolUsed\n}: ToolsWidgetProps) {\n  const [activeModal, setActiveModal] = useState<string | null>(null);\n\n  const permissions = {\n    canCreateEvents,\n    canCreatePolls,\n    canCreateTasks,\n    canCreateResources\n  };\n\n  const availableTools = DEFAULT_TOOLS.filter(tool => permissions[tool.permission]);\n\n  const handleToolClick = (toolId: string) => {\n    setActiveModal(toolId);\n  };\n\n  const handleToolComplete = (toolType: string, data: any) => {\n    setActiveModal(null);\n    onToolUsed?.(toolType, data);\n  };\n\n  return (\n    <>\n      <Card className=\"bg-gray-900/50 border-gray-800 p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h4 className=\"font-semibold text-white flex items-center gap-2\">\n            <Zap className=\"w-4 h-4 text-[var(--hive-brand-primary)]\" />\n            Quick Tools\n          </h4>\n        </div>\n\n        {availableTools.length > 0 ? (\n          <div className=\"grid grid-cols-2 gap-2\">\n            {availableTools.map(tool => {\n              const IconComponent = tool.icon;\n              return (\n                <Button\n                  key={tool.id}\n                  variant=\"outline\"\n                  className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white hover:border-gray-600 flex flex-col items-center gap-1 h-auto py-3\"\n                  onClick={() => handleToolClick(tool.id)}\n                >\n                  <IconComponent className={`w-5 h-5 ${tool.color}`} />\n                  <span className=\"text-xs\">{tool.name}</span>\n                </Button>\n              );\n            })}\n          </div>\n        ) : (\n          <div className=\"text-center py-4\">\n            <Settings className=\"w-8 h-8 text-gray-600 mx-auto mb-2\" />\n            <p className=\"text-xs text-gray-400\">No tools available</p>\n            <p className=\"text-xs text-gray-500\">Contact space leaders</p>\n          </div>\n        )}\n      </Card>\n\n      {/* Tool Modals */}\n      {activeModal && (\n        <ToolModal\n          toolId={activeModal}\n          spaceId={spaceId}\n          onClose={() => setActiveModal(null)}\n          onComplete={handleToolComplete}\n        />\n      )}\n    </>\n  );\n}\n\nfunction ToolModal({\n  toolId,\n  spaceId,\n  onClose,\n  onComplete\n}: {\n  toolId: string;\n  spaceId: string;\n  onClose: () => void;\n  onComplete: (toolType: string, data: any) => void;\n}) {\n  const tool = DEFAULT_TOOLS.find(t => t.id === toolId);\n  if (!tool) return null;\n\n  switch (toolId) {\n    case 'event':\n      return (\n        <EventCreationModal\n          spaceId={spaceId}\n          onClose={onClose}\n          onComplete={onComplete}\n        />\n      );\n    case 'poll':\n      return (\n        <PollCreationModal\n          spaceId={spaceId}\n          onClose={onClose}\n          onComplete={onComplete}\n        />\n      );\n    case 'task':\n      return (\n        <TaskCreationModal\n          spaceId={spaceId}\n          onClose={onClose}\n          onComplete={onComplete}\n        />\n      );\n    case 'resource':\n      return (\n        <ResourceCreationModal\n          spaceId={spaceId}\n          onClose={onClose}\n          onComplete={onComplete}\n        />\n      );\n    default:\n      return null;\n  }\n}\n\nfunction ModalShell({\n  onClose,\n  title,\n  children,\n  maxWidth = 'max-w-2xl'\n}: {\n  onClose: () => void;\n  title: string;\n  children: ReactNode;\n  maxWidth?: string;\n}) {\n  return (\n    <Dialog\n      open\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <DialogContent className={maxWidth}>\n        <h2 className=\"text-2xl font-semibold text-white mb-4\">{title}</h2>\n        {children}\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction EventCreationModal({\n  spaceId,\n  onClose,\n  onComplete\n}: {\n  spaceId: string;\n  onClose: () => void;\n  onComplete: (toolType: string, data: any) => void;\n}) {\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    startDate: '',\n    startTime: '',\n    endDate: '',\n    endTime: '',\n    location: '',\n    maxAttendees: '',\n    requireRsvp: true,\n    template: 'custom'\n  });\n\n  const templates = {\n    meeting: {\n      title: 'Weekly Meeting',\n      description: 'Regular team meeting to discuss updates and plan ahead.',\n      requireRsvp: true\n    },\n    social: {\n      title: 'Social Gathering',\n      description: 'Come hang out and get to know fellow members!',\n      requireRsvp: false\n    },\n    workshop: {\n      title: 'Workshop',\n      description: 'Educational workshop for skill building.',\n      requireRsvp: true\n    }\n  };\n\n  const handleTemplateSelect = (template: keyof typeof templates) => {\n    const templateData = templates[template];\n    setFormData(prev => ({\n      ...prev,\n      ...templateData,\n      template\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const eventData = {\n        ...formData,\n        startTime: new Date(`${formData.startDate}T${formData.startTime}`),\n        endTime: formData.endDate && formData.endTime\n          ? new Date(`${formData.endDate}T${formData.endTime}`)\n          : undefined,\n        maxAttendees: formData.maxAttendees ? parseInt(formData.maxAttendees) : undefined\n      };\n\n      const response = await api.post<{ event: any }>(`/api/spaces/${spaceId}/events`, eventData);\n      onComplete('event', response.event);\n    } catch (error) {\n      console.error('Failed to create event:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <ModalShell onClose={onClose} title=\"Create Event\">\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Templates */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">\n            Quick Templates\n          </label>\n          <div className=\"grid grid-cols-3 gap-2\">\n            {Object.entries(templates).map(([key, template]) => (\n              <Button\n                key={key}\n                type=\"button\"\n                variant={formData.template === key ? 'default' : 'outline'}\n                className=\"max-w-sm text-xs\"\n                onClick={() => handleTemplateSelect(key as keyof typeof templates)}\n              >\n                {key.charAt(0).toUpperCase() + key.slice(1)}\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        {/* Title */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Event Title *\n          </label>\n          <Input\n            value={formData.title}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, title: e.target.value }))}\n            placeholder=\"Enter event title\"\n            required\n          />\n        </div>\n\n        {/* Description */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Description\n          </label>\n          <Textarea\n            value={formData.description}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n              setFormData(prev => ({ ...prev, description: e.target.value }))}\n            placeholder=\"Event description...\"\n            rows={3}\n          />\n        </div>\n\n        {/* Date & Time */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Start Date *\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.startDate}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, startDate: e.target.value }))}\n              required\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Start Time *\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.startTime}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, startTime: e.target.value }))}\n              required\n            />\n          </div>\n        </div>\n\n        {/* Optional End Time */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              End Date\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.endDate}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, endDate: e.target.value }))}\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              End Time\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.endTime}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, endTime: e.target.value }))}\n            />\n          </div>\n        </div>\n\n        {/* Location */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Location\n          </label>\n          <Input\n            value={formData.location}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, location: e.target.value }))}\n            placeholder=\"Event location or 'Online'\"\n          />\n        </div>\n\n        {/* Options */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Max Attendees\n            </label>\n            <Input\n              type=\"number\"\n              value={formData.maxAttendees}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, maxAttendees: e.target.value }))}\n              placeholder=\"Leave empty for unlimited\"\n            />\n          </div>\n          <div className=\"flex items-center gap-2 pt-6\">\n            <input\n              type=\"checkbox\"\n              id=\"requireRsvp\"\n              checked={formData.requireRsvp}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, requireRsvp: e.target.checked }))}\n              className=\"rounded\"\n            />\n            <label htmlFor=\"requireRsvp\" className=\"text-sm text-white\">\n              Require RSVP\n            </label>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-3 pt-4\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onClose}\n            className=\"flex-1\"\n          >\n            Cancel\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={loading || !formData.title || !formData.startDate || !formData.startTime}\n            className=\"flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            {loading ? 'Creating...' : 'Create Event'}\n          </Button>\n        </div>\n      </form>\n    </ModalShell>\n  );\n}\n\nfunction PollCreationModal({\n  spaceId,\n  onClose,\n  onComplete\n}: {\n  spaceId: string;\n  onClose: () => void;\n  onComplete: (toolType: string, data: any) => void;\n}) {\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    question: '',\n    options: ['', ''],\n    allowMultiple: false,\n    anonymous: false,\n    endDate: '',\n    endTime: ''\n  });\n\n  const addOption = () => {\n    if (formData.options.length < 5) {\n      setFormData(prev => ({\n        ...prev,\n        options: [...prev.options, '']\n      }));\n    }\n  };\n\n  const removeOption = (index: number) => {\n    if (formData.options.length > 2) {\n      setFormData(prev => ({\n        ...prev,\n        options: prev.options.filter((_, i) => i !== index)\n      }));\n    }\n  };\n\n  const updateOption = (index: number, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      options: prev.options.map((opt, i) => i === index ? value : opt)\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const pollData = {\n        ...formData,\n        options: formData.options.filter(opt => opt.trim()),\n        endTime: formData.endDate && formData.endTime\n          ? new Date(`${formData.endDate}T${formData.endTime}`)\n          : undefined\n      };\n\n      const response = await api.post<{ poll: any }>(`/api/spaces/${spaceId}/polls`, pollData);\n      onComplete('poll', response.poll);\n    } catch (error) {\n      console.error('Failed to create poll:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const isValid = formData.question.trim() &&\n    formData.options.filter(opt => opt.trim()).length >= 2;\n\n  return (\n    <ModalShell onClose={onClose} title=\"Create Poll\" maxWidth=\"max-w-lg\">\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Question */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Poll Question *\n          </label>\n          <Input\n            value={formData.question}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, question: e.target.value }))}\n            placeholder=\"What would you like to ask?\"\n            required\n          />\n        </div>\n\n        {/* Options */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">\n            Options (2-5) *\n          </label>\n          <div className=\"space-y-2\">\n            {formData.options.map((option, index) => (\n              <div key={index} className=\"flex gap-2\">\n                <Input\n                  value={option}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                    updateOption(index, e.target.value)}\n                  placeholder={`Option ${index + 1}`}\n                  className=\"flex-1\"\n                />\n                {formData.options.length > 2 && (\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    className=\"max-w-sm border-red-600 text-red-400\"\n                    onClick={() => removeOption(index)}\n                  >\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                )}\n              </div>\n            ))}\n            {formData.options.length < 5 && (\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"max-w-sm w-full border-dashed border-gray-600\"\n                onClick={addOption}\n              >\n                <Plus className=\"w-4 h-4 mr-1\" />\n                Add Option\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Settings */}\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              id=\"allowMultiple\"\n              checked={formData.allowMultiple}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, allowMultiple: e.target.checked }))}\n              className=\"rounded\"\n            />\n            <label htmlFor=\"allowMultiple\" className=\"text-sm text-white\">\n              Allow multiple choices\n            </label>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              id=\"anonymous\"\n              checked={formData.anonymous}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, anonymous: e.target.checked }))}\n              className=\"rounded\"\n            />\n            <label htmlFor=\"anonymous\" className=\"text-sm text-white\">\n              Anonymous voting\n            </label>\n          </div>\n        </div>\n\n        {/* End Time */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">\n            Auto-close (optional)\n          </label>\n          <div className=\"grid grid-cols-2 gap-2\">\n            <Input\n              type=\"date\"\n              value={formData.endDate}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, endDate: e.target.value }))}\n              placeholder=\"End date\"\n            />\n            <Input\n              type=\"time\"\n              value={formData.endTime}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, endTime: e.target.value }))}\n              placeholder=\"End time\"\n            />\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-3 pt-4\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onClose}\n            className=\"flex-1\"\n          >\n            Cancel\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={loading || !isValid}\n            className=\"flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            {loading ? 'Creating...' : 'Create Poll'}\n          </Button>\n        </div>\n      </form>\n    </ModalShell>\n  );\n}\n\nfunction TaskCreationModal({\n  spaceId,\n  onClose,\n  onComplete\n}: {\n  spaceId: string;\n  onClose: () => void;\n  onComplete: (toolType: string, data: any) => void;\n}) {\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    dueDate: '',\n    dueTime: '',\n    priority: 'medium' as 'low' | 'medium' | 'high',\n    assignTo: 'volunteer' as 'volunteer' | 'specific',\n    assigneeId: ''\n  });\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const taskData = {\n        ...formData,\n        dueTime: formData.dueDate && formData.dueTime\n          ? new Date(`${formData.dueDate}T${formData.dueTime}`)\n          : undefined\n      };\n\n      const response = await api.post<{ task: any }>(`/api/spaces/${spaceId}/tasks`, taskData);\n      onComplete('task', response.task);\n    } catch (error) {\n      console.error('Failed to create task:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <ModalShell onClose={onClose} title=\"Create Task\" maxWidth=\"max-w-lg\">\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Title */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Task Title *\n          </label>\n          <Input\n            value={formData.title}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n              setFormData(prev => ({ ...prev, title: e.target.value }))}\n            placeholder=\"What needs to be done?\"\n            required\n          />\n        </div>\n\n        {/* Description */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-1\">\n            Description\n          </label>\n          <Textarea\n            value={formData.description}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n              setFormData(prev => ({ ...prev, description: e.target.value }))}\n            placeholder=\"Task details and requirements...\"\n            rows={3}\n          />\n        </div>\n\n        {/* Due Date */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Due Date\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.dueDate}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, dueDate: e.target.value }))}\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Due Time\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.dueTime}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, dueTime: e.target.value }))}\n            />\n          </div>\n        </div>\n\n        {/* Priority */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">\n            Priority\n          </label>\n          <div className=\"grid grid-cols-3 gap-2\">\n            {(['low', 'medium', 'high'] as const).map(priority => (\n              <Button\n                key={priority}\n                type=\"button\"\n                variant={formData.priority === priority ? 'default' : 'outline'}\n                className={`max-w-sm text-xs ${\n                  priority === 'low' ? 'border-green-600 text-green-400' :\n                  priority === 'medium' ? 'border-yellow-600 text-yellow-400' :\n                  'border-red-600 text-red-400'\n                }`}\n                onClick={() => setFormData(prev => ({ ...prev, priority }))}\n              >\n                {priority.charAt(0).toUpperCase() + priority.slice(1)}\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        {/* Assignment */}\n        <div>\n          <label className=\"block text-sm font-medium text-white mb-2\">\n            Assignment\n          </label>\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-2\">\n              <input\n                type=\"radio\"\n                id=\"volunteer\"\n                name=\"assignTo\"\n                checked={formData.assignTo === 'volunteer'}\n                onChange={() => setFormData(prev => ({ ...prev, assignTo: 'volunteer' }))}\n              />\n              <label htmlFor=\"volunteer\" className=\"text-sm text-white\">\n                Open for volunteers\n              </label>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <input\n                type=\"radio\"\n                id=\"specific\"\n                name=\"assignTo\"\n                checked={formData.assignTo === 'specific'}\n                onChange={() => setFormData(prev => ({ ...prev, assignTo: 'specific' }))}\n              />\n              <label htmlFor=\"specific\" className=\"text-sm text-white\">\n                Assign to specific member\n              </label>\n            </div>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-3 pt-4\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onClose}\n            className=\"flex-1\"\n          >\n            Cancel\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={loading || !formData.title}\n            className=\"flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            {loading ? 'Creating...' : 'Create Task'}\n          </Button>\n        </div>\n      </form>\n    </ModalShell>\n  );\n}\n\nfunction ResourceCreationModal({\n  spaceId,\n  onClose,\n  onComplete\n}: {\n  spaceId: string;\n  onClose: () => void;\n  onComplete: (toolType: string, data: any) => void;\n}) {\n  const [loading, setLoading] = useState(false);\n  const [mode, setMode] = useState<'upload' | 'link'>('upload');\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    url: '',\n    tags: '',\n    file: null as File | null\n  });\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setFormData(prev => ({\n        ...prev,\n        file,\n        title: prev.title || file.name.split('.')[0]\n      }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      if (mode === 'upload' && formData.file) {\n        const uploadFormData = new FormData();\n        uploadFormData.append('file', formData.file);\n        uploadFormData.append('title', formData.title);\n        uploadFormData.append('description', formData.description);\n        uploadFormData.append('tags', formData.tags);\n\n        const response = await api.post<{ resource: any }>(`/api/spaces/${spaceId}/resources`, uploadFormData, {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        });\n        onComplete('resource', response.resource);\n      } else if (mode === 'link' && formData.url) {\n        const linkData = {\n          title: formData.title,\n          description: formData.description,\n          url: formData.url,\n          tags: formData.tags.split(',').map(t => t.trim()).filter(Boolean),\n          type: 'link'\n        };\n\n        const response = await api.post<{ resource: any }>(`/api/spaces/${spaceId}/resources`, linkData);\n        onComplete('resource', response.resource);\n      }\n    } catch (error) {\n      console.error('Failed to create resource:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const isValid = mode === 'upload'\n    ? formData.file && formData.title\n    : formData.url && formData.title;\n\n  return (\n    <ModalShell onClose={onClose} title=\"Add Resource\" maxWidth=\"max-w-lg\">\n      <div className=\"space-y-4\">\n        {/* Mode Selection */}\n        <Tabs value={mode} onValueChange={(v) => setMode(v as any)}>\n          <TabsList className=\"bg-gray-800 border-gray-700 w-full\">\n            <TabsTrigger value=\"upload\" className=\"flex-1\">\n              Upload File\n            </TabsTrigger>\n            <TabsTrigger value=\"link\" className=\"flex-1\">\n              Add Link\n            </TabsTrigger>\n          </TabsList>\n        </Tabs>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {mode === 'upload' ? (\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-1\">\n                File *\n              </label>\n              <input\n                type=\"file\"\n                onChange={handleFileSelect}\n                className=\"w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:bg-[var(--hive-brand-primary)] file:text-black hover:file:bg-yellow-400\"\n                accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.png,.gif,.mp4,.mp3\"\n                required\n              />\n              {formData.file && (\n                <p className=\"text-xs text-gray-400 mt-1\">\n                  Selected: {formData.file.name}\n                </p>\n              )}\n            </div>\n          ) : (\n            <div>\n              <label className=\"block text-sm font-medium text-white mb-1\">\n                URL *\n              </label>\n              <Input\n                type=\"url\"\n                value={formData.url}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                  setFormData(prev => ({ ...prev, url: e.target.value }))}\n                placeholder=\"https://example.com/resource\"\n                required\n              />\n            </div>\n          )}\n\n          {/* Title */}\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Title *\n            </label>\n            <Input\n              value={formData.title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, title: e.target.value }))}\n              placeholder=\"Resource title\"\n              required\n            />\n          </div>\n\n          {/* Description */}\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Description\n            </label>\n            <Textarea\n              value={formData.description}\n              onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                setFormData(prev => ({ ...prev, description: e.target.value }))}\n              placeholder=\"What is this resource for?\"\n              rows={2}\n            />\n          </div>\n\n          {/* Tags */}\n          <div>\n            <label className=\"block text-sm font-medium text-white mb-1\">\n              Tags\n            </label>\n            <Input\n              value={formData.tags}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData(prev => ({ ...prev, tags: e.target.value }))}\n              placeholder=\"study, notes, exam (comma separated)\"\n            />\n          </div>\n\n          {/* Actions */}\n        <div className=\"flex gap-3 pt-4\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onClose}\n            className=\"flex-1\"\n          >\n            Cancel\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={loading || !isValid}\n            className=\"flex-1 bg-[var(--hive-brand-primary)] text-black hover:bg-yellow-400\"\n          >\n            {loading ? 'Adding...' : `Add ${mode === 'upload' ? 'File' : 'Link'}`}\n          </Button>\n        </div>\n      </form>\n    </div>\n    </ModalShell>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/spaces/unified-space-interface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useParams' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'canUserJoinSpace' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSpaceData'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [spaceId, spaceData, loadSpaceData]","fix":{"range":[1818,1838],"text":"[spaceId, spaceData, loadSpaceData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleRealtimeMessage'. Either include it or remove the dependency array.","line":157,"column":6,"nodeType":"ArrayExpression","endLine":157,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [handleRealtimeMessage, spaceId]","fix":{"range":[4126,4135],"text":"[handleRealtimeMessage, spaceId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'spaceData.space.spaceType'. Either include it or remove the dependency array.","line":243,"column":6,"nodeType":"ArrayExpression","endLine":243,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [spaceData.space.spaceType, spaceData.space?.type]","fix":{"range":[6821,6845],"text":"[spaceData.space.spaceType, spaceData.space?.type]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'effectivePermissions' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":265,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":265,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toolId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":507,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":507,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'action' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":507,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":507,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toolId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":537,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":537,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'action' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":537,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":537,"endColumn":53}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useParams } from 'next/navigation';\nimport {\n  Hash,\n  Users,\n  Calendar,\n  Settings,\n  Bell,\n  Share,\n  ChevronLeft,\n  ChevronRight,\n  Menu,\n  X\n} from 'lucide-react';\nimport {\n  Card,\n  Button,\n  Badge,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent\n} from '@hive/ui';\nimport type { Space, User } from '@hive/core';\nimport { SpacePostFeed } from './space-post-feed';\nimport { SpaceMemberList } from './space-member-list';\nimport { SpaceEventCalendar } from './space-event-calendar';\nimport { SpaceContextPanel } from './space-context-panel';\nimport { SpaceToolRenderer } from './space-tool-renderer';\nimport {\n  getSpaceTypeRules,\n  canUserJoinSpace,\n  type SpaceType\n} from '@/lib/space-type-rules';\nimport {\n  resolveUserPermissions,\n  hasPermission,\n  type UserPermissions\n} from '@/lib/permission-system';\nimport { api } from '@/lib/api-client';\nimport { spaceNameToString } from '@/lib/mappers/space-mapper';\n\ninterface UnifiedSpaceInterfaceProps {\n  spaceId: string;\n  initialData?: {\n    space: Space;\n    userMembership: any;\n    onlineMembers: User[];\n  };\n}\n\nexport function UnifiedSpaceInterface({\n  spaceId,\n  initialData\n}: UnifiedSpaceInterfaceProps) {\n  const [spaceData, setSpaceData] = useState(initialData);\n  const [loading, setLoading] = useState(!initialData);\n  const [activeTab, setActiveTab] = useState('posts');\n  const [contextPanelVisible, setContextPanelVisible] = useState(true);\n  const [installedTools, setInstalledTools] = useState<any[]>([]);\n  const [realtimeConnected, setRealtimeConnected] = useState(false);\n  const [onlineMembers, setOnlineMembers] = useState<User[]>([]);\n\n  // Load space data if not provided\n  useEffect(() => {\n    if (!spaceData && spaceId) {\n      loadSpaceData();\n    }\n  }, [spaceId, spaceData]);\n\n  // Set up realtime connection for this space with proper cleanup\n  useEffect(() => {\n    if (!spaceId) return;\n\n    let eventSource: EventSource | null = null;\n    let timeoutId: NodeJS.Timeout | null = null;\n    let reconnectTimeoutId: NodeJS.Timeout | null = null;\n    let isUnmounted = false;\n\n    const connectToRealtime = () => {\n      // Don't connect if component is unmounted\n      if (isUnmounted) return;\n\n      try {\n        // Subscribe to space-specific channels\n        const channels = [\n          `space:${spaceId}:presence`,\n          `space:${spaceId}:activity`,\n          `space:${spaceId}:tools`\n        ];\n\n        const url = `/api/realtime/sse?channels=${channels.join(',')}`;\n        eventSource = new EventSource(url);\n\n        eventSource.onopen = () => {\n          if (!isUnmounted) {\n            setRealtimeConnected(true);\n          }\n        };\n\n        eventSource.onmessage = (event) => {\n          if (isUnmounted) return;\n\n          try {\n            const data = JSON.parse(event.data);\n            handleRealtimeMessage(data);\n          } catch (error) {\n            // Intentionally suppressed - non-critical error\n          }\n        };\n\n        eventSource.onerror = (error) => {\n          if (!isUnmounted) {\n            setRealtimeConnected(false);\n\n            // Clean up current connection\n            eventSource?.close();\n            eventSource = null;\n\n            // Attempt reconnection with exponential backoff\n            reconnectTimeoutId = setTimeout(() => {\n              if (!isUnmounted) {\n                connectToRealtime();\n              }\n            }, 3000);\n          }\n        };\n\n      } catch (error) {\n        if (!isUnmounted) {\n          setRealtimeConnected(false);\n        }\n      }\n    };\n\n    // Connect after a short delay to ensure space data is loaded\n    timeoutId = setTimeout(connectToRealtime, 1000);\n\n    return () => {\n      // Mark component as unmounted\n      isUnmounted = true;\n\n      // Clear all timeouts\n      if (timeoutId) clearTimeout(timeoutId);\n      if (reconnectTimeoutId) clearTimeout(reconnectTimeoutId);\n\n      // Close EventSource connection\n      if (eventSource) {\n        eventSource.close();\n        eventSource = null;\n      }\n\n      setRealtimeConnected(false);\n    };\n  }, [spaceId]);\n\n  // Handle realtime messages\n  const handleRealtimeMessage = (data: any) => {\n    switch (data.type) {\n      case 'presence':\n        if (data.data?.status === 'online' && data.data?.currentSpace === spaceId) {\n          // Add user to online members if not already there\n          setOnlineMembers(prev => {\n            const exists = prev.some(member => member.id === data.data.userId);\n            if (!exists) {\n              // In real implementation, fetch user data\n              const newMember = {\n                id: data.data.userId,\n                fullName: 'Online User',\n                handle: 'user',\n                email: ''\n              } as User;\n              return [...prev, newMember];\n            }\n            return prev;\n          });\n        } else if (data.data?.status === 'offline') {\n          // Remove user from online members\n          setOnlineMembers(prev => prev.filter(member => member.id !== data.data.userId));\n        }\n        break;\n\n      case 'tool_update':\n        // Refresh tools when there's a tool update\n        if (data.data?.spaceId === spaceId) {\n          loadSpaceData();\n        }\n        break;\n\n      case 'space_activity':\n        // Handle space activity updates (new posts, events, etc.)\n        break;\n\n      default:\n    }\n  };\n\n  const loadSpaceData = async () => {\n    try {\n      setLoading(true);\n      const [spaceDetails, membershipDetails, toolsDetails] = await Promise.all([\n        api.spaces.get<Space>(spaceId),\n        api.spaces.membership.get<{ requestingUser?: any }>(spaceId),\n        api.spaces.tools.list<{ tools?: any[] }>(spaceId)\n      ]);\n\n      setSpaceData({\n        space: spaceDetails,\n        userMembership: membershipDetails?.requestingUser ?? null,\n        onlineMembers\n      });\n\n      const transformedTools = (toolsDetails.tools || []).map((tool: any) => ({\n        id: tool.deploymentId,\n        toolId: tool.toolId,\n        name: tool.name,\n        description: tool.description,\n        category: tool.category,\n        status: tool.status,\n        icon: 'üîß',\n        position: 'both',\n        configuration: tool.configuration,\n        permissions: tool.permissions,\n        deployer: tool.deployer,\n        deployedAt: tool.deployedAt,\n        lastUsed: tool.lastUsed,\n        usageCount: tool.usageCount\n      }));\n      setInstalledTools(transformedTools);\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Get space type rules\n  const spaceRules = useMemo(() => {\n    if (!spaceData?.space?.type) return null;\n    return getSpaceTypeRules(spaceData.space.spaceType as SpaceType);\n  }, [spaceData?.space?.type]);\n\n  // Determine user permissions using unified permission system\n  const userPermissions = useMemo((): UserPermissions => {\n    if (!spaceData?.userMembership) {\n      return {\n        id: '',\n        spaceId: spaceId,\n        role: 'guest'\n      };\n    }\n\n    const membership = spaceData.userMembership;\n    return {\n      id: membership.userId || '',\n      spaceId: spaceId,\n      role: membership.role || 'member',\n      customPermissions: membership.permissions?.map((p: string) => p as any) || undefined\n    };\n  }, [spaceData?.userMembership, spaceId]);\n\n  // Resolve effective permissions for the user\n  const effectivePermissions = useMemo(() => {\n    if (!spaceRules) return [];\n    return resolveUserPermissions(userPermissions, spaceData?.space?.type as SpaceType, spaceRules);\n  }, [userPermissions, spaceData?.space?.type, spaceRules]);\n\n  // Create simplified permissions for SpaceContextPanel\n  const simplePermissions = useMemo(() => ({\n    isMember: userPermissions.role !== 'guest',\n    isAdmin: userPermissions.role === 'admin' || userPermissions.role === 'owner',\n    isModerator: userPermissions.role === 'moderator',\n    role: userPermissions.role\n  }), [userPermissions.role]);\n\n  // Filter tools based on space rules and position\n  const inlineTools = useMemo(() => {\n    return installedTools.filter(tool =>\n      tool.position === 'inline' ||\n      (tool.position === 'both')\n    );\n  }, [installedTools]);\n\n  const contextualTools = useMemo(() => {\n    return installedTools.filter(tool =>\n      tool.position === 'contextual' ||\n      (tool.position === 'both')\n    );\n  }, [installedTools]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-black to-gray-900 flex items-center justify-center\">\n        <div className=\"flex flex-col items-center gap-4\">\n          <div className=\"text-6xl animate-pulse\">üçØ</div>\n          <span className=\"text-xl text-[var(--hive-brand-primary)] animate-pulse\">Loading space...</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!spaceData?.space) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-black to-gray-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-6xl mb-4\">ü§∑</div>\n          <h2 className=\"text-2xl font-bold text-white mb-2\">Space not found</h2>\n          <p className=\"text-gray-400 mb-6\">This space might be private or you need permission to access it.</p>\n        </div>\n      </div>\n    );\n  }\n\n  const { space } = spaceData;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-black to-gray-900\">\n      {/* Space Header */}\n      <div className=\"bg-black/80 backdrop-blur-md border-b border-gray-800\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"py-6\">\n            {/* Space Identity */}\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-4 mb-3\">\n                  <div className=\"w-16 h-16 bg-gray-800 rounded-lg border-2 border-gray-700 flex items-center justify-center\">\n                    <span className=\"text-2xl\">{(space as any).avatar || 'üçØ'}</span>\n                  </div>\n                  <div>\n                    <div className=\"flex items-center gap-3 mb-1\">\n                      <h1 className=\"text-2xl font-bold text-white\">{spaceNameToString(space.name)}</h1>\n                      <Badge className=\"bg-[var(--hive-brand-primary)]/20 text-[var(--hive-brand-primary)] border-[var(--hive-brand-primary)]/30\">\n                        {space.spaceType?.replace('_', ' ')}\n                      </Badge>\n                    </div>\n                    <p className=\"text-gray-400 max-w-2xl text-sm\">\n                      {typeof space.description === 'object' && 'value' in space.description ? space.description.value : space.description}\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-6 text-sm\">\n                  <div className=\"flex items-center gap-2 text-gray-300\">\n                    <Users className=\"w-4 h-4 text-gray-500\" />\n                    <span className=\"font-semibold\">{space.memberCount || 0}</span>\n                    <span className=\"text-gray-500\">members</span>\n                  </div>\n                  <div className=\"flex items-center gap-2 text-gray-300\">\n                    <div className={`w-2 h-2 rounded-full ${realtimeConnected ? 'bg-green-500' : 'bg-gray-500'}`} />\n                    <span className=\"font-semibold\">{onlineMembers.length}</span>\n                    <span className=\"text-gray-500\">online</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex items-center gap-3\">\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm lg:hidden border-gray-700 text-gray-300\"\n                  onClick={() => setContextPanelVisible(!contextPanelVisible)}\n                >\n                  <Menu className=\"w-4 h-4\" />\n                </Button>\n\n                {userPermissions.role !== 'guest' && (\n                  <>\n                    <Button\n                      variant=\"outline\"\n                      className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n                    >\n                      <Bell className=\"w-4 h-4\" />\n                    </Button>\n\n                    {hasPermission(userPermissions, spaceData?.space?.type as SpaceType, spaceRules!, 'space:settings') && (\n                      <Button\n                        variant=\"outline\"\n                        className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n                      >\n                        <Settings className=\"w-4 h-4 mr-2\" />\n                        Settings\n                      </Button>\n                    )}\n                  </>\n                )}\n\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm border-gray-700 text-gray-300 hover:text-white\"\n                >\n                  <Share className=\"w-4 h-4 mr-2\" />\n                  Share\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content Area - 60/40 Split */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n\n          {/* Left Side - 60% - Post Board */}\n          <div className={contextPanelVisible ? 'lg:col-span-7 space-y-6' : 'lg:col-span-12 space-y-6'}>\n\n            {/* Navigation Tabs */}\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\n              <TabsList className=\"bg-gray-900 border border-gray-800 w-full\">\n                <TabsTrigger\n                  value=\"posts\"\n                  className=\"flex items-center space-x-2 data-[state=active]:bg-[var(--hive-brand-primary)] data-[state=active]:text-black\"\n                >\n                  <Hash className=\"w-4 h-4\" />\n                  <span>Posts</span>\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"members\"\n                  className=\"flex items-center space-x-2 data-[state=active]:bg-[var(--hive-brand-primary)] data-[state=active]:text-black\"\n                >\n                  <Users className=\"w-4 h-4\" />\n                  <span>Members</span>\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"events\"\n                  className=\"flex items-center space-x-2 data-[state=active]:bg-[var(--hive-brand-primary)] data-[state=active]:text-black\"\n                >\n                  <Calendar className=\"w-4 h-4\" />\n                  <span>Events</span>\n                </TabsTrigger>\n\n                {/* Dynamic Tool Tabs */}\n                {inlineTools.map(tool => (\n                  <TabsTrigger\n                    key={tool.id}\n                    value={`tool-${tool.id}`}\n                    className=\"flex items-center space-x-2 data-[state=active]:bg-[var(--hive-brand-primary)] data-[state=active]:text-black\"\n                  >\n                    <span className=\"text-xs\">{tool.icon || 'üîß'}</span>\n                    <span>{tool.name}</span>\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n\n              {/* Tab Content */}\n              <TabsContent value=\"posts\">\n                <Card className=\"bg-gray-900/50 border-gray-800 p-0 overflow-hidden\">\n                  <SpacePostFeed\n                    spaceId={spaceId}\n                    canPost={hasPermission(userPermissions, spaceData?.space?.type as SpaceType, spaceRules!, 'posts:create')}\n                    spaceRules={spaceRules}\n                  />\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"members\">\n                <Card className=\"bg-gray-900/50 border-gray-800 p-6\">\n                  <SpaceMemberList\n                    spaceId={spaceId}\n                    userMembership={spaceData.userMembership}\n                    onlineMembers={onlineMembers}\n                    spaceRules={spaceRules}\n                    onClose={() => {}}\n                  />\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"events\">\n                <Card className=\"bg-gray-900/50 border-gray-800 p-6\">\n                  <SpaceEventCalendar\n                    spaceId={spaceId}\n                    canCreateEvents={hasPermission(userPermissions, spaceData?.space?.type as SpaceType, spaceRules!, 'events:create')}\n                    spaceRules={spaceRules}\n                  />\n                </Card>\n              </TabsContent>\n\n              {/* Tool Tab Contents */}\n              {inlineTools.map(tool => (\n                <TabsContent key={tool.id} value={`tool-${tool.id}`}>\n                  <Card className=\"bg-gray-900/50 border-gray-800 p-6\">\n                    <SpaceToolRenderer\n                      tool={tool}\n                      spaceId={spaceId}\n                      userPermissions={userPermissions}\n                      spaceRules={spaceRules}\n                      position=\"inline\"\n                    />\n                  </Card>\n                </TabsContent>\n              ))}\n            </Tabs>\n          </div>\n\n          {/* Right Side - 40% - Context Panel */}\n          {contextPanelVisible && (\n            <div className=\"lg:col-span-5 space-y-6\">\n              <SpaceContextPanel\n                space={space}\n                userMembership={spaceData.userMembership}\n                onlineMembers={onlineMembers}\n                contextualTools={contextualTools}\n                userPermissions={simplePermissions}\n                spaceRules={spaceRules}\n                onToolInteraction={(toolId, action) => {\n                  // Handle tool interactions\n                }}\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Mobile Context Panel Overlay */}\n        {contextPanelVisible && (\n          <div className=\"lg:hidden fixed inset-0 z-50 bg-black/50 backdrop-blur-sm\">\n            <div className=\"absolute right-0 top-0 h-full w-80 bg-gray-900 border-l border-gray-800 overflow-y-auto\">\n              <div className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold text-white\">Space Info</h3>\n                  <Button\n                    variant=\"outline\"\n                    className=\"max-w-sm\"\n                    onClick={() => setContextPanelVisible(false)}\n                  >\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n                <SpaceContextPanel\n                  space={space}\n                  userMembership={spaceData.userMembership}\n                  onlineMembers={onlineMembers}\n                  contextualTools={contextualTools}\n                  userPermissions={simplePermissions}\n                  spaceRules={spaceRules}\n                  onToolInteraction={(toolId, action) => {\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/temp-stubs.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'size' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":91,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":7}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n// Force dynamic rendering to avoid SSG issues with hooks\nexport const dynamic = 'force-dynamic';\n\n// Temporary stub components to unblock production build\n// TODO: Fix @hive/ui export resolution and remove these stubs\n\nimport React from 'react';\nimport Image from 'next/image';\n\nexport function PageContainer({ \n  children, \n  title, \n  subtitle, \n  className = \"\",\n  ...props \n}: {\n  children: React.ReactNode;\n  title?: string;\n  subtitle?: string;\n  className?: string;\n  [key: string]: any;\n}) {\n  return (\n    <div className={`w-full max-w-6xl mx-auto px-4 sm:px-6 py-6 ${className}`} {...props}>\n      {title && (\n        <div className=\"mb-6\">\n          <h1 className=\"text-2xl font-bold text-white mb-2\">{title}</h1>\n          {subtitle && <p className=\"text-gray-400\">{subtitle}</p>}\n        </div>\n      )}\n      {children}\n    </div>\n  );\n}\n\nexport function Alert({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return (\n    <div className={`p-4 border rounded-lg bg-yellow-50 border-yellow-200 text-yellow-800 ${className}`}>\n      {children}\n    </div>\n  );\n}\n\nexport function AlertDescription({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return <div className={`text-sm ${className}`}>{children}</div>;\n}\n\n// Header components stubs\nexport function LandingPageHeader() {\n  return (\n    <div className=\"bg-black border-b border-white/10 p-4\">\n      <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n        <div className=\"flex items-center space-x-2\">\n          <div className=\"w-8 h-8 flex items-center justify-center\">\n            <Image\n              src=\"/assets/hive-logo-white.svg\"\n              alt=\"HIVE Logo\"\n              width={32}\n              height={32}\n              className=\"w-8 h-8\"\n            />\n          </div>\n          <div className=\"text-xl font-bold text-white\">HIVE</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function SchoolsPageHeader(props: any) {\n  return <LandingPageHeader />;\n}\n\nexport function AuthPageHeader() {\n  return <LandingPageHeader />;\n}\n\nexport function DashboardPageHeader() {\n  return <LandingPageHeader />;\n}\n\n// Modal component stubs\nexport function HiveModal({ \n  children, \n  open, \n  isOpen, \n  onOpenChange, \n  onClose, \n  size,\n  title,\n  showCloseButton \n}: { \n  children: React.ReactNode; \n  open?: boolean; \n  isOpen?: boolean;\n  onOpenChange?: () => void; \n  onClose?: () => void;\n  size?: string;\n  title?: string;\n  showCloseButton?: boolean;\n}) {\n  const modalIsOpen = open ?? isOpen ?? false;\n  const handleClose = onOpenChange || onClose || (() => {});\n  \n  if (!modalIsOpen) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\" onClick={handleClose}>\n      <div className=\"bg-white rounded-lg shadow-lg max-w-md w-full mx-4\" onClick={(e: React.MouseEvent) => e.stopPropagation()}>\n        {title && (\n          <div className=\"p-4 border-b border-gray-200 flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold\">{title}</h2>\n            {showCloseButton && (\n              <button onClick={handleClose} className=\"text-gray-500 hover:text-gray-700\">\n                √ó\n              </button>\n            )}\n          </div>\n        )}\n        {children}\n      </div>\n    </div>\n  );\n}\n\nexport function HiveModalContent({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return <div className={`p-6 ${className}`}>{children}</div>;\n}\n\nexport function HiveModalHeader({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return <div className={`mb-4 ${className}`}>{children}</div>;\n}\n\nexport function HiveModalTitle({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return <h2 className={`text-lg font-semibold ${className}`}>{children}</h2>;\n}\n\nexport function HiveModalFooter({ children, className = \"\" }: { children: React.ReactNode; className?: string }) {\n  return <div className={`mt-6 flex gap-3 ${className}`}>{children}</div>;\n}\n\nexport function CompleteHIVEToolsSystem({\n  tools = [],\n  onToolCreate,\n  showCreateButton,\n  showSearch,\n  showFilters,\n  className = \"\",\n}: {\n  tools?: Array<{\n    id: string;\n    name: string;\n    description?: string;\n    tags?: string[];\n    category?: string;\n    isFeatured?: boolean;\n  }>;\n  onToolCreate?: (mode?: \"visual\" | \"template\" | \"wizard\") => void;\n  showCreateButton?: boolean;\n  showSearch?: boolean;\n  showFilters?: boolean;\n  className?: string;\n}) {\n  return (\n    <div\n      className={`rounded-xl border border-white/10 bg-black/60 p-6 shadow-lg shadow-black/30 text-white ${className}`}\n    >\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-semibold\">HIVE Tools Library</h2>\n          <p className=\"text-sm text-white/60\">\n            Browse featured tools while the full design system is being restored.\n          </p>\n        </div>\n        {showCreateButton && onToolCreate && (\n          <button\n            onClick={() => onToolCreate(\"visual\")}\n            className=\"inline-flex items-center justify-center rounded-lg bg-yellow-400 px-4 py-2 text-black transition hover:bg-yellow-300\"\n          >\n            Launch Builder\n          </button>\n        )}\n      </div>\n\n      {(showSearch || showFilters) && (\n        <div className=\"mt-6 grid gap-3 md:grid-cols-2\">\n          {showSearch && (\n            <input\n              className=\"rounded-lg border border-white/10 bg-black/40 px-3 py-2 text-sm text-white placeholder:text-white/40 focus:border-yellow-400 focus:outline-none\"\n              placeholder=\"Search tools...\"\n              disabled\n            />\n          )}\n          {showFilters && (\n            <div className=\"flex flex-wrap gap-2\">\n              {[\"All\", \"Academic\", \"Social\", \"Events\", \"Services\"].map((filter) => (\n                <span\n                  key={filter}\n                  className=\"rounded-full border border-white/10 px-3 py-1 text-xs uppercase tracking-wide text-white/60\"\n                >\n                  {filter}\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className=\"mt-6 grid gap-4 md:grid-cols-2\">\n        {tools.slice(0, 6).map((tool) => (\n          <div\n            key={tool.id}\n            className=\"rounded-lg border border-white/10 bg-black/40 p-4 transition hover:border-yellow-400/70\"\n          >\n            <div className=\"flex items-start justify-between gap-3\">\n              <div>\n                <h3 className=\"text-lg font-semibold\">{tool.name}</h3>\n                {tool.description && (\n                  <p className=\"mt-1 text-sm text-white/60 line-clamp-2\">{tool.description}</p>\n                )}\n              </div>\n              {tool.isFeatured && (\n                <span className=\"rounded-full bg-yellow-400/20 px-2 py-1 text-xs font-medium text-yellow-300\">\n                  Featured\n                </span>\n              )}\n            </div>\n            {tool.tags && tool.tags.length > 0 && (\n              <div className=\"mt-3 flex flex-wrap gap-2\">\n                {tool.tags.slice(0, 3).map((tag) => (\n                  <span\n                    key={tag}\n                    className=\"rounded-full border border-white/10 px-2 py-0.5 text-xs text-white/60\"\n                  >\n                    #{tag}\n                  </span>\n                ))}\n              </div>\n            )}\n          </div>\n        ))}\n        {tools.length === 0 && (\n          <div className=\"rounded-lg border border-dashed border-white/10 p-6 text-center text-white/60\">\n            No tools available yet. Add templates in `campus-tools-templates.ts`.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function WelcomeMat({\n  onDismiss,\n  userName,\n}: {\n  onDismiss?: () => void;\n  userName?: string;\n}) {\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/70 p-4\">\n      <div className=\"w-full max-w-lg rounded-2xl border border-white/10 bg-[#0F0F10] p-6 text-white shadow-2xl shadow-black/30\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div>\n            <h2 className=\"text-2xl font-bold\">\n              Welcome back{userName ? `, ${userName}` : \"\"}!\n            </h2>\n            <p className=\"mt-2 text-sm text-white/60\">\n              The guided onboarding experience is temporarily simplified while UI exports are restored.\n            </p>\n          </div>\n          {onDismiss && (\n            <button\n              aria-label=\"Dismiss welcome\"\n              onClick={onDismiss}\n              className=\"rounded-full border border-white/10 p-2 text-white/60 transition hover:text-white\"\n            >\n              √ó\n            </button>\n          )}\n        </div>\n        <div className=\"mt-6 space-y-3 text-sm text-white/70\">\n          <p>‚Ä¢ Discover new spaces and tools curated for your campus.</p>\n          <p>‚Ä¢ Track progress in your Rituals and HiveLab creations.</p>\n          <p>‚Ä¢ Stay tuned for the full Welcome Mat experience returning soon.</p>\n        </div>\n        <div className=\"mt-6 flex justify-end\">\n          <button\n            onClick={onDismiss}\n            className=\"rounded-lg bg-yellow-400 px-4 py-2 text-black transition hover:bg-yellow-300\"\n          >\n            Got it\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Hook stubs\nexport function useOnboardingBridge() {\n  return {\n    currentStep: 0,\n    totalSteps: 8,\n    nextStep: () => {},\n    prevStep: () => {},\n    completeOnboarding: () => {},\n    isLoading: false,\n    error: null\n  };\n}\n\n// Type stubs for missing @hive/ui types\nexport interface User {\n  id: string;\n  handle: string;\n  name: string;\n  email: string;\n  avatar?: string;\n  school: string;\n  preferences: {\n    privacy: 'public' | 'private' | 'friends-only';\n    notifications: boolean;\n  };\n  isPrivate: boolean;\n}\n\nexport interface Space {\n  id: string;\n  name: string;\n  description: string;\n  type: string;\n  memberCount: number;\n}\n\nexport interface Event {\n  id: string;\n  title: string;\n  description: string;\n  date: string;\n  location?: string;\n}\n\nexport interface Connection {\n  id: string;\n  userId: string;\n  connectedUserId: string;\n  type: 'friend' | 'follow';\n}\n\nexport interface HiveLabSection {\n  id: string;\n  title: string;\n  description: string;\n  tools: any[];\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/element-renderers.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Progress' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":9}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { \n  Input, \n  Button, \n  Card, \n  CardContent,\n  Badge,\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n  Progress\n} from '@hive/ui';\nimport { \n  Search, \n  Filter, \n  Users, \n  Calendar, \n  Tag, \n  BarChart3,\n  Clock,\n  FileText,\n  Bell,\n  MapPin\n} from 'lucide-react';\nimport { ElementProps } from '@/lib/element-system';\n\n// Search Input Element\nexport function SearchInputElement({ config, onChange }: ElementProps) {\n  const [query, setQuery] = useState('');\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n\n  const debounceMs = config.debounceMs || 300;\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (onChange && query !== '') {\n        onChange({ query, searchTerm: query });\n      }\n      \n      // Mock suggestions for demo\n      if (config.showSuggestions && query.length > 2) {\n        setSuggestions([\n          `${query} in spaces`,\n          `${query} in users`,\n          `${query} in posts`\n        ]);\n        setShowSuggestions(true);\n      } else {\n        setShowSuggestions(false);\n      }\n    }, debounceMs);\n\n    return () => clearTimeout(timer);\n  }, [query, debounceMs, onChange, config.showSuggestions]);\n\n  return (\n    <div className=\"relative\">\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n        <Input\n          value={query}\n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => setQuery((e.target as any).value)}\n          placeholder={config.placeholder || 'Search...'}\n          className=\"pl-10\"\n        />\n      </div>\n      \n      {showSuggestions && suggestions.length > 0 && (\n        <div className=\"absolute z-10 w-full mt-1 bg-background border border-border rounded-lg shadow-lg\">\n          {suggestions.map((suggestion, index) => (\n            <button\n              key={index}\n              className=\"w-full px-3 py-2 text-left text-sm hover:bg-accent rounded-lg\"\n              onClick={() => {\n                setQuery(suggestion);\n                setShowSuggestions(false);\n              }}\n            >\n              {suggestion}\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Filter Selector Element\nexport function FilterSelectorElement({ config, onChange }: ElementProps) {\n  const [selectedFilters, setSelectedFilters] = useState<string[]>([]);\n  const options = config.options || [];\n  const allowMultiple = config.allowMultiple !== false;\n\n  const handleFilterToggle = (value: string) => {\n    let newFilters: string[];\n    \n    if (allowMultiple) {\n      newFilters = selectedFilters.includes(value)\n        ? selectedFilters.filter(f => f !== value)\n        : [...selectedFilters, value];\n    } else {\n      newFilters = selectedFilters.includes(value) ? [] : [value];\n    }\n    \n    setSelectedFilters(newFilters);\n    if (onChange) {\n      onChange({ selectedFilters: newFilters, filters: newFilters });\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center space-x-2\">\n        <Filter className=\"h-4 w-4 text-muted-foreground\" />\n        <span className=\"text-sm font-medium\">Filters</span>\n      </div>\n      \n      <div className=\"flex flex-wrap gap-2\">\n        {options.map((option: any, index: number) => {\n          const value = option.value || option;\n          const label = option.label || option;\n          const count = option.count;\n          const isSelected = selectedFilters.includes(value);\n          \n          return (\n            <Button\n              key={index}\n              variant={isSelected ? \"default\" : \"outline\"}\n              className=\"max-w-sm h-8\"\n              onClick={() => handleFilterToggle(value)}\n            >\n              {label}\n              {config.showCounts && count && (\n                <Badge variant=\"secondary\" className=\"ml-2 h-4 text-xs\">\n                  {count}\n                </Badge>\n              )}\n            </Button>\n          );\n        })}\n      </div>\n      \n      {selectedFilters.length > 0 && (\n        <div className=\"text-xs text-muted-foreground\">\n          {selectedFilters.length} filter{selectedFilters.length !== 1 ? 's' : ''} applied\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Result List Element\nexport function ResultListElement({ config, data }: ElementProps) {\n  const items = data?.items || [];\n  const itemsPerPage = config.itemsPerPage || 10;\n  const showPagination = config.showPagination !== false;\n  const [currentPage, setCurrentPage] = useState(1);\n\n  const totalPages = Math.ceil(items.length / itemsPerPage);\n  const startIndex = (currentPage - 1) * itemsPerPage;\n  const displayItems = items.slice(startIndex, startIndex + itemsPerPage);\n\n  if (items.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"p-8 text-center\">\n          <div className=\"text-muted-foreground\">\n            <Search className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n            <p>No results found</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        {displayItems.map((item: any, index: number) => (\n          <Card key={index} className=\"hover:shadow-sm transition-shadow\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"flex-1\">\n                  <h3 className=\"font-medium\">{item.title || item.name || `Item ${index + 1}`}</h3>\n                  {item.description && (\n                    <p className=\"text-sm text-muted-foreground mt-1\">{item.description}</p>\n                  )}\n                  <div className=\"flex items-center space-x-2 mt-2\">\n                    {item.type && <Badge variant=\"secondary\">{item.type}</Badge>}\n                    {item.date && (\n                      <span className=\"text-xs text-muted-foreground\">{item.date}</span>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n      \n      {showPagination && totalPages > 1 && (\n        <div className=\"flex items-center justify-between\">\n          <div className=\"text-sm text-muted-foreground\">\n            Showing {startIndex + 1}-{Math.min(startIndex + itemsPerPage, items.length)} of {items.length}\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n              disabled={currentPage === 1}\n            >\n              Previous\n            </Button>\n            <span className=\"text-sm\">\n              {currentPage} of {totalPages}\n            </span>\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\n              disabled={currentPage === totalPages}\n            >\n              Next\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Date Picker Element\nexport function DatePickerElement({ config, onChange }: ElementProps) {\n  const [selectedDate, setSelectedDate] = useState('');\n  const [selectedTime, setSelectedTime] = useState('');\n  \n  const includeTime = config.includeTime || false;\n  const allowRange = config.allowRange || false;\n\n  const handleDateChange = (date: string) => {\n    setSelectedDate(date);\n    if (onChange) {\n      onChange({\n        selectedDate: date,\n        selectedTime: includeTime ? selectedTime : undefined,\n        selectedDates: allowRange ? [date] : date\n      });\n    }\n  };\n\n  const handleTimeChange = (time: string) => {\n    setSelectedTime(time);\n    if (onChange) {\n      onChange({\n        selectedDate,\n        selectedTime: time,\n        selectedDates: allowRange ? [selectedDate] : selectedDate\n      });\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center space-x-2\">\n        <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n        <span className=\"text-sm font-medium\">\n          {allowRange ? 'Date Range' : 'Select Date'}\n        </span>\n      </div>\n      \n      <div className=\"space-y-2\">\n        <Input\n          type=\"date\"\n          value={selectedDate}\n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleDateChange((e.target as any).value)}\n          min={config.minDate}\n          max={config.maxDate}\n        />\n        \n        {includeTime && (\n          <Input\n            type=\"time\"\n            value={selectedTime}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleTimeChange((e.target as any).value)}\n          />\n        )}\n        \n        {allowRange && selectedDate && (\n          <Input\n            type=\"date\"\n            placeholder=\"End date\"\n            min={selectedDate}\n            max={config.maxDate}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\n// User Selector Element\nexport function UserSelectorElement({ config, onChange }: ElementProps) {\n  const [selectedUsers, setSelectedUsers] = useState<string[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  \n  const allowMultiple = config.allowMultiple || false;\n  const showAvatars = config.showAvatars !== false;\n  \n  // Mock users for demo\n  const mockUsers = useMemo(() => [\n    { id: '1', name: 'Alice Johnson', avatar: 'üë©', email: 'alice@example.com' },\n    { id: '2', name: 'Bob Smith', avatar: 'üë®', email: 'bob@example.com' },\n    { id: '3', name: 'Carol Davis', avatar: 'üë©‚Äçü¶≥', email: 'carol@example.com' },\n    { id: '4', name: 'David Wilson', avatar: 'üë®‚Äçü¶≤', email: 'david@example.com' },\n  ], []);\n\n  const filteredUsers = mockUsers.filter(user =>\n    user.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    user.email.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const handleUserSelect = (userId: string) => {\n    let newSelection: string[];\n    \n    if (allowMultiple) {\n      newSelection = selectedUsers.includes(userId)\n        ? selectedUsers.filter(id => id !== userId)\n        : [...selectedUsers, userId];\n    } else {\n      newSelection = selectedUsers.includes(userId) ? [] : [userId];\n    }\n    \n    setSelectedUsers(newSelection);\n    if (onChange) {\n      onChange({ \n        selectedUsers: newSelection,\n        selectedUserData: mockUsers.filter(u => newSelection.includes(u.id))\n      });\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center space-x-2\">\n        <Users className=\"h-4 w-4 text-muted-foreground\" />\n        <span className=\"text-sm font-medium\">\n          {allowMultiple ? 'Select Users' : 'Select User'}\n        </span>\n      </div>\n      \n      <Input\n        placeholder=\"Search users...\"\n        value={searchQuery}\n        onChange={(e: React.ChangeEvent<HTMLInputElement>) => setSearchQuery((e.target as any).value)}\n      />\n      \n      <div className=\"max-h-40 overflow-y-auto space-y-1\">\n        {filteredUsers.map(user => (\n          <div\n            key={user.id}\n            className={`flex items-center space-x-3 p-2 rounded-lg cursor-pointer transition-colors ${\n              selectedUsers.includes(user.id) ? 'bg-primary/10 border border-primary/20' : 'hover:bg-accent'\n            }`}\n            onClick={() => handleUserSelect(user.id)}\n          >\n            {showAvatars && (\n              <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center text-sm\">\n                {user.avatar}\n              </div>\n            )}\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"text-sm font-medium truncate\">{user.name}</div>\n              <div className=\"text-xs text-muted-foreground truncate\">{user.email}</div>\n            </div>\n          </div>\n        ))}\n      </div>\n      \n      {selectedUsers.length > 0 && (\n        <div className=\"text-xs text-muted-foreground\">\n          {selectedUsers.length} user{selectedUsers.length !== 1 ? 's' : ''} selected\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Chart Display Element\nexport function ChartDisplayElement({ config, data }: ElementProps) {\n  const chartData = data?.chartData || [];\n  const chartType = config.chartType || 'bar';\n  const showLegend = config.showLegend !== false;\n  \n  // Mock chart implementation using simple bars\n  const maxValue = Math.max(...chartData.map((item: any) => item.value || 0));\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center space-x-2\">\n        <BarChart3 className=\"h-4 w-4 text-muted-foreground\" />\n        <span className=\"text-sm font-medium\">\n          {chartType.charAt(0).toUpperCase() + chartType.slice(1)} Chart\n        </span>\n      </div>\n      \n      {chartData.length === 0 ? (\n        <div className=\"h-32 flex items-center justify-center text-muted-foreground bg-muted/20 rounded-lg\">\n          No data to display\n        </div>\n      ) : (\n        <div className=\"space-y-2\">\n          {chartData.map((item: any, index: number) => (\n            <div key={index} className=\"space-y-1\">\n              <div className=\"flex justify-between text-sm\">\n                <span>{item.label || `Item ${index + 1}`}</span>\n                <span className=\"font-medium\">{item.value}</span>\n              </div>\n              <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                <div\n                  className=\"h-full bg-primary transition-all duration-300\"\n                  style={{ width: `${(item.value / maxValue) * 100}%` }}\n                />\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n      \n      {showLegend && chartData.length > 0 && (\n        <div className=\"text-xs text-muted-foreground\">\n          Total: {chartData.reduce((sum: number, item: any) => sum + (item.value || 0), 0)}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Form Builder Element\nexport function FormBuilderElement({ config, onChange }: ElementProps) {\n  const [formData, setFormData] = useState<Record<string, any>>({});\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  \n  const fields = config.fields || [];\n  const validateOnChange = config.validateOnChange !== false;\n\n  const handleFieldChange = (fieldName: string, value: any) => {\n    const newFormData = { ...formData, [fieldName]: value };\n    setFormData(newFormData);\n    \n    // Clear error for this field\n    if (errors[fieldName]) {\n      setErrors(prev => ({ ...prev, [fieldName]: '' }));\n    }\n    \n    if (onChange) {\n      onChange({ formData: newFormData, isValid: validateForm(newFormData) });\n    }\n  };\n\n  const validateForm = (data: Record<string, any>) => {\n    const newErrors: Record<string, string> = {};\n    \n    fields.forEach((field: any) => {\n      if (field.required && (!data[field.name] || data[field.name].toString().trim() === '')) {\n        newErrors[field.name] = `${field.label || field.name} is required`;\n      }\n    });\n    \n    if (validateOnChange) {\n      setErrors(newErrors);\n    }\n    \n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = () => {\n    const isValid = validateForm(formData);\n    if (isValid && onChange) {\n      onChange({ \n        formData, \n        action: 'submit',\n        isValid: true\n      });\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center space-x-2\">\n        <FileText className=\"h-4 w-4 text-muted-foreground\" />\n        <span className=\"text-sm font-medium\">Form</span>\n      </div>\n      \n      <div className=\"space-y-3\">\n        {fields.map((field: any, index: number) => (\n          <div key={index} className=\"space-y-1\">\n            <label className=\"text-sm font-medium\">\n              {field.label || field.name}\n              {field.required && <span className=\"text-destructive ml-1\">*</span>}\n            </label>\n            \n            {field.type === 'textarea' ? (\n              <textarea\n                className=\"w-full p-2 border border-border rounded-lg resize-none\"\n                rows={3}\n                value={formData[field.name] || ''}\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleFieldChange(field.name, (e.target as any).value)}\n                placeholder={field.placeholder}\n              />\n            ) : field.type === 'select' ? (\n              <Select\n                value={formData[field.name] || ''}\n                onValueChange={(value) => handleFieldChange(field.name, value)}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder={field.placeholder || 'Select...'} />\n                </SelectTrigger>\n                <SelectContent>\n                  {(field.options || []).map((option: any, optIndex: number) => (\n                    <SelectItem key={optIndex} value={option.value || option}>\n                      {option.label || option}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            ) : (\n              <Input\n                type={field.type || 'text'}\n                value={formData[field.name] || ''}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleFieldChange(field.name, (e.target as any).value)}\n                placeholder={field.placeholder}\n              />\n            )}\n            \n            {errors[field.name] && (\n              <div className=\"text-xs text-destructive\">{errors[field.name]}</div>\n            )}\n          </div>\n        ))}\n        \n        <Button onClick={handleSubmit} className=\"w-full\">\n          Submit Form\n        </Button>\n      </div>\n    </div>\n  );\n}\n\n// Element renderer registry\nexport const ELEMENT_RENDERERS = {\n  'search-input': SearchInputElement,\n  'filter-selector': FilterSelectorElement,\n  'result-list': ResultListElement,\n  'date-picker': DatePickerElement,\n  'user-selector': UserSelectorElement,\n  'chart-display': ChartDisplayElement,\n  'form-builder': FormBuilderElement,\n  // Add more renderers as needed\n};\n\n// Generic element renderer\nexport function renderElement(elementId: string, props: ElementProps): JSX.Element {\n  const Renderer = ELEMENT_RENDERERS[elementId as keyof typeof ELEMENT_RENDERERS];\n\n  if (!Renderer) {\n    return (\n      <div className=\"p-4 border border-dashed border-muted-foreground rounded-lg text-center text-muted-foreground\">\n        <div className=\"text-sm\">Element: {elementId}</div>\n        <div className=\"text-xs\">Renderer not implemented</div>\n      </div>\n    );\n  }\n  \n  return <Renderer {...props} />;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/tool-builder.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":111,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":116},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Play' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Copy' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTriangle' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useRef, useEffect } from 'react';\nimport { Card, Button, Input, Label, Textarea, Select, SelectContent, SelectItem, SelectTrigger, SelectValue, Badge, Switch, Tabs, TabsContent, TabsList, TabsTrigger } from \"@hive/ui\";\nimport { Alert, AlertDescription } from \"@/components/temp-stubs\";\nimport {\n  Code,\n  Save,\n  Play,\n  Settings,\n  Eye,\n  FileText,\n  Shield,\n  Zap,\n  Plus,\n  Trash2,\n  Copy,\n  Download,\n  Upload,\n  CheckCircle,\n  AlertTriangle\n} from 'lucide-react';\nimport { ToolExecutionPanel } from './tool-execution-panel';\nimport { toolTemplates, ToolDefinition } from '../../lib/tool-execution-runtime';\nimport { useFormValidation, toolValidation } from '../../lib/form-validation';\n\ninterface ToolBuilderProps {\n  tool?: ToolDefinition;\n  onSave: (tool: ToolDefinition) => Promise<void>;\n  onCancel: () => void;\n  userId: string;\n  spaceId?: string;\n  isEditing?: boolean;\n}\n\nexport function ToolBuilder({ \n  tool, \n  onSave, \n  onCancel, \n  userId, \n  spaceId,\n  isEditing = false \n}: ToolBuilderProps) {\n  const [activeTab, setActiveTab] = useState('editor');\n  const [isSaving, setIsSaving] = useState(false);\n  const [showPreview, setShowPreview] = useState(false);\n  const [inputFields, setInputFields] = useState<Array<{\n    key: string;\n    type: string;\n    required: boolean;\n    description: string;\n  }>>([]);\n  const [outputFields, setOutputFields] = useState<Array<{\n    key: string;\n    type: string;\n    description: string;\n  }>>([]);\n  const [permissions, setPermissions] = useState<string[]>([]);\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Form validation\n  const {\n    data: formData,\n    errors: validationErrors,\n    touched,\n    isValid: formIsValid,\n    setValue,\n    setTouched: setFieldTouched,\n    validateAll\n  } = useFormValidation({\n    name: tool?.name || '',\n    description: tool?.description || '',\n    code: tool?.code || '',\n    language: tool?.language || 'javascript',\n    category: tool?.category || 'utility',\n    version: tool?.version || '1.0.0',\n    isPublic: tool?.isPublic || false\n  }, toolValidation);\n\n  // Initialize form data\n  useEffect(() => {\n    if (tool) {\n      setValue('name', tool.name);\n      setValue('description', tool.description);\n      setValue('code', tool.code);\n      setValue('language', tool.language);\n      setValue('category', tool.category);\n      setValue('version', tool.version);\n      setValue('isPublic', tool.isPublic);\n      \n      // Initialize schema fields\n      if (tool.schema.inputs) {\n        const inputs = Object.entries(tool.schema.inputs).map(([key, def]) => ({\n          key,\n          type: (def as any).type || 'string',\n          required: (def as any).required || false,\n          description: (def as any).description || ''\n        }));\n        setInputFields(inputs);\n      }\n      \n      if (tool.schema.outputs) {\n        const outputs = Object.entries(tool.schema.outputs).map(([key, def]) => ({\n          key,\n          type: (def as any).type || 'string',\n          description: (def as any).description || ''\n        }));\n        setOutputFields(outputs);\n      }\n      \n      setPermissions(tool.permissions || []);\n    }\n  }, [tool, setValue]);\n\n  const handleInputChange = (field: string, value: any) => {\n    setValue(field, value);\n  };\n\n  const handleFieldBlur = (field: string) => {\n    setFieldTouched(field);\n  };\n\n  const loadTemplate = (templateName: string) => {\n    const template = toolTemplates[templateName as keyof typeof toolTemplates];\n    if (template) {\n      setValue('name', template.name);\n      setValue('code', template.code);\n      \n      // Load schema\n      const inputs = Object.entries(template.schema.inputs).map(([key, def]) => ({\n        key,\n        type: (def as any).type || 'string',\n        required: (def as any).required || false,\n        description: (def as any).description || ''\n      }));\n      setInputFields(inputs);\n      \n      const outputs = Object.entries(template.schema.outputs).map(([key, def]) => ({\n        key,\n        type: (def as any).type || 'string',\n        description: (def as any).description || ''\n      }));\n      setOutputFields(outputs);\n    }\n  };\n\n  const addInputField = () => {\n    setInputFields(prev => [...prev, {\n      key: `input${prev.length + 1}`,\n      type: 'string',\n      required: false,\n      description: ''\n    }]);\n  };\n\n  const removeInputField = (index: number) => {\n    setInputFields(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const updateInputField = (index: number, field: string, value: any) => {\n    setInputFields(prev => prev.map((item, i) => \n      i === index ? { ...item, [field]: value } : item\n    ));\n  };\n\n  const addOutputField = () => {\n    setOutputFields(prev => [...prev, {\n      key: `output${prev.length + 1}`,\n      type: 'string',\n      description: ''\n    }]);\n  };\n\n  const removeOutputField = (index: number) => {\n    setOutputFields(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const updateOutputField = (index: number, field: string, value: any) => {\n    setOutputFields(prev => prev.map((item, i) => \n      i === index ? { ...item, [field]: value } : item\n    ));\n  };\n\n  const togglePermission = (permission: string) => {\n    setPermissions(prev => \n      prev.includes(permission) \n        ? prev.filter(p => p !== permission)\n        : [...prev, permission]\n    );\n  };\n\n  const exportTool = () => {\n    const toolData = buildToolDefinition();\n    const dataStr = JSON.stringify(toolData, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `${formData.name.replace(/\\s+/g, '_')}.json`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const importTool = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        try {\n          const toolData = JSON.parse(e.target?.result as string);\n          // Load imported tool data\n          setValue('name', toolData.name);\n          setValue('description', toolData.description);\n          setValue('code', toolData.code);\n          setValue('language', toolData.language || 'javascript');\n          setValue('category', toolData.category || 'utility');\n          setValue('version', toolData.version || '1.0.0');\n          setValue('isPublic', toolData.isPublic || false);\n          \n          // Load schema and permissions\n          if (toolData.schema?.inputs) {\n            const inputs = Object.entries(toolData.schema.inputs).map(([key, def]) => ({\n              key,\n              type: (def as any).type || 'string',\n              required: (def as any).required || false,\n              description: (def as any).description || ''\n            }));\n            setInputFields(inputs);\n          }\n          \n          if (toolData.schema?.outputs) {\n            const outputs = Object.entries(toolData.schema.outputs).map(([key, def]) => ({\n              key,\n              type: (def as any).type || 'string',\n              description: (def as any).description || ''\n            }));\n            setOutputFields(outputs);\n          }\n          \n          setPermissions(toolData.permissions || []);\n        } catch (error) {\n          console.error('Failed to import tool:', error);\n        }\n      };\n      reader.readAsText(file);\n    }\n  };\n\n  const buildToolDefinition = (): ToolDefinition => {\n    const inputs: Record<string, any> = {};\n    inputFields.forEach(field => {\n      inputs[field.key] = {\n        type: field.type,\n        required: field.required,\n        description: field.description\n      };\n    });\n\n    const outputs: Record<string, any> = {};\n    outputFields.forEach(field => {\n      outputs[field.key] = {\n        type: field.type,\n        description: field.description\n      };\n    });\n\n    return {\n      id: tool?.id || `tool_${Date.now()}`,\n      name: formData.name,\n      code: formData.code,\n      language: formData.language as 'javascript' | 'typescript' | 'python',\n      version: formData.version,\n      dependencies: [], // TODO: Parse from code\n      permissions,\n      schema: { inputs, outputs },\n      category: formData.category,\n      isPublic: formData.isPublic,\n      createdBy: tool?.createdBy || userId,\n      createdAt: tool?.createdAt || new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      description: formData.description\n    };\n  };\n\n  const handleSave = async () => {\n    const validation = validateAll();\n    if (!validation.isValid) {\n      Object.keys(formData).forEach(field => {\n        setFieldTouched(field);\n      });\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      const toolDef = buildToolDefinition();\n      await onSave(toolDef);\n    } catch (error) {\n      console.error('Failed to save tool:', error);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const availablePermissions = [\n    { id: 'user:read', name: 'Read User Data', description: 'Access user profile information' },\n    { id: 'user:write', name: 'Write User Data', description: 'Modify user profile information' },\n    { id: 'space:read', name: 'Read Space Data', description: 'Access space information and members' },\n    { id: 'space:write', name: 'Write Space Data', description: 'Modify space information' },\n    { id: 'storage:read', name: 'Read Storage', description: 'Access tool storage data' },\n    { id: 'storage:write', name: 'Write Storage', description: 'Store data persistently' },\n    { id: 'network:read', name: 'Network Read', description: 'Make HTTP GET requests' },\n    { id: 'network:write', name: 'Network Write', description: 'Make HTTP POST/PUT requests' }\n  ];\n\n  const fieldTypes = [\n    'string', 'number', 'boolean', 'array', 'object', 'date', 'file', 'url', 'email'\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\">\n            {isEditing ? 'Edit Tool' : 'Create New Tool'}\n          </h2>\n          <p className=\"text-hive-text-mutedLight\">\n            Build custom tools for your HIVE community\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          <Button\n            variant=\"outline\"\n            onClick={() => fileInputRef.current?.click()}\n          >\n            <Upload className=\"h-4 w-4 mr-2\" />\n            Import\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={exportTool}\n            disabled={!formData.name}\n          >\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={() => setShowPreview(!showPreview)}\n          >\n            <Eye className=\"h-4 w-4 mr-2\" />\n            {showPreview ? 'Hide' : 'Show'} Preview\n          </Button>\n        </div>\n      </div>\n\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\".json\"\n        onChange={importTool}\n        className=\"hidden\"\n      />\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Builder */}\n        <div className=\"space-y-6\">\n          {/* Templates */}\n          <Card className=\"p-4 bg-hive-background-overlay border-hive-border-default\">\n            <h3 className=\"font-medium text-white mb-3\">Quick Start Templates</h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {Object.keys(toolTemplates).map(template => (\n                <Button\n                  key={template}\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                  onClick={() => loadTemplate(template)}\n                >\n                  {toolTemplates[template as keyof typeof toolTemplates].name}\n                </Button>\n              ))}\n            </div>\n          </Card>\n\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\n            <TabsList className=\"grid w-full grid-cols-4\">\n              <TabsTrigger value=\"editor\">\n                <Code className=\"h-4 w-4 mr-2\" />\n                Editor\n              </TabsTrigger>\n              <TabsTrigger value=\"schema\">\n                <FileText className=\"h-4 w-4 mr-2\" />\n                Schema\n              </TabsTrigger>\n              <TabsTrigger value=\"permissions\">\n                <Shield className=\"h-4 w-4 mr-2\" />\n                Permissions\n              </TabsTrigger>\n              <TabsTrigger value=\"settings\">\n                <Settings className=\"h-4 w-4 mr-2\" />\n                Settings\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Editor Tab */}\n            <TabsContent value=\"editor\" className=\"space-y-4 mt-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Tool Name</Label>\n                  <Input\n                    value={formData.name}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange('name', (e.target as any).value)}\n                    onBlur={() => handleFieldBlur('name')}\n                    placeholder=\"Enter tool name\"\n                    className={`mt-1 ${touched.name && validationErrors.name?.length ? 'border-red-500' : ''}`}\n                  />\n                  {touched.name && validationErrors.name?.length > 0 && (\n                    <p className=\"text-red-400 text-sm mt-1\">{validationErrors.name[0]}</p>\n                  )}\n                </div>\n                \n                <div>\n                  <Label className=\"text-white\">Language</Label>\n                  <Select\n                    value={formData.language}\n                    onValueChange={(value) => handleInputChange('language', value)}\n                  >\n                    <SelectTrigger className=\"mt-1\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"javascript\">JavaScript</SelectItem>\n                      <SelectItem value=\"typescript\">TypeScript</SelectItem>\n                      <SelectItem value=\"python\">Python</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div>\n                <Label className=\"text-white\">Description</Label>\n                <Textarea\n                  value={formData.description}\n                  onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleInputChange('description', (e.target as any).value)}\n                  onBlur={() => handleFieldBlur('description')}\n                  placeholder=\"Describe what your tool does...\"\n                  rows={3}\n                  className={`mt-1 ${touched.description && validationErrors.description?.length ? 'border-red-500' : ''}`}\n                />\n                {touched.description && validationErrors.description?.length > 0 && (\n                  <p className=\"text-red-400 text-sm mt-1\">{validationErrors.description[0]}</p>\n                )}\n              </div>\n\n              <div>\n                <Label className=\"text-white\">Code</Label>\n                <Textarea\n                  value={formData.code}\n                  onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleInputChange('code', (e.target as any).value)}\n                  onBlur={() => handleFieldBlur('code')}\n                  placeholder=\"// Write your tool code here...\"\n                  rows={12}\n                  className={`mt-1 font-mono text-sm ${touched.code && validationErrors.code?.length ? 'border-red-500' : ''}`}\n                />\n                {touched.code && validationErrors.code?.length > 0 && (\n                  <p className=\"text-red-400 text-sm mt-1\">{validationErrors.code[0]}</p>\n                )}\n              </div>\n            </TabsContent>\n\n            {/* Schema Tab */}\n            <TabsContent value=\"schema\" className=\"space-y-6 mt-4\">\n              {/* Input Fields */}\n              <div>\n                <div className=\"flex items-center justify-between mb-3\">\n                  <Label className=\"text-white\">Input Fields</Label>\n                  <Button\n                    variant=\"outline\"\n                    className=\"max-w-sm\"\n                    onClick={addInputField}\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Input\n                  </Button>\n                </div>\n                \n                <div className=\"space-y-3\">\n                  {inputFields.map((field, index) => (\n                    <Card key={index} className=\"p-3 bg-hive-background-tertiary\">\n                      <div className=\"grid grid-cols-12 gap-2 items-center\">\n                        <div className=\"col-span-3\">\n                          <Input\n                            value={field.key}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => updateInputField(index, 'key', (e.target as any).value)}\n                            placeholder=\"Field name\"\n                            className=\"text-sm\"\n                          />\n                        </div>\n                        <div className=\"col-span-2\">\n                          <Select\n                            value={field.type}\n                            onValueChange={(value) => updateInputField(index, 'type', value)}\n                          >\n                            <SelectTrigger className=\"text-sm\">\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {fieldTypes.map(type => (\n                                <SelectItem key={type} value={type}>{type}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"col-span-5\">\n                          <Input\n                            value={field.description}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => updateInputField(index, 'description', (e.target as any).value)}\n                            placeholder=\"Description\"\n                            className=\"text-sm\"\n                          />\n                        </div>\n                        <div className=\"col-span-1\">\n                          <Switch\n                            checked={field.required}\n                            onCheckedChange={(checked) => updateInputField(index, 'required', checked)}\n                          />\n                        </div>\n                        <div className=\"col-span-1\">\n                          <Button\n                            variant=\"outline\"\n                            className=\"max-w-sm text-red-400 border-red-400\"\n                            onClick={() => removeInputField(index)}\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </Card>\n                  ))}\n                  {inputFields.length === 0 && (\n                    <p className=\"text-hive-text-mutedLight text-center py-4\">\n                      No input fields defined\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              {/* Output Fields */}\n              <div>\n                <div className=\"flex items-center justify-between mb-3\">\n                  <Label className=\"text-white\">Output Fields</Label>\n                  <Button\n                    variant=\"outline\"\n                    className=\"max-w-sm\"\n                    onClick={addOutputField}\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Output\n                  </Button>\n                </div>\n                \n                <div className=\"space-y-3\">\n                  {outputFields.map((field, index) => (\n                    <Card key={index} className=\"p-3 bg-hive-background-tertiary\">\n                      <div className=\"grid grid-cols-12 gap-2 items-center\">\n                        <div className=\"col-span-3\">\n                          <Input\n                            value={field.key}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => updateOutputField(index, 'key', (e.target as any).value)}\n                            placeholder=\"Field name\"\n                            className=\"text-sm\"\n                          />\n                        </div>\n                        <div className=\"col-span-2\">\n                          <Select\n                            value={field.type}\n                            onValueChange={(value) => updateOutputField(index, 'type', value)}\n                          >\n                            <SelectTrigger className=\"text-sm\">\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {fieldTypes.map(type => (\n                                <SelectItem key={type} value={type}>{type}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"col-span-6\">\n                          <Input\n                            value={field.description}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => updateOutputField(index, 'description', (e.target as any).value)}\n                            placeholder=\"Description\"\n                            className=\"text-sm\"\n                          />\n                        </div>\n                        <div className=\"col-span-1\">\n                          <Button\n                            variant=\"outline\"\n                            className=\"max-w-sm text-red-400 border-red-400\"\n                            onClick={() => removeOutputField(index)}\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </Card>\n                  ))}\n                  {outputFields.length === 0 && (\n                    <p className=\"text-hive-text-mutedLight text-center py-4\">\n                      No output fields defined\n                    </p>\n                  )}\n                </div>\n              </div>\n            </TabsContent>\n\n            {/* Permissions Tab */}\n            <TabsContent value=\"permissions\" className=\"space-y-4 mt-4\">\n              <Alert>\n                <Shield className=\"h-4 w-4\" />\n                <AlertDescription>\n                  Select the permissions your tool needs. Users will see these when they install your tool.\n                </AlertDescription>\n              </Alert>\n              \n              <div className=\"space-y-3\">\n                {availablePermissions.map(perm => (\n                  <Card key={perm.id} className=\"p-4 bg-hive-background-tertiary\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <h4 className=\"font-medium text-white\">{perm.name}</h4>\n                        <p className=\"text-sm text-hive-text-mutedLight\">{perm.description}</p>\n                      </div>\n                      <Switch\n                        checked={permissions.includes(perm.id)}\n                        onCheckedChange={() => togglePermission(perm.id)}\n                      />\n                    </div>\n                  </Card>\n                ))}\n              </div>\n            </TabsContent>\n\n            {/* Settings Tab */}\n            <TabsContent value=\"settings\" className=\"space-y-4 mt-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-white\">Category</Label>\n                  <Select\n                    value={formData.category}\n                    onValueChange={(value) => handleInputChange('category', value)}\n                  >\n                    <SelectTrigger className=\"mt-1\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"utility\">Utility</SelectItem>\n                      <SelectItem value=\"academic\">Academic</SelectItem>\n                      <SelectItem value=\"social\">Social</SelectItem>\n                      <SelectItem value=\"productivity\">Productivity</SelectItem>\n                      <SelectItem value=\"entertainment\">Entertainment</SelectItem>\n                      <SelectItem value=\"other\">Other</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <Label className=\"text-white\">Version</Label>\n                  <Input\n                    value={formData.version}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange('version', (e.target as any).value)}\n                    placeholder=\"1.0.0\"\n                    className=\"mt-1\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label className=\"text-white\">Public Tool</Label>\n                  <p className=\"text-sm text-hive-text-mutedLight\">\n                    Make this tool discoverable by other HIVE users\n                  </p>\n                </div>\n                <Switch\n                  checked={formData.isPublic}\n                  onCheckedChange={(checked) => handleInputChange('isPublic', checked)}\n                />\n              </div>\n            </TabsContent>\n          </Tabs>\n\n          {/* Actions */}\n          <div className=\"flex items-center justify-between\">\n            <Button\n              variant=\"outline\"\n              onClick={onCancel}\n              disabled={isSaving}\n            >\n              Cancel\n            </Button>\n            <div className=\"flex items-center space-x-3\">\n              <Button\n                onClick={handleSave}\n                disabled={!formIsValid || isSaving}\n                className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n              >\n                <Save className=\"h-4 w-4 mr-2\" />\n                {isSaving ? 'Saving...' : 'Save Tool'}\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Preview */}\n        {showPreview && (\n          <div>\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Live Preview</h3>\n            {formData.name && formData.code ? (\n              <ToolExecutionPanel\n                tool={buildToolDefinition()}\n                userId={userId}\n                spaceId={spaceId}\n              />\n            ) : (\n              <Card className=\"p-8 bg-hive-background-overlay border-hive-border-default\">\n                <div className=\"text-center text-hive-text-mutedLight\">\n                  <Code className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                  <p>Complete the tool details to see preview</p>\n                </div>\n              </Card>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/tool-execution-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cpu' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTriangle' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":9}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useRef, useEffect } from 'react';\nimport { Card, Button, Input, Label, Textarea, Badge, Tabs, TabsContent, TabsList, TabsTrigger, Progress } from \"@hive/ui\";\nimport { Alert, AlertDescription } from \"@/components/temp-stubs\";\nimport {\n  Play,\n  Square,\n  Terminal,\n  Code,\n  Settings,\n  Clock,\n  Cpu,\n  Brain as Memory,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  Copy,\n  Download,\n  Share2\n} from 'lucide-react';\nimport { \n  ToolExecutionRuntime, \n  ToolDefinition, \n  ExecutionResult, \n  ExecutionContext \n} from '../../lib/tool-execution-runtime';\n\ninterface ToolExecutionPanelProps {\n  tool: ToolDefinition;\n  onResult?: (result: ExecutionResult) => void;\n  userId: string;\n  spaceId?: string;\n}\n\nexport function ToolExecutionPanel({ \n  tool, \n  onResult, \n  userId, \n  spaceId \n}: ToolExecutionPanelProps) {\n  const [inputs, setInputs] = useState<Record<string, any>>({});\n  const [isExecuting, setIsExecuting] = useState(false);\n  const [executionId, setExecutionId] = useState<string | null>(null);\n  const [result, setResult] = useState<ExecutionResult | null>(null);\n  const [executionHistory, setExecutionHistory] = useState<ExecutionResult[]>([]);\n  const [logs, setLogs] = useState<string[]>([]);\n  const [activeTab, setActiveTab] = useState('inputs');\n  \n  const runtime = useRef(ToolExecutionRuntime.getInstance());\n  const logsEndRef = useRef<HTMLDivElement>(null);\n\n  // Auto-scroll logs to bottom\n  useEffect(() => {\n    logsEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [logs]);\n\n  // Initialize inputs with default values\n  useEffect(() => {\n    const initialInputs: Record<string, any> = {};\n    Object.entries(tool.schema.inputs).forEach(([key, definition]) => {\n      if (definition.default !== undefined) {\n        initialInputs[key] = definition.default;\n      } else {\n        // Set default values based on type\n        switch (definition.type) {\n          case 'string':\n            initialInputs[key] = '';\n            break;\n          case 'number':\n            initialInputs[key] = 0;\n            break;\n          case 'boolean':\n            initialInputs[key] = false;\n            break;\n          case 'array':\n            initialInputs[key] = [];\n            break;\n          case 'object':\n            initialInputs[key] = {};\n            break;\n          default:\n            initialInputs[key] = null;\n        }\n      }\n    });\n    setInputs(initialInputs);\n  }, [tool]);\n\n  const handleInputChange = (key: string, value: any) => {\n    setInputs(prev => ({ ...prev, [key]: value }));\n  };\n\n  const parseInputValue = (value: string, type: string): any => {\n    switch (type) {\n      case 'number': {\n        const num = parseFloat(value);\n        return isNaN(num) ? 0 : num;\n      }\n      case 'boolean':\n        return value.toLowerCase() === 'true';\n      case 'array':\n        try {\n          return JSON.parse(value);\n        } catch {\n          return value.split(',').map(s => s.trim());\n        }\n      case 'object':\n        try {\n          return JSON.parse(value);\n        } catch {\n          return {};\n        }\n      default:\n        return value;\n    }\n  };\n\n  const handleExecute = async () => {\n    setIsExecuting(true);\n    setActiveTab('output');\n    setLogs([]);\n    \n    const context: ExecutionContext = {\n      userId,\n      toolId: tool.id,\n      spaceId,\n      permissions: tool.permissions,\n      timeout: 10000, // 10 seconds\n      maxMemory: 50 * 1024 * 1024 // 50MB\n    };\n\n    const currentExecutionId = `exec_${Date.now()}`;\n    setExecutionId(currentExecutionId);\n\n    try {\n      const execResult = await runtime.current.executeTool(tool, inputs, context);\n      \n      setResult(execResult);\n      setLogs(execResult.logs);\n      setExecutionHistory(prev => [execResult, ...prev.slice(0, 9)]); // Keep last 10\n      \n      if (onResult) {\n        onResult(execResult);\n      }\n    } catch (error) {\n      const errorResult: ExecutionResult = {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        executionTime: 0,\n        memoryUsed: 0,\n        logs: ['Error: Failed to execute tool']\n      };\n      \n      setResult(errorResult);\n      setLogs(errorResult.logs);\n    } finally {\n      setIsExecuting(false);\n      setExecutionId(null);\n    }\n  };\n\n  const handleCancel = () => {\n    if (executionId) {\n      runtime.current.cancelExecution(executionId);\n      setIsExecuting(false);\n      setExecutionId(null);\n    }\n  };\n\n  const copyResult = () => {\n    if (result) {\n      navigator.clipboard.writeText(JSON.stringify(result, null, 2));\n    }\n  };\n\n  const exportResult = () => {\n    if (result) {\n      const dataStr = JSON.stringify(result, null, 2);\n      const dataBlob = new Blob([dataStr], { type: 'application/json' });\n      const url = URL.createObjectURL(dataBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${tool.name}_result_${Date.now()}.json`;\n      link.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const renderInputField = (key: string, definition: any) => {\n    const value = inputs[key];\n    \n    switch (definition.type) {\n      case 'string':\n        if (definition.multiline) {\n          return (\n            <Textarea\n              value={value || ''}\n              onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleInputChange(key, (e.target as any).value)}\n              placeholder={definition.placeholder}\n              rows={3}\n              className=\"mt-1\"\n            />\n          );\n        }\n        return (\n          <Input\n            value={value || ''}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange(key, (e.target as any).value)}\n            placeholder={definition.placeholder}\n            className=\"mt-1\"\n          />\n        );\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            value={value || 0}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange(key, parseFloat((e.target as any).value))}\n            className=\"mt-1\"\n          />\n        );\n      \n      case 'boolean':\n        return (\n          <div className=\"mt-1\">\n            <Button\n              variant=\"outline\"\n              className={`max-w-sm ${value ? 'bg-green-500/20 border-green-500' : ''}`}\n              onClick={() => handleInputChange(key, !value)}\n            >\n              {value ? 'True' : 'False'}\n            </Button>\n          </div>\n        );\n      \n      case 'array':\n      case 'object':\n        return (\n          <Textarea\n            value={typeof value === 'string' ? value : JSON.stringify(value, null, 2)}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => handleInputChange(key, parseInputValue((e.target as any).value, definition.type))}\n            placeholder={definition.type === 'array' ? '[\"item1\", \"item2\"]' : '{\"key\": \"value\"}'}\n            rows={3}\n            className=\"mt-1 font-mono text-sm\"\n          />\n        );\n      \n      default:\n        return (\n          <Input\n            value={value || ''}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange(key, (e.target as any).value)}\n            className=\"mt-1\"\n          />\n        );\n    }\n  };\n\n  const getStatusIcon = () => {\n    if (isExecuting) return <Clock className=\"h-4 w-4 animate-spin\" />;\n    if (!result) return <Play className=\"h-4 w-4\" />;\n    return result.success ? \n      <CheckCircle className=\"h-4 w-4 text-green-400\" /> : \n      <XCircle className=\"h-4 w-4 text-red-400\" />;\n  };\n\n  const getStatusColor = () => {\n    if (isExecuting) return 'border-yellow-500 bg-yellow-500/10';\n    if (!result) return 'border-hive-border-default';\n    return result.success ? \n      'border-green-500 bg-green-500/10' : \n      'border-red-500 bg-red-500/10';\n  };\n\n  return (\n    <Card className={`p-6 bg-hive-background-overlay transition-all duration-200 ${getStatusColor()}`}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-8 h-8 bg-[var(--hive-brand-primary)] rounded-lg flex items-center justify-center\">\n              <Code className=\"h-5 w-5 text-hive-obsidian\" />\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-white\">{tool.name}</h3>\n              <p className=\"text-sm text-hive-text-mutedLight\">\n                {tool.language} ‚Ä¢ v{tool.version}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            {result && (\n              <>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                  onClick={copyResult}\n                >\n                  <Copy className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"max-w-sm\"\n                  onClick={exportResult}\n                >\n                  <Download className=\"h-4 w-4\" />\n                </Button>\n              </>\n            )}\n            {isExecuting ? (\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm text-red-400 border-red-400\"\n                onClick={handleCancel}\n              >\n                <Square className=\"h-4 w-4 mr-2\" />\n                Cancel\n              </Button>\n            ) : (\n              <Button\n                onClick={handleExecute}\n                disabled={Object.keys(tool.schema.inputs).some(key => \n                  tool.schema.inputs[key].required && !inputs[key]\n                )}\n                className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n              >\n                <Play className=\"h-4 w-4 mr-2\" />\n                Execute\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Execution Progress */}\n        {isExecuting && (\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-white\">Executing...</span>\n              <span className=\"text-hive-text-mutedLight\">\n                {executionId}\n              </span>\n            </div>\n            <Progress value={75} className=\"h-2\" />\n          </div>\n        )}\n\n        {/* Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"inputs\" className=\"flex items-center space-x-2\">\n              <Settings className=\"h-4 w-4\" />\n              <span>Inputs</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"output\" className=\"flex items-center space-x-2\">\n              {getStatusIcon()}\n              <span>Output</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"logs\" className=\"flex items-center space-x-2\">\n              <Terminal className=\"h-4 w-4\" />\n              <span>Logs</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"history\" className=\"flex items-center space-x-2\">\n              <Clock className=\"h-4 w-4\" />\n              <span>History</span>\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Inputs Tab */}\n          <TabsContent value=\"inputs\" className=\"space-y-4 mt-4\">\n            {Object.keys(tool.schema.inputs).length === 0 ? (\n              <p className=\"text-hive-text-mutedLight text-center py-4\">\n                This tool doesn't require any inputs\n              </p>\n            ) : (\n              <div className=\"space-y-4\">\n                {Object.entries(tool.schema.inputs).map(([key, definition]) => (\n                  <div key={key}>\n                    <Label className=\"text-white flex items-center space-x-2\">\n                      <span>{key}</span>\n                      {definition.required && (\n                        <Badge variant=\"secondary\" className=\"text-xs\">Required</Badge>\n                      )}\n                    </Label>\n                    {definition.description && (\n                      <p className=\"text-sm text-hive-text-mutedLight mb-1\">\n                        {definition.description}\n                      </p>\n                    )}\n                    {renderInputField(key, definition)}\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Output Tab */}\n          <TabsContent value=\"output\" className=\"mt-4\">\n            {result ? (\n              <div className=\"space-y-4\">\n                {/* Status Banner */}\n                <Alert className={result.success ? 'border-green-500/20 bg-green-500/10' : 'border-red-500/20 bg-red-500/10'}>\n                  {result.success ? \n                    <CheckCircle className=\"h-4 w-4 text-green-400\" /> : \n                    <XCircle className=\"h-4 w-4 text-red-400\" />\n                  }\n                  <AlertDescription className={result.success ? 'text-green-200' : 'text-red-200'}>\n                    {result.success ? 'Execution completed successfully' : `Execution failed: ${result.error}`}\n                  </AlertDescription>\n                </Alert>\n\n                {/* Performance Stats */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"bg-hive-background-tertiary rounded-lg p-3\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Clock className=\"h-4 w-4 text-blue-400\" />\n                      <span className=\"text-sm text-hive-text-mutedLight\">Execution Time</span>\n                    </div>\n                    <p className=\"text-lg font-semibold text-white\">{result.executionTime}ms</p>\n                  </div>\n                  <div className=\"bg-hive-background-tertiary rounded-lg p-3\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Memory className=\"h-4 w-4 text-purple-400\" />\n                      <span className=\"text-sm text-hive-text-mutedLight\">Memory Used</span>\n                    </div>\n                    <p className=\"text-lg font-semibold text-white\">\n                      {(result.memoryUsed / 1024).toFixed(1)}KB\n                    </p>\n                  </div>\n                </div>\n\n                {/* Result Data */}\n                {result.success && result.result && (\n                  <div>\n                    <Label className=\"text-white\">Result</Label>\n                    <div className=\"mt-1 bg-hive-background-tertiary rounded-lg p-4\">\n                      <pre className=\"text-sm text-white overflow-x-auto\">\n                        {JSON.stringify(result.result, null, 2)}\n                      </pre>\n                    </div>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-hive-text-mutedLight\">\n                <Terminal className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                <p>No output yet</p>\n                <p className=\"text-sm\">Execute the tool to see results</p>\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Logs Tab */}\n          <TabsContent value=\"logs\" className=\"mt-4\">\n            <div className=\"bg-black rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm\">\n              {logs.length === 0 ? (\n                <p className=\"text-gray-500\">No logs yet...</p>\n              ) : (\n                logs.map((log, index) => (\n                  <div key={index} className=\"mb-1\">\n                    <span className=\"text-gray-400\">{String(index + 1).padStart(2, '0')} </span>\n                    <span className={\n                      log.includes('[ERROR]') ? 'text-red-400' :\n                      log.includes('[WARN]') ? 'text-yellow-400' :\n                      log.includes('[TOAST]') ? 'text-blue-400' :\n                      'text-green-400'\n                    }>\n                      {log}\n                    </span>\n                  </div>\n                ))\n              )}\n              <div ref={logsEndRef} />\n            </div>\n          </TabsContent>\n\n          {/* History Tab */}\n          <TabsContent value=\"history\" className=\"mt-4\">\n            {executionHistory.length === 0 ? (\n              <div className=\"text-center py-8 text-hive-text-mutedLight\">\n                <Clock className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                <p>No execution history</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {executionHistory.map((exec, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-3 bg-hive-background-tertiary rounded-lg\">\n                    <div className=\"flex items-center space-x-3\">\n                      {exec.success ? \n                        <CheckCircle className=\"h-4 w-4 text-green-400\" /> : \n                        <XCircle className=\"h-4 w-4 text-red-400\" />\n                      }\n                      <div>\n                        <p className=\"text-sm text-white\">\n                          {exec.success ? 'Success' : 'Failed'}\n                        </p>\n                        <p className=\"text-xs text-hive-text-mutedLight\">\n                          {exec.executionTime}ms ‚Ä¢ {(exec.memoryUsed / 1024).toFixed(1)}KB\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"text-xs text-hive-text-mutedLight\">\n                      {new Date(exec.metadata?.timestamp || Date.now()).toLocaleTimeString()}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/tool-runtime.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'renderElement' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ElementInstance' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'globalState' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":41,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'elementEngine' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":44,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeRuntime'. Either include it or remove the dependency array.","line":49,"column":6,"nodeType":"ArrayExpression","endLine":49,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [composition, initializeRuntime]","fix":{"range":[1539,1552],"text":"[composition, initializeRuntime]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'processDataFlow' and 'syncWithBackend'. Either include them or remove the dependency array.","line":129,"column":6,"nodeType":"ArrayExpression","endLine":129,"endColumn":51,"suggestions":[{"desc":"Update the dependencies array to be: [deploymentId, mode, processDataFlow, syncWithBackend]","fix":{"range":[3823,3868],"text":"[deploymentId, mode, processDataFlow, syncWithBackend]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Card, CardContent, Button, Alert, AlertDescription } from '@hive/ui';\nimport { Play, Square, RefreshCw, Settings, ExternalLink } from 'lucide-react';\nimport { ToolComposition, ElementRegistry, ElementEngine } from '@/lib/element-system';\nimport { renderElement } from './element-renderers';\n\ninterface ToolRuntimeProps {\n  composition: ToolComposition;\n  deploymentId?: string;\n  userId: string;\n  mode?: 'preview' | 'live';\n  onExecutionResult?: (result: any) => void;\n  onError?: (error: string) => void;\n}\n\ninterface ElementInstance {\n  id: string;\n  // id: string;\n  instanceId: string;\n  config: Record<string, any>;\n  position: { x: number; y: number };\n  size: { width: number; height: number };\n  data?: any;\n  isActive: boolean;\n}\n\nexport function ToolRuntime({\n  composition,\n  deploymentId,\n  userId,\n  mode = 'preview',\n  onExecutionResult,\n  onError\n}: ToolRuntimeProps) {\n  const [isRunning, setIsRunning] = useState(false);\n  const [elementStates, setElementStates] = useState<Map<string, any>>(new Map());\n  const [error, setError] = useState<string | null>(null);\n  const [executionHistory, setExecutionHistory] = useState<any[]>([]);\n  const [globalState, setGlobalState] = useState<Record<string, any>>({});\n\n  const elementRegistry = useMemo(() => ElementRegistry.getInstance(), []);\n  const elementEngine = useMemo(() => new ElementEngine(), []);\n\n  // Initialize tool runtime\n  useEffect(() => {\n    initializeRuntime();\n  }, [composition]);\n\n  const initializeRuntime = async () => {\n    try {\n      setError(null);\n      \n      // Initialize element states\n      const initialStates = new Map();\n      composition.elements.forEach(element => {\n        const elementDef = elementRegistry.getElement(element.elementId);\n        if (elementDef) {\n          initialStates.set(element.instanceId, {\n            ...element.config,\n            data: null,\n            isActive: false\n          });\n        }\n      });\n      \n      setElementStates(initialStates);\n      \n      // Initialize global state if in live mode\n      if (mode === 'live' && deploymentId) {\n        await initializeLiveState();\n      }\n      \n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to initialize tool runtime';\n      setError(errorMessage);\n      onError?.(errorMessage);\n    }\n  };\n\n  const initializeLiveState = async () => {\n    if (!deploymentId) return;\n    \n    try {\n      const response = await fetch('/api/tools/execute', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          deploymentId,\n          action: 'initialize',\n          context: { mode: 'live', userId }\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to initialize live state');\n      }\n      \n      const result = await response.json();\n      if (result.result?.state) {\n        setGlobalState(result.result.state);\n      }\n    } catch (err) {\n      // Intentionally suppressed - non-critical error\n    }\n  };\n\n  const handleElementChange = useCallback(async (instanceId: string, data: any) => {\n    // Update local element state\n    setElementStates(prev => {\n      const newStates = new Map(prev);\n      const currentState = newStates.get(instanceId) || {};\n      newStates.set(instanceId, { ...currentState, data, lastUpdated: Date.now() });\n      return newStates;\n    });\n\n    // Process data flow through connections\n    processDataFlow(instanceId, data);\n\n    // If in live mode, sync with backend\n    if (mode === 'live' && deploymentId) {\n      try {\n        await syncWithBackend(instanceId, data);\n      } catch (err) {\n        // Intentionally suppressed - non-critical error\n      }\n    }\n  }, [composition.connections, deploymentId, mode]);\n\n  const processDataFlow = (sourceInstanceId: string, data: any) => {\n    // Find connections from this element\n    const outgoingConnections = composition.connections.filter(\n      conn => conn.from.instanceId === sourceInstanceId\n    );\n\n    // Update connected elements\n    outgoingConnections.forEach(connection => {\n      setElementStates(prev => {\n        const newStates = new Map(prev);\n        const targetState = newStates.get(connection.to.instanceId) || {};\n        \n        // Map output data to input format\n        const mappedData = mapConnectionData(data, connection);\n        \n        newStates.set(connection.to.instanceId, {\n          ...targetState,\n          data: { ...targetState.data, ...mappedData },\n          isActive: true,\n          lastUpdated: Date.now()\n        });\n        \n        return newStates;\n      });\n    });\n  };\n\n  const mapConnectionData = (sourceData: any, connection: any) => {\n    // Simple data mapping - in a full implementation, this would be more sophisticated\n    const outputKey = connection.from.output || 'output';\n    const inputKey = connection.to.input || 'input';\n    \n    return {\n      [inputKey]: sourceData[outputKey] || sourceData\n    };\n  };\n\n  const syncWithBackend = async (instanceId: string, data: any) => {\n    if (!deploymentId) return;\n\n    try {\n      const response = await fetch('/api/tools/execute', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          deploymentId,\n          action: 'element_update',\n          // id: instanceId,\n          data,\n          context: { userId, timestamp: Date.now() }\n        })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        if (result.result) {\n          onExecutionResult?.(result.result);\n          \n          // Update execution history\n          setExecutionHistory(prev => [...prev, {\n            timestamp: Date.now(),\n            instanceId,\n            action: 'element_update',\n            data,\n            result: result.result\n          }].slice(-50)); // Keep last 50 executions\n        }\n      }\n    } catch (err) {\n      // Intentionally suppressed - non-critical error\n    }\n  };\n\n  const handleElementAction = async (instanceId: string, action: string, payload: any) => {\n    if (mode === 'live' && deploymentId) {\n      try {\n        const response = await fetch('/api/tools/execute', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            deploymentId,\n            action,\n            // id: instanceId,\n            data: payload,\n            context: { userId, timestamp: Date.now() }\n          })\n        });\n\n        if (response.ok) {\n          const result = await response.json();\n          onExecutionResult?.(result.result);\n          \n          // Update execution history\n          setExecutionHistory(prev => [...prev, {\n            timestamp: Date.now(),\n            instanceId,\n            action,\n            payload,\n            result: result.result\n          }].slice(-50));\n        }\n      } catch (err) {\n        onError?.(`Failed to execute action: ${action}`);\n      }\n    } else {\n      // Preview mode - just update local state\n    }\n  };\n\n  const startTool = () => {\n    setIsRunning(true);\n    setError(null);\n    \n    // Mark all elements as active\n    setElementStates(prev => {\n      const newStates = new Map();\n      prev.forEach((state, instanceId) => {\n        newStates.set(instanceId, { ...state, isActive: true });\n      });\n      return newStates;\n    });\n  };\n\n  const stopTool = () => {\n    setIsRunning(false);\n    \n    // Mark all elements as inactive\n    setElementStates(prev => {\n      const newStates = new Map();\n      prev.forEach((state, instanceId) => {\n        newStates.set(instanceId, { ...state, isActive: false });\n      });\n      return newStates;\n    });\n  };\n\n  const resetTool = async () => {\n    setIsRunning(false);\n    setError(null);\n    setExecutionHistory([]);\n    await initializeRuntime();\n  };\n\n  // Render elements in grid layout\n  const renderElements = () => {\n    if (composition.layout === 'grid') {\n      return (\n        <div className=\"grid gap-4\" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))' }}>\n          {composition.elements.map(element => {\n            const elementDef = elementRegistry.getElement(element.elementId);\n            const elementState = elementStates.get(element.instanceId);\n            \n            if (!elementDef) return null;\n\n            return (\n              <Card \n                key={element.instanceId}\n                className={`transition-all duration-200 ${\n                  elementState?.isActive ? 'border-primary shadow-sm' : 'border-border'\n                }`}\n              >\n                <CardContent className=\"p-4\">\n                  <div className=\"mb-3\">\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-sm font-medium\">{elementDef.name}</span>\n                      {mode === 'live' && (\n                        <div className={`w-2 h-2 rounded-full ${\n                          elementState?.isActive ? 'bg-green-500' : 'bg-gray-300'\n                        }`} />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">{elementDef.description}</p>\n                  </div>\n                  \n                  {elementDef.render({\n                    id: element.instanceId,\n                    config: element.config,\n                    data: elementState?.data,\n                    onChange: (data) => handleElementChange(element.instanceId, data),\n                    onAction: (action, payload) => handleElementAction(element.instanceId, action, payload)\n                  })}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      );\n    }\n\n    // Other layout types can be implemented here\n    return <div>Layout type \"{composition.layout}\" not implemented</div>;\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Tool Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-xl font-semibold\">{composition.name}</h2>\n          <p className=\"text-sm text-muted-foreground\">{composition.description}</p>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          {mode === 'preview' && (\n            <>\n              <Button\n                variant=\"outline\"\n                className=\"max-w-sm\"\n                onClick={resetTool}\n                disabled={isRunning}\n              >\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n                Reset\n              </Button>\n              \n              <Button\n                className=\"max-w-sm\"\n                onClick={isRunning ? stopTool : startTool}\n                variant={isRunning ? \"destructive\" : \"default\"}\n              >\n                {isRunning ? (\n                  <>\n                    <Square className=\"h-4 w-4 mr-2\" />\n                    Stop\n                  </>\n                ) : (\n                  <>\n                    <Play className=\"h-4 w-4 mr-2\" />\n                    Run\n                  </>\n                )}\n              </Button>\n            </>\n          )}\n          \n          {mode === 'live' && (\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"flex items-center space-x-1 text-sm text-muted-foreground\">\n                <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n                <span>Live</span>\n              </div>\n              <Button variant=\"outline\" className=\"max-w-sm\">\n                <Settings className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <Alert variant=\"destructive\">\n          <AlertDescription>{error}</AlertDescription>\n        </Alert>\n      )}\n\n      {/* Tool Elements */}\n      {composition.elements.length > 0 ? (\n        renderElements()\n      ) : (\n        <Card>\n          <CardContent className=\"p-8 text-center\">\n            <p className=\"text-muted-foreground\">No elements in this tool</p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Execution History (for debugging in preview mode) */}\n      {mode === 'preview' && executionHistory.length > 0 && (\n        <Card>\n          <CardContent className=\"p-4\">\n            <h3 className=\"text-sm font-medium mb-2\">Execution History</h3>\n            <div className=\"space-y-1 max-h-40 overflow-y-auto\">\n              {executionHistory.slice(-10).map((entry, index) => (\n                <div key={index} className=\"text-xs p-2 bg-muted rounded\">\n                  <div className=\"flex justify-between\">\n                    <span>{entry.action} on {entry.instanceId}</span>\n                    <span>{new Date(entry.timestamp).toLocaleTimeString()}</span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/tools-loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/tools/visual-tool-composer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":5,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'variant' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":6,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'size' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":6,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'variant' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":9,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertDescription' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Copy' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Move' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Resize' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Code' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Palette' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":72,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setToolDescription' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":75,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCanvasSize' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":87,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useRef, useCallback } from 'react';\n// Temp fix for chunk 2073 useRef errors\nconst Card = ({ children, className = \"\", ...props }: any) => <div className={`border rounded-lg p-4 ${className}`} {...props}>{children}</div>;\nconst Button = ({ children, variant = \"default\", size = \"default\", className = \"\", ...props }: any) => <button className={`px-4 py-2 rounded ${className}`} {...props}>{children}</button>;\nconst Input = ({ className = \"\", ...props }: any) => <input className={`px-3 py-2 border rounded ${className}`} {...props} />;\nconst Label = ({ children, className = \"\", ...props }: any) => <label className={`text-sm font-medium ${className}`} {...props}>{children}</label>;\nconst Badge = ({ children, variant = \"default\", className = \"\", ...props }: any) => <span className={`px-2 py-1 text-xs rounded ${className}`} {...props}>{children}</span>;\nconst Tabs = ({ children, defaultValue, className = \"\", ...props }: any) => <div className={className} {...props}>{children}</div>;\nconst TabsContent = ({ children, value, className = \"\", ...props }: any) => <div className={className} {...props}>{children}</div>;\nconst TabsList = ({ children, className = \"\", ...props }: any) => <div className={`flex space-x-2 ${className}`} {...props}>{children}</div>;\nconst TabsTrigger = ({ children, value, className = \"\", ...props }: any) => <button className={`px-3 py-1 ${className}`} {...props}>{children}</button>;\nimport { Alert, AlertDescription } from '@/components/temp-stubs';\nimport {\n  Plus,\n  Search,\n  Grid,\n  Layers,\n  Settings,\n  Play,\n  Save,\n  Trash2,\n  Copy,\n  Link,\n  Move,\n  Maximize2 as Resize,\n  Eye,\n  Code,\n  Zap,\n  Palette,\n  Box,\n  ArrowRight,\n  CheckCircle\n} from 'lucide-react';\nimport { \n  ElementRegistry, \n  ToolComposition, \n  ElementDefinition, \n  initializeElementSystem \n} from '../../lib/element-system';\n\ninterface VisualToolComposerProps {\n  onSave: (composition: ToolComposition) => Promise<void>;\n  onPreview: (composition: ToolComposition) => void;\n  onCancel: () => void;\n  initialComposition?: ToolComposition;\n  userId: string;\n}\n\ninterface CanvasElement {\n  id: string;\n  // id: string;\n  instanceId: string;\n  position: { x: number; y: number };\n  size: { width: number; height: number };\n  config: Record<string, any>;\n  isSelected: boolean;\n}\n\ninterface Connection {\n  id: string;\n  from: { instanceId: string; output: string; x: number; y: number };\n  to: { instanceId: string; input: string; x: number; y: number };\n}\n\nexport function VisualToolComposer({\n  onSave,\n  onPreview,\n  onCancel,\n  initialComposition,\n  userId\n}: VisualToolComposerProps) {\n  const [toolName, setToolName] = useState(initialComposition?.name || '');\n  const [toolDescription, setToolDescription] = useState(initialComposition?.description || '');\n  const [canvasElements, setCanvasElements] = useState<CanvasElement[]>([]);\n  const [connections, setConnections] = useState<Connection[]>([]);\n  const [selectedElement, setSelectedElement] = useState<string | null>(null);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [connectionStart, setConnectionStart] = useState<{\n    instanceId: string;\n    output: string;\n    x: number;\n    y: number;\n  } | null>(null);\n  const [draggedElement, setDraggedElement] = useState<ElementDefinition | null>(null);\n  const [canvasSize, setCanvasSize] = useState({ width: 1200, height: 800 });\n  const [zoom, setZoom] = useState(1);\n  const [showGrid, setShowGrid] = useState(true);\n  const [activeTab, setActiveTab] = useState('canvas');\n\n  const canvasRef = useRef<HTMLDivElement>(null);\n  const elementRegistry = useRef(ElementRegistry.getInstance());\n\n  // Initialize element system\n  useState(() => {\n    initializeElementSystem();\n  });\n\n  const handleDragStart = (element: ElementDefinition) => {\n    setDraggedElement(element);\n  };\n\n  const handleCanvasDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    if (!draggedElement || !canvasRef.current) return;\n\n    const rect = canvasRef.current.getBoundingClientRect();\n    const x = (e.clientX - rect.left) / zoom;\n    const y = (e.clientY - rect.top) / zoom;\n\n    const newElement: CanvasElement = {\n      id: `element_${Date.now()}`,\n      // id: draggedElement.id,\n      instanceId: `${draggedElement.id}_${Date.now()}`,\n      position: { x: Math.max(0, x - 50), y: Math.max(0, y - 25) },\n      size: { width: 200, height: 100 },\n      config: { ...draggedElement.defaultConfig },\n      isSelected: false\n    };\n\n    setCanvasElements(prev => [...prev, newElement]);\n    setDraggedElement(null);\n  }, [draggedElement, zoom]);\n\n  const handleCanvasDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n  };\n\n  const handleElementSelect = (elementId: string) => {\n    setCanvasElements(prev =>\n      prev.map(el => ({ ...el, isSelected: el.id === elementId }))\n    );\n    setSelectedElement(elementId);\n  };\n\n  const handleElementMove = (elementId: string, newPosition: { x: number; y: number }) => {\n    setCanvasElements(prev =>\n      prev.map(el =>\n        el.id === elementId\n          ? { ...el, position: newPosition }\n          : el\n      )\n    );\n  };\n\n  const handleElementResize = (elementId: string, newSize: { width: number; height: number }) => {\n    setCanvasElements(prev =>\n      prev.map(el =>\n        el.id === elementId\n          ? { ...el, size: newSize }\n          : el\n      )\n    );\n  };\n\n  const handleElementDelete = (elementId: string) => {\n    setCanvasElements(prev => prev.filter(el => el.id !== elementId));\n    setConnections(prev => \n      prev.filter(conn => \n        conn.from.instanceId !== elementId && conn.to.instanceId !== elementId\n      )\n    );\n    if (selectedElement === elementId) {\n      setSelectedElement(null);\n    }\n  };\n\n  const handleConnectionStart = (instanceId: string, output: string, x: number, y: number) => {\n    setIsConnecting(true);\n    setConnectionStart({ instanceId, output, x, y });\n  };\n\n  const handleConnectionEnd = (instanceId: string, input: string, x: number, y: number) => {\n    if (connectionStart && connectionStart.instanceId !== instanceId) {\n      const newConnection: Connection = {\n        id: `conn_${Date.now()}`,\n        from: connectionStart,\n        to: { instanceId, input, x, y }\n      };\n      setConnections(prev => [...prev, newConnection]);\n    }\n    setIsConnecting(false);\n    setConnectionStart(null);\n  };\n\n  const handleElementConfigChange = (elementId: string, newConfig: Record<string, any>) => {\n    setCanvasElements(prev =>\n      prev.map(el =>\n        el.id === elementId\n          ? { ...el, config: { ...el.config, ...newConfig } }\n          : el\n      )\n    );\n  };\n\n  const buildToolComposition = (): ToolComposition => {\n    return {\n      id: initialComposition?.id || `tool_${Date.now()}`,\n      name: toolName,\n      description: toolDescription,\n      elements: canvasElements.map(canvasEl => ({\n        // id: canvasEl.elementId,\n        instanceId: canvasEl.instanceId,\n        config: canvasEl.config,\n        position: canvasEl.position,\n        size: canvasEl.size\n      })),\n      connections: connections.map(conn => ({\n        from: { instanceId: conn.from.instanceId, output: conn.from.output },\n        to: { instanceId: conn.to.instanceId, input: conn.to.input }\n      })),\n      layout: 'grid'\n    };\n  };\n\n  const handleSave = async () => {\n    if (!toolName.trim()) {\n      alert('Please enter a tool name');\n      return;\n    }\n\n    const composition = buildToolComposition();\n    await onSave(composition);\n  };\n\n  const handlePreview = () => {\n    const composition = buildToolComposition();\n    onPreview(composition);\n  };\n\n  const selectedCanvasElement = canvasElements.find(el => el.id === selectedElement);\n  const selectedElementDef = selectedCanvasElement \n    ? elementRegistry.current.getElement(selectedCanvasElement.elementId)\n    : null;\n\n  const elementCategories = [\n    { id: 'input', name: 'Input', icon: 'Type', color: 'text-blue-400' },\n    { id: 'display', name: 'Display', icon: 'Eye', color: 'text-green-400' },\n    { id: 'filter', name: 'Filter', icon: 'Filter', color: 'text-purple-400' },\n    { id: 'action', name: 'Action', icon: 'Zap', color: 'text-orange-400' },\n    { id: 'layout', name: 'Layout', icon: 'Grid', color: 'text-pink-400' }\n  ];\n\n  return (\n    <div className=\"h-screen flex flex-col bg-hive-background-primary\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-4 border-b border-hive-border-default bg-hive-background-overlay\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"flex items-center space-x-2\">\n            <Box className=\"h-6 w-6 text-[var(--hive-brand-primary)]\" />\n            <h1 className=\"text-xl font-bold text-white\">Tool Composer</h1>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Input\n              value={toolName}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setToolName((e.target as any).value)}\n              placeholder=\"Tool name...\"\n              className=\"w-48\"\n            />\n            <Badge variant=\"secondary\">\n              {canvasElements.length} elements\n            </Badge>\n          </div>\n        </div>\n\n        <div className=\"flex items-center space-x-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setShowGrid(!showGrid)}\n            className={showGrid ? 'bg-[var(--hive-brand-primary)]/20 border-[var(--hive-brand-primary)]' : ''}\n          >\n            <Grid className=\"h-4 w-4\" />\n          </Button>\n          \n          <div className=\"flex items-center space-x-1 bg-hive-background-tertiary rounded-lg p-1\">\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => setZoom(Math.max(0.5, zoom - 0.1))}\n            >\n              -\n            </Button>\n            <span className=\"text-sm text-white px-2\">{Math.round(zoom * 100)}%</span>\n            <Button\n              variant=\"outline\"\n              className=\"max-w-sm\"\n              onClick={() => setZoom(Math.min(2, zoom + 0.1))}\n            >\n              +\n            </Button>\n          </div>\n\n          <Button\n            variant=\"outline\"\n            onClick={handlePreview}\n            disabled={canvasElements.length === 0}\n          >\n            <Play className=\"h-4 w-4 mr-2\" />\n            Preview\n          </Button>\n          \n          <Button\n            onClick={handleSave}\n            disabled={!toolName.trim() || canvasElements.length === 0}\n            className=\"bg-[var(--hive-brand-primary)] text-hive-obsidian hover:bg-hive-champagne\"\n          >\n            <Save className=\"h-4 w-4 mr-2\" />\n            Save Tool\n          </Button>\n          \n          <Button variant=\"outline\" onClick={onCancel}>\n            Cancel\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex-1 flex\">\n        {/* Element Palette */}\n        <div className=\"w-80 border-r border-hive-border-default bg-hive-background-overlay\">\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\n            <TabsList className=\"grid w-full grid-cols-2 m-2\">\n              <TabsTrigger value=\"elements\">\n                <Layers className=\"h-4 w-4 mr-2\" />\n                Elements\n              </TabsTrigger>\n              <TabsTrigger value=\"properties\">\n                <Settings className=\"h-4 w-4 mr-2\" />\n                Properties\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"elements\" className=\"p-4 space-y-4\">\n              {elementCategories.map(category => {\n                const elements = elementRegistry.current.getElementsByCategory(category.id);\n                return (\n                  <div key={category.id}>\n                    <h3 className={`text-sm font-medium mb-2 ${category.color}`}>\n                      {category.name} ({elements.length})\n                    </h3>\n                    <div className=\"space-y-2\">\n                      {elements.map(element => (\n                        <div\n                          key={element.id}\n                          draggable\n                          onDragStart={() => handleDragStart(element)}\n                          className=\"p-3 bg-hive-background-tertiary rounded-lg cursor-move hover:bg-hive-background-secondary transition-colors\"\n                        >\n                          <div className=\"flex items-center space-x-2\">\n                            <div className={`w-8 h-8 rounded flex items-center justify-center bg-hive-background-primary ${category.color}`}>\n                              <span className=\"text-xs\">üì¶</span>\n                            </div>\n                            <div className=\"flex-1 min-w-0\">\n                              <h4 className=\"text-sm font-medium text-white truncate\">\n                                {element.name}\n                              </h4>\n                              <p className=\"text-xs text-hive-text-mutedLight truncate\">\n                                {element.description}\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                );\n              })}\n            </TabsContent>\n\n            <TabsContent value=\"properties\" className=\"p-4\">\n              {selectedCanvasElement && selectedElementDef ? (\n                <div className=\"space-y-4\">\n                  <div>\n                    <h3 className=\"text-lg font-medium text-white mb-2\">\n                      {selectedElementDef.name}\n                    </h3>\n                    <p className=\"text-sm text-hive-text-mutedLight mb-4\">\n                      {selectedElementDef.description}\n                    </p>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <div>\n                      <Label className=\"text-white\">Position</Label>\n                      <div className=\"flex space-x-2 mt-1\">\n                        <Input\n                          type=\"number\"\n                          value={selectedCanvasElement.position.x}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementMove(selectedCanvasElement.id, {\n                            x: parseInt((e.target as any).value) || 0,\n                            y: selectedCanvasElement.position.y\n                          })}\n                          className=\"w-20\"\n                        />\n                        <Input\n                          type=\"number\"\n                          value={selectedCanvasElement.position.y}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementMove(selectedCanvasElement.id, {\n                            x: selectedCanvasElement.position.x,\n                            y: parseInt((e.target as any).value) || 0\n                          })}\n                          className=\"w-20\"\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <Label className=\"text-white\">Size</Label>\n                      <div className=\"flex space-x-2 mt-1\">\n                        <Input\n                          type=\"number\"\n                          value={selectedCanvasElement.size.width}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementResize(selectedCanvasElement.id, {\n                            width: parseInt((e.target as any).value) || 100,\n                            height: selectedCanvasElement.size.height\n                          })}\n                          className=\"w-20\"\n                        />\n                        <Input\n                          type=\"number\"\n                          value={selectedCanvasElement.size.height}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementResize(selectedCanvasElement.id, {\n                            width: selectedCanvasElement.size.width,\n                            height: parseInt((e.target as any).value) || 50\n                          })}\n                          className=\"w-20\"\n                        />\n                      </div>\n                    </div>\n\n                    {Object.entries(selectedElementDef.configSchema).map(([key, schema]) => (\n                      <div key={key}>\n                        <Label className=\"text-white capitalize\">{key}</Label>\n                        {(schema as any).type === 'string' && (\n                          <Input\n                            value={selectedCanvasElement.config[key] || ''}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementConfigChange(selectedCanvasElement.id, {\n                              [key]: (e.target as any).value\n                            })}\n                            className=\"mt-1\"\n                          />\n                        )}\n                        {(schema as any).type === 'boolean' && (\n                          <div className=\"mt-1\">\n                            <Button\n                              variant=\"outline\"\n                              className={`max-w-sm ${selectedCanvasElement.config[key] ? 'bg-green-500/20 border-green-500' : ''}`}\n                              onClick={() => handleElementConfigChange(selectedCanvasElement.id, {\n                                [key]: !selectedCanvasElement.config[key]\n                              })}\n                            >\n                              {selectedCanvasElement.config[key] ? 'True' : 'False'}\n                            </Button>\n                          </div>\n                        )}\n                        {(schema as any).type === 'number' && (\n                          <Input\n                            type=\"number\"\n                            value={selectedCanvasElement.config[key] || 0}\n                            onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleElementConfigChange(selectedCanvasElement.id, {\n                              [key]: parseInt((e.target as any).value) || 0\n                            })}\n                            className=\"mt-1\"\n                          />\n                        )}\n                      </div>\n                    ))}\n                  </div>\n\n                  <div className=\"pt-4 border-t border-hive-border-default\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"max-w-sm text-red-400 border-red-400 hover:bg-red-500/10\"\n                      onClick={() => handleElementDelete(selectedCanvasElement.id)}\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      Delete Element\n                    </Button>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-8\">\n                  <Settings className=\"h-12 w-12 mx-auto mb-3 text-hive-text-mutedLight opacity-50\" />\n                  <p className=\"text-hive-text-mutedLight\">\n                    Select an element to view its properties\n                  </p>\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n\n        {/* Canvas */}\n        <div className=\"flex-1 relative overflow-hidden\">\n          <div\n            ref={canvasRef}\n            className={`w-full h-full relative ${showGrid ? 'bg-grid-pattern' : ''}`}\n            style={{ \n              transform: `scale(${zoom})`,\n              transformOrigin: 'top left',\n              backgroundSize: showGrid ? `${20 * zoom}px ${20 * zoom}px` : 'none'\n            }}\n            onDrop={handleCanvasDrop}\n            onDragOver={handleCanvasDragOver}\n            onClick={() => setSelectedElement(null)}\n          >\n            {/* Canvas Elements */}\n            {canvasElements.map(element => {\n              const elementDef = elementRegistry.current.getElement(element.elementId);\n              if (!elementDef) return null;\n\n              return (\n                <div\n                  key={element.id}\n                  className={`absolute bg-hive-background-overlay border-2 rounded-lg p-3 cursor-move ${\n                    element.isSelected \n                      ? 'border-[var(--hive-brand-primary)] shadow-lg shadow-hive-gold/20' \n                      : 'border-hive-border-default hover:border-hive-border-hover'\n                  }`}\n                  style={{\n                    left: element.position.x,\n                    top: element.position.y,\n                    width: element.size.width,\n                    height: element.size.height\n                  }}\n                  onClick={(e: React.MouseEvent) => {\n                    e.stopPropagation();\n                    handleElementSelect(element.id);\n                  }}\n                >\n                  <div className=\"flex items-center space-x-2 mb-2\">\n                    <div className=\"w-4 h-4 bg-[var(--hive-brand-primary)] rounded flex items-center justify-center\">\n                      <span className=\"text-xs\">üì¶</span>\n                    </div>\n                    <span className=\"text-sm font-medium text-white truncate\">\n                      {elementDef.name}\n                    </span>\n                  </div>\n                  \n                  <div className=\"text-xs text-hive-text-mutedLight\">\n                    {elementDef.description}\n                  </div>\n\n                  {/* Connection Points */}\n                  <div className=\"absolute -right-2 top-1/2 w-4 h-4 bg-blue-500 rounded-full cursor-pointer transform -translate-y-1/2\"\n                       onClick={(e: React.MouseEvent) => {\n                         e.stopPropagation();\n                         handleConnectionStart(element.instanceId, 'output', element.position.x + element.size.width, element.position.y + element.size.height / 2);\n                       }}>\n                    <ArrowRight className=\"h-3 w-3 text-white m-0.5\" />\n                  </div>\n                  \n                  <div className=\"absolute -left-2 top-1/2 w-4 h-4 bg-green-500 rounded-full cursor-pointer transform -translate-y-1/2\"\n                       onClick={(e: React.MouseEvent) => {\n                         e.stopPropagation();\n                         handleConnectionEnd(element.instanceId, 'input', element.position.x, element.position.y + element.size.height / 2);\n                       }}>\n                    <ArrowRight className=\"h-3 w-3 text-white m-0.5 rotate-180\" />\n                  </div>\n                </div>\n              );\n            })}\n\n            {/* Connections */}\n            <svg className=\"absolute inset-0 pointer-events-none\">\n              {connections.map(connection => (\n                <line\n                  key={connection.id}\n                  x1={connection.from.x}\n                  y1={connection.from.y}\n                  x2={connection.to.x}\n                  y2={connection.to.y}\n                  stroke=\"#D4AF37\"\n                  strokeWidth=\"2\"\n                  markerEnd=\"url(#arrowhead)\"\n                />\n              ))}\n              <defs>\n                <marker\n                  id=\"arrowhead\"\n                  markerWidth=\"10\"\n                  markerHeight=\"7\"\n                  refX=\"9\"\n                  refY=\"3.5\"\n                  orient=\"auto\"\n                >\n                  <polygon\n                    points=\"0 0, 10 3.5, 0 7\"\n                    fill=\"#D4AF37\"\n                  />\n                </marker>\n              </defs>\n            </svg>\n\n            {/* Empty State */}\n            {canvasElements.length === 0 && (\n              <div className=\"absolute inset-0 flex items-center justify-center\">\n                <div className=\"text-center\">\n                  <Box className=\"h-16 w-16 mx-auto mb-4 text-hive-text-mutedLight opacity-50\" />\n                  <h3 className=\"text-lg font-medium text-white mb-2\">\n                    Start Building Your Tool\n                  </h3>\n                  <p className=\"text-hive-text-mutedLight mb-4\">\n                    Drag elements from the palette to create your custom tool\n                  </p>\n                  <div className=\"flex items-center justify-center space-x-2 text-sm text-hive-text-mutedLight\">\n                    <span>üí° Tip: Connect elements to create data flow</span>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Status Bar */}\n      <div className=\"h-8 bg-hive-background-tertiary border-t border-hive-border-default flex items-center justify-between px-4 text-xs text-hive-text-mutedLight\">\n        <div className=\"flex items-center space-x-4\">\n          <span>Canvas: {canvasSize.width} √ó {canvasSize.height}</span>\n          <span>Elements: {canvasElements.length}</span>\n          <span>Connections: {connections.length}</span>\n        </div>\n        <div className=\"flex items-center space-x-4\">\n          {isConnecting && (\n            <div className=\"flex items-center space-x-2 text-[var(--hive-brand-primary)]\">\n              <Link className=\"h-3 w-3\" />\n              <span>Click target element to connect</span>\n            </div>\n          )}\n          <span>Zoom: {Math.round(zoom * 100)}%</span>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/ui/touch-safe-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/components/welcome-mat-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-api-spaces.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-calendar-data.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Event' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":78,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":83}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { fetchCalendarEvents, transformApiEvent, type CalendarApiEvent, type Event } from '../lib/calendar-api';\n\n// Local type definitions since these are not exported from @hive/ui\ntype CalendarCardState = 'idle' | 'loading' | 'success' | 'error' | 'empty' | 'default';\ninterface CalendarCardData {\n  nextEvent?: any;\n  upcomingEvents?: any[];\n  todaysEvents?: any[];\n  connections?: any[];\n  conflicts?: any[];\n  lastUpdated?: Date;\n  events?: any[];\n  upcomingCount?: number;\n}\n\n\ninterface UseCalendarDataOptions {\n  fetchEvents?: () => Promise<CalendarApiEvent[]>;\n  autoFetch?: boolean;\n}\n\ninterface UseCalendarDataResult {\n  data: CalendarCardData | undefined;\n  state: CalendarCardState;\n  refetch: () => void;\n  isLoading: boolean;\n  error: string | undefined;\n}\n\n/**\n * Hook for managing calendar data in HIVE dashboard\n * Provides mock data by default, but can be configured to fetch real data\n */\n/**\n * Convert time string like \"2:00 PM\" to minutes since midnight\n */\nconst convertTimeToMinutes = (timeStr: string): number => {\n  if (!timeStr) return 0;\n  \n  const [time, period] = timeStr.split(' ');\n  if (!time || !period) return 0;\n  \n  const [hours, minutes] = time.split(':').map(Number);\n  if (isNaN(hours) || isNaN(minutes)) return 0;\n  \n  let totalMinutes = minutes;\n  \n  if (period === 'AM') {\n    totalMinutes += hours === 12 ? 0 : hours * 60;\n  } else if (period === 'PM') {\n    totalMinutes += hours === 12 ? 12 * 60 : (hours + 12) * 60;\n  }\n  \n  return totalMinutes;\n};\n\nexport const useCalendarData = (options: UseCalendarDataOptions = {}): UseCalendarDataResult => {\n  const { fetchEvents = fetchCalendarEvents, autoFetch = true } = options;\n  const [data, setData] = useState<CalendarCardData | undefined>();\n  const [state, setState] = useState<CalendarCardState>('loading');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | undefined>();\n\n  const refetch = useCallback(async () => {\n    if (!fetchEvents) {\n      // No data source - show empty state\n      setData(undefined);\n      setState('empty' as CalendarCardState);\n      return;\n    }\n\n    setIsLoading(true);\n    setState('loading');\n    setError(undefined);\n\n    try {\n      const apiEvents = await fetchEvents();\n      \n      if (!apiEvents || apiEvents.length === 0) {\n        setState('empty' as CalendarCardState);\n        setData(undefined);\n      } else {\n        // Transform API events to UI Event format\n        const events = apiEvents.map(transformApiEvent);\n        \n        // Sort events by time to get the next upcoming event\n        const sortedEvents = events.sort((a: any, b: any) => {\n          const timeA = convertTimeToMinutes(a.time || '');\n          const timeB = convertTimeToMinutes(b.time || '');\n          return timeA - timeB;\n        });\n\n        const transformedData: CalendarCardData = {\n          nextEvent: sortedEvents[0],\n          upcomingEvents: sortedEvents.slice(1, 6), // Limit to 5 upcoming events\n          todaysEvents: sortedEvents,\n          connections: [\n            {\n              id: 'google',\n              name: 'Google',\n              type: 'google',\n              status: 'disconnected', // Default to disconnected until user connects\n              color: '#4285f4'\n            },\n            {\n              id: 'university',\n              name: 'University',\n              type: 'university',\n              status: 'disconnected', // Default to disconnected until user connects\n              color: '#ffd700'\n            }\n          ],\n          conflicts: [], // TODO: Implement conflict detection\n          lastUpdated: new Date()\n        };\n        \n        setData(transformedData);\n        setState('default' as CalendarCardState);\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch events');\n      setState('error');\n      setData(undefined);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [fetchEvents]);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch, autoFetch]);\n\n  return {\n    data,\n    state,\n    refetch,\n    isLoading,\n    error\n  };\n};\n\nexport default useCalendarData;","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-calendar-integration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-connections.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserConnections' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'result' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":142,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":142,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Connections Hook\n * Manages connections, friends, and friend requests\n */\n\n'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '@hive/auth-logic';\nimport type {\n  Connection,\n  Friend,\n  FriendRequest,\n  UserConnections\n} from '@hive/core';\n\ninterface ConnectionsState {\n  connections: Connection[];\n  friends: Friend[];\n  receivedRequests: FriendRequest[];\n  sentRequests: FriendRequest[];\n  stats: {\n    totalConnections: number;\n    totalFriends: number;\n    onlineFriends: number;\n    pendingReceived: number;\n    pendingSent: number;\n    averageStrength: number;\n  };\n  isLoading: boolean;\n  error: any | null;\n}\n\ninterface UseConnectionsReturn extends ConnectionsState {\n  // Connection actions\n  detectConnections: () => Promise<void>;\n  refreshConnections: () => Promise<void>;\n\n  // Friend actions\n  sendFriendRequest: (toUserId: string, message?: string) => Promise<void>;\n  acceptFriendRequest: (requestId: string) => Promise<void>;\n  rejectFriendRequest: (requestId: string) => Promise<void>;\n  unfriend: (friendId: string) => Promise<void>;\n\n  // Utility functions\n  isConnected: (userId: string) => boolean;\n  isFriend: (userId: string) => boolean;\n  hasPendingRequest: (userId: string) => boolean;\n  getConnectionStrength: (userId: string) => number;\n}\n\nexport function useConnections(): UseConnectionsReturn {\n  const { user } = useAuth();\n  const [state, setState] = useState<ConnectionsState>({\n    connections: [],\n    friends: [],\n    receivedRequests: [],\n    sentRequests: [],\n    stats: {\n      totalConnections: 0,\n      totalFriends: 0,\n      onlineFriends: 0,\n      pendingReceived: 0,\n      pendingSent: 0,\n      averageStrength: 0\n    },\n    isLoading: true,\n    error: null\n  });\n\n  // Fetch all connection data\n  const fetchConnections = useCallback(async () => {\n    if (!user) {\n      setState(prev => ({ ...prev, isLoading: false }));\n      return;\n    }\n\n    try {\n      setState(prev => ({ ...prev, isLoading: true, error: null }));\n\n      // Fetch connections\n      const connectionsResponse = await fetch('/api/connections', {\n        credentials: 'include'\n      });\n\n      if (!connectionsResponse.ok) {\n        throw new Error('Failed to fetch connections');\n      }\n\n      const connectionsData = await connectionsResponse.json();\n\n      // Fetch friends and requests\n      const friendsResponse = await fetch('/api/friends', {\n        credentials: 'include'\n      });\n\n      if (!friendsResponse.ok) {\n        throw new Error('Failed to fetch friends');\n      }\n\n      const friendsData = await friendsResponse.json();\n\n      setState({\n        connections: connectionsData.connections || [],\n        friends: friendsData.friends || [],\n        receivedRequests: friendsData.receivedRequests || [],\n        sentRequests: friendsData.sentRequests || [],\n        stats: {\n          totalConnections: connectionsData.stats?.totalConnections || 0,\n          totalFriends: friendsData.stats?.totalFriends || 0,\n          onlineFriends: friendsData.stats?.onlineFriends || 0,\n          pendingReceived: friendsData.stats?.pendingReceived || 0,\n          pendingSent: friendsData.stats?.pendingSent || 0,\n          averageStrength: connectionsData.stats?.averageStrength || 0\n        },\n        isLoading: false,\n        error: null\n      });\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        isLoading: false,\n        error: error as Error\n      }));\n    }\n  }, [user]);\n\n  // Detect new connections based on affiliations\n  const detectConnections = useCallback(async () => {\n    if (!user) return;\n\n    const response = await fetch('/api/connections', {\n      method: 'POST',\n      credentials: 'include'\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to detect connections');\n    }\n\n    const result = await response.json();\n\n    // Refresh connections list\n    await fetchConnections();\n  }, [user, fetchConnections]);\n\n  // Send friend request\n  const sendFriendRequest = useCallback(async (toUserId: string, message?: string) => {\n    if (!user) throw new Error('Not authenticated');\n\n    const response = await fetch('/api/friends', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include',\n      body: JSON.stringify({ toUserId, message })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to send friend request');\n    }\n\n    // Refresh friends list\n    await fetchConnections();\n  }, [user, fetchConnections]);\n\n  // Accept friend request\n  const acceptFriendRequest = useCallback(async (requestId: string) => {\n    if (!user) throw new Error('Not authenticated');\n\n    const response = await fetch('/api/friends', {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include',\n      body: JSON.stringify({ requestId, action: 'accept' })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to accept friend request');\n    }\n\n    // Refresh friends list\n    await fetchConnections();\n  }, [user, fetchConnections]);\n\n  // Reject friend request\n  const rejectFriendRequest = useCallback(async (requestId: string) => {\n    if (!user) throw new Error('Not authenticated');\n\n    const response = await fetch('/api/friends', {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include',\n      body: JSON.stringify({ requestId, action: 'reject' })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to reject friend request');\n    }\n\n    // Refresh friends list\n    await fetchConnections();\n  }, [user, fetchConnections]);\n\n  // Unfriend\n  const unfriend = useCallback(async (friendId: string) => {\n    if (!user) throw new Error('Not authenticated');\n\n    const response = await fetch(`/api/friends/${friendId}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to unfriend');\n    }\n\n    // Refresh friends list\n    await fetchConnections();\n  }, [user, fetchConnections]);\n\n  // Utility functions\n  const isConnected = useCallback((userId: string) => {\n    return state.connections.some(c => c.userId === userId);\n  }, [state.connections]);\n\n  const isFriend = useCallback((userId: string) => {\n    return state.friends.some(f => f.userId === userId);\n  }, [state.friends]);\n\n  const hasPendingRequest = useCallback((userId: string) => {\n    return (\n      state.sentRequests.some(r => r.toUserId === userId && r.status === 'pending') ||\n      state.receivedRequests.some(r => r.fromUserId === userId && r.status === 'pending')\n    );\n  }, [state.sentRequests, state.receivedRequests]);\n\n  const getConnectionStrength = useCallback((userId: string) => {\n    const connection = state.connections.find(c => c.userId === userId);\n    return connection?.strength || 0;\n  }, [state.connections]);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchConnections();\n  }, [fetchConnections]);\n\n  // Auto-detect connections on first load\n  useEffect(() => {\n    if (user && state.connections.length === 0 && !state.isLoading) {\n      detectConnections();\n    }\n  }, [user, state.connections.length, state.isLoading, detectConnections]);\n\n  return {\n    ...state,\n    detectConnections,\n    refreshConnections: fetchConnections,\n    sendFriendRequest,\n    acceptFriendRequest,\n    rejectFriendRequest,\n    unfriend,\n    isConnected,\n    isFriend,\n    hasPendingRequest,\n    getConnectionStrength\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-csrf.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-dashboard-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-enhanced-command-palette.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-feed.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'feedState.posts.length'. Either include it or remove the dependency array.","line":155,"column":6,"nodeType":"ArrayExpression","endLine":155,"endColumn":105,"suggestions":[{"desc":"Update the dependencies array to be: [user, feedState.posts.length, options.limit, options.spaceId, options.userId, options.sortBy, options.types, getAuthToken]","fix":{"range":[4266,4365],"text":"[user, feedState.posts.length, options.limit, options.spaceId, options.userId, options.sortBy, options.types, getAuthToken]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'getAuthToken'. Either include it or remove the dependency array.","line":211,"column":6,"nodeType":"ArrayExpression","endLine":211,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [getAuthToken, user]","fix":{"range":[5653,5659],"text":"[getAuthToken, user]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'getAuthToken'. Either include it or remove the dependency array.","line":302,"column":6,"nodeType":"ArrayExpression","endLine":302,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [user, getAuthToken, loadPosts]","fix":{"range":[8393,8410],"text":"[user, getAuthToken, loadPosts]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'options'. Either include it or remove the dependency array.","line":353,"column":52,"nodeType":"ArrayExpression","endLine":359,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [options]","fix":{"range":[9856,9970],"text":"[options]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":358,"column":5,"nodeType":"ChainExpression","endLine":358,"endColumn":29}],"suppressedMessages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useRealtimeFeed\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":374,"column":28,"nodeType":"Identifier","endLine":374,"endColumn":43,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '@hive/auth-logic';\n\nexport interface Post {\n  id: string;\n  content: string;\n  type: 'text' | 'image' | 'video' | 'link' | 'poll' | 'event' | 'tool' | 'announcement';\n  authorId: string;\n  author: {\n    id: string;\n    name: string;\n    handle: string;\n    avatarUrl?: string;\n    isVerified?: boolean;\n    badges?: string[];\n  };\n  createdAt: string;\n  updatedAt?: string;\n  visibility: 'public' | 'space' | 'private';\n  spaceId?: string;\n  spaceName?: string;\n  attachments?: any[];\n  mentions?: string[];\n  tags?: string[];\n  poll?: any;\n  event?: any;\n  location?: any;\n  engagement: {\n    likes: number;\n    comments: number;\n    shares: number;\n    views: number;\n    hasLiked: boolean;\n    hasBookmarked: boolean;\n  };\n  reactions?: any;\n  comments?: any[];\n  isPinned?: boolean;\n  isEdited?: boolean;\n}\n\nexport interface FeedState {\n  posts: Post[];\n  isLoading: boolean;\n  isLoadingMore: boolean;\n  hasMore: boolean;\n  error: string | null;\n  lastUpdated: Date | null;\n}\n\nexport interface FeedOptions {\n  spaceId?: string;\n  userId?: string;\n  limit?: number;\n  sortBy?: 'recent' | 'popular' | 'trending';\n  types?: string[];\n  enableRealtime?: boolean; // Use Firebase real-time listeners instead of polling\n}\n\nexport interface PostInteraction {\n  postId: string;\n  action: 'like' | 'unlike' | 'comment' | 'share' | 'bookmark' | 'unbookmark';\n  content?: string;\n  metadata?: Record<string, any>;\n}\n\nexport function useFeed(options: FeedOptions = {}) {\n  // Always call hooks at the top level\n  const { user } = useAuth();\n  const getAuthToken = user?.getIdToken;\n  const [feedState, setFeedState] = useState<FeedState>({\n    posts: [],\n    isLoading: true,\n    isLoadingMore: false,\n    hasMore: true,\n    error: null,\n    lastUpdated: null,\n  });\n\n  // Load feed posts\n  const loadPosts = useCallback(async (reset = false) => {\n    if (!user) return;\n\n    const isInitialLoad = reset || feedState.posts.length === 0;\n    setFeedState(prev => ({\n      ...prev,\n      isLoading: isInitialLoad,\n      isLoadingMore: !isInitialLoad,\n      error: null,\n    }));\n\n    try {\n      const params = new URLSearchParams({\n        limit: String(options.limit || 20),\n        ...(options.spaceId && { spaceId: options.spaceId }),\n        ...(options.userId && { userId: options.userId }),\n        ...(options.sortBy && { sortBy: options.sortBy }),\n        ...(options.types && { types: options.types.join(',') }),\n        ...(!reset && { offset: String(feedState.posts.length) }),\n      });\n\n      const authToken = getAuthToken ? await getAuthToken() : '';\n      const response = await fetch(`/api/feed?${params}`, {\n        headers: {\n          'Authorization': `Bearer ${authToken}`,\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(`Feed load failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (!data.success) {\n        throw new Error(data.error || 'Failed to load feed');\n      }\n\n      // Safely handle the posts array\n      const posts = Array.isArray(data.posts) ? data.posts : [];\n\n      // Transform the posts to match our interface\n      const transformedPosts: Post[] = posts.map((post: any) => ({\n        ...post,\n        engagement: {\n          likes: post.engagement?.likes || 0,\n          comments: post.engagement?.comments || 0,\n          shares: post.engagement?.shares || 0,\n          views: post.engagement?.views || 0,\n          hasLiked: post.userInteractions?.hasLiked || false,\n          hasBookmarked: post.userInteractions?.hasBookmarked || false,\n        },\n      }));\n\n      setFeedState(prev => ({\n        ...prev,\n        posts: reset ? transformedPosts : [...prev.posts, ...transformedPosts],\n        isLoading: false,\n        isLoadingMore: false,\n        hasMore: transformedPosts.length === (options.limit || 20),\n        lastUpdated: new Date(),\n      }));\n    } catch (error) {\n      console.error('Feed load error:', error);\n      setFeedState(prev => ({\n        ...prev,\n        isLoading: false,\n        isLoadingMore: false,\n        error: error instanceof Error ? error.message : String(error),\n      }));\n    }\n  }, [user, getAuthToken, options.limit, options.spaceId, options.userId, options.sortBy, options.types]);\n\n  // Create a new post\n  const createPost = useCallback(async (postData: {\n    content: string;\n    type: string;\n    visibility: string;\n    spaceId?: string;\n    attachments?: any[];\n    tags?: string[];\n    mentions?: string[];\n    poll?: any;\n    event?: any;\n    location?: any;\n  }) => {\n    if (!user) throw new Error('Authentication required');\n\n    const response = await fetch('/api/social/posts', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${getAuthToken ? await getAuthToken() : ''}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(postData),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Post creation failed: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (!data.success) {\n      throw new Error(data.error || 'Failed to create post');\n    }\n\n    // Add the new post to the beginning of the feed\n    const newPost: Post = {\n      ...data.post,\n      engagement: {\n        likes: 0,\n        comments: 0,\n        shares: 0,\n        views: 0,\n        hasLiked: false,\n        hasBookmarked: false,\n      },\n    };\n\n    setFeedState(prev => ({\n      ...prev,\n      posts: [newPost, ...prev.posts],\n      lastUpdated: new Date(),\n    }));\n\n    return data.post;\n  }, [user]);\n\n  // Handle post interactions\n  const interactWithPost = useCallback(async (interaction: PostInteraction) => {\n    if (!user) throw new Error('Authentication required');\n\n    // Optimistically update the UI\n    setFeedState(prev => ({\n      ...prev,\n      posts: prev.posts.map(post => {\n        if (post.id !== interaction.postId) return post;\n\n        const newEngagement = { ...post.engagement };\n        \n        switch (interaction.action) {\n          case 'like':\n            newEngagement.likes += 1;\n            newEngagement.hasLiked = true;\n            break;\n          case 'unlike':\n            newEngagement.likes = Math.max(0, newEngagement.likes - 1);\n            newEngagement.hasLiked = false;\n            break;\n          case 'bookmark':\n            newEngagement.hasBookmarked = true;\n            break;\n          case 'unbookmark':\n            newEngagement.hasBookmarked = false;\n            break;\n          case 'comment':\n            newEngagement.comments += 1;\n            break;\n          case 'share':\n            newEngagement.shares += 1;\n            break;\n        }\n\n        return {\n          ...post,\n          engagement: newEngagement,\n        };\n      }),\n    }));\n\n    try {\n      const response = await fetch('/api/social/interactions', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${getAuthToken ? await getAuthToken() : ''}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(interaction),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Interaction failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n      \n      if (!data.success) {\n        throw new Error(data.error || 'Failed to process interaction');\n      }\n\n      // Update with real engagement data from server\n      setFeedState(prev => ({\n        ...prev,\n        posts: prev.posts.map(post => {\n          if (post.id !== interaction.postId) return post;\n          \n          return {\n            ...post,\n            engagement: {\n              likes: data.engagement?.likes || post.engagement.likes,\n              comments: data.engagement?.comments || post.engagement.comments,\n              shares: data.engagement?.shares || post.engagement.shares,\n              views: data.engagement?.views || post.engagement.views,\n              hasLiked: data.reactions?.heart > 0 || false,\n              hasBookmarked: data.reactions?.bookmarks > 0 || false,\n            },\n            reactions: data.reactions,\n          };\n        }),\n      }));\n\n    } catch (error) {\n      console.error('Interaction error:', error);\n      // Revert optimistic update on error\n      loadPosts(true);\n      throw error;\n    }\n  }, [user, loadPosts]);\n\n  // Convenient interaction methods\n  const likePost = useCallback(async (postId: string) => {\n    const post = feedState.posts.find(p => p.id === postId);\n    if (!post) return;\n    \n    await interactWithPost({\n      postId,\n      action: post.engagement.hasLiked ? 'unlike' : 'like',\n    });\n  }, [feedState.posts, interactWithPost]);\n\n  const bookmarkPost = useCallback(async (postId: string) => {\n    const post = feedState.posts.find(p => p.id === postId);\n    if (!post) return;\n    \n    await interactWithPost({\n      postId,\n      action: post.engagement.hasBookmarked ? 'unbookmark' : 'bookmark',\n    });\n  }, [feedState.posts, interactWithPost]);\n\n  const sharePost = useCallback(async (postId: string) => {\n    await interactWithPost({\n      postId,\n      action: 'share',\n    });\n  }, [interactWithPost]);\n\n  const commentOnPost = useCallback(async (postId: string, content: string) => {\n    await interactWithPost({\n      postId,\n      action: 'comment',\n      content,\n    });\n  }, [interactWithPost]);\n\n  // Load more posts\n  const loadMore = useCallback(() => {\n    if (!feedState.isLoadingMore && feedState.hasMore) {\n      loadPosts(false);\n    }\n  }, [feedState.isLoadingMore, feedState.hasMore, loadPosts]);\n\n  // Refresh feed\n  const refresh = useCallback(() => {\n    loadPosts(true);\n  }, [loadPosts]);\n\n  // Stabilize options object to prevent unnecessary re-renders\n  const stableOptions = useCallback(() => options, [\n    options.limit,\n    options.spaceId,\n    options.userId,\n    options.sortBy,\n    options.types?.join(',')\n  ]);\n\n  // Initial load\n  useEffect(() => {\n    if (user) {\n      loadPosts(true);\n    }\n  }, [user, loadPosts, stableOptions]);\n\n  // Try to use real-time feed if enabled\n  let realtimeFeedResult: any = null;\n  try {\n    if (options.enableRealtime) {\n      const { useRealtimeFeed } = require('./use-realtime-feed');\n      // eslint-disable-next-line react-hooks/rules-of-hooks\n      realtimeFeedResult = useRealtimeFeed(options);\n    }\n  } catch (e) {\n    // Real-time feed not available\n  }\n\n  // If real-time is enabled and available, return the real-time feed\n  if (options.enableRealtime && realtimeFeedResult) {\n    return realtimeFeedResult;\n  }\n\n  return {\n    // State\n    posts: feedState.posts,\n    isLoading: feedState.isLoading,\n    isLoadingMore: feedState.isLoadingMore,\n    hasMore: feedState.hasMore,\n    error: feedState.error,\n    lastUpdated: feedState.lastUpdated,\n\n    // Actions\n    createPost,\n    likePost,\n    bookmarkPost,\n    sharePost,\n    commentOnPost,\n    loadMore,\n    refresh,\n\n    // Raw interaction method\n    interactWithPost,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-hive-profile.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DEFAULT_PRIVACY_SETTINGS' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DEFAULT_BUILDER_INFO' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ApiProfileData' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state.profile'. Either include it or remove the dependency array.","line":382,"column":6,"nodeType":"ArrayExpression","endLine":382,"endColumn":64,"suggestions":[{"desc":"Update the dependencies array to be: [isAuthenticated, user, getAuthHeaders, handleApiResponse, state.profile]","fix":{"range":[12027,12085],"text":"[isAuthenticated, user, getAuthHeaders, handleApiResponse, state.profile]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadProfile' and 'user'. Either include them or remove the dependency array.","line":600,"column":6,"nodeType":"ArrayExpression","endLine":600,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isAuthenticated, loadProfile, user, user.id]","fix":{"range":[18959,18986],"text":"[isAuthenticated, loadProfile, user, user.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'refreshDashboard', 'state.dashboard', and 'state.profile'. Either include them or remove the dependency array.","line":607,"column":6,"nodeType":"ArrayExpression","endLine":607,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [refreshDashboard, state.dashboard, state.profile, state.profile.identity.id]","fix":{"range":[19183,19212],"text":"[refreshDashboard, state.dashboard, state.profile, state.profile.identity.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { getSecureAuthHeaders, handleAuthError } from '../lib/secure-auth-utils';\nimport { \n  HiveProfile, \n  HiveProfileUpdateData,\n  HiveProfileDashboard,\n  getProfileCompleteness,\n  DEFAULT_PRIVACY_SETTINGS,\n  DEFAULT_BUILDER_INFO\n} from '@hive/core';\nimport { useSession } from './use-session';\n\ninterface HiveProfileState {\n  profile: HiveProfile | null;\n  dashboard: HiveProfileDashboard | null;\n  isLoading: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  completeness: number;\n}\n\ninterface CalendarEvent {\n  id: string;\n  title: string;\n  description?: string;\n  startDate: string;\n  endDate: string;\n  type: 'personal' | 'space' | 'class' | 'study' | 'meeting';\n  location?: string;\n  spaceId?: string;\n  spaceName?: string;\n  status: 'confirmed' | 'tentative' | 'cancelled';\n}\n\ninterface CalendarConflict {\n  id: string;\n  type: 'overlap' | 'double_booking' | 'travel_time';\n  severity: 'high' | 'medium' | 'low';\n  eventIds: string[];\n  description: string;\n  suggestion: string;\n  suggestedActions: Array<{\n    action: 'reschedule' | 'cancel' | 'shorten' | 'move_location';\n    eventId: string;\n    newTime?: string;\n    newLocation?: string;\n  }>;\n}\n\ninterface HiveProfileActions {\n  loadProfile: () => Promise<void>;\n  updateProfile: (data: HiveProfileUpdateData) => Promise<boolean>;\n  uploadAvatar: (file: File) => Promise<string | null>;\n  toggleGhostMode: (enabled: boolean) => Promise<void>;\n  refreshDashboard: () => Promise<void>;\n  clearError: () => void;\n  // Calendar management functions\n  createEvent: (event: Partial<CalendarEvent>) => Promise<CalendarEvent | null>;\n  updateEvent: (id: string, updates: Partial<CalendarEvent>) => Promise<boolean>;\n  deleteEvent: (id: string) => Promise<boolean>;\n  getCalendarEvents: (startDate?: string, endDate?: string) => Promise<CalendarEvent[]>;\n  detectConflicts: (newEvent?: Partial<CalendarEvent>) => Promise<CalendarConflict[]>;\n  resolveConflict: (conflictId: string, resolution: string, eventId?: string, newTime?: string) => Promise<boolean>;\n}\n\n// API response interfaces\ninterface ApiProfileData {\n  id: string;\n  fullName?: string;\n  handle?: string;\n  email?: string;\n  avatarUrl?: string;\n  profilePhoto?: string;\n  major?: string;\n  academicYear?: string;\n  graduationYear?: string;\n  schoolId?: string;\n  housing?: string;\n  pronouns?: string;\n  bio?: string;\n  statusMessage?: string;\n  interests?: string[];\n  isPublic?: boolean;\n  showActivity?: boolean;\n  showSpaces?: boolean;\n  showConnections?: boolean;\n  allowDirectMessages?: boolean;\n  showOnlineStatus?: boolean;\n  ghostMode?: {\n    enabled?: boolean;\n    level?: string;\n  };\n  isBuilder?: boolean;\n  builderOptIn?: boolean;\n  builderLevel?: string;\n  specializations?: string[];\n  toolsCreated?: number;\n  spacesJoined?: number;\n  spacesActive?: number;\n  spacesLed?: number;\n  toolsUsed?: number;\n  connectionsCount?: number;\n  totalActivity?: number;\n  currentStreak?: number;\n  longestStreak?: number;\n  reputation?: number;\n  achievements?: number;\n  createdAt?: string;\n  joinedAt?: string;\n  updatedAt?: string;\n  lastActive?: string;\n  lastActiveAt?: string;\n  lastSeenAt?: string;\n  emailVerified?: boolean;\n  profileVerified?: boolean;\n  accountStatus?: string;\n  userType?: string;\n  onboardingCompleted?: boolean;\n  [key: string]: any;\n}\n\nexport interface UseHiveProfileReturn extends HiveProfileState, HiveProfileActions {}\n\n/**\n * Centralized HIVE Profile Hook\n * Single source of truth for all profile data and operations\n * Integrates with HIVE's design system and atomic principles\n */\nexport function useHiveProfile(): UseHiveProfileReturn {\n  const { user, isAuthenticated } = useSession();\n  \n  const [state, setState] = useState<HiveProfileState>({\n    profile: null,\n    dashboard: null,\n    isLoading: false,\n    isUpdating: false,\n    error: null,\n    completeness: 0\n  });\n\n  // API Helper Functions - SECURITY HARDENED\n  const getAuthHeaders = useCallback(() => {\n    try {\n      return getSecureAuthHeaders();\n    } catch (error) {\n      handleAuthError(error as Error);\n      throw error;\n    }\n  }, []);\n\n  const handleApiResponse = useCallback(async (response: Response) => {\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({ message: 'Unknown error' })) as { message: string };\n      throw new Error(errorData.message || `HTTP ${response.status}: ${response.statusText}`);\n    }\n    return response.json();\n  }, []);\n\n  // No transformation needed - API returns HiveProfile format directly\n\n  // Load Profile Completion Status\n  const loadProfileCompletion = useCallback(async () => {\n    try {\n      const response = await fetch('/api/profile/completion', {\n        headers: getAuthHeaders()\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success && data.completion) {\n        return data.completion.completionPercentage;\n      }\n      return null;\n    } catch (error) {\n      console.error('Failed to load profile completion:', error);\n      return null;\n    }\n  }, [getAuthHeaders, handleApiResponse]);\n\n  // Load Profile Data\n  const loadProfile = useCallback(async () => {\n    if (!isAuthenticated || !user) return;\n\n    try {\n      setState(prev => ({ ...prev, isLoading: true, error: null }));\n\n      // Fetch profile and completion data in parallel\n      const [profileResponse, completionPercentage] = await Promise.all([\n        fetch('/api/profile', { headers: getAuthHeaders() }),\n        loadProfileCompletion()\n      ]);\n\n      const data = await handleApiResponse(profileResponse);\n\n      if (data.success && data.profile) {\n        // API now returns HiveProfile format directly\n        const profile = data.profile as HiveProfile;\n        const completeness = completionPercentage ?? getProfileCompleteness(profile);\n\n        setState(prev => ({\n          ...prev,\n          profile,\n          completeness,\n          isLoading: false\n        }));\n      } else {\n        throw new Error(data.error || 'Failed to load profile');\n      }\n    } catch (error) {\n      console.error('Failed to load profile:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isLoading: false\n      }));\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, loadProfileCompletion]);\n\n  // Update Profile\n  const updateProfile = useCallback(async (updateData: HiveProfileUpdateData): Promise<boolean> => {\n    if (!isAuthenticated || !user) return false;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      // Flatten update data for API compatibility\n      const apiUpdateData: Record<string, unknown> = {};\n\n      if (updateData.identity) {\n        Object.assign(apiUpdateData, updateData.identity);\n      }\n\n      if (updateData.academic) {\n        Object.assign(apiUpdateData, updateData.academic);\n      }\n\n      if (updateData.personal) {\n        if (updateData.personal.bio !== undefined) apiUpdateData.bio = updateData.personal.bio;\n        if (updateData.personal.statusMessage !== undefined) apiUpdateData.statusMessage = updateData.personal.statusMessage;\n        if (updateData.personal.interests !== undefined) apiUpdateData.interests = updateData.personal.interests;\n      }\n\n      if (updateData.privacy) {\n        Object.assign(apiUpdateData, updateData.privacy);\n      }\n\n      if (updateData.builder) {\n        Object.assign(apiUpdateData, updateData.builder);\n      }\n\n      const response = await fetch('/api/profile', {\n        method: 'PATCH',\n        headers: getAuthHeaders(),\n        body: JSON.stringify(apiUpdateData)\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        // Reload profile to get updated data\n        await loadProfile();\n        setState(prev => ({ ...prev, isUpdating: false }));\n        return true;\n      } else {\n        throw new Error(data.error || 'Failed to update profile');\n      }\n    } catch (error) {\n      console.error('Failed to update profile:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return false;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, loadProfile]);\n\n  // Upload Avatar\n  const uploadAvatar = useCallback(async (file: File): Promise<string | null> => {\n    if (!isAuthenticated || !user) return null;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      const formData = new FormData();\n      formData.append('photo', file);\n\n      const headers = getAuthHeaders();\n      // Remove Content-Type for FormData\n      const { 'Content-Type': _, ...headersWithoutContentType } = headers;\n      const finalHeaders = headersWithoutContentType;\n\n      const response = await fetch('/api/profile/upload-photo', {\n        method: 'POST',\n        headers: finalHeaders,\n        body: formData\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success && data.avatarUrl) {\n        // Update profile with new avatar URL\n        await updateProfile({\n          identity: { avatarUrl: data.avatarUrl }\n        });\n        \n        setState(prev => ({ ...prev, isUpdating: false }));\n        return data.avatarUrl;\n      } else {\n        throw new Error(data.error || 'Failed to upload avatar');\n      }\n    } catch (error) {\n      console.error('Failed to upload avatar:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return null;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, updateProfile]);\n\n  // Toggle Ghost Mode\n  const toggleGhostMode = useCallback(async (enabled: boolean) => {\n    await updateProfile({\n      privacy: {\n        ghostMode: {\n          enabled,\n          level: enabled ? 'moderate' : 'minimal'\n        }\n      }\n    });\n  }, [updateProfile]);\n\n  // Load Dashboard Data\n  const refreshDashboard = useCallback(async () => {\n    if (!isAuthenticated || !user) return;\n\n    try {\n      const response = await fetch('/api/profile/dashboard?timeRange=week&includeRecommendations=true', {\n        headers: getAuthHeaders()\n      });\n\n      const data = await handleApiResponse(response);\n      \n      if (data.success && data.dashboard) {\n        const dashboard: HiveProfileDashboard = {\n          profile: state.profile!, // Will be set by loadProfile\n          recentSpaces: data.dashboard.quickActions?.favoriteSpaces?.map((space: { id: string; name: string; color: string; memberCount: number; [key: string]: any }) => ({\n            id: space.id,\n            name: space.name,\n            type: 'favorite',\n            lastActivity: space.lastActivity,\n            memberCount: space.memberCount || 0,\n            role: 'member'\n          })) || [],\n          recentTools: [], // Would need to fetch from tools API\n          recentActivity: data.dashboard.recentActivity?.spaces?.map((activity: { spaceId: string; action: string; timestamp: string; [key: string]: any }, index: number) => ({\n            id: `activity-${index}`,\n            type: 'space' as const,\n            action: activity.action,\n            title: activity.spaceName,\n            timestamp: activity.timestamp\n          })) || [],\n          upcomingEvents: data.dashboard.upcomingEvents?.map((event: { id: string; title: string; date: string; type: string; [key: string]: any }) => ({\n            id: event.id,\n            title: event.title,\n            startDate: event.startDate,\n            type: event.type,\n            spaceId: event.spaceId\n          })) || []\n        };\n        \n        setState(prev => ({ ...prev, dashboard }));\n      }\n    } catch (error) {\n      console.error('Failed to load dashboard:', error);\n      // Don't set error state for dashboard failure - it's secondary data\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse]);\n\n  // Clear Error\n  const clearError = useCallback(() => {\n    setState(prev => ({ ...prev, error: null }));\n  }, []);\n\n  // Calendar Management Functions\n  const createEvent = useCallback(async (event: Partial<CalendarEvent>): Promise<CalendarEvent | null> => {\n    if (!isAuthenticated || !user) return null;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      const response = await fetch('/api/profile/calendar/events', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: JSON.stringify(event)\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        // Refresh dashboard to show new event\n        await refreshDashboard();\n        setState(prev => ({ ...prev, isUpdating: false }));\n        return data.event;\n      } else {\n        throw new Error(data.error || 'Failed to create event');\n      }\n    } catch (error) {\n      console.error('Failed to create event:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return null;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, refreshDashboard]);\n\n  const updateEvent = useCallback(async (id: string, updates: Partial<CalendarEvent>): Promise<boolean> => {\n    if (!isAuthenticated || !user) return false;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      const response = await fetch('/api/profile/calendar/events', {\n        method: 'PUT',\n        headers: getAuthHeaders(),\n        body: JSON.stringify({ id, ...updates })\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        // Refresh dashboard to show updated event\n        await refreshDashboard();\n        setState(prev => ({ ...prev, isUpdating: false }));\n        return true;\n      } else {\n        throw new Error(data.error || 'Failed to update event');\n      }\n    } catch (error) {\n      console.error('Failed to update event:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return false;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, refreshDashboard]);\n\n  const deleteEvent = useCallback(async (id: string): Promise<boolean> => {\n    if (!isAuthenticated || !user) return false;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      const response = await fetch(`/api/profile/calendar/events?id=${id}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        // Refresh dashboard to remove deleted event\n        await refreshDashboard();\n        setState(prev => ({ ...prev, isUpdating: false }));\n        return true;\n      } else {\n        throw new Error(data.error || 'Failed to delete event');\n      }\n    } catch (error) {\n      console.error('Failed to delete event:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return false;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, refreshDashboard]);\n\n  const getCalendarEvents = useCallback(async (startDate?: string, endDate?: string): Promise<CalendarEvent[]> => {\n    if (!isAuthenticated || !user) return [];\n\n    try {\n      const params = new URLSearchParams();\n      if (startDate) params.append('startDate', startDate);\n      if (endDate) params.append('endDate', endDate);\n\n      const response = await fetch(`/api/profile/calendar/events?${params.toString()}`, {\n        headers: getAuthHeaders()\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        return data.events || [];\n      } else {\n        throw new Error(data.error || 'Failed to fetch events');\n      }\n    } catch (error) {\n      console.error('Failed to fetch calendar events:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error)\n      }));\n      return [];\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse]);\n\n  const detectConflicts = useCallback(async (newEvent?: Partial<CalendarEvent>): Promise<CalendarConflict[]> => {\n    if (!isAuthenticated || !user) return [];\n\n    try {\n      const params = new URLSearchParams();\n      if (newEvent) {\n        params.append('includeNewEvent', JSON.stringify(newEvent));\n      }\n      params.append('suggestTimes', 'true');\n\n      const response = await fetch(`/api/profile/calendar/conflicts?${params.toString()}`, {\n        headers: getAuthHeaders()\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        return data.conflicts || [];\n      } else {\n        throw new Error(data.error || 'Failed to detect conflicts');\n      }\n    } catch (error) {\n      console.error('Failed to detect conflicts:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error)\n      }));\n      return [];\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse]);\n\n  const resolveConflict = useCallback(async (\n    conflictId: string, \n    resolution: string, \n    eventId?: string, \n    newTime?: string\n  ): Promise<boolean> => {\n    if (!isAuthenticated || !user) return false;\n\n    try {\n      setState(prev => ({ ...prev, isUpdating: true, error: null }));\n\n      const response = await fetch('/api/profile/calendar/conflicts', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: JSON.stringify({ conflictId, resolution, eventId, newTime })\n      });\n\n      const data = await handleApiResponse(response);\n\n      if (data.success) {\n        // Refresh dashboard to show resolved conflict\n        await refreshDashboard();\n        setState(prev => ({ ...prev, isUpdating: false }));\n        return true;\n      } else {\n        throw new Error(data.error || 'Failed to resolve conflict');\n      }\n    } catch (error) {\n      console.error('Failed to resolve conflict:', error);\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : String(error),\n        isUpdating: false\n      }));\n      return false;\n    }\n  }, [isAuthenticated, user, getAuthHeaders, handleApiResponse, refreshDashboard]);\n\n  // Load profile on mount and when user changes\n  useEffect(() => {\n    if (isAuthenticated && user) {\n      loadProfile();\n    } else {\n      setState({\n        profile: null,\n        dashboard: null,\n        isLoading: false,\n        isUpdating: false,\n        error: null,\n        completeness: 0\n      });\n    }\n  }, [isAuthenticated, user?.id]); // Remove loadProfile to prevent infinite loop\n\n  // Load dashboard after profile is loaded\n  useEffect(() => {\n    if (state.profile && !state.dashboard) {\n      refreshDashboard();\n    }\n  }, [state.profile?.identity?.id]); // Remove refreshDashboard and state.dashboard to prevent infinite loop\n\n  return {\n    // State\n    profile: state.profile,\n    dashboard: state.dashboard,\n    isLoading: state.isLoading,\n    isUpdating: state.isUpdating,\n    error: state.error,\n    completeness: state.completeness,\n    \n    // Actions\n    loadProfile,\n    updateProfile,\n    uploadAvatar,\n    toggleGhostMode,\n    refreshDashboard,\n    clearError,\n    \n    // Calendar Management\n    createEvent,\n    updateEvent,\n    deleteEvent,\n    getCalendarEvents,\n    detectConflicts,\n    resolveConflict\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-intersection-observer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-notifications.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'where' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Real-time Notifications System\n * Live notifications using Firebase\n */\n\nimport { useEffect, useState, useCallback } from 'react';\nimport {\n  collection,\n  query,\n  where,\n  orderBy,\n  limit,\n  onSnapshot,\n  doc,\n  updateDoc,\n  writeBatch,\n  serverTimestamp,\n  addDoc,\n  Timestamp\n} from 'firebase/firestore';\nimport { db } from '@hive/firebase';\nimport { useAuth } from '@hive/auth-logic';\nimport { logger } from '@/lib/logger';\n\nexport interface Notification {\n  id: string;\n  type: 'like' | 'comment' | 'follow' | 'mention' | 'space_invite' | 'post' | 'system';\n  title: string;\n  message: string;\n  read: boolean;\n  createdAt: Date;\n  data?: {\n    postId?: string;\n    spaceId?: string;\n    userId?: string;\n    commentId?: string;\n    link?: string;\n  };\n  from?: {\n    userId: string;\n    name: string;\n    avatar?: string;\n  };\n}\n\ninterface NotificationState {\n  notifications: Notification[];\n  unreadCount: number;\n  loading: boolean;\n  error: string | null;\n}\n\n/**\n * Hook for real-time notifications\n */\nexport function useNotifications() {\n  const { user } = useAuth();\n  const [state, setState] = useState<NotificationState>({\n    notifications: [],\n    unreadCount: 0,\n    loading: true,\n    error: null\n  });\n\n  useEffect(() => {\n    if (!user?.id) {\n      setState(prev => ({ ...prev, loading: false }));\n      return;\n    }\n\n    const notificationsRef = collection(db, 'notifications', user.id, 'userNotifications');\n    const q = query(\n      notificationsRef,\n      orderBy('createdAt', 'desc'),\n      limit(50)\n    );\n\n    // Subscribe to notifications\n    const unsubscribe = onSnapshot(\n      q,\n      (snapshot) => {\n        const notifications: Notification[] = [];\n        let unreadCount = 0;\n\n        snapshot.forEach((doc) => {\n          const data = doc.data();\n          const notification: Notification = {\n            id: doc.id,\n            type: data.type,\n            title: data.title,\n            message: data.message,\n            read: data.read || false,\n            createdAt: data.createdAt?.toDate?.() || new Date(),\n            data: data.data,\n            from: data.from\n          };\n\n          notifications.push(notification);\n          if (!notification.read) {\n            unreadCount++;\n          }\n        });\n\n        setState({\n          notifications,\n          unreadCount,\n          loading: false,\n          error: null\n        });\n\n        // Play sound for new notifications (if enabled)\n        if (snapshot.docChanges().some(change => change.type === 'added')) {\n          playNotificationSound();\n        }\n      },\n      (error) => {\n        logger.error('Notification subscription error', { error: error instanceof Error ? error.message : String(error) });\n        setState(prev => ({\n          ...prev,\n          loading: false,\n          error: error.message\n        }));\n      }\n    );\n\n    return () => unsubscribe();\n  }, [user?.id]);\n\n  // Mark notification as read\n  const markAsRead = useCallback(async (notificationId: string) => {\n    if (!user?.id) return;\n\n    try {\n      const notificationRef = doc(db, 'notifications', user.id, 'userNotifications', notificationId);\n      await updateDoc(notificationRef, {\n        read: true,\n        readAt: serverTimestamp()\n      });\n    } catch (error) {\n      logger.error('Failed to mark notification as read', { error: error instanceof Error ? error.message : String(error), notificationId });\n    }\n  }, [user?.id]);\n\n  // Mark all as read\n  const markAllAsRead = useCallback(async () => {\n    if (!user?.id || state.unreadCount === 0) return;\n\n    try {\n      const batch = writeBatch(db);\n      state.notifications\n        .filter(n => !n.read)\n        .forEach(notification => {\n          const ref = doc(db, 'notifications', user.id, 'userNotifications', notification.id);\n          batch.update(ref, {\n            read: true,\n            readAt: serverTimestamp()\n          });\n        });\n\n      await batch.commit();\n    } catch (error) {\n      logger.error('Failed to mark all notifications as read', { error: error instanceof Error ? error.message : String(error) });\n    }\n  }, [user?.id, state.notifications, state.unreadCount]);\n\n  // Clear all notifications\n  const clearAll = useCallback(async () => {\n    if (!user?.id) return;\n\n    try {\n      const batch = writeBatch(db);\n      state.notifications.forEach(notification => {\n        const ref = doc(db, 'notifications', user.id, 'userNotifications', notification.id);\n        batch.delete(ref);\n      });\n\n      await batch.commit();\n    } catch (error) {\n      logger.error('Failed to clear notifications', { error: error instanceof Error ? error.message : String(error) });\n    }\n  }, [user?.id, state.notifications]);\n\n  return {\n    notifications: state.notifications,\n    unreadCount: state.unreadCount,\n    loading: state.loading,\n    error: state.error,\n    markAsRead,\n    markAllAsRead,\n    clearAll,\n    hasUnread: state.unreadCount > 0\n  };\n}\n\n/**\n * Helper to send notifications\n */\nexport async function sendNotification({\n  toUserId,\n  type,\n  title,\n  message,\n  data,\n  from\n}: {\n  toUserId: string;\n  type: Notification['type'];\n  title: string;\n  message: string;\n  data?: Notification['data'];\n  from?: Notification['from'];\n}) {\n  try {\n    const notificationRef = collection(db, 'notifications', toUserId, 'userNotifications');\n    await addDoc(notificationRef, {\n      type,\n      title,\n      message,\n      read: false,\n      createdAt: serverTimestamp(),\n      data,\n      from\n    });\n\n    logger.info('Notification sent', { toUserId, type, title });\n  } catch (error) {\n    logger.error('Failed to send notification', { error: error instanceof Error ? error.message : String(error), toUserId, type });\n    throw error;\n  }\n}\n\n/**\n * Play notification sound\n */\nfunction playNotificationSound() {\n  try {\n    // Only play if user hasn't disabled sounds\n    if (typeof window !== 'undefined' && !localStorage.getItem('muteSounds')) {\n      // Create audio element with a subtle notification sound\n      const audio = new Audio('/sounds/notification.mp3');\n      audio.volume = 0.3;\n      audio.play().catch(() => {\n        // Ignore errors (e.g., autoplay blocked)\n      });\n    }\n  } catch (error) {\n    // Ignore sound errors\n  }\n}\n\n/**\n * Request browser notification permission\n */\nexport async function requestNotificationPermission(): Promise<boolean> {\n  if (!('Notification' in window)) {\n    return false;\n  }\n\n  if (Notification.permission === 'granted') {\n    return true;\n  }\n\n  if (Notification.permission !== 'denied') {\n    const permission = await Notification.requestPermission();\n    return permission === 'granted';\n  }\n\n  return false;\n}\n\n/**\n * Show browser notification\n */\nexport function showBrowserNotification(title: string, options?: { body?: string; icon?: string; tag?: string }) {\n  if (!('Notification' in window) || Notification.permission !== 'granted') {\n    return;\n  }\n\n  try {\n    const notification = new Notification(title, {\n      icon: '/icon-192.png',\n      badge: '/icon-72.png',\n      ...options\n    });\n\n    // Auto-close after 5 seconds\n    setTimeout(() => notification.close(), 5000);\n\n    // Handle click\n    notification.onclick = () => {\n      window.focus();\n      notification.close();\n    };\n  } catch (error) {\n    logger.error('Failed to show browser notification', { error: error instanceof Error ? error.message : String(error) });\n  }\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-platform-integration.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FeedItem' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SearchQuery' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":62},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'integration' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":27,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'notificationManager' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'syncWithServer' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":74,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'feedIntegration' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":497,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":497,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Platform Integration React Hook\n * \n * Connects React components to the platform integration systems\n * Provides unified access to real-time data, search, and notifications\n */\n\nimport { useEffect, useState, useCallback, useMemo as _useMemo } from 'react';\nimport { useUnifiedStore, useFeedState, useSpacesState, useToolsState, useNotificationsState, useRealtimeState } from '@/lib/unified-state-management';\nimport { getPlatformIntegration, type FeedItem } from '@/lib/platform-integration';\nimport { getSearchEngine, type SearchResult, type SearchQuery, searchPlatform } from '@/lib/platform-wide-search';\nimport { getNotificationManager, type NotificationType } from '@/lib/cross-platform-notifications';\n\n// ===== MAIN PLATFORM INTEGRATION HOOK =====\n\nexport function usePlatformIntegration() {\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [integrationError, setIntegrationError] = useState<string | null>(null);\n\n  const user = useUnifiedStore(state => state.user);\n  const isAuthenticated = useUnifiedStore(state => state.isAuthenticated);\n  \n  // Initialize platform integration when user authenticates\n  useEffect(() => {\n    if (isAuthenticated && user && !isInitialized) {\n      try {\n        const integration = getPlatformIntegration();\n        const searchEngine = getSearchEngine();\n        const notificationManager = getNotificationManager();\n\n        // Set search context\n        searchEngine.setContext({\n          userId: user.id,\n          currentSlice: 'feed',\n          recentSearches: [],\n          preferences: {\n            defaultSlices: ['spaces', 'tools', 'feed', 'profile'],\n            preferredResultTypes: ['space', 'tool', 'post', 'user'],\n            maxResults: 20,\n            enableAutoComplete: true,\n            enableRecentSearches: true,\n            saveSearchHistory: true\n          }\n        });\n\n        setIsInitialized(true);\n        setIntegrationError(null);\n      } catch (error) {\n        console.error('Failed to initialize platform integration:', error);\n        setIntegrationError(error instanceof Error ? error.message : 'Initialization failed');\n      }\n    }\n  }, [isAuthenticated, user, isInitialized]);\n\n  return {\n    isInitialized,\n    error: integrationError,\n    user,\n    isAuthenticated\n  };\n}\n\n// ===== UNIFIED FEED HOOK =====\n\nexport function useUnifiedFeed(options: {\n  limit?: number;\n  sources?: string[];\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n} = {}) {\n  const { limit = 20, sources = ['feed', 'spaces', 'tools', 'profile'], autoRefresh = true, refreshInterval = 60000 } = options;\n  \n  const { feedItems, loading, error, refresh } = useFeedState();\n  const { isOnline, syncWithServer } = useRealtimeState();\n  const user = useUnifiedStore(state => state.user);\n\n  // Auto-refresh feed data\n  useEffect(() => {\n    if (autoRefresh && user) {\n      const interval = setInterval(() => {\n        if (isOnline) {\n          refresh({ force: false });\n        }\n      }, refreshInterval);\n\n      return () => clearInterval(interval);\n    }\n  }, [autoRefresh, user, refresh, isOnline, refreshInterval]);\n\n  const refreshFeed = useCallback(async (force = false) => {\n    if (user) {\n      await refresh({ force });\n    }\n  }, [user, refresh]);\n\n  const getFeedData = useCallback(async (customOptions?: any) => {\n    if (!user) return [];\n\n    try {\n      const integration = getPlatformIntegration();\n      return await integration.getUnifiedFeedData(user.id, {\n        limit,\n        sources,\n        ...customOptions\n      });\n    } catch (error) {\n      console.error('Error getting feed data:', error);\n      return [];\n    }\n  }, [user, limit, sources]);\n\n  return {\n    feedItems: feedItems.slice(0, limit),\n    loading,\n    error,\n    refresh: refreshFeed,\n    getFeedData,\n    isOnline\n  };\n}\n\n// ===== SPACE INTEGRATION HOOK =====\n\nexport function useSpaceIntegration(spaceId: string | null) {\n  const { spaces, loading, error, refresh, setActiveSpace } = useSpacesState();\n  const [spaceData, setSpaceData] = useState<any>(null);\n  const [spacePosts, setSpacePosts] = useState<any[]>([]);\n  const [spaceMembers, setSpaceMembers] = useState<any[]>([]);\n  \n  const user = useUnifiedStore(state => state.user);\n\n  // Set active space\n  useEffect(() => {\n    if (spaceId) {\n      setActiveSpace(spaceId);\n    }\n  }, [spaceId, setActiveSpace]);\n\n  // Load space data\n  useEffect(() => {\n    if (spaceId && user) {\n      loadSpaceData(spaceId);\n    }\n  }, [spaceId, user]);\n\n  const loadSpaceData = useCallback(async (id: string) => {\n    try {\n      // Load space details\n      const space = spaces.find(s => s.id === id);\n      if (space) {\n        setSpaceData(space);\n      }\n\n      // Load space posts\n      const postsResponse = await fetch(`/api/spaces/${id}/posts?limit=20`, {\n        headers: {\n          'Authorization': `Bearer ${await getAuthToken()}`\n        }\n      });\n\n      if (postsResponse.ok) {\n        const postsData = await postsResponse.json();\n        setSpacePosts(postsData.posts || []);\n      }\n\n      // Load space members\n      const membersResponse = await fetch(`/api/spaces/${id}/members?limit=50`, {\n        headers: {\n          'Authorization': `Bearer ${await getAuthToken()}`\n        }\n      });\n\n      if (membersResponse.ok) {\n        const membersData = await membersResponse.json();\n        setSpaceMembers(membersData.members || []);\n      }\n    } catch (error) {\n      console.error('Error loading space data:', error);\n    }\n  }, [spaces]);\n\n  const createPost = useCallback(async (postData: any) => {\n    if (!spaceId || !user) return null;\n\n    try {\n      const response = await fetch(`/api/spaces/${spaceId}/posts`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await getAuthToken()}`\n        },\n        body: JSON.stringify(postData)\n      });\n\n      if (response.ok) {\n        const newPost = await response.json();\n        setSpacePosts(prev => [newPost.post, ...prev]);\n        return newPost.post;\n      }\n    } catch (error) {\n      console.error('Error creating post:', error);\n    }\n    return null;\n  }, [spaceId, user]);\n\n  const joinSpace = useCallback(async (id: string) => {\n    if (!user) return false;\n\n    try {\n      const response = await fetch(`/api/spaces/${id}/join`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${await getAuthToken()}`\n        }\n      });\n\n      if (response.ok) {\n        await refresh();\n        return true;\n      }\n    } catch (error) {\n      console.error('Error joining space:', error);\n    }\n    return false;\n  }, [user, refresh]);\n\n  return {\n    spaceData,\n    spacePosts,\n    spaceMembers,\n    loading,\n    error,\n    refresh: () => refresh(),\n    createPost,\n    joinSpace,\n    reloadSpace: () => spaceId && loadSpaceData(spaceId)\n  };\n}\n\n// ===== TOOL INTEGRATION HOOK =====\n\nexport function useToolIntegration(toolId: string | null) {\n  const { tools, loading, error, refresh, setActiveTool } = useToolsState();\n  const [toolData, setToolData] = useState<any>(null);\n  const [toolDeployments, setToolDeployments] = useState<any[]>([]);\n  \n  const user = useUnifiedStore(state => state.user);\n\n  useEffect(() => {\n    if (toolId) {\n      setActiveTool(toolId);\n      loadToolData(toolId);\n    }\n  }, [toolId, setActiveTool]);\n\n  const loadToolData = useCallback(async (id: string) => {\n    try {\n      const tool = tools.find(t => t.id === id);\n      if (tool) {\n        setToolData(tool);\n      }\n\n      // Load tool deployments\n      const deploymentsResponse = await fetch(`/api/tools/${id}/deployments`, {\n        headers: {\n          'Authorization': `Bearer ${await getAuthToken()}`\n        }\n      });\n\n      if (deploymentsResponse.ok) {\n        const deploymentsData = await deploymentsResponse.json();\n        setToolDeployments(deploymentsData.deployments || []);\n      }\n    } catch (error) {\n      console.error('Error loading tool data:', error);\n    }\n  }, [tools]);\n\n  const deployTool = useCallback(async (deploymentData: any) => {\n    if (!toolId || !user) return null;\n\n    try {\n      const response = await fetch(`/api/tools/${toolId}/deploy`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await getAuthToken()}`\n        },\n        body: JSON.stringify(deploymentData)\n      });\n\n      if (response.ok) {\n        const deployment = await response.json();\n        setToolDeployments(prev => [deployment.deployment, ...prev]);\n        return deployment.deployment;\n      }\n    } catch (error) {\n      console.error('Error deploying tool:', error);\n    }\n    return null;\n  }, [toolId, user]);\n\n  const shareTool = useCallback(async (shareData: any) => {\n    if (!toolId || !user) return false;\n\n    try {\n      const response = await fetch(`/api/tools/${toolId}/share`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await getAuthToken()}`\n        },\n        body: JSON.stringify(shareData)\n      });\n\n      return response.ok;\n    } catch (error) {\n      console.error('Error sharing tool:', error);\n      return false;\n    }\n  }, [toolId, user]);\n\n  return {\n    toolData,\n    toolDeployments,\n    loading,\n    error,\n    refresh: () => refresh(),\n    deployTool,\n    shareTool,\n    reloadTool: () => toolId && loadToolData(toolId)\n  };\n}\n\n// ===== SEARCH INTEGRATION HOOK =====\n\nexport function useSearchIntegration() {\n  const [searchResults, setSearchResults] = useState<SearchResult[]>([]);\n  const [suggestions, setSuggestions] = useState<any[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchError, setSearchError] = useState<string | null>(null);\n\n  const search = useCallback(async (query: string, options?: any) => {\n    if (!query.trim()) {\n      setSearchResults([]);\n      return [];\n    }\n\n    setIsSearching(true);\n    setSearchError(null);\n\n    try {\n      const results = await searchPlatform(query, options?.options, options?.filters);\n      setSearchResults(results);\n      return results;\n    } catch (error) {\n      console.error('Search error:', error);\n      setSearchError(error instanceof Error ? error.message : 'Search failed');\n      return [];\n    } finally {\n      setIsSearching(false);\n    }\n  }, []);\n\n  const getSuggestions = useCallback(async (partial: string) => {\n    if (partial.length < 2) {\n      setSuggestions([]);\n      return [];\n    }\n\n    try {\n      const engine = getSearchEngine();\n      const results = await engine.getSuggestions(partial);\n      setSuggestions(results);\n      return results;\n    } catch (error) {\n      console.error('Suggestions error:', error);\n      return [];\n    }\n  }, []);\n\n  const clearSearch = useCallback(() => {\n    setSearchResults([]);\n    setSuggestions([]);\n    setSearchError(null);\n  }, []);\n\n  return {\n    searchResults,\n    suggestions,\n    isSearching,\n    error: searchError,\n    search,\n    getSuggestions,\n    clearSearch\n  };\n}\n\n// ===== NOTIFICATION INTEGRATION HOOK =====\n\nexport function useNotificationIntegration() {\n  const { notifications, unreadCount, addNotification, markAsRead, removeNotification } = useNotificationsState();\n  const user = useUnifiedStore(state => state.user);\n\n  const sendNotification = useCallback(async (type: NotificationType, targetUserId: string, data: any) => {\n    if (!user) return;\n\n    try {\n      const manager = getNotificationManager();\n      await manager.createNotification(type, targetUserId, data);\n    } catch (error) {\n      console.error('Error sending notification:', error);\n    }\n  }, [user]);\n\n  const updatePreferences = useCallback(async (preferences: any) => {\n    if (!user) return;\n\n    try {\n      const manager = getNotificationManager();\n      await manager.updateUserPreferences(user.id, preferences);\n    } catch (error) {\n      console.error('Error updating notification preferences:', error);\n    }\n  }, [user]);\n\n  return {\n    notifications,\n    unreadCount,\n    addNotification,\n    markAsRead,\n    removeNotification,\n    sendNotification,\n    updatePreferences\n  };\n}\n\n// ===== REAL-TIME INTEGRATION HOOK =====\n\nexport function useRealtimeIntegration() {\n  const { isOnline, websocketConnected, lastSyncTime, syncInProgress, syncWithServer, handleRealtimeUpdate } = useRealtimeState();\n\n  const subscribeToUpdates = useCallback(() => {\n    const integration = getPlatformIntegration();\n    \n    const unsubscribers = [\n      integration.subscribe('platform_update', handleRealtimeUpdate),\n      integration.subscribe('feed_update', handleRealtimeUpdate),\n      integration.subscribe('space_activity', handleRealtimeUpdate),\n      integration.subscribe('tool_interaction', handleRealtimeUpdate),\n      integration.subscribe('notification', handleRealtimeUpdate)\n    ];\n\n    return () => {\n      unsubscribers.forEach(unsubscribe => unsubscribe());\n    };\n  }, [handleRealtimeUpdate]);\n\n  const forceSync = useCallback(async (slices?: string[]) => {\n    await syncWithServer(slices);\n  }, [syncWithServer]);\n\n  return {\n    isOnline,\n    websocketConnected,\n    lastSyncTime,\n    syncInProgress,\n    subscribeToUpdates,\n    forceSync\n  };\n}\n\n// ===== UTILITY FUNCTIONS =====\n\nasync function getAuthToken(): Promise<string> {\n  if (typeof window === 'undefined') return '';\n  \n  try {\n    const sessionJson = localStorage.getItem('hive_session');\n    if (sessionJson) {\n      const session = JSON.parse(sessionJson);\n      return process.env.NODE_ENV === 'development' \n        ? `dev_token_${session.id}` \n        : session.token;\n    }\n  } catch (error) {\n    console.error('Error getting auth token:', error);\n  }\n  \n  return '';\n}\n\n// ===== COMBINED HOOK FOR SURFACE COMPONENTS =====\n\nexport function useSurfaceIntegration(surfaceType: 'posts' | 'members' | 'events' | 'tools' | 'chat' | 'pinned', spaceId?: string) {\n  const platformIntegration = usePlatformIntegration();\n  const feedIntegration = useUnifiedFeed();\n  const spaceIntegration = useSpaceIntegration(spaceId || null);\n  const realtimeIntegration = useRealtimeIntegration();\n\n  const [surfaceData, setSurfaceData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadSurfaceData = useCallback(async () => {\n    if (!spaceId || !platformIntegration.isInitialized) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let data = [];\n\n      switch (surfaceType) {\n        case 'posts':\n          data = spaceIntegration.spacePosts;\n          break;\n        case 'members':\n          data = spaceIntegration.spaceMembers;\n          break;\n        case 'events': {\n          // Load events data\n          const eventsResponse = await fetch(`/api/spaces/${spaceId}/events`, {\n            headers: { 'Authorization': `Bearer ${await getAuthToken()}` }\n          });\n          if (eventsResponse.ok) {\n            const eventsData = await eventsResponse.json();\n            data = eventsData.events || [];\n          }\n          break;\n        }\n        case 'tools': {\n          // Load space tools\n          const toolsResponse = await fetch(`/api/spaces/${spaceId}/tools`, {\n            headers: { 'Authorization': `Bearer ${await getAuthToken()}` }\n          });\n          if (toolsResponse.ok) {\n            const toolsData = await toolsResponse.json();\n            data = toolsData.tools || [];\n          }\n          break;\n        }\n        // Add more surface types as needed\n      }\n\n      setSurfaceData(data);\n    } catch (err) {\n      console.error(`Error loading ${surfaceType} data:`, err);\n      setError(err instanceof Error ? err.message : `Failed to load ${surfaceType}`);\n    } finally {\n      setLoading(false);\n    }\n  }, [surfaceType, spaceId, platformIntegration.isInitialized, spaceIntegration.spacePosts, spaceIntegration.spaceMembers]);\n\n  useEffect(() => {\n    loadSurfaceData();\n  }, [loadSurfaceData]);\n\n  // Subscribe to real-time updates\n  useEffect(() => {\n    const unsubscribe = realtimeIntegration.subscribeToUpdates();\n    return unsubscribe;\n  }, [realtimeIntegration]);\n\n  return {\n    data: surfaceData,\n    loading: loading || spaceIntegration.loading,\n    error: error || spaceIntegration.error,\n    refresh: loadSurfaceData,\n    space: spaceIntegration,\n    realtime: realtimeIntegration\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-presence.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'presenceRef' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":48,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Real-time Presence System\n * Tracks online/offline status using Firebase\n */\n\nimport { useEffect, useState, useRef } from 'react';\nimport {\n  doc,\n  setDoc,\n  onDisconnect,\n  serverTimestamp,\n  onSnapshot,\n  collection,\n  query,\n  where,\n  getDocs\n} from 'firebase/firestore';\nimport { db } from '@hive/firebase';\nimport { useAuth } from '@hive/auth-logic';\nimport { logger } from '@/lib/logger';\n\ninterface PresenceData {\n  userId: string;\n  status: 'online' | 'away' | 'offline';\n  lastSeen: Date;\n  campusId: string;\n  deviceInfo?: {\n    browser?: string;\n    platform?: string;\n  };\n}\n\ninterface OnlineUser {\n  userId: string;\n  handle: string;\n  name: string;\n  avatar?: string;\n  status: 'online' | 'away';\n  lastSeen: Date;\n}\n\n/**\n * Hook to track user's presence status\n */\nexport function usePresence() {\n  const { user } = useAuth();\n  const [isOnline, setIsOnline] = useState(true);\n  const presenceRef = useRef<any>(null);\n\n  useEffect(() => {\n    if (!user?.id) return;\n\n    const campusId = 'ub-buffalo';\n    const userPresenceRef = doc(db, 'presence', user.id);\n\n    // Function to update presence\n    const updatePresence = async (status: 'online' | 'away' | 'offline') => {\n      try {\n        await setDoc(userPresenceRef, {\n          userId: user.id,\n          status,\n          lastSeen: serverTimestamp(),\n          campusId,\n          deviceInfo: {\n            browser: navigator.userAgent,\n            platform: navigator.platform\n          }\n        }, { merge: true });\n      } catch (error) {\n        logger.error('Failed to update presence', { error: error instanceof Error ? error.message : String(error) });\n      }\n    };\n\n    // Set user as online\n    updatePresence('online');\n    setIsOnline(true);\n\n    // Handle page visibility change (tab switching)\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        updatePresence('away');\n      } else {\n        updatePresence('online');\n      }\n    };\n\n    // Handle online/offline events\n    const handleOnline = () => {\n      setIsOnline(true);\n      updatePresence('online');\n    };\n\n    const handleOffline = () => {\n      setIsOnline(false);\n      updatePresence('offline');\n    };\n\n    // Set up Firebase onDisconnect hook\n    const setupDisconnectHandler = async () => {\n      try {\n        // This will automatically set status to offline when connection is lost\n        await onDisconnect(userPresenceRef).set({\n          userId: user.id,\n          status: 'offline',\n          lastSeen: serverTimestamp(),\n          campusId\n        });\n      } catch (error) {\n        logger.error('Failed to setup disconnect handler', { error: error instanceof Error ? error.message : String(error) });\n      }\n    };\n\n    setupDisconnectHandler();\n\n    // Add event listeners\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    // Send heartbeat every 30 seconds to keep alive\n    const heartbeatInterval = setInterval(() => {\n      if (!document.hidden && navigator.onLine) {\n        updatePresence('online');\n      }\n    }, 30000);\n\n    // Cleanup\n    return () => {\n      updatePresence('offline');\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n      clearInterval(heartbeatInterval);\n    };\n  }, [user?.id]);\n\n  return { isOnline };\n}\n\n/**\n * Hook to get online users in a space or campus\n */\nexport function useOnlineUsers(spaceId?: string) {\n  const [onlineUsers, setOnlineUsers] = useState<OnlineUser[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const campusId = 'ub-buffalo';\n    const constraints = [\n      where('campusId', '==', campusId),\n      where('status', 'in', ['online', 'away'])\n    ];\n\n    if (spaceId) {\n      // For space-specific presence, we'd need to track that separately\n      // For now, just get campus-wide presence\n    }\n\n    const presenceRef = collection(db, 'presence');\n    const q = query(presenceRef, ...constraints);\n\n    // Subscribe to online users\n    const unsubscribe = onSnapshot(\n      q,\n      async (snapshot) => {\n        const users: OnlineUser[] = [];\n\n        // Get user details for each online presence\n        const userPromises = snapshot.docs.map(async (doc) => {\n          const presence = doc.data() as PresenceData;\n\n          // Fetch user profile (would be better to cache this)\n          try {\n            const userDoc = await getDocs(\n              query(\n                collection(db, 'users'),\n                where('__name__', '==', presence.userId)\n              )\n            );\n\n            if (!userDoc.empty) {\n              const userData = userDoc.docs[0].data();\n              users.push({\n                userId: presence.userId,\n                handle: userData.handle || 'unknown',\n                name: userData.name || 'Anonymous',\n                avatar: userData.avatar,\n                status: presence.status as 'online' | 'away',\n                lastSeen: presence.lastSeen instanceof Date\n                  ? presence.lastSeen\n                  : new Date()\n              });\n            }\n          } catch (error) {\n            logger.error('Failed to fetch user data', { error: error instanceof Error ? error.message : String(error), userId: presence.userId });\n          }\n        });\n\n        await Promise.all(userPromises);\n\n        setOnlineUsers(users);\n        setLoading(false);\n      },\n      (error) => {\n        logger.error('Failed to subscribe to online users', { error: error instanceof Error ? error.message : String(error) });\n        setLoading(false);\n      }\n    );\n\n    return () => unsubscribe();\n  }, [spaceId]);\n\n  return { onlineUsers, loading };\n}\n\n/**\n * Hook to track typing indicators in a space/chat\n */\nexport function useTypingIndicator(contextId: string) {\n  const { user } = useAuth();\n  const [typingUsers, setTypingUsers] = useState<string[]>([]);\n  const typingTimeoutRef = useRef<NodeJS.Timeout>();\n\n  useEffect(() => {\n    if (!contextId) return;\n\n    const typingRef = collection(db, 'typing', contextId, 'users');\n\n    // Subscribe to typing indicators\n    const unsubscribe = onSnapshot(typingRef, (snapshot) => {\n      const typing: string[] = [];\n      const now = Date.now();\n\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        // Only show if typed within last 3 seconds\n        if (data.timestamp && (now - data.timestamp.toMillis()) < 3000) {\n          if (doc.id !== user?.id) {\n            typing.push(doc.id);\n          }\n        }\n      });\n\n      setTypingUsers(typing);\n    });\n\n    return () => unsubscribe();\n  }, [contextId, user?.id]);\n\n  // Function to indicate current user is typing\n  const setTyping = async (isTyping: boolean) => {\n    if (!user?.id || !contextId) return;\n\n    const typingRef = doc(db, 'typing', contextId, 'users', user.id);\n\n    if (isTyping) {\n      // Clear existing timeout\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n\n      // Set typing indicator\n      await setDoc(typingRef, {\n        timestamp: serverTimestamp(),\n        userId: user.id\n      });\n\n      // Auto-clear after 3 seconds\n      typingTimeoutRef.current = setTimeout(() => {\n        setTyping(false);\n      }, 3000);\n    } else {\n      // Clear typing indicator\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n\n      await setDoc(typingRef, {\n        timestamp: null,\n        userId: user.id\n      });\n    }\n  };\n\n  return { typingUsers, setTyping };\n}\n\n/**\n * Get user's current online status\n */\nexport function useUserStatus(userId: string) {\n  const [status, setStatus] = useState<'online' | 'away' | 'offline'>('offline');\n  const [lastSeen, setLastSeen] = useState<Date | null>(null);\n\n  useEffect(() => {\n    if (!userId) return;\n\n    const presenceRef = doc(db, 'presence', userId);\n\n    const unsubscribe = onSnapshot(\n      presenceRef,\n      (doc) => {\n        if (doc.exists()) {\n          const data = doc.data() as PresenceData;\n          setStatus(data.status);\n          setLastSeen(data.lastSeen instanceof Date ? data.lastSeen : new Date());\n        } else {\n          setStatus('offline');\n          setLastSeen(null);\n        }\n      },\n      (error) => {\n        logger.error('Failed to get user status', { error: error instanceof Error ? error.message : String(error), userId });\n        setStatus('offline');\n      }\n    );\n\n    return () => unsubscribe();\n  }, [userId]);\n\n  return { status, lastSeen };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-privacy-settings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-profile-v2.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-comments.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sendNotification' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Real-time Comments System\n * Live comment updates using Firebase\n */\n\nimport { useEffect, useState, useCallback } from 'react';\nimport {\n  collection,\n  query,\n  where,\n  orderBy,\n  onSnapshot,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  doc,\n  serverTimestamp,\n  increment\n} from 'firebase/firestore';\nimport { db } from '@hive/firebase';\nimport { useAuth } from '@hive/auth-logic';\nimport { logger } from '@/lib/logger';\nimport { sendNotification } from './use-notifications';\n\nexport interface Comment {\n  id: string;\n  postId: string;\n  parentId?: string; // For nested comments\n  content: string;\n  authorId: string;\n  authorName: string;\n  authorAvatar?: string;\n  createdAt: Date;\n  updatedAt?: Date;\n  likes: number;\n  hasLiked?: boolean;\n  replies?: Comment[];\n  isDeleted?: boolean;\n}\n\ninterface CommentState {\n  comments: Comment[];\n  loading: boolean;\n  error: string | null;\n  totalCount: number;\n}\n\n/**\n * Hook for real-time comments on a post\n */\nexport function useRealtimeComments(postId: string | null) {\n  const { user } = useAuth();\n  const [state, setState] = useState<CommentState>({\n    comments: [],\n    loading: true,\n    error: null,\n    totalCount: 0\n  });\n\n  useEffect(() => {\n    if (!postId) {\n      setState(prev => ({ ...prev, loading: false }));\n      return;\n    }\n\n    const commentsRef = collection(db, 'posts', postId, 'comments');\n    const q = query(\n      commentsRef,\n      where('isDeleted', '!=', true),\n      orderBy('isDeleted'),\n      orderBy('createdAt', 'desc')\n    );\n\n    const unsubscribe = onSnapshot(\n      q,\n      async (snapshot) => {\n        const comments: Comment[] = [];\n        const commentMap = new Map<string, Comment>();\n\n        // First pass: Create all comments\n        snapshot.forEach((doc) => {\n          const data = doc.data();\n          const comment: Comment = {\n            id: doc.id,\n            postId,\n            parentId: data.parentId,\n            content: data.content,\n            authorId: data.authorId,\n            authorName: data.authorName,\n            authorAvatar: data.authorAvatar,\n            createdAt: data.createdAt?.toDate?.() || new Date(),\n            updatedAt: data.updatedAt?.toDate?.(),\n            likes: data.likes || 0,\n            hasLiked: user?.id ? data.likedBy?.includes(user.id) : false,\n            replies: [],\n            isDeleted: data.isDeleted\n          };\n\n          commentMap.set(comment.id, comment);\n\n          // Only add top-level comments to main array\n          if (!comment.parentId) {\n            comments.push(comment);\n          }\n        });\n\n        // Second pass: Build reply hierarchy\n        commentMap.forEach(comment => {\n          if (comment.parentId && commentMap.has(comment.parentId)) {\n            const parent = commentMap.get(comment.parentId)!;\n            parent.replies = parent.replies || [];\n            parent.replies.push(comment);\n          }\n        });\n\n        // Sort replies by date\n        comments.forEach(comment => {\n          if (comment.replies && comment.replies.length > 0) {\n            comment.replies.sort((a, b) =>\n              a.createdAt.getTime() - b.createdAt.getTime()\n            );\n          }\n        });\n\n        setState({\n          comments,\n          loading: false,\n          error: null,\n          totalCount: commentMap.size\n        });\n\n        // Log changes for development\n        snapshot.docChanges().forEach((change) => {\n          if (change.type === 'added' && !snapshot.metadata.hasPendingWrites) {\n            logger.info('New comment added', { postId, commentId: change.doc.id });\n          }\n        });\n      },\n      (error) => {\n        logger.error('Comments subscription error', { error: error instanceof Error ? error.message : String(error), postId });\n        setState(prev => ({\n          ...prev,\n          loading: false,\n          error: error.message\n        }));\n      }\n    );\n\n    return () => unsubscribe();\n  }, [postId, user?.id]);\n\n  // Add a comment\n  const addComment = useCallback(async (\n    content: string,\n    parentId?: string\n  ): Promise<boolean> => {\n    if (!user?.id || !postId) return false;\n\n    try {\n      const commentsRef = collection(db, 'posts', postId, 'comments');\n      const commentData = {\n        postId,\n        parentId: parentId || null,\n        content,\n        authorId: user.id,\n        authorName: user.displayName || 'Anonymous',\n        authorAvatar: user.photoURL || undefined,\n        createdAt: serverTimestamp(),\n        likes: 0,\n        likedBy: [],\n        isDeleted: false\n      };\n\n      const docRef = await addDoc(commentsRef, commentData);\n\n      // Update post comment count\n      const postRef = doc(db, 'posts', postId);\n      await updateDoc(postRef, {\n        commentCount: increment(1),\n        lastActivity: serverTimestamp()\n      });\n\n      // Send notification to post author\n      // (Would need to fetch post author ID from post document)\n      logger.info('Comment added', { postId, commentId: docRef.id });\n\n      return true;\n    } catch (error) {\n      logger.error('Failed to add comment', { error: error instanceof Error ? error.message : String(error), postId });\n      return false;\n    }\n  }, [user, postId]);\n\n  // Like a comment\n  const likeComment = useCallback(async (commentId: string): Promise<boolean> => {\n    if (!user?.id || !postId) return false;\n\n    try {\n      const commentRef = doc(db, 'posts', postId, 'comments', commentId);\n      const comment = state.comments.find(c => c.id === commentId);\n\n      if (!comment) return false;\n\n      const hasLiked = comment.hasLiked;\n\n      await updateDoc(commentRef, {\n        likes: increment(hasLiked ? -1 : 1),\n        likedBy: hasLiked\n          ? (comment as any).likedBy?.filter((id: string) => id !== user.id)\n          : [...((comment as any).likedBy || []), user.id]\n      });\n\n      logger.info('Comment like toggled', { commentId, liked: !hasLiked });\n      return true;\n    } catch (error) {\n      logger.error('Failed to like comment', { error: error instanceof Error ? error.message : String(error), commentId });\n      return false;\n    }\n  }, [user?.id, postId, state.comments]);\n\n  // Delete a comment (soft delete)\n  const deleteComment = useCallback(async (commentId: string): Promise<boolean> => {\n    if (!user?.id || !postId) return false;\n\n    try {\n      const commentRef = doc(db, 'posts', postId, 'comments', commentId);\n      const comment = state.comments.find(c => c.id === commentId);\n\n      // Only author can delete\n      if (comment?.authorId !== user.id) {\n        logger.warn('Unauthorized delete attempt', { commentId, userId: user.id });\n        return false;\n      }\n\n      await updateDoc(commentRef, {\n        isDeleted: true,\n        content: '[Deleted]',\n        deletedAt: serverTimestamp()\n      });\n\n      // Update post comment count\n      const postRef = doc(db, 'posts', postId);\n      await updateDoc(postRef, {\n        commentCount: increment(-1)\n      });\n\n      logger.info('Comment deleted', { commentId });\n      return true;\n    } catch (error) {\n      logger.error('Failed to delete comment', { error: error instanceof Error ? error.message : String(error), commentId });\n      return false;\n    }\n  }, [user?.id, postId, state.comments]);\n\n  // Edit a comment\n  const editComment = useCallback(async (\n    commentId: string,\n    newContent: string\n  ): Promise<boolean> => {\n    if (!user?.id || !postId) return false;\n\n    try {\n      const commentRef = doc(db, 'posts', postId, 'comments', commentId);\n      const comment = state.comments.find(c => c.id === commentId);\n\n      // Only author can edit\n      if (comment?.authorId !== user.id) {\n        logger.warn('Unauthorized edit attempt', { commentId, userId: user.id });\n        return false;\n      }\n\n      await updateDoc(commentRef, {\n        content: newContent,\n        updatedAt: serverTimestamp(),\n        isEdited: true\n      });\n\n      logger.info('Comment edited', { commentId });\n      return true;\n    } catch (error) {\n      logger.error('Failed to edit comment', { error: error instanceof Error ? error.message : String(error), commentId });\n      return false;\n    }\n  }, [user?.id, postId, state.comments]);\n\n  return {\n    comments: state.comments,\n    loading: state.loading,\n    error: state.error,\n    totalCount: state.totalCount,\n    addComment,\n    likeComment,\n    deleteComment,\n    editComment,\n    hasComments: state.totalCount > 0\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-feed-v2.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadInitialFeed' and 'setupRealtimeListener'. Either include them or remove the dependency array.","line":274,"column":6,"nodeType":"ArrayExpression","endLine":274,"endColumn":57,"suggestions":[{"desc":"Update the dependencies array to be: [userId, campusId, options.filter, options.spaceId, loadInitialFeed, setupRealtimeListener]","fix":{"range":[8262,8313],"text":"[userId, campusId, options.filter, options.spaceId, loadInitialFeed, setupRealtimeListener]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Real-time Feed Hook V2\n * Uses the new feed listener infrastructure with CQRS pattern\n */\n\nimport { useEffect, useState, useCallback, useRef } from 'react';\nimport { feedListener, FeedUpdate, FeedListenerOptions } from '@hive/core';\nimport { GetFeedQuery, GetFeedQueryHandler } from '@hive/core';\nimport { FirebaseUnitOfWork } from '@hive/core';\nimport { useAuth } from '@hive/auth-logic';\nimport { useToast } from './use-toast';\n\ninterface UseRealtimeFeedOptions {\n  filter?: 'all' | 'my_spaces' | 'trending' | 'events' | 'rituals';\n  spaceId?: string;\n  limitCount?: number;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n}\n\ninterface UseRealtimeFeedReturn {\n  feed: FeedUpdate[];\n  loading: boolean;\n  error: any | null;\n  refresh: () => Promise<void>;\n  loadMore: () => Promise<void>;\n  hasMore: boolean;\n  isRealtime: boolean;\n}\n\nexport function useRealtimeFeed(options: UseRealtimeFeedOptions = {}): UseRealtimeFeedReturn {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [feed, setFeed] = useState<FeedUpdate[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [hasMore, setHasMore] = useState(true);\n  const [isRealtime, setIsRealtime] = useState(false);\n  const [offset, setOffset] = useState(0);\n\n  const listenerIdRef = useRef<string | null>(null);\n  const mountedRef = useRef(true);\n\n  // Get campus ID from user profile or default to UB\n  const campusId = user?.campusId || 'ub-buffalo';\n  const userId = user?.id;\n\n  // Initial load using CQRS query\n  const loadInitialFeed = useCallback(async () => {\n    if (!userId || !campusId) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Use CQRS to get initial feed\n      const query = new GetFeedQuery(\n        options.filter || 'all',\n        options.limitCount || 50,\n        0,\n        userId,\n        campusId\n      );\n\n      const unitOfWork = new FirebaseUnitOfWork();\n      const queryHandler = new GetFeedQueryHandler(\n        unitOfWork.feeds,\n        unitOfWork.spaces,\n        unitOfWork.profiles\n      );\n\n      const result = await queryHandler.execute(query);\n\n      if (result.isFailure) {\n        throw new Error(result.error);\n      }\n\n      const feedData = result.getValue();\n\n      if (mountedRef.current) {\n        // Convert CQRS result to FeedUpdate format\n        const feedUpdates: FeedUpdate[] = feedData.items.map(item => ({\n          id: item.id,\n          type: item.type,\n          content: {\n            text: item.content.text,\n            mediaUrls: item.content.mediaUrls,\n            authorId: item.content.author.id,\n            authorName: item.content.author.name,\n            authorHandle: item.content.author.handle,\n            authorAvatar: item.content.author.avatar\n          },\n          spaceId: item.source.type === 'space' ? item.source.id : undefined,\n          spaceName: item.source.name,\n          engagement: item.engagement,\n          isPromoted: item.isPromoted,\n          createdAt: item.createdAt,\n          relevanceScore: item.relevanceScore\n        }));\n\n        setFeed(feedUpdates);\n        setHasMore(feedData.hasMore);\n        setOffset(feedData.nextOffset);\n      }\n    } catch (err) {\n      console.error('Failed to load feed:', err);\n      if (mountedRef.current) {\n        setError(err as Error);\n        toast({\n          title: \"Failed to load feed\",\n          description: \"Please try again later\",\n          variant: \"destructive\"\n        });\n      }\n    } finally {\n      if (mountedRef.current) {\n        setLoading(false);\n      }\n    }\n  }, [userId, campusId, options.filter, options.limitCount, toast]);\n\n  // Set up real-time listener\n  const setupRealtimeListener = useCallback(() => {\n    if (!userId || !campusId) return;\n\n    // Clean up existing listener\n    if (listenerIdRef.current) {\n      feedListener.unsubscribe(listenerIdRef.current);\n    }\n\n    const listenerOptions: FeedListenerOptions = {\n      campusId,\n      userId,\n      filter: options.filter,\n      limitCount: options.limitCount,\n      onUpdate: (updates) => {\n        if (mountedRef.current) {\n          // Merge real-time updates with existing feed\n          setFeed(prevFeed => {\n            const merged = [...updates];\n\n            // Add existing items that aren't in updates\n            prevFeed.forEach(item => {\n              if (!updates.find(u => u.id === item.id)) {\n                merged.push(item);\n              }\n            });\n\n            // Sort by creation date\n            merged.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n            return merged.slice(0, options.limitCount || 50);\n          });\n\n          setIsRealtime(true);\n\n          // Show toast for new items if not initial load\n          if (updates.length > 0 && !loading) {\n            toast({\n              title: \"New posts available\",\n              description: `${updates.length} new ${updates.length === 1 ? 'post' : 'posts'}`,\n              duration: 3000\n            });\n          }\n        }\n      },\n      onError: (err) => {\n        console.error('Real-time feed error:', err);\n        setIsRealtime(false);\n        if (mountedRef.current) {\n          toast({\n            title: \"Real-time updates paused\",\n            description: \"Connection issue detected\",\n            variant: \"destructive\"\n          });\n        }\n      }\n    };\n\n    // Choose appropriate listener based on context\n    let listenerId: string;\n\n    if (options.spaceId) {\n      listenerId = feedListener.subscribeToSpace(options.spaceId, listenerOptions);\n    } else if (options.filter === 'trending') {\n      listenerId = feedListener.subscribeToPromoted(campusId, listenerOptions);\n    } else {\n      listenerId = feedListener.subscribeToUserFeed(userId, campusId, listenerOptions);\n    }\n\n    listenerIdRef.current = listenerId;\n  }, [userId, campusId, options.filter, options.spaceId, options.limitCount, loading, toast]);\n\n  // Load more items\n  const loadMore = useCallback(async () => {\n    if (!hasMore || loading || !userId || !campusId) return;\n\n    setLoading(true);\n\n    try {\n      const query = new GetFeedQuery(\n        options.filter || 'all',\n        options.limitCount || 50,\n        offset,\n        userId,\n        campusId\n      );\n\n      const unitOfWork = new FirebaseUnitOfWork();\n      const queryHandler = new GetFeedQueryHandler(\n        unitOfWork.feeds,\n        unitOfWork.spaces,\n        unitOfWork.profiles\n      );\n\n      const result = await queryHandler.execute(query);\n\n      if (result.isSuccess) {\n        const feedData = result.getValue();\n        const newItems: FeedUpdate[] = feedData.items.map(item => ({\n          id: item.id,\n          type: item.type,\n          content: {\n            text: item.content.text,\n            mediaUrls: item.content.mediaUrls,\n            authorId: item.content.author.id,\n            authorName: item.content.author.name,\n            authorHandle: item.content.author.handle,\n            authorAvatar: item.content.author.avatar\n          },\n          spaceId: item.source.type === 'space' ? item.source.id : undefined,\n          spaceName: item.source.name,\n          engagement: item.engagement,\n          isPromoted: item.isPromoted,\n          createdAt: item.createdAt,\n          relevanceScore: item.relevanceScore\n        }));\n\n        setFeed(prev => [...prev, ...newItems]);\n        setHasMore(feedData.hasMore);\n        setOffset(feedData.nextOffset);\n      }\n    } catch (err) {\n      console.error('Failed to load more:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [hasMore, loading, offset, userId, campusId, options.filter, options.limitCount]);\n\n  // Refresh feed\n  const refresh = useCallback(async () => {\n    setOffset(0);\n    setHasMore(true);\n    await loadInitialFeed();\n  }, [loadInitialFeed]);\n\n  // Effect: Initial load and setup\n  useEffect(() => {\n    mountedRef.current = true;\n\n    if (userId && campusId) {\n      loadInitialFeed().then(() => {\n        // Set up real-time listener after initial load\n        setupRealtimeListener();\n      });\n    }\n\n    return () => {\n      mountedRef.current = false;\n      if (listenerIdRef.current) {\n        feedListener.unsubscribe(listenerIdRef.current);\n      }\n    };\n  }, [userId, campusId, options.filter, options.spaceId]);\n\n  // Effect: Auto-refresh\n  useEffect(() => {\n    if (!options.autoRefresh || !options.refreshInterval) return;\n\n    const interval = setInterval(() => {\n      if (!loading && mountedRef.current) {\n        refresh();\n      }\n    }, options.refreshInterval);\n\n    return () => clearInterval(interval);\n  }, [options.autoRefresh, options.refreshInterval, refresh, loading]);\n\n  return {\n    feed,\n    loading,\n    error,\n    refresh,\n    loadMore,\n    hasMore,\n    isRealtime\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-feed.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'startRealtimeListeners'. Either include it or remove the dependency array.","line":195,"column":6,"nodeType":"ArrayExpression","endLine":195,"endColumn":75,"suggestions":[{"desc":"Update the dependencies array to be: [user, feedState.posts.length, options.limit, options.spaceId, options.userId, options.sortBy, options.types, getAuthToken, enableRealtime, startRealtimeListeners]","fix":{"range":[6180,6249],"text":"[user, feedState.posts.length, options.limit, options.spaceId, options.userId, options.sortBy, options.types, getAuthToken, enableRealtime, startRealtimeListeners]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from '@hive/auth-logic';\nimport { getRealtimeFeedManager, RealtimeFeedItem, cleanupRealtimeFeedManager } from '@/lib/real-time-feed-listeners';\n\nexport interface FeedOptions {\n  limit?: number;\n  spaceId?: string;\n  userId?: string;\n  sortBy?: 'recent' | 'popular' | 'relevance';\n  types?: string[];\n  enableRealtime?: boolean; // New option to control real-time mode\n}\n\nexport interface Post {\n  id: string;\n  type: string;\n  title: string;\n  content?: string;\n  description?: string;\n  authorId?: string;\n  authorName?: string;\n  createdAt: Date;\n  updatedAt?: Date;\n  spaceId?: string;\n  reactions?: Record<string, number>;\n  engagement: {\n    likes: number;\n    comments: number;\n    shares: number;\n    views: number;\n    hasLiked: boolean;\n    hasBookmarked: boolean;\n  };\n  isImported?: boolean;\n  source?: string;\n  startTime?: Date;\n  endTime?: Date;\n  location?: string;\n}\n\ninterface RealtimeFeedState {\n  posts: Post[];\n  realtimeItems: RealtimeFeedItem[];\n  isLoading: boolean;\n  isLoadingMore: boolean;\n  error: string | null;\n  hasMore: boolean;\n  lastUpdated: Date | null;\n  connectionStatus: 'connected' | 'connecting' | 'disconnected';\n  liveUpdatesCount: number;\n}\n\n/**\n * Enhanced feed hook with real-time Firebase listeners\n * Combines traditional pagination with instant live updates\n */\nexport function useRealtimeFeed(options: FeedOptions = {}) {\n  const { user, getAuthToken } = useAuth();\n  const [feedState, setFeedState] = useState<RealtimeFeedState>({\n    posts: [],\n    realtimeItems: [],\n    isLoading: false,\n    isLoadingMore: false,\n    error: null,\n    hasMore: true,\n    lastUpdated: null,\n    connectionStatus: 'disconnected',\n    liveUpdatesCount: 0\n  });\n\n  const feedManagerRef = useRef<ReturnType<typeof getRealtimeFeedManager> | null>(null);\n  const userSpaceIdsRef = useRef<string[]>([]);\n  const enableRealtime = options.enableRealtime !== false; // Default to true\n\n  // Get user's space memberships for real-time listeners\n  const fetchUserSpaces = useCallback(async (): Promise<string[]> => {\n    if (!user || !getAuthToken) return [];\n\n    try {\n      const authToken = await getAuthToken();\n      const response = await fetch('/api/user/spaces', {\n        headers: {\n          'Authorization': `Bearer ${authToken}`,\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) return [];\n\n      const data = await response.json();\n      return data.spaces?.map((s: any) => s.id) || [];\n    } catch (error) {\n      return [];\n    }\n  }, [user, getAuthToken]);\n\n  // Load initial feed data (traditional API call)\n  const loadInitialFeed = useCallback(async (reset = false) => {\n    if (!user) return;\n\n    const isInitialLoad = reset || feedState.posts.length === 0;\n    setFeedState(prev => ({\n      ...prev,\n      isLoading: isInitialLoad,\n      isLoadingMore: !isInitialLoad,\n      error: null,\n      connectionStatus: 'connecting'\n    }));\n\n    try {\n      const params = new URLSearchParams({\n        limit: String(options.limit || 20),\n        ...(options.spaceId && { spaceId: options.spaceId }),\n        ...(options.userId && { userId: options.userId }),\n        ...(options.sortBy && { sortBy: options.sortBy }),\n        ...(options.types && { types: options.types.join(',') }),\n        ...(!reset && { offset: String(feedState.posts.length) }),\n      });\n\n      const authToken = getAuthToken ? await getAuthToken() : '';\n      const response = await fetch(`/api/feed?${params}`, {\n        headers: {\n          'Authorization': `Bearer ${authToken}`,\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(`Feed load failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (!data.success) {\n        throw new Error(data.error || 'Failed to load feed');\n      }\n\n      const posts = Array.isArray(data.posts) ? data.posts : [];\n\n      // Transform posts to match interface\n      const transformedPosts: Post[] = posts.map((post: any) => ({\n        id: post.content?.id || post.id,\n        type: post.content?.type || post.contentType || 'post',\n        title: post.content?.title || 'Untitled',\n        content: post.content?.content,\n        description: post.content?.description,\n        authorId: post.content?.authorId,\n        authorName: post.content?.authorName,\n        createdAt: new Date(post.content?.createdAt || post.timestamp),\n        updatedAt: post.content?.updatedAt ? new Date(post.content.updatedAt) : undefined,\n        spaceId: post.spaceId,\n        reactions: post.content?.reactions || {},\n        engagement: {\n          likes: post.engagement?.likes || 0,\n          comments: post.engagement?.comments || 0,\n          shares: post.engagement?.shares || 0,\n          views: post.engagement?.views || 0,\n          hasLiked: post.userInteractions?.hasLiked || false,\n          hasBookmarked: post.userInteractions?.hasBookmarked || false,\n        },\n        isImported: post.content?.isImported || false,\n        source: post.content?.source || post.source,\n        // Event-specific fields\n        startTime: post.content?.startTime ? new Date(post.content.startTime) : undefined,\n        endTime: post.content?.endTime ? new Date(post.content.endTime) : undefined,\n        location: post.content?.location\n      }));\n\n      setFeedState(prev => ({\n        ...prev,\n        posts: reset ? transformedPosts : [...prev.posts, ...transformedPosts],\n        isLoading: false,\n        isLoadingMore: false,\n        hasMore: transformedPosts.length === (options.limit || 20),\n        lastUpdated: new Date(),\n        connectionStatus: 'connected'\n      }));\n\n      // Start real-time listeners after initial load\n      if (enableRealtime && !feedManagerRef.current) {\n        await startRealtimeListeners();\n      }\n\n    } catch (error) {\n      setFeedState(prev => ({\n        ...prev,\n        isLoading: false,\n        isLoadingMore: false,\n        error: error instanceof Error ? error.message : String(error),\n        connectionStatus: 'disconnected'\n      }));\n    }\n  }, [user, getAuthToken, options, feedState.posts.length, enableRealtime]);\n\n  // Start real-time listeners\n  const startRealtimeListeners = useCallback(async () => {\n    if (!user || !enableRealtime) return;\n\n    try {\n      // Get user's spaces for targeted listening\n      const spaceIds = await fetchUserSpaces();\n      userSpaceIdsRef.current = spaceIds;\n\n      // Initialize real-time manager\n      feedManagerRef.current = getRealtimeFeedManager(user.id);\n\n      // Real-time callback to handle new items\n      const handleRealtimeUpdate = (items: RealtimeFeedItem[], updateType: 'added' | 'modified' | 'removed') => {\n        if (updateType === 'added' && items.length > 0) {\n          setFeedState(prev => ({\n            ...prev,\n            realtimeItems: [...items, ...prev.realtimeItems.slice(0, 19)], // Keep last 20\n            liveUpdatesCount: prev.liveUpdatesCount + items.length,\n            connectionStatus: 'connected',\n            lastUpdated: new Date()\n          }));\n\n          // Show a subtle notification for new content\n        }\n      };\n\n      // Start listening\n      await feedManagerRef.current.startFeedListeners(spaceIds, handleRealtimeUpdate);\n\n      setFeedState(prev => ({\n        ...prev,\n        connectionStatus: 'connected'\n      }));\n\n    } catch (error) {\n      setFeedState(prev => ({\n        ...prev,\n        connectionStatus: 'disconnected'\n      }));\n    }\n  }, [user, enableRealtime, fetchUserSpaces]);\n\n  // Merge real-time items into main feed\n  const mergeRealtimeItems = useCallback(() => {\n    setFeedState(prev => {\n      if (prev.realtimeItems.length === 0) return prev;\n\n      // Convert real-time items to Post format\n      const newPosts: Post[] = prev.realtimeItems.map(item => ({\n        id: item.id,\n        type: item.type,\n        title: item.content.title,\n        content: item.content.description,\n        description: item.content.description,\n        authorId: item.content.authorId,\n        authorName: item.content.authorName,\n        createdAt: item.content.createdAt,\n        updatedAt: item.content.createdAt,\n        spaceId: item.spaceId,\n        reactions: item.content.reactions || {},\n        engagement: {\n          likes: 0,\n          comments: 0,\n          shares: 0,\n          views: 0,\n          hasLiked: false,\n          hasBookmarked: false,\n        },\n        isImported: item.content.isImported,\n        source: item.content.source,\n        // Event fields\n        startTime: item.content.startTime,\n        endTime: item.content.endTime,\n        location: item.content.location\n      }));\n\n      // Deduplicate and sort by timestamp\n      const allPosts = [...newPosts, ...prev.posts];\n      const uniquePosts = allPosts.filter((post, index, self) =>\n        index === self.findIndex(p => p.id === post.id)\n      );\n\n      uniquePosts.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n      return {\n        ...prev,\n        posts: uniquePosts,\n        realtimeItems: [], // Clear merged items\n        liveUpdatesCount: 0\n      };\n    });\n  }, []);\n\n  // Initialize feed on mount\n  useEffect(() => {\n    if (user) {\n      loadInitialFeed(true);\n    } else {\n      setFeedState({\n        posts: [],\n        realtimeItems: [],\n        isLoading: false,\n        isLoadingMore: false,\n        error: null,\n        hasMore: true,\n        lastUpdated: null,\n        connectionStatus: 'disconnected',\n        liveUpdatesCount: 0\n      });\n    }\n  }, [user, loadInitialFeed]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (feedManagerRef.current && user) {\n        cleanupRealtimeFeedManager(user.id);\n        feedManagerRef.current = null;\n      }\n    };\n  }, [user]);\n\n  // Load more posts (traditional pagination)\n  const loadMore = useCallback(() => {\n    if (!feedState.isLoadingMore && feedState.hasMore) {\n      loadInitialFeed(false);\n    }\n  }, [loadInitialFeed, feedState.isLoadingMore, feedState.hasMore]);\n\n  // Refresh feed\n  const refresh = useCallback(() => {\n    loadInitialFeed(true);\n  }, [loadInitialFeed]);\n\n  // Create a post\n  const createPost = useCallback(async (postData: {\n    content: string;\n    spaceId?: string;\n    type?: string;\n  }) => {\n    if (!user || !getAuthToken) return false;\n\n    try {\n      const authToken = await getAuthToken();\n      const response = await fetch('/api/posts', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${authToken}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(postData),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create post');\n      }\n\n      // The real-time listener will automatically pick up the new post\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, [user, getAuthToken]);\n\n  return {\n    // State\n    posts: feedState.posts,\n    realtimeItems: feedState.realtimeItems,\n    isLoading: feedState.isLoading,\n    isLoadingMore: feedState.isLoadingMore,\n    error: feedState.error,\n    hasMore: feedState.hasMore,\n    lastUpdated: feedState.lastUpdated,\n\n    // Real-time specific\n    connectionStatus: feedState.connectionStatus,\n    hasLiveUpdates: feedState.liveUpdatesCount > 0,\n    liveUpdatesCount: feedState.liveUpdatesCount,\n    isRealtime: enableRealtime && feedManagerRef.current !== null,\n\n    // Actions\n    loadMore,\n    refresh,\n    createPost,\n    mergeRealtimeItems,\n\n    // Computed\n    allItems: [...feedState.realtimeItems, ...feedState.posts],\n    isEmpty: feedState.posts.length === 0 && feedState.realtimeItems.length === 0,\n    isConnected: feedState.connectionStatus === 'connected'\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-performance.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'setupPerformanceObserver' and 'startMetricsCollection'. Either include them or remove the dependency array.","line":135,"column":6,"nodeType":"ArrayExpression","endLine":135,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [enableMetrics, metricsInterval, setupPerformanceObserver, startMetricsCollection]","fix":{"range":[3681,3713],"text":"[enableMetrics, metricsInterval, setupPerformanceObserver, startMetricsCollection]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'updateMetrics'. Either include it or remove the dependency array.","line":148,"column":6,"nodeType":"ArrayExpression","endLine":148,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [metricsInterval, updateMetrics]","fix":{"range":[4155,4172],"text":"[metricsInterval, updateMetrics]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'recordLatency'. Either include it or remove the dependency array.","line":170,"column":6,"nodeType":"ArrayExpression","endLine":170,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [recordLatency]","fix":{"range":[5013,5015],"text":"[recordLatency]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'calculateConnectionQuality', 'checkForAlerts', 'cleanupMeasurements', 'determineConnectionStatus', 'generateRecommendations', 'getMemoryUsage', and 'identifyIssues'. Either include them or remove the dependency array.","line":228,"column":6,"nodeType":"ArrayExpression","endLine":228,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [getMemoryUsage, calculateConnectionQuality, metrics, determineConnectionStatus, identifyIssues, generateRecommendations, enableAlerts, cleanupMeasurements, checkForAlerts]","fix":{"range":[6748,6788],"text":"[getMemoryUsage, calculateConnectionQuality, metrics, determineConnectionStatus, identifyIssues, generateRecommendations, enableAlerts, cleanupMeasurements, checkForAlerts]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * React Hook for Real-time Performance Monitoring\n * Provides client-side performance metrics and optimization\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { logger } from '@/lib/logger';\n\ninterface PerformanceMetrics {\n  connectionLatency: number;\n  messageLatency: number;\n  reconnectionCount: number;\n  errorCount: number;\n  messagesReceived: number;\n  messagesSent: number;\n  connectionQuality: 'excellent' | 'good' | 'poor' | 'critical';\n  bandwidthUsage: number;\n  memoryUsage: number;\n  lastUpdated: number;\n}\n\ninterface ConnectionHealth {\n  isHealthy: boolean;\n  status: 'connected' | 'connecting' | 'disconnected' | 'error';\n  quality: 'excellent' | 'good' | 'poor' | 'critical';\n  latency: number;\n  uptime: number;\n  issues: string[];\n  recommendations: string[];\n}\n\ninterface PerformanceAlert {\n  id: string;\n  type: 'latency' | 'error' | 'memory' | 'bandwidth' | 'connection';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  message: string;\n  timestamp: number;\n  acknowledged: boolean;\n}\n\ninterface UseRealtimePerformanceOptions {\n  enableMetrics?: boolean;\n  enableAlerts?: boolean;\n  metricsInterval?: number;\n  alertThresholds?: {\n    maxLatency: number;\n    maxErrorRate: number;\n    maxMemoryUsage: number;\n    maxBandwidthUsage: number;\n  };\n  onAlert?: (alert: PerformanceAlert) => void;\n  onQualityChange?: (quality: ConnectionHealth['quality']) => void;\n}\n\ninterface PerformanceActions {\n  acknowledgeAlert: (alertId: string) => void;\n  clearAlerts: () => void;\n  recordLatency: (latency: number) => void;\n  recordError: (error: any) => void;\n  recordMessage: (type: 'sent' | 'received', size: number) => void;\n  runSpeedTest: () => Promise<number>;\n  optimizeConnection: () => Promise<void>;\n  exportMetrics: () => any;\n}\n\nexport function useRealtimePerformance(\n  options: UseRealtimePerformanceOptions = {}\n): [PerformanceMetrics, ConnectionHealth, PerformanceAlert[], PerformanceActions] {\n  const {\n    enableMetrics = true,\n    enableAlerts = true,\n    metricsInterval = 5000,\n    alertThresholds = {\n      maxLatency: 2000,\n      maxErrorRate: 0.05,\n      maxMemoryUsage: 100,\n      maxBandwidthUsage: 1000\n    },\n    onAlert,\n    onQualityChange\n  } = options;\n\n  // State\n  const [metrics, setMetrics] = useState<PerformanceMetrics>({\n    connectionLatency: 0,\n    messageLatency: 0,\n    reconnectionCount: 0,\n    errorCount: 0,\n    messagesReceived: 0,\n    messagesSent: 0,\n    connectionQuality: 'good',\n    bandwidthUsage: 0,\n    memoryUsage: 0,\n    lastUpdated: Date.now()\n  });\n\n  const [connectionHealth, setConnectionHealth] = useState<ConnectionHealth>({\n    isHealthy: true,\n    status: 'disconnected',\n    quality: 'good',\n    latency: 0,\n    uptime: 0,\n    issues: [],\n    recommendations: []\n  });\n\n  const [alerts, setAlerts] = useState<PerformanceAlert[]>([]);\n\n  // Refs for tracking\n  const metricsIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const startTimeRef = useRef<number>(Date.now());\n  const latencyMeasurements = useRef<number[]>([]);\n  const errorCounts = useRef<{ [key: string]: number }>({});\n  const bandwidthTracker = useRef<{ timestamp: number; bytes: number }[]>([]);\n\n  // Initialize performance monitoring\n  useEffect(() => {\n    if (!enableMetrics) return;\n\n    startTimeRef.current = Date.now();\n    \n    // Start metrics collection\n    startMetricsCollection();\n    \n    // Add performance observer if available\n    if (typeof window !== 'undefined' && 'PerformanceObserver' in window) {\n      setupPerformanceObserver();\n    }\n\n    return () => {\n      if (metricsIntervalRef.current) {\n        clearInterval(metricsIntervalRef.current);\n      }\n    };\n  }, [enableMetrics, metricsInterval]);\n\n  // Monitor connection quality changes\n  useEffect(() => {\n    if (onQualityChange && connectionHealth.quality !== metrics.connectionQuality) {\n      onQualityChange(connectionHealth.quality);\n    }\n  }, [connectionHealth.quality, metrics.connectionQuality, onQualityChange]);\n\n  const startMetricsCollection = useCallback(() => {\n    metricsIntervalRef.current = setInterval(() => {\n      updateMetrics();\n    }, metricsInterval);\n  }, [metricsInterval]);\n\n  const setupPerformanceObserver = useCallback(() => {\n    try {\n      const observer = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        entries.forEach((entry) => {\n          if (entry.entryType === 'navigation') {\n            // Track navigation performance\n            const navEntry = entry as PerformanceNavigationTiming;\n            recordLatency(navEntry.loadEventEnd - navEntry.loadEventStart);\n          } else if (entry.entryType === 'measure') {\n            // Track custom measurements\n            recordLatency(entry.duration);\n          }\n        });\n      });\n\n      observer.observe({ entryTypes: ['navigation', 'measure'] });\n    } catch (error) {\n      logger.warn('PerformanceObserver not supported', { error: error instanceof Error ? error.message : String(error) });\n    }\n  }, []);\n\n  const updateMetrics = useCallback(() => {\n    const now = Date.now();\n    const uptime = now - startTimeRef.current;\n\n    // Calculate average latency\n    const avgLatency = latencyMeasurements.current.length > 0\n      ? latencyMeasurements.current.reduce((sum, val) => sum + val, 0) / latencyMeasurements.current.length\n      : 0;\n\n    // Calculate bandwidth usage (bytes per second over last minute)\n    const recentBandwidth = bandwidthTracker.current.filter(\n      entry => now - entry.timestamp < 60000\n    );\n    const bandwidthUsage = recentBandwidth.length > 0\n      ? recentBandwidth.reduce((sum, entry) => sum + entry.bytes, 0) / 60\n      : 0;\n\n    // Calculate memory usage (if available)\n    const memoryUsage = getMemoryUsage();\n\n    // Calculate connection quality\n    const quality = calculateConnectionQuality(avgLatency, metrics.errorCount, bandwidthUsage);\n\n    // Update metrics\n    const newMetrics: PerformanceMetrics = {\n      ...metrics,\n      connectionLatency: avgLatency,\n      messageLatency: avgLatency,\n      connectionQuality: quality,\n      bandwidthUsage,\n      memoryUsage,\n      lastUpdated: now\n    };\n\n    setMetrics(newMetrics);\n\n    // Update connection health\n    const health: ConnectionHealth = {\n      isHealthy: quality !== 'critical' && quality !== 'poor',\n      status: determineConnectionStatus(avgLatency, metrics.errorCount),\n      quality,\n      latency: avgLatency,\n      uptime,\n      issues: identifyIssues(newMetrics),\n      recommendations: generateRecommendations(newMetrics)\n    };\n\n    setConnectionHealth(health);\n\n    // Check for alerts\n    if (enableAlerts) {\n      checkForAlerts(newMetrics);\n    }\n\n    // Clean up old measurements\n    cleanupMeasurements();\n  }, [metrics, enableAlerts, alertThresholds]);\n\n  const calculateConnectionQuality = useCallback((\n    latency: number,\n    errorCount: number,\n    bandwidth: number\n  ): ConnectionHealth['quality'] => {\n    let score = 100;\n\n    // Latency penalties\n    if (latency > 2000) score -= 40;\n    else if (latency > 1000) score -= 20;\n    else if (latency > 500) score -= 10;\n\n    // Error penalties\n    const errorRate = errorCount / Math.max(metrics.messagesReceived + metrics.messagesSent, 1);\n    if (errorRate > 0.1) score -= 30;\n    else if (errorRate > 0.05) score -= 15;\n    else if (errorRate > 0.02) score -= 5;\n\n    // Bandwidth penalties (for very high usage)\n    if (bandwidth > 2000) score -= 20;\n    else if (bandwidth > 1000) score -= 10;\n\n    if (score >= 80) return 'excellent';\n    if (score >= 60) return 'good';\n    if (score >= 40) return 'poor';\n    return 'critical';\n  }, [metrics.messagesReceived, metrics.messagesSent]);\n\n  const determineConnectionStatus = useCallback((\n    latency: number,\n    errorCount: number\n  ): ConnectionHealth['status'] => {\n    if (latency === 0 && errorCount === 0) return 'disconnected';\n    if (latency > 5000) return 'error';\n    if (latency > 2000) return 'connecting';\n    return 'connected';\n  }, []);\n\n  const identifyIssues = useCallback((metrics: PerformanceMetrics): string[] => {\n    const issues: string[] = [];\n\n    if (metrics.connectionLatency > alertThresholds.maxLatency) {\n      issues.push('High connection latency detected');\n    }\n\n    const errorRate = metrics.errorCount / Math.max(metrics.messagesReceived + metrics.messagesSent, 1);\n    if (errorRate > alertThresholds.maxErrorRate) {\n      issues.push('High error rate detected');\n    }\n\n    if (metrics.memoryUsage > alertThresholds.maxMemoryUsage) {\n      issues.push('High memory usage detected');\n    }\n\n    if (metrics.bandwidthUsage > alertThresholds.maxBandwidthUsage) {\n      issues.push('High bandwidth usage detected');\n    }\n\n    return issues;\n  }, [alertThresholds]);\n\n  const generateRecommendations = useCallback((metrics: PerformanceMetrics): string[] => {\n    const recommendations: string[] = [];\n\n    if (metrics.connectionLatency > 1000) {\n      recommendations.push('Consider switching to a faster network connection');\n      recommendations.push('Close unnecessary browser tabs to free up resources');\n    }\n\n    if (metrics.errorCount > 5) {\n      recommendations.push('Check your internet connection stability');\n      recommendations.push('Try refreshing the page to reset the connection');\n    }\n\n    if (metrics.memoryUsage > 80) {\n      recommendations.push('Close other applications to free up memory');\n      recommendations.push('Refresh the page to clear memory caches');\n    }\n\n    if (metrics.bandwidthUsage > 800) {\n      recommendations.push('Reduce other network activity for better performance');\n      recommendations.push('Consider using a wired connection for stability');\n    }\n\n    return recommendations;\n  }, []);\n\n  const checkForAlerts = useCallback((metrics: PerformanceMetrics) => {\n    const now = Date.now();\n    const newAlerts: PerformanceAlert[] = [];\n\n    // Latency alert\n    if (metrics.connectionLatency > alertThresholds.maxLatency) {\n      newAlerts.push({\n        id: `latency-${now}`,\n        type: 'latency',\n        severity: metrics.connectionLatency > alertThresholds.maxLatency * 2 ? 'critical' : 'high',\n        message: `High latency detected: ${Math.round(metrics.connectionLatency)}ms`,\n        timestamp: now,\n        acknowledged: false\n      });\n    }\n\n    // Error rate alert\n    const errorRate = metrics.errorCount / Math.max(metrics.messagesReceived + metrics.messagesSent, 1);\n    if (errorRate > alertThresholds.maxErrorRate) {\n      newAlerts.push({\n        id: `error-${now}`,\n        type: 'error',\n        severity: errorRate > alertThresholds.maxErrorRate * 2 ? 'critical' : 'high',\n        message: `High error rate: ${(errorRate * 100).toFixed(1)}%`,\n        timestamp: now,\n        acknowledged: false\n      });\n    }\n\n    // Memory alert\n    if (metrics.memoryUsage > alertThresholds.maxMemoryUsage) {\n      newAlerts.push({\n        id: `memory-${now}`,\n        type: 'memory',\n        severity: metrics.memoryUsage > alertThresholds.maxMemoryUsage * 1.5 ? 'critical' : 'medium',\n        message: `High memory usage: ${Math.round(metrics.memoryUsage)}MB`,\n        timestamp: now,\n        acknowledged: false\n      });\n    }\n\n    // Bandwidth alert\n    if (metrics.bandwidthUsage > alertThresholds.maxBandwidthUsage) {\n      newAlerts.push({\n        id: `bandwidth-${now}`,\n        type: 'bandwidth',\n        severity: 'medium',\n        message: `High bandwidth usage: ${Math.round(metrics.bandwidthUsage)} bytes/s`,\n        timestamp: now,\n        acknowledged: false\n      });\n    }\n\n    if (newAlerts.length > 0) {\n      setAlerts(prev => [...prev, ...newAlerts]);\n      newAlerts.forEach(alert => onAlert?.(alert));\n    }\n  }, [alertThresholds, onAlert]);\n\n  const getMemoryUsage = useCallback((): number => {\n    if (typeof window !== 'undefined' && 'performance' in window && 'memory' in performance) {\n      return (performance as any).memory.usedJSHeapSize / 1024 / 1024; // MB\n    }\n    return 0;\n  }, []);\n\n  const cleanupMeasurements = useCallback(() => {\n    const now = Date.now();\n    const maxAge = 5 * 60 * 1000; // 5 minutes\n\n    // Keep only recent latency measurements\n    latencyMeasurements.current = latencyMeasurements.current.slice(-100);\n\n    // Clean up bandwidth tracker\n    bandwidthTracker.current = bandwidthTracker.current.filter(\n      entry => now - entry.timestamp < maxAge\n    );\n\n    // Clean up old alerts\n    setAlerts(prev => prev.filter(alert => now - alert.timestamp < maxAge));\n  }, []);\n\n  // Performance action functions\n  const acknowledgeAlert = useCallback((alertId: string) => {\n    setAlerts(prev => prev.map(alert =>\n      alert.id === alertId ? { ...alert, acknowledged: true } : alert\n    ));\n  }, []);\n\n  const clearAlerts = useCallback(() => {\n    setAlerts([]);\n  }, []);\n\n  const recordLatency = useCallback((latency: number) => {\n    latencyMeasurements.current.push(latency);\n    // Keep only recent measurements\n    if (latencyMeasurements.current.length > 100) {\n      latencyMeasurements.current = latencyMeasurements.current.slice(-100);\n    }\n  }, []);\n\n  const recordError = useCallback((error: any) => {\n    setMetrics(prev => ({\n      ...prev,\n      errorCount: prev.errorCount + 1,\n      lastUpdated: Date.now()\n    }));\n\n    const errorType = error.type || 'unknown';\n    errorCounts.current[errorType] = (errorCounts.current[errorType] || 0) + 1;\n  }, []);\n\n  const recordMessage = useCallback((type: 'sent' | 'received', size: number) => {\n    const now = Date.now();\n    bandwidthTracker.current.push({ timestamp: now, bytes: size });\n\n    setMetrics(prev => ({\n      ...prev,\n      [type === 'sent' ? 'messagesSent' : 'messagesReceived']: \n        prev[type === 'sent' ? 'messagesSent' : 'messagesReceived'] + 1,\n      lastUpdated: now\n    }));\n  }, []);\n\n  const runSpeedTest = useCallback(async (): Promise<number> => {\n    try {\n      const start = performance.now();\n      \n      // Simple ping test to server\n      const response = await fetch('/api/health', {\n        method: 'HEAD',\n        cache: 'no-cache'\n      });\n      \n      const end = performance.now();\n      const latency = end - start;\n      \n      if (response.ok) {\n        recordLatency(latency);\n        return latency;\n      } else {\n        throw new Error('Speed test failed');\n      }\n    } catch (error) {\n      recordError(error);\n      return -1;\n    }\n  }, [recordLatency, recordError]);\n\n  const optimizeConnection = useCallback(async (): Promise<void> => {\n    try {\n      // Clear old measurements\n      latencyMeasurements.current = [];\n      bandwidthTracker.current = [];\n      errorCounts.current = {};\n      \n      // Reset error count\n      setMetrics(prev => ({\n        ...prev,\n        errorCount: 0,\n        reconnectionCount: prev.reconnectionCount + 1,\n        lastUpdated: Date.now()\n      }));\n\n      // Clear alerts\n      clearAlerts();\n      \n      logger.info('Connection optimization completed');\n    } catch (error) {\n      logger.error('Connection optimization failed', { error: error instanceof Error ? error.message : String(error) });\n      recordError(error);\n    }\n  }, [clearAlerts, recordError]);\n\n  const exportMetrics = useCallback(() => {\n    return {\n      metrics,\n      connectionHealth,\n      alerts: alerts.filter(alert => !alert.acknowledged),\n      measurements: {\n        latency: latencyMeasurements.current.slice(-50),\n        bandwidth: bandwidthTracker.current.slice(-50),\n        errors: errorCounts.current\n      },\n      exportedAt: new Date().toISOString()\n    };\n  }, [metrics, connectionHealth, alerts]);\n\n  const actions: PerformanceActions = {\n    acknowledgeAlert,\n    clearAlerts,\n    recordLatency,\n    recordError,\n    recordMessage,\n    runSpeedTest,\n    optimizeConnection,\n    exportMetrics\n  };\n\n  return [metrics, connectionHealth, alerts, actions];\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-posts.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'campusId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":62,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'posts'. Either include it or remove the dependency array.","line":163,"column":6,"nodeType":"ArrayExpression","endLine":163,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [spaceId, enabled, limitCount, fetchInitialPosts, posts]","fix":{"range":[5040,5089],"text":"[spaceId, enabled, limitCount, fetchInitialPosts, posts]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react';\nimport { collection, query, where, orderBy, limit, onSnapshot, Timestamp } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { api } from '@/lib/api-client';\nimport type { User } from '@hive/core';\n\ninterface Post {\n  id: string;\n  content: string;\n  authorId: string;\n  spaceId: string;\n  createdAt: Date;\n  updatedAt: Date;\n  isPinned?: boolean;\n  author?: User;\n  reactions?: {\n    [key: string]: string[];\n  };\n  replyCount?: number;\n}\n\ninterface UseRealtimePostsOptions {\n  spaceId: string;\n  enabled?: boolean;\n  limitCount?: number;\n}\n\nexport function useRealtimePosts({ spaceId, enabled = true, limitCount = 50 }: UseRealtimePostsOptions) {\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Fetch initial posts with auth (for member validation)\n  const fetchInitialPosts = useCallback(async () => {\n    if (!spaceId || !enabled) return;\n\n    try {\n      const postsResponse = await api.spaces.posts.list<{ posts: Post[] }>(spaceId);\n      setPosts(postsResponse.posts || []);\n    } catch (err) {\n      console.error('Failed to fetch posts:', err);\n      setError(err as Error);\n    } finally {\n      setLoading(false);\n    }\n  }, [spaceId, enabled]);\n\n  // Set up real-time listener for updates\n  useEffect(() => {\n    if (!spaceId || !enabled) {\n      setLoading(false);\n      return;\n    }\n\n    // Fetch initial posts first\n    fetchInitialPosts();\n\n    // Then set up real-time listener for new posts\n    const postsRef = collection(db, 'spaces', spaceId, 'posts');\n\n    // SECURITY: Posts should inherit campus from space, but we add extra validation\n    const campusId = 'ub-buffalo'; // Hardcoded for UB launch\n    const q = query(\n      postsRef,\n      where('isDeleted', '==', false), // Never show deleted posts\n      orderBy('createdAt', 'desc'),\n      limit(limitCount)\n    );\n\n    const unsubscribe = onSnapshot(\n      q,\n      async (snapshot) => {\n        // Process changes (new posts, updates, deletions)\n        const changes = snapshot.docChanges();\n\n        if (changes.length === 0) return;\n\n        // Get author data for new posts\n        const newPosts: Post[] = [];\n\n        for (const change of changes) {\n          if (change.type === 'added' || change.type === 'modified') {\n            const postData = change.doc.data();\n\n            // Skip if we already have this post (from initial fetch)\n            const existingPost = posts.find(p => p.id === change.doc.id);\n            if (existingPost && change.type === 'added') continue;\n\n            // Fetch author data if not present\n            let author = null;\n            if (postData.authorId) {\n              try {\n                const authorResponse = await fetch(`/api/users/${postData.authorId}`);\n                if (authorResponse.ok) {\n                  const authorData = await authorResponse.json();\n                  author = authorData.data;\n                }\n              } catch (err) {\n                console.error('Failed to fetch author:', err);\n              }\n            }\n\n            const post: Post = {\n              id: change.doc.id,\n              content: postData.content || '',\n              authorId: postData.authorId || '',\n              spaceId: postData.spaceId || spaceId,\n              createdAt: postData.createdAt?.toDate() || new Date(),\n              updatedAt: postData.updatedAt?.toDate() || new Date(),\n              isPinned: postData.isPinned || false,\n              author,\n              reactions: postData.reactions || {},\n              replyCount: postData.replyCount || 0\n            };\n\n            newPosts.push(post);\n          }\n        }\n\n        // Update state with new posts\n        if (newPosts.length > 0) {\n          setPosts((prevPosts) => {\n            const updatedPosts = [...prevPosts];\n\n            // Add or update posts\n            newPosts.forEach((newPost) => {\n              const index = updatedPosts.findIndex(p => p.id === newPost.id);\n              if (index >= 0) {\n                updatedPosts[index] = newPost;\n              } else {\n                updatedPosts.unshift(newPost);\n              }\n            });\n\n            // Sort by creation date\n            updatedPosts.sort((a, b) =>\n              new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n            );\n\n            // Keep only the limit\n            return updatedPosts.slice(0, limitCount);\n          });\n        }\n\n        // Handle deletions\n        const deletedIds = changes\n          .filter(change => change.type === 'removed')\n          .map(change => change.doc.id);\n\n        if (deletedIds.length > 0) {\n          setPosts(prev => prev.filter(post => !deletedIds.includes(post.id)));\n        }\n      },\n      (error) => {\n        console.error('Firestore listener error:', error);\n        setError(error as Error);\n      }\n    );\n\n    return () => {\n      unsubscribe();\n    };\n  }, [spaceId, enabled, limitCount, fetchInitialPosts]);\n\n  // Create a new post\n  const createPost = useCallback(async (content: string, parentId?: string) => {\n    if (!spaceId) return null;\n\n    try {\n      const result = await api.spaces.posts.create<{ post: Post }>(spaceId, content, parentId);\n      return result.post ?? null;\n    } catch (err) {\n      console.error('Failed to create post:', err);\n      throw err;\n    }\n  }, [spaceId]);\n\n  // React to a post\n  const reactToPost = useCallback(async (postId: string, emoji: string) => {\n    if (!spaceId) return;\n\n    try {\n      const response = await fetch(`/api/spaces/${spaceId}/posts/${postId}/reactions`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ emoji })\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to react to post');\n      }\n    } catch (err) {\n      console.error('Failed to react to post:', err);\n      throw err;\n    }\n  }, [spaceId]);\n\n  return {\n    posts,\n    loading,\n    error,\n    createPost,\n    reactToPost,\n    refetch: fetchInitialPosts\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-ritual.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'unsubscribersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'unsubscribersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":73,"column":24,"nodeType":"Identifier","endLine":73,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'unsubscribersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'unsubscribersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":284,"column":24,"nodeType":"Identifier","endLine":284,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { db } from '@hive/core';\nimport { doc, onSnapshot, collection, query, where, orderBy, limit, Unsubscribe } from 'firebase/firestore';\nimport { useAuth } from '@hive/auth-logic';\n\nexport interface RealtimeRitualData {\n  id: string;\n  name: string;\n  title: string;\n  description: string;\n  type: string;\n  status: string;\n  stats: {\n    totalParticipants: number;\n    activeParticipants: number;\n    completedParticipants: number;\n    averageProgress: number;\n    lastActivityAt: Date;\n  };\n  userParticipation?: {\n    id: string;\n    status: string;\n    progressPercentage: number;\n    actionsCompleted: any[];\n    milestonesReached: any[];\n    currentStreak: number;\n    longestStreak: number;\n    lastActivityAt: Date;\n  };\n  recentActivity: Array<{\n    type: 'join' | 'complete_action' | 'milestone_reached';\n    userId: string;\n    userName: string;\n    timestamp: Date;\n    actionId?: string;\n    milestoneId?: string;\n  }>;\n  milestones: Array<{\n    id: string;\n    name: string;\n    description: string;\n    isReached: boolean;\n    reachedAt?: Date;\n    participantsCompleted: number;\n  }>;\n}\n\nexport interface RitualUpdate {\n  type: 'stats' | 'participation' | 'milestone' | 'activity';\n  data: any;\n  timestamp: Date;\n}\n\n/**\n * Real-time ritual participation hook\n * Provides instant updates on ritual progress, participation, and milestones\n */\nexport function useRealtimeRitual(ritualId: string | null) {\n  const { user } = useAuth();\n  const [ritualData, setRitualData] = useState<RealtimeRitualData | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [liveUpdates, setLiveUpdates] = useState<RitualUpdate[]>([]);\n\n  const unsubscribersRef = useRef<Map<string, Unsubscribe>>(new Map());\n\n  // Clean up listeners on unmount\n  useEffect(() => {\n    return () => {\n      unsubscribersRef.current.forEach((unsubscribe) => unsubscribe());\n      unsubscribersRef.current.clear();\n    };\n  }, []);\n\n  // Main ritual data listener\n  useEffect(() => {\n    if (!ritualId || !user) {\n      setRitualData(null);\n      setIsLoading(false);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    // 1. Listen to main ritual document\n    const ritualDocRef = doc(db, 'rituals', ritualId);\n    const unsubscribeRitual = onSnapshot(ritualDocRef,\n      (snapshot) => {\n        if (!snapshot.exists()) {\n          setError('Ritual not found');\n          setIsLoading(false);\n          return;\n        }\n\n        const ritualInfo = snapshot.data();\n\n        setRitualData(prev => ({\n          ...prev,\n          id: ritualId,\n          name: ritualInfo.name,\n          title: ritualInfo.title,\n          description: ritualInfo.description,\n          type: ritualInfo.type,\n          status: ritualInfo.status,\n          stats: {\n            totalParticipants: ritualInfo.stats?.totalParticipants || 0,\n            activeParticipants: ritualInfo.stats?.activeParticipants || 0,\n            completedParticipants: ritualInfo.stats?.completedParticipants || 0,\n            averageProgress: ritualInfo.stats?.averageProgress || 0,\n            lastActivityAt: ritualInfo.stats?.lastActivityAt?.toDate() || new Date()\n          },\n          userParticipation: prev?.userParticipation,\n          recentActivity: prev?.recentActivity || [],\n          milestones: prev?.milestones || []\n        }));\n\n        setIsLoading(false);\n\n        // Broadcast stats update\n        setLiveUpdates(prev => [...prev.slice(-4), {\n          type: 'stats',\n          data: ritualInfo.stats,\n          timestamp: new Date()\n        }]);\n      },\n      (error) => {\n        console.error('Error listening to ritual:', error);\n        setError('Failed to load ritual data');\n        setIsLoading(false);\n      }\n    );\n\n    unsubscribersRef.current.set('ritual', unsubscribeRitual);\n\n    // 2. Listen to user's participation\n    const participationQuery = query(\n      collection(db, 'ritual_participation'),\n      where('ritualId', '==', ritualId),\n      where('userId', '==', user.id),\n      where('campusId', '==', 'ub-buffalo'),\n      limit(1)\n    );\n\n    const unsubscribeParticipation = onSnapshot(participationQuery, (snapshot) => {\n      let userParticipation = null;\n\n      if (!snapshot.empty) {\n        const participationDoc = snapshot.docs[0];\n        const participationData = participationDoc.data();\n\n        userParticipation = {\n          id: participationDoc.id,\n          status: participationData.status,\n          progressPercentage: participationData.progressPercentage || 0,\n          actionsCompleted: participationData.actionsCompleted || [],\n          milestonesReached: participationData.milestonesReached || [],\n          currentStreak: participationData.currentStreak || 0,\n          longestStreak: participationData.longestStreak || 0,\n          lastActivityAt: participationData.lastActivityAt?.toDate() || new Date()\n        };\n      }\n\n      setRitualData(prev => prev ? {\n        ...prev,\n        userParticipation: userParticipation || undefined\n      } : prev);\n\n      // Broadcast participation update\n      setLiveUpdates(prev => [...prev.slice(-4), {\n        type: 'participation',\n        data: userParticipation,\n        timestamp: new Date()\n      }]);\n    });\n\n    unsubscribersRef.current.set('participation', unsubscribeParticipation);\n\n    // 3. Listen to milestone completions\n    const milestonesQuery = query(\n      collection(db, 'rituals', ritualId, 'milestones'),\n      orderBy('participantsCompleted', 'desc')\n    );\n\n    const unsubscribeMilestones = onSnapshot(milestonesQuery, (snapshot) => {\n      const milestones = snapshot.docs.map(doc => {\n        const data = doc.data();\n        return {\n          id: doc.id,\n          name: data.name || '',\n          description: data.description || '',\n          isReached: data.isReached || false,\n          reachedAt: data.reachedAt?.toDate(),\n          participantsCompleted: data.participantsCompleted || 0\n        };\n      });\n\n      setRitualData(prev => prev ? {\n        ...prev,\n        milestones\n      } : prev);\n\n      // Check for newly reached milestones\n      snapshot.docChanges().forEach(change => {\n        if (change.type === 'modified') {\n          const milestoneData = change.doc.data();\n          if (milestoneData.isReached && milestoneData.reachedAt) {\n            const reachedTime = milestoneData.reachedAt.toDate();\n            // Only broadcast if reached in last 30 seconds (real-time)\n            if (Date.now() - reachedTime.getTime() < 30000) {\n              setLiveUpdates(prev => [...prev.slice(-4), {\n                type: 'milestone',\n                data: {\n                  milestoneId: change.doc.id,\n                  name: milestoneData.name,\n                  description: milestoneData.description,\n                  participantsCompleted: milestoneData.participantsCompleted\n                },\n                timestamp: new Date()\n              }]);\n            }\n          }\n        }\n      });\n    });\n\n    unsubscribersRef.current.set('milestones', unsubscribeMilestones);\n\n    // 4. Listen to recent ritual activity\n    const recentActivityQuery = query(\n      collection(db, 'ritual_action_completions'),\n      where('ritualId', '==', ritualId),\n      where('campusId', '==', 'ub-buffalo'),\n      orderBy('completedAt', 'desc'),\n      limit(10)\n    );\n\n    const unsubscribeActivity = onSnapshot(recentActivityQuery, (snapshot) => {\n      const recentActivity = snapshot.docs.map(doc => {\n        const data = doc.data();\n        return {\n          type: 'complete_action' as const,\n          userId: data.userId,\n          userName: data.userName || 'Anonymous',\n          timestamp: data.completedAt?.toDate() || new Date(),\n          actionId: data.actionId\n        };\n      });\n\n      setRitualData(prev => prev ? {\n        ...prev,\n        recentActivity\n      } : prev);\n\n      // Broadcast new activity\n      snapshot.docChanges().forEach(change => {\n        if (change.type === 'added') {\n          const activityData = change.doc.data();\n          const completedAt = activityData.completedAt?.toDate();\n\n          // Only broadcast very recent activity (last 10 seconds)\n          if (completedAt && Date.now() - completedAt.getTime() < 10000) {\n            setLiveUpdates(prev => [...prev.slice(-4), {\n              type: 'activity',\n              data: {\n                userId: activityData.userId,\n                userName: activityData.userName || 'Someone',\n                actionId: activityData.actionId\n              },\n              timestamp: new Date()\n            }]);\n          }\n        }\n      });\n    });\n\n    unsubscribersRef.current.set('activity', unsubscribeActivity);\n\n    // Cleanup function\n    return () => {\n      unsubscribersRef.current.forEach((unsubscribe) => unsubscribe());\n      unsubscribersRef.current.clear();\n    };\n\n  }, [ritualId, user]);\n\n  // Clear old updates periodically\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setLiveUpdates(prev => prev.filter(update =>\n        Date.now() - update.timestamp.getTime() < 60000 // Keep last minute\n      ));\n    }, 30000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  const joinRitual = useCallback(async () => {\n    if (!ritualId || !user) return false;\n\n    try {\n      const response = await fetch(`/api/rituals/${ritualId}/participate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await user.getIdToken()}`\n        },\n        body: JSON.stringify({\n          action: 'join',\n          entryPoint: 'realtime_hook'\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to join ritual');\n      }\n\n      return true;\n    } catch (error) {\n      console.error('Error joining ritual:', error);\n      return false;\n    }\n  }, [ritualId, user]);\n\n  const completeAction = useCallback(async (actionId: string, metadata?: any) => {\n    if (!ritualId || !user) return false;\n\n    try {\n      const response = await fetch(`/api/rituals/${ritualId}/participate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await user.getIdToken()}`\n        },\n        body: JSON.stringify({\n          action: 'complete_action',\n          actionId,\n          metadata: metadata || {},\n          entryPoint: 'realtime_hook'\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to complete action');\n      }\n\n      const result = await response.json();\n      return result.progress;\n    } catch (error) {\n      console.error('Error completing ritual action:', error);\n      return false;\n    }\n  }, [ritualId, user]);\n\n  return {\n    // Data\n    ritual: ritualData,\n    isLoading,\n    error,\n    liveUpdates,\n\n    // Computed values\n    isParticipating: !!ritualData?.userParticipation,\n    userProgress: ritualData?.userParticipation?.progressPercentage || 0,\n    isCompleted: ritualData?.userParticipation?.status === 'completed',\n\n    // Actions\n    joinRitual,\n    completeAction,\n\n    // Real-time indicators\n    hasRecentActivity: liveUpdates.some(update =>\n      Date.now() - update.timestamp.getTime() < 30000\n    ),\n    participantCount: ritualData?.stats.activeParticipants || 0\n  };\n}\n\n/**\n * Hook for ritual list with real-time updates\n */\nexport function useRealtimeRitualsList() {\n  const { user } = useAuth();\n  const [rituals, setRituals] = useState<RealtimeRitualData[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!user) {\n      setRituals([]);\n      setIsLoading(false);\n      return;\n    }\n\n    const ritualsQuery = query(\n      collection(db, 'rituals'),\n      where('status', 'in', ['active', 'scheduled']),\n      where('universities', 'array-contains', 'university_buffalo'),\n      orderBy('stats.lastActivityAt', 'desc'),\n      limit(10)\n    );\n\n    const unsubscribe = onSnapshot(ritualsQuery, (snapshot) => {\n      const ritualsList = snapshot.docs.map(doc => {\n        const data = doc.data();\n        return {\n          id: doc.id,\n          name: data.name,\n          title: data.title,\n          description: data.description,\n          type: data.type,\n          status: data.status,\n          stats: {\n            totalParticipants: data.stats?.totalParticipants || 0,\n            activeParticipants: data.stats?.activeParticipants || 0,\n            completedParticipants: data.stats?.completedParticipants || 0,\n            averageProgress: data.stats?.averageProgress || 0,\n            lastActivityAt: data.stats?.lastActivityAt?.toDate() || new Date()\n          },\n          recentActivity: [],\n          milestones: []\n        };\n      });\n\n      setRituals(ritualsList);\n      setIsLoading(false);\n    }, (error) => {\n      console.error('Error loading rituals list:', error);\n      setError('Failed to load rituals');\n      setIsLoading(false);\n    });\n\n    return unsubscribe;\n  }, [user]);\n\n  return {\n    rituals,\n    isLoading,\n    error\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-spaces.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-realtime-sse.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state.messageCount'. Either include it or remove the dependency array.","line":133,"column":6,"nodeType":"ArrayExpression","endLine":133,"endColumn":78,"suggestions":[{"desc":"Update the dependencies array to be: [updateState, channels, state.messageCount, onMessage, maxReconnectAttempts, reconnectDelay]","fix":{"range":[3677,3749],"text":"[updateState, channels, state.messageCount, onMessage, maxReconnectAttempts, reconnectDelay]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'connect', 'disconnect', and 'state.connected'. Either include them or remove the dependency array.","line":242,"column":6,"nodeType":"ArrayExpression","endLine":242,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [connect, disconnect, state.connected]","fix":{"range":[6334,6354],"text":"[connect, disconnect, state.connected]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":242,"column":7,"nodeType":"CallExpression","endLine":242,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * React hook for Server-Sent Events real-time communication\n * Replaces broken Firebase Realtime Database WebSocket connection\n */\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { RealtimeMessage } from '@/lib/sse-realtime-service';\n\nexport interface SSEConnectionState {\n  connected: boolean;\n  connecting: boolean;\n  error: string | null;\n  connectionId: string | null;\n  messageCount: number;\n}\n\nexport interface UseRealtimeSSEOptions {\n  channels: string[];\n  reconnectDelay?: number;\n  maxReconnectAttempts?: number;\n  onMessage?: (message: RealtimeMessage) => void;\n  onConnectionChange?: (state: SSEConnectionState) => void;\n}\n\nexport function useRealtimeSSE(options: UseRealtimeSSEOptions) {\n  const {\n    channels,\n    reconnectDelay = 3000,\n    maxReconnectAttempts = 5,\n    onMessage,\n    onConnectionChange\n  } = options;\n\n  const [state, setState] = useState<SSEConnectionState>({\n    connected: false,\n    connecting: false,\n    error: null,\n    connectionId: null,\n    messageCount: 0\n  });\n\n  const [messages, setMessages] = useState<RealtimeMessage[]>([]);\n  const eventSourceRef = useRef<EventSource | null>(null);\n  const reconnectAttemptsRef = useRef(0);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  const updateState = useCallback((updates: Partial<SSEConnectionState>) => {\n    setState(prev => {\n      const newState = { ...prev, ...updates };\n      onConnectionChange?.(newState);\n      return newState;\n    });\n  }, [onConnectionChange]);\n\n  const connect = useCallback(() => {\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n    }\n\n    updateState({ connecting: true, error: null });\n\n    try {\n      const channelsParam = channels.join(',');\n      const eventSource = new EventSource(`/api/realtime/sse?channels=${encodeURIComponent(channelsParam)}`, {\n        withCredentials: true\n      });\n\n      eventSource.onopen = () => {\n        reconnectAttemptsRef.current = 0;\n        updateState({\n          connected: true,\n          connecting: false,\n          error: null\n        });\n      };\n\n      eventSource.onmessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n          \n          if (data.type === 'connection') {\n            updateState({\n              connectionId: data.data.connectionId,\n              connected: true,\n              connecting: false\n            });\n          } else if (data.type === 'message') {\n            const message: RealtimeMessage = data.data;\n            \n            setMessages(prev => [...prev, message]);\n            updateState({\n              messageCount: state.messageCount + 1\n            });\n            \n            onMessage?.(message);\n          }\n        } catch (error) {\n          // Intentionally suppressed - non-critical error\n        }\n      };\n\n      eventSource.onerror = (error) => {\n        \n        updateState({\n          connected: false,\n          connecting: false,\n          error: 'Connection failed'\n        });\n\n        // Attempt reconnection\n        if (reconnectAttemptsRef.current < maxReconnectAttempts) {\n          reconnectAttemptsRef.current++;\n          \n          reconnectTimeoutRef.current = setTimeout(() => {\n            connect();\n          }, reconnectDelay * reconnectAttemptsRef.current);\n        } else {\n          updateState({\n            error: `Failed to connect after ${maxReconnectAttempts} attempts`\n          });\n        }\n      };\n\n      eventSourceRef.current = eventSource;\n\n    } catch (error) {\n      updateState({\n        connected: false,\n        connecting: false,\n        error: 'Failed to create connection'\n      });\n    }\n  }, [channels, maxReconnectAttempts, reconnectDelay, updateState, onMessage]);\n\n  const disconnect = useCallback(() => {\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n      eventSourceRef.current = null;\n    }\n    \n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n    \n    updateState({\n      connected: false,\n      connecting: false,\n      connectionId: null\n    });\n  }, [updateState]);\n\n  const sendMessage = useCallback(async (\n    type: RealtimeMessage['type'],\n    channel: string,\n    content: any,\n    targetUsers?: string[]\n  ) => {\n    const response = await fetch('/api/realtime/send', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        type,\n        channel,\n        content,\n        targetUsers,\n        metadata: {\n          timestamp: new Date().toISOString(),\n          priority: 'normal',\n          requiresAck: false,\n          retryCount: 0\n        }\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to send message: ${response.statusText}`);\n    }\n\n    const result = await response.json();\n    return result.messageId;\n  }, []);\n\n  const sendChatMessage = useCallback(async (\n    spaceId: string,\n    content: string,\n    type: 'text' | 'image' | 'file' = 'text'\n  ) => {\n    return sendMessage('chat', `space:${spaceId}`, {\n      spaceId,\n      message: content,\n      messageType: type\n    });\n  }, [sendMessage]);\n\n  const updatePresence = useCallback(async (\n    status: 'online' | 'away' | 'offline',\n    currentSpace?: string\n  ) => {\n    try {\n      await fetch('/api/realtime/presence', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          status,\n          currentSpace\n        })\n      });\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n  }, []);\n\n  const getChannelMessages = useCallback((channel: string): RealtimeMessage[] => {\n    return messages.filter(msg => msg.channel === channel);\n  }, [messages]);\n\n  const clearMessages = useCallback(() => {\n    setMessages([]);\n    updateState({ messageCount: 0 });\n  }, [updateState]);\n\n  // Auto-connect on mount, disconnect on unmount\n  useEffect(() => {\n    connect();\n    \n    return () => {\n      disconnect();\n    };\n  }, [connect, disconnect]);\n\n  // Reconnect when channels change\n  useEffect(() => {\n    if (state.connected) {\n      disconnect();\n      setTimeout(connect, 100); // Small delay to ensure clean disconnect\n    }\n  }, [channels.join(',')]);\n\n  return {\n    // Connection state\n    ...state,\n    \n    // Messages\n    messages,\n    getChannelMessages,\n    clearMessages,\n    \n    // Connection control\n    connect,\n    disconnect,\n    \n    // Messaging\n    sendMessage,\n    sendChatMessage,\n    updatePresence\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-resilient-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-search.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-session.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/hooks/use-toast.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ReactNode' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":69}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useCallback, ReactNode } from 'react';\nimport { Check, X, AlertCircle, Info } from 'lucide-react';\n\ntype ToastType = 'success' | 'error' | 'warning' | 'info';\n\ninterface Toast {\n  id: string;\n  title: string;\n  description?: string;\n  type: ToastType;\n  duration?: number;\n  variant?: 'default' | 'destructive'; // Deprecated - use type instead\n}\n\n// Helper type for toast calls - allows either type or variant\ntype ToastInput = Omit<Toast, 'id'> | (Omit<Omit<Toast, 'id'>, 'type'> & { variant: 'default' | 'destructive' });\n\ninterface ToastContextType {\n  toasts: Toast[];\n  addToast: (toast: ToastInput) => void;\n  removeToast: (id: string) => void;\n}\n\n// Hook return type for better type safety\ninterface UseToastReturn {\n  toast: (toast: ToastInput) => void;\n  toasts: Toast[];\n  dismiss: (id: string) => void;\n  success: (title: string, description?: string) => void;\n  error: (title: string, description?: string) => void;\n  warning: (title: string, description?: string) => void;\n  info: (title: string, description?: string) => void;\n}\n\nconst ToastContext = createContext<ToastContextType | undefined>(undefined);\n\nexport function ToastProvider({ children }: { children: React.ReactNode }) {\n  const [toasts, setToasts] = useState<Toast[]>([]);\n\n  const addToast = useCallback((toast: ToastInput) => {\n    const id = Math.random().toString(36).substr(2, 9);\n\n    // Map variant to type for backward compatibility\n    let type: ToastType;\n    if ('type' in toast && toast.type) {\n      type = toast.type;\n    } else if ('variant' in toast && toast.variant === 'destructive') {\n      type = 'error';\n    } else if ('variant' in toast && toast.variant === 'default') {\n      type = 'info';\n    } else {\n      type = 'info';\n    }\n\n    const newToast: Toast = { ...toast, id, type };\n\n    setToasts(prev => [...prev, newToast]);\n\n    // Auto-remove after duration (default 5 seconds)\n    const duration = toast.duration || 5000;\n    setTimeout(() => {\n      setToasts(prev => prev.filter(t => t.id !== id));\n    }, duration);\n  }, []);\n\n  const removeToast = useCallback((id: string) => {\n    setToasts(prev => prev.filter(t => t.id !== id));\n  }, []);\n\n  return (\n    <ToastContext.Provider value={{ toasts, addToast, removeToast }}>\n      {children}\n      <ToastContainer toasts={toasts} removeToast={removeToast} />\n    </ToastContext.Provider>\n  );\n}\n\nfunction ToastContainer({ toasts, removeToast }: { toasts: Toast[]; removeToast: (id: string) => void }) {\n  if (toasts.length === 0) return null;\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50 space-y-2 max-w-md\">\n      {toasts.map(toast => (\n        <div\n          key={toast.id}\n          className={`\n            flex items-start gap-3 p-4 rounded-lg shadow-lg backdrop-blur-sm\n            animate-in slide-in-from-right-5 duration-300\n            ${toast.type === 'success' ? 'bg-green-500/90 text-white' : ''}\n            ${toast.type === 'error' ? 'bg-red-500/90 text-white' : ''}\n            ${toast.type === 'warning' ? 'bg-yellow-500/90 text-black' : ''}\n            ${toast.type === 'info' ? 'bg-blue-500/90 text-white' : ''}\n          `}\n        >\n          {toast.type === 'success' && <Check className=\"w-5 h-5 mt-0.5\" />}\n          {toast.type === 'error' && <X className=\"w-5 h-5 mt-0.5\" />}\n          {toast.type === 'warning' && <AlertCircle className=\"w-5 h-5 mt-0.5\" />}\n          {toast.type === 'info' && <Info className=\"w-5 h-5 mt-0.5\" />}\n\n          <div className=\"flex-1\">\n            <p className=\"font-semibold\">{toast.title}</p>\n            {toast.description && (\n              <p className=\"text-sm opacity-90 mt-1\">{toast.description}</p>\n            )}\n          </div>\n\n          <button\n            onClick={() => removeToast(toast.id)}\n            className=\"opacity-70 hover:opacity-100 transition-opacity\"\n          >\n            <X className=\"w-4 h-4\" />\n          </button>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport function useToast(): UseToastReturn {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within ToastProvider');\n  }\n\n  return {\n    toast: context.addToast,\n    toasts: context.toasts,\n    dismiss: context.removeToast,\n    // Convenience methods\n    success: (title: string, description?: string) =>\n      context.addToast({ type: 'success', title, description }),\n    error: (title: string, description?: string) =>\n      context.addToast({ type: 'error', title, description }),\n    warning: (title: string, description?: string) =>\n      context.addToast({ type: 'warning', title, description }),\n    info: (title: string, description?: string) =>\n      context.addToast({ type: 'info', title, description }),\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-activity-logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-auth-firebase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'admin' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'adminId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":189,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":189,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'action' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":190,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'details' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":191,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":191,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ipAddress' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":192,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":192,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as admin from 'firebase-admin';\nimport { getAuth } from 'firebase-admin/auth';\nimport { getFirestore } from 'firebase-admin/firestore';\nimport { NextRequest } from 'next/server';\nimport { validateAuthToken } from './security-service';\n\nexport interface AdminUser {\n  id: string;\n  email: string;\n  role: 'admin' | 'super_admin' | 'moderator';\n  permissions: string[];\n  lastLogin: Date;\n}\n\n// Hardcoded admin emails for ultimate security\nconst ADMIN_EMAILS = [\n  'jwrhineh@buffalo.edu',  // Jacob Rhinehart - Super Admin\n  'noahowsh@gmail.com',     // Noah - Admin\n  'test-user@hive.com'      // Development testing\n];\n\n/**\n * Get admin user IDs from environment variables\n */\nfunction getAdminUserIds(): string[] {\n  const adminIds = process.env.ADMIN_USER_IDS;\n  if (!adminIds) {\n    return ['test-user']; // Fallback for development\n  }\n  return adminIds.split(',').map(id => id.trim());\n}\n\n/**\n * Check if user is an admin by ID or email\n */\nexport async function isAdmin(userId: string, userEmail?: string): Promise<boolean> {\n  // Check by user ID first (legacy support)\n  const adminUserIds = getAdminUserIds();\n  if (adminUserIds.includes(userId)) {\n    return true;\n  }\n\n  // Check by email (primary method)\n  if (userEmail && ADMIN_EMAILS.includes(userEmail)) {\n    return true;\n  }\n\n  // Check Firebase custom claims\n  try {\n    const auth = getAuth();\n    const user = await auth.getUser(userId);\n    if (user.customClaims?.isAdmin === true || user.customClaims?.role === 'admin' || user.customClaims?.role === 'super_admin') {\n      return true;\n    }\n  } catch (error) {\n    console.error('Failed to check Firebase custom claims for admin:', error);\n  }\n\n  // Check Firestore admins collection\n  try {\n    const db = getFirestore();\n    const adminDoc = await db.collection('admins').doc(userId).get();\n    if (adminDoc.exists && adminDoc.data()?.active === true) {\n      return true;\n    }\n  } catch (error) {\n    console.error('Failed to check Firestore admins collection:', error);\n  }\n\n  return false;\n}\n\n/**\n * Require admin role for a userId (throws if not admin)\n */\nexport async function requireAdminRole(userId: string): Promise<void> {\n  const isAdminUser = await isAdmin(userId);\n  if (!isAdminUser) {\n    throw new Error('Unauthorized: Admin access required');\n  }\n}\n\n/**\n * Get admin user details\n */\nexport async function getAdminUser(userId: string): Promise<AdminUser | null> {\n  if (!(await isAdmin(userId))) {\n    return null;\n  }\n\n  try {\n    const auth = getAuth();\n    const userRecord = await auth.getUser(userId);\n    \n    // Get custom claims for permissions\n    const customClaims = userRecord.customClaims || {};\n    const role = customClaims.role || 'admin';\n    const permissions = customClaims.permissions || ['read', 'write', 'delete'];\n\n    return {\n      id: userId,\n      email: userRecord.email || '',\n      role: role as 'admin' | 'moderator',\n      permissions,\n      lastLogin: new Date(),\n    };\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Verify admin token from request using centralized security service\n */\nexport async function verifyAdminToken(request: NextRequest): Promise<AdminUser | null> {\n  try {\n    // Get token from Authorization header\n    const authHeader = request.headers.get('Authorization');\n    if (!authHeader?.startsWith('Bearer ')) {\n      return null;\n    }\n\n    const token = authHeader.substring(7);\n\n    // Use centralized security service for token validation\n    const tokenValidation = await validateAuthToken(token, request, {\n      operation: 'admin_access',\n      requireRealAuth: false\n    });\n\n    if (!tokenValidation.valid) {\n      return null;\n    }\n\n    // If we have a userId from the validation, use it\n    if (tokenValidation.userId) {\n      return await getAdminUser(tokenValidation.userId);\n    }\n\n    // For production tokens, verify with Firebase\n    try {\n      const auth = getAuth();\n      const decodedToken = await auth.verifyIdToken(token);\n      return await getAdminUser(decodedToken.uid);\n    } catch (authError) {\n      return null;\n    }\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Check if admin has permission\n */\nexport function hasPermission(admin: AdminUser, permission: string): boolean {\n  return admin.permissions.includes(permission) || admin.role === 'admin';\n}\n\n/**\n * Admin authentication middleware\n */\nexport async function requireAdmin(request: NextRequest): Promise<{\n  success: boolean;\n  admin?: AdminUser;\n  error?: string;\n  status?: number;\n}> {\n  const admin = await verifyAdminToken(request);\n\n  if (!admin) {\n    return {\n      success: false,\n      error: 'Admin access required',\n      status: 403\n    };\n  }\n\n  return {\n    success: true,\n    admin\n  };\n}\n\n/**\n * Log admin activity\n */\nexport async function logAdminActivity(\n  adminId: string,\n  action: string,\n  details?: any,\n  ipAddress?: string\n) {\n  try {\n    // TODO: Implement admin activity logging to database\n  } catch (error) {\n    console.error('Failed to log admin activity:', error);\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-moderation-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/admin-notifications.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'notification' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":206,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":206,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getAuth as _getAuth } from 'firebase-admin/auth';\n\nexport type NotificationType = \n  | 'new_user_registration'\n  | 'builder_request_submitted'\n  | 'content_flagged'\n  | 'space_activation_request'\n  | 'system_alert'\n  | 'security_incident'\n  | 'performance_warning'\n  | 'critical_error';\n\nexport type NotificationPriority = 'low' | 'medium' | 'high' | 'critical';\n\nexport interface AdminNotification {\n  id: string;\n  type: NotificationType;\n  title: string;\n  message: string;\n  priority: NotificationPriority;\n  data?: Record<string, any>;\n  createdAt: string;\n  readAt?: string;\n  readBy?: string;\n  actionRequired: boolean;\n  actionUrl?: string;\n  actionText?: string;\n  expiresAt?: string;\n}\n\nexport interface NotificationChannel {\n  id: string;\n  name: string;\n  enabled: boolean;\n  types: NotificationType[];\n  webhookUrl?: string;\n  emailEnabled?: boolean;\n  pushEnabled?: boolean;\n}\n\nclass AdminNotificationSystem {\n  private notifications: AdminNotification[] = [];\n  private channels: NotificationChannel[] = [\n    {\n      id: 'dashboard',\n      name: 'Dashboard Notifications',\n      enabled: true,\n      types: ['new_user_registration', 'builder_request_submitted', 'content_flagged', 'space_activation_request'],\n    },\n    {\n      id: 'security',\n      name: 'Security Alerts',\n      enabled: true,\n      types: ['security_incident', 'critical_error'],\n    },\n    {\n      id: 'system',\n      name: 'System Monitoring',\n      enabled: true,\n      types: ['system_alert', 'performance_warning', 'critical_error'],\n    },\n  ];\n\n  /**\n   * Create a new admin notification\n   */\n  async createNotification(notification: Omit<AdminNotification, 'id' | 'createdAt'>): Promise<AdminNotification> {\n    const newNotification: AdminNotification = {\n      ...notification,\n      id: this.generateId(),\n      createdAt: new Date().toISOString(),\n    };\n\n    this.notifications.unshift(newNotification);\n\n    // Send to appropriate channels\n    await this.sendToChannels(newNotification);\n\n    // Log the notification\n\n    return newNotification;\n  }\n\n  /**\n   * Get notifications for admin dashboard\n   */\n  getNotifications(limit: number = 50, unreadOnly: boolean = false): AdminNotification[] {\n    let filtered = this.notifications;\n\n    if (unreadOnly) {\n      filtered = filtered.filter(n => !n.readAt);\n    }\n\n    return filtered.slice(0, limit);\n  }\n\n  /**\n   * Mark notification as read\n   */\n  async markAsRead(notificationId: string, adminId: string): Promise<boolean> {\n    const notification = this.notifications.find(n => n.id === notificationId);\n    if (!notification) return false;\n\n    notification.readAt = new Date().toISOString();\n    notification.readBy = adminId;\n\n    return true;\n  }\n\n  /**\n   * Mark all notifications as read\n   */\n  async markAllAsRead(adminId: string): Promise<number> {\n    const unreadCount = this.notifications.filter(n => !n.readAt).length;\n    \n    this.notifications.forEach(notification => {\n      if (!notification.readAt) {\n        notification.readAt = new Date().toISOString();\n        notification.readBy = adminId;\n      }\n    });\n\n    return unreadCount;\n  }\n\n  /**\n   * Delete old notifications\n   */\n  async cleanupOldNotifications(daysOld: number = 30): Promise<number> {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysOld);\n\n    const initialCount = this.notifications.length;\n    this.notifications = this.notifications.filter(n => \n      new Date(n.createdAt) > cutoffDate\n    );\n\n    return initialCount - this.notifications.length;\n  }\n\n  /**\n   * Get notification statistics\n   */\n  getStatistics(): {\n    total: number;\n    unread: number;\n    byType: Record<NotificationType, number>;\n    byPriority: Record<NotificationPriority, number>;\n  } {\n    const stats = {\n      total: this.notifications.length,\n      unread: this.notifications.filter(n => !n.readAt).length,\n      byType: {} as Record<NotificationType, number>,\n      byPriority: {} as Record<NotificationPriority, number>,\n    };\n\n    this.notifications.forEach(notification => {\n      stats.byType[notification.type] = (stats.byType[notification.type] || 0) + 1;\n      stats.byPriority[notification.priority] = (stats.byPriority[notification.priority] || 0) + 1;\n    });\n\n    return stats;\n  }\n\n  /**\n   * Send notification to configured channels\n   */\n  private async sendToChannels(notification: AdminNotification): Promise<void> {\n    const relevantChannels = this.channels.filter(channel => \n      channel.enabled && channel.types.includes(notification.type)\n    );\n\n    for (const channel of relevantChannels) {\n      try {\n        await this.sendToChannel(channel, notification);\n      } catch (error) {\n        console.error(`Failed to send notification to channel ${channel.id}:`, error);\n      }\n    }\n  }\n\n  /**\n   * Send notification to specific channel\n   */\n  private async sendToChannel(channel: NotificationChannel, notification: AdminNotification): Promise<void> {\n    switch (channel.id) {\n      case 'dashboard':\n        // Dashboard notifications are handled by the UI\n        break;\n      case 'security':\n        if (notification.priority === 'critical') {\n          await this.sendSecurityAlert(notification);\n        }\n        break;\n      case 'system':\n        if (channel.webhookUrl) {\n          await this.sendWebhook(channel.webhookUrl, notification);\n        }\n        break;\n    }\n  }\n\n  /**\n   * Send security alert\n   */\n  private async sendSecurityAlert(notification: AdminNotification): Promise<void> {\n    // TODO: Implement security alert system (email, Slack, etc.)\n  }\n\n  /**\n   * Send webhook notification\n   */\n  private async sendWebhook(url: string, notification: AdminNotification): Promise<void> {\n    try {\n      await fetch(url, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          text: `${notification.title}: ${notification.message}`,\n          notification,\n        }),\n      });\n    } catch (error) {\n      console.error('Failed to send Slack notification:', error);\n    }\n  }\n\n  /**\n   * Generate unique ID\n   */\n  private generateId(): string {\n    return `notif_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n}\n\n// Singleton instance\nexport const adminNotifications = new AdminNotificationSystem();\n\n// Convenience functions for common notification types\nexport const notifyNewUserRegistration = (userEmail: string) => {\n  return adminNotifications.createNotification({\n    type: 'new_user_registration',\n    title: 'New User Registration',\n    message: `New user registered: ${userEmail}`,\n    priority: 'low',\n    actionRequired: false,\n    data: { userEmail },\n  });\n};\n\nexport const notifyBuilderRequestSubmitted = (userName: string, spaceName: string) => {\n  return adminNotifications.createNotification({\n    type: 'builder_request_submitted',\n    title: 'Builder Request Submitted',\n    message: `${userName} requested builder access for ${spaceName}`,\n    priority: 'medium',\n    actionRequired: true,\n    actionUrl: '/admin/dashboard?tab=builders',\n    actionText: 'Review Request',\n    data: { userName, spaceName },\n  });\n};\n\nexport const notifyContentFlagged = (contentType: string, flagReason: string) => {\n  return adminNotifications.createNotification({\n    type: 'content_flagged',\n    title: 'Content Flagged',\n    message: `${contentType} flagged for: ${flagReason}`,\n    priority: 'medium',\n    actionRequired: true,\n    actionUrl: '/admin/dashboard?tab=content',\n    actionText: 'Review Content',\n    data: { contentType, flagReason },\n  });\n};\n\nexport const notifySystemAlert = (alertType: string, message: string, priority: NotificationPriority = 'medium') => {\n  return adminNotifications.createNotification({\n    type: 'system_alert',\n    title: `System Alert: ${alertType}`,\n    message,\n    priority,\n    actionRequired: priority === 'high' || priority === 'critical',\n    actionUrl: '/admin/dashboard?tab=system',\n    actionText: 'View System Status',\n    data: { alertType },\n  });\n};\n\nexport const notifySecurityIncident = (incidentType: string, details: string) => {\n  return adminNotifications.createNotification({\n    type: 'security_incident',\n    title: `Security Incident: ${incidentType}`,\n    message: details,\n    priority: 'critical',\n    actionRequired: true,\n    actionUrl: '/admin/dashboard?tab=system',\n    actionText: 'Investigate',\n    data: { incidentType, details },\n  });\n};\n\nexport const notifyPerformanceWarning = (metric: string, value: string, threshold: string) => {\n  return adminNotifications.createNotification({\n    type: 'performance_warning',\n    title: 'Performance Warning',\n    message: `${metric} at ${value} (threshold: ${threshold})`,\n    priority: 'medium',\n    actionRequired: false,\n    actionUrl: '/admin/dashboard?tab=system',\n    actionText: 'View Metrics',\n    data: { metric, value, threshold },\n  });\n};","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/advanced-auth-security.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-auth-middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-auth-secure.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checkRedisRateLimit' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * PRODUCTION-SECURE API Authentication Middleware\n * Zero tolerance for dev bypasses in production\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { DecodedIdToken } from 'firebase-admin/auth';\nimport { authAdmin } from './firebase-admin';\nimport { logger } from './logger';\nimport {\n  checkRedisRateLimit,\n  getRateLimitHeaders,\n  checkIpRateLimit,\n  checkUserRateLimit\n} from './rate-limiter-redis';\nimport {\n  blockDevBypassesInProduction,\n  validateOrigin,\n  getSecurityHeaders,\n  enforceCampusIsolation,\n  sanitizeInput\n} from './security-middleware';\n\ninterface ApiAuthOptions {\n  requireAdmin?: boolean;\n  allowAnonymous?: boolean;\n  campusId?: string;\n  rateLimit?: {\n    type: string;\n    identifier?: string;\n  };\n  allowedFields?: string[]; // For input sanitization\n}\n\n/**\n * PRODUCTION-SECURE authentication wrapper\n * Returns a function that handles the request\n * NO DEV BYPASSES - EVER\n */\nexport function withSecureAuth(\n  handler: (request: NextRequest, token: DecodedIdToken) => Promise<NextResponse>,\n  options: ApiAuthOptions = {}\n) {\n  return async (request: NextRequest): Promise<NextResponse> => {\n    // CRITICAL: Block all dev bypasses in production\n    blockDevBypassesInProduction();\n\n    const {\n      requireAdmin = false,\n      allowAnonymous = false,\n      campusId = 'ub-buffalo', // Default to UB for vBETA\n      rateLimit,\n      allowedFields\n    } = options;\n\n    try {\n      // 1. Validate request origin\n      if (!validateOrigin(request)) {\n        logger.warn('Invalid origin attempted API access', {\n          origin: request.headers.get('origin') || undefined,\n          referer: request.headers.get('referer') || undefined,\n          url: request.url\n        });\n\n        return NextResponse.json(\n          { error: 'Invalid origin' },\n          { status: 403, headers: getSecurityHeaders() }\n        );\n      }\n\n      // 2. Rate limiting checks\n      if (rateLimit) {\n        const ip = request.headers.get('x-forwarded-for') || 'unknown';\n\n        // IP-based rate limiting\n        const ipLimitResult = await checkIpRateLimit(ip, rateLimit.type);\n        if (!ipLimitResult.success) {\n          return NextResponse.json(\n            { error: 'Too many requests' },\n            {\n              status: 429,\n              headers: {\n                ...getSecurityHeaders(),\n                ...getRateLimitHeaders(ipLimitResult)\n              }\n            }\n          );\n        }\n      }\n\n      // 3. Check for anonymous access\n      if (allowAnonymous) {\n        // Still apply rate limiting and security checks\n        return handler(request, {} as DecodedIdToken);\n      }\n\n      // 4. Validate authentication token\n      const authHeader = request.headers.get('authorization');\n      if (!authHeader?.startsWith('Bearer ')) {\n        logger.warn('Missing or invalid auth header', {\n          url: request.url,\n          hasHeader: !!authHeader,\n          headerStart: authHeader?.substring(0, 10)\n        });\n\n        return NextResponse.json(\n          { error: 'Authentication required' },\n          { status: 401, headers: getSecurityHeaders() }\n        );\n      }\n\n      const token = authHeader.replace('Bearer ', '');\n\n      // 5. Verify Firebase token\n      let decodedToken: DecodedIdToken;\n      try {\n        decodedToken = await authAdmin.verifyIdToken(token);\n      } catch (error) {\n        logger.error('Token verification failed', {\n          error,\n          url: request.url\n        });\n\n        return NextResponse.json(\n          { error: 'Invalid authentication token' },\n          { status: 401, headers: getSecurityHeaders() }\n        );\n      }\n\n      // 6. User-based rate limiting\n      if (rateLimit) {\n        const userLimitResult = await checkUserRateLimit(\n          decodedToken.uid,\n          rateLimit.type\n        );\n\n        if (!userLimitResult.success) {\n          return NextResponse.json(\n            { error: 'Too many requests for user' },\n            {\n              status: 429,\n              headers: {\n                ...getSecurityHeaders(),\n                ...getRateLimitHeaders(userLimitResult)\n              }\n            }\n          );\n        }\n      }\n\n      // 7. Check admin requirements\n      if (requireAdmin) {\n        const adminEmails = [\n          'jwrhineh@buffalo.edu',\n          'noahowsh@gmail.com'\n        ];\n\n        if (!adminEmails.includes(decodedToken.email || '')) {\n          logger.warn('Non-admin attempted admin access', {\n            userId: decodedToken.uid,\n            email: decodedToken.email,\n            url: request.url\n          });\n\n          return NextResponse.json(\n            { error: 'Admin access required' },\n            { status: 403, headers: getSecurityHeaders() }\n          );\n        }\n      }\n\n      // 8. Campus isolation check\n      if (campusId) {\n        const userCampusId = (decodedToken as Record<string, unknown>).campusId as string | undefined;\n        if (userCampusId && !enforceCampusIsolation(userCampusId, campusId)) {\n          logger.warn('Campus isolation violation', {\n            userId: decodedToken.uid,\n            expectedCampus: campusId,\n            userCampusId,\n            userEmail: decodedToken.email\n          });\n\n          return NextResponse.json(\n            { error: 'Access denied for this campus' },\n            { status: 403, headers: getSecurityHeaders() }\n          );\n        }\n      }\n\n      // 9. Input sanitization if body exists\n      if (request.method === 'POST' || request.method === 'PUT' || request.method === 'PATCH') {\n        try {\n          const body = await request.json();\n          const sanitized = sanitizeInput(body, allowedFields ?? []);\n\n          // Create a new request with sanitized body\n          const sanitizedRequest = new NextRequest(request.url, {\n            method: request.method,\n            headers: request.headers,\n            body: JSON.stringify(sanitized)\n          });\n\n          return handler(sanitizedRequest, decodedToken);\n        } catch (error) {\n          logger.error('Request body processing failed', {\n            error,\n            url: request.url\n          });\n\n          return NextResponse.json(\n            { error: 'Invalid request body' },\n            { status: 400, headers: getSecurityHeaders() }\n          );\n        }\n      }\n\n      // 10. Execute handler with authenticated context\n      return handler(request, decodedToken);\n\n    } catch (error) {\n      logger.error('Auth middleware error', {\n        error,\n        url: request.url\n      });\n\n      return NextResponse.json(\n        { error: 'Internal server error' },\n        { status: 500, headers: getSecurityHeaders() }\n      );\n    }\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-client-resilient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-error-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-response-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/api-wrapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/audit-logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth-middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'admin' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Centralized authentication middleware for API routes\n * Provides secure token validation and prevents bypass vulnerabilities\n */\n\nimport { NextRequest } from 'next/server';\nimport * as admin from 'firebase-admin';\nimport { getAuth } from 'firebase-admin/auth';\nimport { validateAuthToken, blockDevPatternsInProduction } from './security-service';\nimport { AuthenticationError, AuthorizationError } from './api-error-handler';\n\nexport interface AuthContext {\n  userId: string;\n  email?: string;\n  isTestUser: boolean;\n  isDevelopmentMode: boolean;\n}\n\n/**\n * Authentication configuration\n */\nexport interface AuthConfig {\n  required?: boolean;\n  allowTestTokens?: boolean;\n  allowAnonymous?: boolean;\n  operation?: string;\n  action?: string;\n}\n\n/**\n * Centralized authentication middleware\n * Use this instead of manual token validation in API routes\n */\nexport async function authenticateRequest(\n  request: NextRequest,\n  config: AuthConfig = {}\n): Promise<AuthContext | null> {\n  const {\n    required = true,\n    allowTestTokens = process.env.NODE_ENV === 'development',\n    allowAnonymous = false,\n    operation = 'api_access'\n  } = config;\n\n  // Check for security violations\n  const securityCheck = await blockDevPatternsInProduction(request);\n  if (securityCheck.blocked) {\n    throw new AuthenticationError(`Security violation: ${securityCheck.reason}`);\n  }\n\n  // Get token from Authorization header\n  const authHeader = request.headers.get('authorization');\n  \n  // Handle missing auth header\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    if (allowAnonymous) {\n      return null;\n    }\n    if (required) {\n      throw new AuthenticationError('Authorization header required');\n    }\n    return null;\n  }\n\n  const token = authHeader.substring(7).trim();\n  \n  if (!token) {\n    if (required) {\n      throw new AuthenticationError('Token required');\n    }\n    return null;\n  }\n\n  // Use centralized security service for validation\n  const tokenValidation = await validateAuthToken(token, request, {\n    operation,\n    requireRealAuth: !allowTestTokens\n  });\n\n  if (!tokenValidation.valid) {\n    if (tokenValidation.securityAlert) {\n      throw new AuthorizationError(`Security violation: ${tokenValidation.reason}`);\n    }\n    throw new AuthenticationError(tokenValidation.reason || 'Invalid token');\n  }\n\n  // Handle development test tokens\n  if (tokenValidation.userId && tokenValidation.reason === 'Development bypass token') {\n    return {\n      userId: tokenValidation.userId,\n      email: 'test@example.com',\n      isTestUser: true,\n      isDevelopmentMode: true\n    };\n  }\n\n  // Handle production Firebase tokens\n  try {\n    const auth = getAuth();\n    const decodedToken = await auth.verifyIdToken(token);\n    \n    return {\n      userId: decodedToken.uid,\n      email: decodedToken.email,\n      isTestUser: false,\n      isDevelopmentMode: false\n    };\n  } catch (firebaseError) {\n    console.error('Firebase token verification failed:', firebaseError);\n    throw new AuthenticationError('Invalid token');\n  }\n}\n\n/**\n * Require authentication wrapper for API handlers\n * Throws appropriate errors if authentication fails\n */\nexport async function requireAuth(\n  request: NextRequest,\n  config?: AuthConfig\n): Promise<AuthContext> {\n  const authContext = await authenticateRequest(request, { ...config, required: true });\n  \n  if (!authContext) {\n    throw new AuthenticationError('Authentication required');\n  }\n  \n  return authContext;\n}\n\n/**\n * Optional authentication wrapper for API handlers\n * Returns null if no valid authentication is found\n */\nexport async function optionalAuth(\n  request: NextRequest,\n  config?: AuthConfig\n): Promise<AuthContext | null> {\n  return authenticateRequest(request, { ...config, required: false });\n}\n\n/**\n * Extract user ID from request for backwards compatibility\n * @deprecated Use authenticateRequest instead\n */\nexport async function getUserIdFromRequest(request: NextRequest): Promise<string | null> {\n  try {\n    const authContext = await authenticateRequest(request, { required: false });\n    return authContext?.userId || null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Check if request is from a test user\n */\nexport function isTestUser(authContext: AuthContext | null): boolean {\n  return authContext?.isTestUser === true;\n}\n\n/**\n * Check if request is in development mode\n */\nexport function isDevelopmentAuth(authContext: AuthContext | null): boolean {\n  return authContext?.isDevelopmentMode === true;\n}\n\n/**\n * Admin authentication wrapper\n * Requires additional admin role verification\n */\nexport async function requireAdminAuth(\n  request: NextRequest,\n  config?: AuthConfig\n): Promise<AuthContext> {\n  const authContext = await requireAuth(request, { ...config, action: 'admin_access' });\n  \n  // For test users in development, allow admin access\n  if (authContext.isTestUser && authContext.isDevelopmentMode) {\n    return authContext;\n  }\n  \n  // TODO: Add real admin role verification from Firestore/custom claims\n  // For now, this is a placeholder that would check user roles\n  \n  throw new AuthorizationError('Admin access required');\n}\n\n/**\n * Audit log for authentication events using structured logging\n */\nexport async function logAuthEvent(\n  event: 'login' | 'logout' | 'token_validation' | 'auth_failure',\n  request: NextRequest,\n  authContext?: AuthContext,\n  details?: any\n) {\n  const { logAuthEvent: structuredLogAuthEvent } = await import('./structured-logger');\n\n  // Map event types to structured logger types\n  const mappedEvent = event === 'token_validation' ? 'verify' :\n                      event === 'auth_failure' ? 'failed_login' :\n                      event as 'login' | 'logout' | 'register' | 'verify' | 'failed_login';\n\n  await structuredLogAuthEvent(mappedEvent, {\n    requestId: request.headers.get('x-request-id') || undefined,\n    userId: authContext?.userId,\n    isTestUser: authContext?.isTestUser,\n    ip: request.headers.get('x-forwarded-for') || \n        request.headers.get('x-real-ip') || \n        request.headers.get('cf-connecting-ip') || undefined,\n    userAgent: request.headers.get('user-agent') || undefined,\n    action: `auth_${event}`,\n    tags: {\n      authEvent: event,\n      path: new URL(request.url).pathname\n    },\n    extra: details\n  });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth-monitoring-analytics.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userEvents' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":449,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":449,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userJourneys' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":458,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":458,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userEvents' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":467,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":467,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userJourneys' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":476,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":476,"endColumn":76},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'performanceEvents' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":487,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":487,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stage' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":508,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":508,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Advanced Authentication Monitoring & Analytics\n * Provides comprehensive auth flow monitoring, user behavior analytics, and performance insights\n */\n\ninterface AuthEvent {\n  id: string;\n  type: 'login_attempt' | 'login_success' | 'login_failure' | 'logout' | 'session_expired' | \n        'onboarding_start' | 'onboarding_complete' | 'security_violation' | 'performance_issue';\n  timestamp: number;\n  userId?: string;\n  sessionId: string;\n  metadata: Record<string, any>;\n  userAgent: string;\n  location: string;\n  duration?: number;\n  success: boolean;\n}\n\ninterface UserJourney {\n  userId: string;\n  sessionId: string;\n  startTime: number;\n  endTime?: number;\n  events: AuthEvent[];\n  funnel: {\n    landed: boolean;\n    schoolSelected: boolean;\n    emailEntered: boolean;\n    magicLinkClicked: boolean;\n    onboardingStarted: boolean;\n    onboardingCompleted: boolean;\n    firstDashboardView: boolean;\n  };\n  conversionTime?: number;\n  dropoffStage?: string;\n}\n\ninterface AuthAnalytics {\n  totalSessions: number;\n  successfulLogins: number;\n  failedLogins: number;\n  averageLoginTime: number;\n  onboardingCompletionRate: number;\n  averageOnboardingTime: number;\n  securityViolations: number;\n  topDropoffStages: Array<{ stage: string; count: number; percentage: number }>;\n  userRetention: {\n    day1: number;\n    day7: number;\n    day30: number;\n  };\n  performanceMetrics: {\n    averageAuthTime: number;\n    slowestQueries: Array<{ query: string; averageTime: number }>;\n    cacheHitRate: number;\n  };\n}\n\nexport class AuthMonitoringAnalytics {\n  private static instance: AuthMonitoringAnalytics;\n  private events: AuthEvent[] = [];\n  private journeys: Map<string, UserJourney> = new Map();\n  private analytics: AuthAnalytics = this.initializeAnalytics();\n  \n  private readonly MAX_EVENTS = 10000;\n  private readonly BATCH_SIZE = 100;\n  private eventQueue: AuthEvent[] = [];\n  private flushTimer: NodeJS.Timeout | null = null;\n\n  static getInstance(): AuthMonitoringAnalytics {\n    if (!AuthMonitoringAnalytics.instance) {\n      AuthMonitoringAnalytics.instance = new AuthMonitoringAnalytics();\n    }\n    return AuthMonitoringAnalytics.instance;\n  }\n\n  constructor() {\n    // Start periodic analytics updates\n    this.startPeriodicAnalytics();\n    \n    // Flush events periodically\n    this.startEventFlushing();\n  }\n\n  /**\n   * Track authentication event with comprehensive metadata\n   */\n  trackAuthEvent(\n    type: AuthEvent['type'],\n    metadata: Record<string, any> = {},\n    userId?: string,\n    duration?: number\n  ): void {\n    const event: AuthEvent = {\n      id: this.generateEventId(),\n      type,\n      timestamp: Date.now(),\n      userId,\n      sessionId: this.getCurrentSessionId(),\n      metadata: {\n        ...metadata,\n        url: typeof window !== 'undefined' ? window.location.href : '',\n        referrer: typeof window !== 'undefined' ? document.referrer : '',\n        viewport: typeof window !== 'undefined' ? \n          `${window.innerWidth}x${window.innerHeight}` : '',\n        connectionType: this.getConnectionType(),\n        ...this.getDeviceInfo()\n      },\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : '',\n      location: this.getUserLocation(),\n      duration,\n      success: !type.includes('failure') && !type.includes('violation')\n    };\n\n    this.addEvent(event);\n    this.updateUserJourney(event);\n    this.updateRealTimeAnalytics(event);\n  }\n\n  /**\n   * Track user journey through auth funnel\n   */\n  startUserJourney(userId?: string): string {\n    const sessionId = this.generateSessionId();\n    const journey: UserJourney = {\n      userId: userId || 'anonymous',\n      sessionId,\n      startTime: Date.now(),\n      events: [],\n      funnel: {\n        landed: true,\n        schoolSelected: false,\n        emailEntered: false,\n        magicLinkClicked: false,\n        onboardingStarted: false,\n        onboardingCompleted: false,\n        firstDashboardView: false\n      }\n    };\n\n    this.journeys.set(sessionId, journey);\n    return sessionId;\n  }\n\n  /**\n   * Update funnel stage for user journey\n   */\n  updateFunnelStage(sessionId: string, stage: keyof UserJourney['funnel']): void {\n    const journey = this.journeys.get(sessionId);\n    if (journey) {\n      journey.funnel[stage] = true;\n      \n      // Calculate conversion time if completed\n      if (stage === 'firstDashboardView') {\n        journey.endTime = Date.now();\n        journey.conversionTime = journey.endTime - journey.startTime;\n      }\n    }\n  }\n\n  /**\n   * Get comprehensive analytics dashboard data\n   */\n  getAnalyticsDashboard(): {\n    overview: AuthAnalytics;\n    realTimeMetrics: {\n      activeUsers: number;\n      recentLogins: number;\n      currentConversions: number;\n      alertsCount: number;\n    };\n    funnelAnalysis: Array<{\n      stage: string;\n      users: number;\n      conversionRate: number;\n      averageTime: number;\n    }>;\n    cohortAnalysis: Array<{\n      cohort: string;\n      users: number;\n      retention: number[];\n    }>;\n    securityInsights: {\n      threatLevel: 'low' | 'medium' | 'high';\n      recentViolations: AuthEvent[];\n      riskScores: Array<{ userId: string; score: number; reasons: string[] }>;\n    };\n  } {\n    return {\n      overview: this.analytics,\n      realTimeMetrics: this.getRealTimeMetrics(),\n      funnelAnalysis: this.getFunnelAnalysis(),\n      cohortAnalysis: this.getCohortAnalysis(),\n      securityInsights: this.getSecurityInsights()\n    };\n  }\n\n  /**\n   * Get user behavior insights\n   */\n  getUserBehaviorInsights(userId: string): {\n    loginPattern: {\n      mostActiveHours: number[];\n      averageSessionDuration: number;\n      loginFrequency: number;\n    };\n    onboardingJourney: {\n      timeToComplete: number;\n      stepsCompleted: string[];\n      dropoffPoints: string[];\n    };\n    securityProfile: {\n      riskScore: number;\n      suspiciousActivities: AuthEvent[];\n      deviceFingerprints: string[];\n    };\n    recommendations: string[];\n  } {\n    const userEvents = this.events.filter(e => e.userId === userId);\n    const userJourneys = Array.from(this.journeys.values()).filter(j => j.userId === userId);\n\n    return {\n      loginPattern: this.analyzeLoginPattern(userEvents),\n      onboardingJourney: this.analyzeOnboardingJourney(userJourneys),\n      securityProfile: this.analyzeSecurityProfile(userEvents),\n      recommendations: this.generateUserRecommendations(userEvents, userJourneys)\n    };\n  }\n\n  /**\n   * Performance monitoring and optimization suggestions\n   */\n  getPerformanceInsights(): {\n    slowQueries: Array<{ action: string; averageTime: number; count: number }>;\n    bottlenecks: Array<{ stage: string; impact: number; suggestion: string }>;\n    optimizations: Array<{ area: string; currentScore: number; targetScore: number; actions: string[] }>;\n    resourceUsage: {\n      memoryUsage: number;\n      cacheEfficiency: number;\n      apiCallVolume: number;\n    };\n  } {\n    const performanceEvents = this.events.filter(e => e.duration !== undefined);\n    \n    return {\n      slowQueries: this.analyzeSlowQueries(performanceEvents),\n      bottlenecks: this.identifyBottlenecks(),\n      optimizations: this.suggestOptimizations(),\n      resourceUsage: this.getResourceUsage()\n    };\n  }\n\n  /**\n   * Export analytics data for external analysis\n   */\n  exportAnalyticsData(format: 'json' | 'csv' | 'xlsx' = 'json'): string | Blob {\n    const data = {\n      events: this.events,\n      journeys: Array.from(this.journeys.values()),\n      analytics: this.analytics,\n      exportedAt: new Date().toISOString(),\n      version: '1.0.0'\n    };\n\n    switch (format) {\n      case 'json':\n        return JSON.stringify(data, null, 2);\n      case 'csv':\n        return this.convertToCSV(data);\n      case 'xlsx':\n        return this.convertToXLSX(data);\n      default:\n        return JSON.stringify(data);\n    }\n  }\n\n  // Private helper methods\n  private addEvent(event: AuthEvent): void {\n    this.events.push(event);\n    this.eventQueue.push(event);\n    \n    // Maintain memory limits\n    if (this.events.length > this.MAX_EVENTS) {\n      this.events = this.events.slice(-this.MAX_EVENTS);\n    }\n  }\n\n  private updateUserJourney(event: AuthEvent): void {\n    const journey = this.journeys.get(event.sessionId);\n    if (journey) {\n      journey.events.push(event);\n      \n      // Update funnel based on event type\n      switch (event.type) {\n        case 'login_attempt':\n          this.updateFunnelStage(event.sessionId, 'emailEntered');\n          break;\n        case 'login_success':\n          this.updateFunnelStage(event.sessionId, 'magicLinkClicked');\n          break;\n        case 'onboarding_start':\n          this.updateFunnelStage(event.sessionId, 'onboardingStarted');\n          break;\n        case 'onboarding_complete':\n          this.updateFunnelStage(event.sessionId, 'onboardingCompleted');\n          break;\n      }\n    }\n  }\n\n  private updateRealTimeAnalytics(event: AuthEvent): void {\n    // Update counters based on event type\n    switch (event.type) {\n      case 'login_success':\n        this.analytics.successfulLogins++;\n        break;\n      case 'login_failure':\n        this.analytics.failedLogins++;\n        break;\n      case 'security_violation':\n        this.analytics.securityViolations++;\n        break;\n    }\n\n    this.analytics.totalSessions = this.journeys.size;\n  }\n\n  private initializeAnalytics(): AuthAnalytics {\n    return {\n      totalSessions: 0,\n      successfulLogins: 0,\n      failedLogins: 0,\n      averageLoginTime: 0,\n      onboardingCompletionRate: 0,\n      averageOnboardingTime: 0,\n      securityViolations: 0,\n      topDropoffStages: [],\n      userRetention: { day1: 0, day7: 0, day30: 0 },\n      performanceMetrics: {\n        averageAuthTime: 0,\n        slowestQueries: [],\n        cacheHitRate: 0\n      }\n    };\n  }\n\n  private generateEventId(): string {\n    return `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  private generateSessionId(): string {\n    return `sess_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  private getCurrentSessionId(): string {\n    // Get current session ID from storage or generate new one\n    if (typeof window !== 'undefined') {\n      let sessionId = sessionStorage.getItem('hive_analytics_session');\n      if (!sessionId) {\n        sessionId = this.generateSessionId();\n        sessionStorage.setItem('hive_analytics_session', sessionId);\n      }\n      return sessionId;\n    }\n    return 'server_session';\n  }\n\n  private getConnectionType(): string {\n    if (typeof navigator !== 'undefined' && 'connection' in navigator) {\n      const connection = (navigator as any).connection;\n      return connection.effectiveType || connection.type || 'unknown';\n    }\n    return 'unknown';\n  }\n\n  private getDeviceInfo(): Record<string, any> {\n    if (typeof window === 'undefined') return {};\n    \n    return {\n      screen: `${screen.width}x${screen.height}`,\n      devicePixelRatio: window.devicePixelRatio,\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      language: navigator.language,\n      platform: navigator.platform,\n      cookieEnabled: navigator.cookieEnabled,\n      onlineStatus: navigator.onLine\n    };\n  }\n\n  private getUserLocation(): string {\n    // This would typically use GeoIP or similar service\n    // For now, return timezone-based approximation\n    try {\n      return Intl.DateTimeFormat().resolvedOptions().timeZone;\n    } catch {\n      return 'unknown';\n    }\n  }\n\n  private getRealTimeMetrics() {\n    const now = Date.now();\n    const oneHourAgo = now - (60 * 60 * 1000);\n    \n    const recentEvents = this.events.filter(e => e.timestamp > oneHourAgo);\n    \n    return {\n      activeUsers: new Set(recentEvents.map(e => e.userId).filter(Boolean)).size,\n      recentLogins: recentEvents.filter(e => e.type === 'login_success').length,\n      currentConversions: recentEvents.filter(e => e.type === 'onboarding_complete').length,\n      alertsCount: recentEvents.filter(e => e.type === 'security_violation').length\n    };\n  }\n\n  private getFunnelAnalysis() {\n    // Analyze conversion funnel\n    const stages = ['landed', 'schoolSelected', 'emailEntered', 'magicLinkClicked', 'onboardingStarted', 'onboardingCompleted', 'firstDashboardView'];\n    const journeys = Array.from(this.journeys.values());\n    \n    return stages.map((stage, index) => {\n      const usersAtStage = journeys.filter(j => j.funnel[stage as keyof UserJourney['funnel']]).length;\n      const previousStage = index > 0 ? journeys.filter(j => j.funnel[stages[index - 1] as keyof UserJourney['funnel']]).length : journeys.length;\n\n      return {\n        stage: stage,\n        users: usersAtStage,\n        conversionRate: previousStage > 0 ? (usersAtStage / previousStage) * 100 : 0,\n        averageTime: this.getAverageTimeToStage(stage)\n      };\n    });\n  }\n\n  private getCohortAnalysis() {\n    // Placeholder for cohort analysis\n    return [];\n  }\n\n  private getSecurityInsights() {\n    const securityEvents = this.events.filter(e => e.type === 'security_violation');\n    const recentViolations = securityEvents.slice(-10);\n    \n    return {\n      threatLevel: (securityEvents.length > 10 ? 'high' : securityEvents.length > 5 ? 'medium' : 'low') as 'low' | 'medium' | 'high',\n      recentViolations,\n      riskScores: []\n    };\n  }\n\n  private analyzeLoginPattern(userEvents: AuthEvent[]) {\n    // Placeholder implementation\n    return {\n      mostActiveHours: [9, 10, 11, 14, 15, 16],\n      averageSessionDuration: 3600000, // 1 hour\n      loginFrequency: 0.8 // times per day\n    };\n  }\n\n  private analyzeOnboardingJourney(userJourneys: UserJourney[]) {\n    // Placeholder implementation\n    return {\n      timeToComplete: 300000, // 5 minutes\n      stepsCompleted: ['profile', 'school', 'major'],\n      dropoffPoints: ['photo_upload']\n    };\n  }\n\n  private analyzeSecurityProfile(userEvents: AuthEvent[]) {\n    // Placeholder implementation\n    return {\n      riskScore: 2,\n      suspiciousActivities: [],\n      deviceFingerprints: []\n    };\n  }\n\n  private generateUserRecommendations(userEvents: AuthEvent[], userJourneys: UserJourney[]): string[] {\n    const recommendations: string[] = [];\n    \n    // Add recommendations based on user behavior\n    if (userEvents.filter(e => e.type === 'login_failure').length > 3) {\n      recommendations.push('Consider enabling two-factor authentication');\n    }\n    \n    return recommendations;\n  }\n\n  private analyzeSlowQueries(performanceEvents: AuthEvent[]) {\n    // Group by operation and calculate averages\n    return [];\n  }\n\n  private identifyBottlenecks() {\n    return [];\n  }\n\n  private suggestOptimizations() {\n    return [];\n  }\n\n  private getResourceUsage() {\n    return {\n      memoryUsage: 0,\n      cacheEfficiency: 0,\n      apiCallVolume: 0\n    };\n  }\n\n  private getAverageTimeToStage(stage: string): number {\n    // Calculate average time to reach specific funnel stage\n    return 0;\n  }\n\n  private convertToCSV(data: any): string {\n    // Convert data to CSV format\n    return '';\n  }\n\n  private convertToXLSX(data: any): Blob {\n    // Convert data to XLSX format\n    return new Blob();\n  }\n\n  private startPeriodicAnalytics(): void {\n    setInterval(() => {\n      this.recalculateAnalytics();\n    }, 5 * 60 * 1000); // Every 5 minutes\n  }\n\n  private startEventFlushing(): void {\n    this.flushTimer = setInterval(() => {\n      this.flushEventQueue();\n    }, 30 * 1000); // Every 30 seconds\n  }\n\n  private recalculateAnalytics(): void {\n    // Recalculate analytics based on current data\n    const completedJourneys = Array.from(this.journeys.values()).filter(j => j.endTime);\n    \n    if (completedJourneys.length > 0) {\n      this.analytics.onboardingCompletionRate = (completedJourneys.length / this.journeys.size) * 100;\n      this.analytics.averageOnboardingTime = completedJourneys.reduce((sum, j) => \n        sum + (j.conversionTime || 0), 0) / completedJourneys.length;\n    }\n  }\n\n  private async flushEventQueue(): Promise<void> {\n    if (this.eventQueue.length === 0) return;\n\n    const eventsToFlush = this.eventQueue.splice(0, this.BATCH_SIZE);\n    \n    try {\n      // Send to analytics endpoint\n      await fetch('/api/analytics/events', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ events: eventsToFlush })\n      });\n    } catch (error) {\n      // Re-queue events on failure\n      this.eventQueue.unshift(...eventsToFlush);\n      console.error('Failed to flush analytics events:', error);\n    }\n  }\n}\n\n// Singleton instance for global use\nexport const authAnalytics = AuthMonitoringAnalytics.getInstance();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth-performance-optimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth-server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auth/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/auto-space-creation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/automated-moderation-workflows.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/avatar-generator.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'backgroundColor' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Avatar Generation Utilities for HIVE\n * Generates consistent, high-quality default avatars for users\n */\n\nexport interface AvatarOptions {\n  seed?: string;\n  size?: number;\n  style?: 'avataaars' | 'identicon' | 'initials' | 'geometric';\n  backgroundColor?: string;\n}\n\n/**\n * Generate a default avatar URL for a user\n */\nexport function generateDefaultAvatar(\n  userId: string, \n  options: AvatarOptions = {}\n): string {\n  const {\n    size = 150,\n    style = 'avataaars',\n    backgroundColor = 'var(--hive-brand-primary)'\n  } = options;\n\n  // Use userId as seed for consistent avatars\n  const seed = options.seed || userId;\n  \n  switch (style) {\n    case 'avataaars':\n      return `https://api.dicebear.com/7.x/avataaars/svg?seed=${seed}&size=${size}&backgroundColor=${encodeURIComponent(backgroundColor)}`;\n    \n    case 'identicon':\n      return `https://api.dicebear.com/7.x/identicon/svg?seed=${seed}&size=${size}&backgroundColor=${encodeURIComponent(backgroundColor)}`;\n    \n    case 'geometric':\n      return `https://api.dicebear.com/7.x/shapes/svg?seed=${seed}&size=${size}&backgroundColor=${encodeURIComponent(backgroundColor)}`;\n    \n    case 'initials':\n    default:\n      // For initials, we'll use a simple service or generate locally\n      return generateInitialsAvatar(seed, size, backgroundColor);\n  }\n}\n\n/**\n * Generate avatar from user initials\n */\nfunction generateInitialsAvatar(\n  seed: string, \n  size: number, \n  backgroundColor: string\n): string {\n  // Extract initials from seed (could be name or userId)\n  const initials = extractInitials(seed);\n  \n  // Generate a consistent color based on seed\n  const colors = [\n    '#F59E0B', // Amber\n    '#EF4444', // Red  \n    '#10B981', // Emerald\n    '#3B82F6', // Blue\n    '#8B5CF6', // Violet\n    '#F97316', // Orange\n    '#06B6D4', // Cyan\n    '#84CC16', // Lime\n  ];\n  \n  const colorIndex = seed.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0) % colors.length;\n  const bgColor = colors[colorIndex];\n  \n  // Return a data URL or use a service\n  return `https://ui-avatars.com/api/?name=${encodeURIComponent(initials)}&size=${size}&background=${bgColor.slice(1)}&color=ffffff&bold=true&format=svg`;\n}\n\n/**\n * Extract initials from a string (name or ID)\n */\nfunction extractInitials(input: string): string {\n  if (!input) return 'HU'; // HIVE User default\n  \n  // If it looks like a name (contains spaces)\n  if (input.includes(' ')) {\n    return input\n      .split(' ')\n      .map(word => word.charAt(0).toUpperCase())\n      .slice(0, 2)\n      .join('');\n  }\n  \n  // If it's a userId or single word, take first two characters\n  return input.slice(0, 2).toUpperCase();\n}\n\n/**\n * Get a variety of default avatar options for user selection\n */\nexport function getDefaultAvatarOptions(userId: string): string[] {\n  const baseOptions = [\n    { style: 'avataaars' as const, seed: userId },\n    { style: 'avataaars' as const, seed: `${userId}-alt1` },\n    { style: 'avataaars' as const, seed: `${userId}-alt2` },\n    { style: 'geometric' as const, seed: userId },\n    { style: 'identicon' as const, seed: userId },\n    { style: 'initials' as const, seed: userId },\n  ];\n\n  return baseOptions.map(options => generateDefaultAvatar(userId, options));\n}\n\n/**\n * Check if a URL is a user-uploaded image (vs generated avatar)\n */\nexport function isUserUploadedImage(imageUrl: string): boolean {\n  if (!imageUrl) return false;\n  \n  // Firebase Storage URLs\n  if (imageUrl.includes('firebasestorage.googleapis.com')) return true;\n  \n  // Other upload services could be added here\n  return false;\n}\n\n/**\n * Get fallback avatar if image fails to load\n */\nexport function getFallbackAvatar(userId: string, userName?: string): string {\n  const seed = userName || userId;\n  return generateDefaultAvatar(userId, {\n    style: 'initials',\n    seed\n  });\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cache/cache-service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tool' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// High-level caching service for HIVE platform\n// Provides domain-specific caching methods with optimized TTL and invalidation strategies\n\nimport { redisCache } from './redis-client';\nimport { logger } from '@/lib/logger';\nimport type { User, Space, Post, Tool, Ritual } from '@hive/core';\n\ninterface CacheNamespaces {\n  USERS: 'users';\n  SPACES: 'spaces';\n  POSTS: 'posts';\n  TOOLS: 'tools';\n  RITUALS: 'rituals';\n  FEED: 'feed';\n  ANALYTICS: 'analytics';\n  SEARCH: 'search';\n  SESSIONS: 'sessions';\n  RATE_LIMITS: 'rate_limits';\n}\n\nconst CACHE_NAMESPACES: CacheNamespaces = {\n  USERS: 'users',\n  SPACES: 'spaces',\n  POSTS: 'posts',\n  TOOLS: 'tools',\n  RITUALS: 'rituals',\n  FEED: 'feed',\n  ANALYTICS: 'analytics',\n  SEARCH: 'search',\n  SESSIONS: 'sessions',\n  RATE_LIMITS: 'rate_limits'\n};\n\ninterface CacheTTL {\n  SHORT: number;    // 5 minutes\n  MEDIUM: number;   // 1 hour\n  LONG: number;     // 4 hours\n  VERY_LONG: number; // 24 hours\n  SESSION: number;  // 7 days\n}\n\nconst TTL: CacheTTL = {\n  SHORT: 300,        // 5 minutes\n  MEDIUM: 3600,      // 1 hour\n  LONG: 14400,       // 4 hours\n  VERY_LONG: 86400,  // 24 hours\n  SESSION: 604800    // 7 days\n};\n\nclass HiveCacheService {\n  // User caching methods\n  async getCachedUser(userId: string, campusId?: string): Promise<User | null> {\n    try {\n      return await redisCache.get<User>(CACHE_NAMESPACES.USERS, userId, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached user:', error);\n      return null;\n    }\n  }\n\n  async setCachedUser(userId: string, user: User, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.USERS,\n        userId,\n        user,\n        TTL.MEDIUM,\n        campusId,\n        { type: 'user_profile', lastUpdated: Date.now() }\n      );\n    } catch (error) {\n      logger.error('Failed to cache user:', error);\n      return false;\n    }\n  }\n\n  async invalidateUser(userId: string, campusId?: string): Promise<boolean> {\n    try {\n      // Invalidate user profile\n      await redisCache.delete(CACHE_NAMESPACES.USERS, userId, campusId);\n\n      // Invalidate user's feed cache\n      await redisCache.deletePattern(CACHE_NAMESPACES.FEED, `user:${userId}:*`, campusId);\n\n      // Invalidate user's session data\n      await redisCache.deletePattern(CACHE_NAMESPACES.SESSIONS, `${userId}:*`, campusId);\n\n      logger.info(`Invalidated cache for user: ${userId}`);\n      return true;\n    } catch (error) {\n      logger.error('Failed to invalidate user cache:', error);\n      return false;\n    }\n  }\n\n  // Space caching methods\n  async getCachedSpace(spaceId: string, campusId?: string): Promise<Space | null> {\n    try {\n      return await redisCache.get<Space>(CACHE_NAMESPACES.SPACES, spaceId, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached space:', error);\n      return null;\n    }\n  }\n\n  async setCachedSpace(spaceId: string, space: Space, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.SPACES,\n        spaceId,\n        space,\n        TTL.LONG,\n        campusId,\n        { type: 'space_data', memberCount: space.memberCount || 0 }\n      );\n    } catch (error) {\n      logger.error('Failed to cache space:', error);\n      return false;\n    }\n  }\n\n  async getCachedSpaceMembers(spaceId: string, campusId?: string): Promise<string[] | null> {\n    try {\n      return await redisCache.get<string[]>(CACHE_NAMESPACES.SPACES, `${spaceId}:members`, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached space members:', error);\n      return null;\n    }\n  }\n\n  async setCachedSpaceMembers(spaceId: string, memberIds: string[], campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.SPACES,\n        `${spaceId}:members`,\n        memberIds,\n        TTL.MEDIUM,\n        campusId,\n        { type: 'space_members', count: memberIds.length }\n      );\n    } catch (error) {\n      logger.error('Failed to cache space members:', error);\n      return false;\n    }\n  }\n\n  async invalidateSpace(spaceId: string, campusId?: string): Promise<boolean> {\n    try {\n      // Invalidate space data and members\n      await redisCache.deletePattern(CACHE_NAMESPACES.SPACES, `${spaceId}*`, campusId);\n\n      // Invalidate space-related posts\n      await redisCache.deletePattern(CACHE_NAMESPACES.POSTS, `space:${spaceId}:*`, campusId);\n\n      // Invalidate feed entries containing this space\n      await redisCache.deletePattern(CACHE_NAMESPACES.FEED, `*space:${spaceId}*`, campusId);\n\n      logger.info(`Invalidated cache for space: ${spaceId}`);\n      return true;\n    } catch (error) {\n      logger.error('Failed to invalidate space cache:', error);\n      return false;\n    }\n  }\n\n  // Feed caching methods\n  async getCachedUserFeed(userId: string, page: number = 0, campusId?: string): Promise<Post[] | null> {\n    try {\n      return await redisCache.get<Post[]>(\n        CACHE_NAMESPACES.FEED,\n        `user:${userId}:page:${page}`,\n        campusId\n      );\n    } catch (error) {\n      logger.error('Failed to get cached user feed:', error);\n      return null;\n    }\n  }\n\n  async setCachedUserFeed(userId: string, page: number, posts: Post[], campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.FEED,\n        `user:${userId}:page:${page}`,\n        posts,\n        TTL.SHORT, // Feed data changes frequently\n        campusId,\n        { type: 'user_feed', postCount: posts.length }\n      );\n    } catch (error) {\n      logger.error('Failed to cache user feed:', error);\n      return false;\n    }\n  }\n\n  async getCachedSpaceFeed(spaceId: string, page: number = 0, campusId?: string): Promise<Post[] | null> {\n    try {\n      return await redisCache.get<Post[]>(\n        CACHE_NAMESPACES.FEED,\n        `space:${spaceId}:page:${page}`,\n        campusId\n      );\n    } catch (error) {\n      logger.error('Failed to get cached space feed:', error);\n      return null;\n    }\n  }\n\n  async setCachedSpaceFeed(spaceId: string, page: number, posts: Post[], campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.FEED,\n        `space:${spaceId}:page:${page}`,\n        posts,\n        TTL.SHORT,\n        campusId,\n        { type: 'space_feed', postCount: posts.length }\n      );\n    } catch (error) {\n      logger.error('Failed to cache space feed:', error);\n      return false;\n    }\n  }\n\n  async invalidateUserFeed(userId: string, campusId?: string): Promise<boolean> {\n    try {\n      await redisCache.deletePattern(CACHE_NAMESPACES.FEED, `user:${userId}:*`, campusId);\n      logger.info(`Invalidated feed cache for user: ${userId}`);\n      return true;\n    } catch (error) {\n      logger.error('Failed to invalidate user feed:', error);\n      return false;\n    }\n  }\n\n  // Search caching methods\n  async getCachedSearchResults(query: string, filters: Record<string, any>, campusId?: string): Promise<any[] | null> {\n    try {\n      const queryKey = this.generateSearchKey(query, filters);\n      return await redisCache.get<any[]>(CACHE_NAMESPACES.SEARCH, queryKey, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached search results:', error);\n      return null;\n    }\n  }\n\n  async setCachedSearchResults(query: string, filters: Record<string, any>, results: any[], campusId?: string): Promise<boolean> {\n    try {\n      const queryKey = this.generateSearchKey(query, filters);\n      return await redisCache.set(\n        CACHE_NAMESPACES.SEARCH,\n        queryKey,\n        results,\n        TTL.MEDIUM,\n        campusId,\n        { type: 'search_results', resultCount: results.length, query }\n      );\n    } catch (error) {\n      logger.error('Failed to cache search results:', error);\n      return false;\n    }\n  }\n\n  private generateSearchKey(query: string, filters: Record<string, any>): string {\n    const normalizedQuery = query.toLowerCase().trim();\n    const filterString = Object.keys(filters)\n      .sort()\n      .map(key => `${key}:${filters[key]}`)\n      .join('|');\n\n    return `${normalizedQuery}:${Buffer.from(filterString).toString('base64')}`;\n  }\n\n  // Analytics caching methods\n  async getCachedAnalytics(key: string, campusId?: string): Promise<any | null> {\n    try {\n      return await redisCache.get<any>(CACHE_NAMESPACES.ANALYTICS, key, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached analytics:', error);\n      return null;\n    }\n  }\n\n  async setCachedAnalytics(key: string, data: any, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.ANALYTICS,\n        key,\n        data,\n        TTL.VERY_LONG, // Analytics can be cached longer\n        campusId,\n        { type: 'analytics_data', generatedAt: Date.now() }\n      );\n    } catch (error) {\n      logger.error('Failed to cache analytics:', error);\n      return false;\n    }\n  }\n\n  // Ritual caching methods\n  async getCachedRitual(ritualId: string, campusId?: string): Promise<Ritual | null> {\n    try {\n      return await redisCache.get<Ritual>(CACHE_NAMESPACES.RITUALS, ritualId, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached ritual:', error);\n      return null;\n    }\n  }\n\n  async setCachedRitual(ritualId: string, ritual: Ritual, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.RITUALS,\n        ritualId,\n        ritual,\n        TTL.LONG,\n        campusId,\n        { type: 'ritual_data', status: ritual.status }\n      );\n    } catch (error) {\n      logger.error('Failed to cache ritual:', error);\n      return false;\n    }\n  }\n\n  async getCachedActiveRituals(campusId?: string): Promise<Ritual[] | null> {\n    try {\n      return await redisCache.get<Ritual[]>(CACHE_NAMESPACES.RITUALS, 'active_list', campusId);\n    } catch (error) {\n      logger.error('Failed to get cached active rituals:', error);\n      return null;\n    }\n  }\n\n  async setCachedActiveRituals(rituals: Ritual[], campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.RITUALS,\n        'active_list',\n        rituals,\n        TTL.MEDIUM,\n        campusId,\n        { type: 'active_rituals', count: rituals.length }\n      );\n    } catch (error) {\n      logger.error('Failed to cache active rituals:', error);\n      return false;\n    }\n  }\n\n  // Session management\n  async getCachedSession(sessionId: string, campusId?: string): Promise<any | null> {\n    try {\n      return await redisCache.get<any>(CACHE_NAMESPACES.SESSIONS, sessionId, campusId);\n    } catch (error) {\n      logger.error('Failed to get cached session:', error);\n      return null;\n    }\n  }\n\n  async setCachedSession(sessionId: string, sessionData: any, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.set(\n        CACHE_NAMESPACES.SESSIONS,\n        sessionId,\n        sessionData,\n        TTL.SESSION,\n        campusId,\n        { type: 'user_session', userId: sessionData.userId }\n      );\n    } catch (error) {\n      logger.error('Failed to cache session:', error);\n      return false;\n    }\n  }\n\n  async invalidateSession(sessionId: string, campusId?: string): Promise<boolean> {\n    try {\n      return await redisCache.delete(CACHE_NAMESPACES.SESSIONS, sessionId, campusId);\n    } catch (error) {\n      logger.error('Failed to invalidate session:', error);\n      return false;\n    }\n  }\n\n  // Rate limiting\n  async checkRateLimit(userId: string, action: string, limit: number, windowSeconds: number, campusId?: string): Promise<{ allowed: boolean; remainingRequests: number; resetTime: number }> {\n    try {\n      const key = `${userId}:${action}`;\n      const currentCount = await redisCache.get<number>(CACHE_NAMESPACES.RATE_LIMITS, key, campusId) || 0;\n\n      if (currentCount >= limit) {\n        return {\n          allowed: false,\n          remainingRequests: 0,\n          resetTime: Date.now() + (windowSeconds * 1000)\n        };\n      }\n\n      const newCount = currentCount + 1;\n      await redisCache.set(CACHE_NAMESPACES.RATE_LIMITS, key, newCount, windowSeconds, campusId);\n\n      return {\n        allowed: true,\n        remainingRequests: limit - newCount,\n        resetTime: Date.now() + (windowSeconds * 1000)\n      };\n    } catch (error) {\n      logger.error('Rate limit check failed:', error);\n      // Allow request on error to avoid blocking users\n      return {\n        allowed: true,\n        remainingRequests: limit,\n        resetTime: Date.now() + (windowSeconds * 1000)\n      };\n    }\n  }\n\n  // Bulk operations for performance\n  async setCachedUsers(users: Array<{ id: string; data: User; campusId?: string }>): Promise<boolean> {\n    try {\n      const entries = users.map(user => ({\n        namespace: CACHE_NAMESPACES.USERS,\n        key: user.id,\n        data: user.data,\n        ttl: TTL.MEDIUM,\n        campusId: user.campusId\n      }));\n\n      return await redisCache.mset(entries);\n    } catch (error) {\n      logger.error('Failed to cache multiple users:', error);\n      return false;\n    }\n  }\n\n  async getCachedUsers(userIds: string[], campusId?: string): Promise<Array<User | null>> {\n    try {\n      return await redisCache.mget<User>(CACHE_NAMESPACES.USERS, userIds, campusId);\n    } catch (error) {\n      logger.error('Failed to get multiple cached users:', error);\n      return new Array(userIds.length).fill(null);\n    }\n  }\n\n  // Cache warming methods\n  async warmUserCache(userId: string, userData: User, campusId?: string): Promise<void> {\n    try {\n      // Cache user profile\n      await this.setCachedUser(userId, userData, campusId);\n\n      // Pre-warm frequently accessed data\n      logger.info(`Cache warmed for user: ${userId}`);\n    } catch (error) {\n      logger.error('Failed to warm user cache:', error);\n    }\n  }\n\n  async warmSpaceCache(spaceId: string, spaceData: Space, campusId?: string): Promise<void> {\n    try {\n      // Cache space data\n      await this.setCachedSpace(spaceId, spaceData, campusId);\n\n      logger.info(`Cache warmed for space: ${spaceId}`);\n    } catch (error) {\n      logger.error('Failed to warm space cache:', error);\n    }\n  }\n\n  // Cache statistics and health\n  getCacheStats() {\n    return redisCache.getStats();\n  }\n\n  async getCacheHealth(): Promise<{ healthy: boolean; stats: any; memory?: any }> {\n    try {\n      const healthy = await redisCache.isHealthy();\n      const stats = this.getCacheStats();\n      const memory = await redisCache.getMemoryInfo();\n\n      return { healthy, stats, memory };\n    } catch (error) {\n      logger.error('Failed to get cache health:', error);\n      return { healthy: false, stats: this.getCacheStats() };\n    }\n  }\n\n  // Campus-wide operations\n  async invalidateCampusCache(campusId: string): Promise<number> {\n    try {\n      return await redisCache.invalidateCampusCache(campusId);\n    } catch (error) {\n      logger.error('Failed to invalidate campus cache:', error);\n      return 0;\n    }\n  }\n\n  // Emergency cache operations\n  async flushAllCache(): Promise<boolean> {\n    try {\n      const success = await redisCache.flushAll();\n      if (success) {\n        logger.warn('All cache data has been flushed');\n      }\n      return success;\n    } catch (error) {\n      logger.error('Failed to flush all cache:', error);\n      return false;\n    }\n  }\n}\n\n// Export singleton instance\nexport const cacheService = new HiveCacheService();\nexport default cacheService;","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cache/redis-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/calendar-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/campus-isolation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/campus-tools-templates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/comprehensive-security-middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/connection-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/content-moderation-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/content-validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cookie-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cors-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cost-aware-feed-fallback.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":280,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":280,"endColumn":37}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { firebaseCostMonitor } from './firebase-cost-monitor';\nimport { logger } from './structured-logger';\n\n/**\n * Cost-Aware Feed Fallback System\n * Gracefully degrades from real-time to polling when costs get high\n */\n\nexport interface FallbackConfig {\n  costThreshold: number;        // Monthly cost limit before fallback\n  userListenerLimit: number;    // Max listeners per user\n  pollInterval: number;         // Fallback polling interval in ms\n  enableProgressiveDegradation: boolean;\n}\n\nexport enum FeedMode {\n  REALTIME_FULL = 'realtime_full',           // All real-time features\n  REALTIME_LIMITED = 'realtime_limited',     // Limited real-time (priority only)\n  HYBRID = 'hybrid',                         // Mix of real-time + polling\n  POLLING_ONLY = 'polling_only',             // Traditional polling fallback\n  EMERGENCY_READONLY = 'emergency_readonly'   // Emergency read-only mode\n}\n\nclass CostAwareFeedManager {\n  private currentMode: FeedMode = FeedMode.REALTIME_FULL;\n  private config: FallbackConfig = {\n    costThreshold: 200,           // $200/month limit\n    userListenerLimit: 3,         // Max 3 listeners per user\n    pollInterval: 30000,          // 30-second fallback polling\n    enableProgressiveDegradation: true\n  };\n\n  private fallbackIntervals: Map<string, NodeJS.Timeout> = new Map();\n  private degradationHistory: { timestamp: Date; mode: FeedMode; reason: string }[] = [];\n\n  constructor() {\n    // Monitor costs every 30 seconds\n    setInterval(() => this.evaluateFeedMode(), 30000);\n\n    // Listen for emergency shutoff\n    window.addEventListener('firebase-emergency-shutoff', () => {\n      this.setFeedMode(FeedMode.EMERGENCY_READONLY, 'emergency_shutoff');\n    });\n  }\n\n  /**\n   * Evaluate and adjust feed mode based on current costs\n   */\n  private evaluateFeedMode(): void {\n    const metrics = firebaseCostMonitor.getMetrics();\n    const currentCost = metrics.estimatedMonthlyCost;\n    const listenerCount = metrics.listenersActive;\n\n    let newMode = this.currentMode;\n    let reason = '';\n\n    // Progressive degradation based on cost\n    if (currentCost > this.config.costThreshold * 1.2) {\n      // 20% over limit - emergency mode\n      newMode = FeedMode.EMERGENCY_READONLY;\n      reason = `Cost ${currentCost} exceeded emergency threshold`;\n    } else if (currentCost > this.config.costThreshold) {\n      // Over limit - polling only\n      newMode = FeedMode.POLLING_ONLY;\n      reason = `Cost ${currentCost} exceeded limit ${this.config.costThreshold}`;\n    } else if (currentCost > this.config.costThreshold * 0.8) {\n      // 80% of limit - hybrid mode\n      newMode = FeedMode.HYBRID;\n      reason = `Cost ${currentCost} approaching limit`;\n    } else if (listenerCount > 500) {\n      // Too many listeners - limited real-time\n      newMode = FeedMode.REALTIME_LIMITED;\n      reason = `High listener count: ${listenerCount}`;\n    } else if (currentCost < this.config.costThreshold * 0.5) {\n      // Under 50% of limit - full real-time OK\n      newMode = FeedMode.REALTIME_FULL;\n      reason = 'Costs under control';\n    }\n\n    if (newMode !== this.currentMode) {\n      this.setFeedMode(newMode, reason);\n    }\n  }\n\n  /**\n   * Set feed mode and notify components\n   */\n  private setFeedMode(mode: FeedMode, reason: string): void {\n    const oldMode = this.currentMode;\n    this.currentMode = mode;\n\n    logger.info(`üìä Feed mode changed: ${oldMode} ‚Üí ${mode}`, { reason });\n\n    // Record history\n    this.degradationHistory.push({\n      timestamp: new Date(),\n      mode,\n      reason\n    });\n\n    // Keep last 24 hours of history\n    const oneDayAgo = Date.now() - 24 * 60 * 60 * 1000;\n    this.degradationHistory = this.degradationHistory.filter(\n      entry => entry.timestamp.getTime() > oneDayAgo\n    );\n\n    // Broadcast mode change to components\n    window.dispatchEvent(new CustomEvent('feed-mode-changed', {\n      detail: {\n        newMode: mode,\n        oldMode,\n        reason,\n        config: this.getModeConfig(mode)\n      }\n    }));\n\n    // Start fallback mechanisms if needed\n    this.handleModeChange(mode);\n  }\n\n  /**\n   * Handle mode-specific setup\n   */\n  private handleModeChange(mode: FeedMode): void {\n    // Clear existing fallback intervals\n    this.fallbackIntervals.forEach(interval => clearInterval(interval));\n    this.fallbackIntervals.clear();\n\n    switch (mode) {\n      case FeedMode.POLLING_ONLY:\n        this.startPollingFallback();\n        break;\n\n      case FeedMode.HYBRID:\n        this.startHybridMode();\n        break;\n\n      case FeedMode.EMERGENCY_READONLY:\n        this.enterEmergencyMode();\n        break;\n\n      // REALTIME_FULL and REALTIME_LIMITED are handled by listener limits\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Start polling fallback for feed updates\n   */\n  private startPollingFallback(): void {\n    const pollForFeedUpdates = async () => {\n      try {\n        // Broadcast polling update event\n        window.dispatchEvent(new CustomEvent('feed-fallback-poll', {\n          detail: { timestamp: new Date() }\n        }));\n      } catch (error) {\n        logger.error('Fallback polling error', { error: error instanceof Error ? error.message : String(error) });\n      }\n    };\n\n    const interval = setInterval(pollForFeedUpdates, this.config.pollInterval);\n    this.fallbackIntervals.set('feed-poll', interval);\n  }\n\n  /**\n   * Start hybrid mode (limited real-time + polling)\n   */\n  private startHybridMode(): void {\n    // Poll for less critical updates\n    const hybridPoll = async () => {\n      window.dispatchEvent(new CustomEvent('feed-hybrid-poll', {\n        detail: {\n          timestamp: new Date(),\n          pollType: 'non_critical_updates'\n        }\n      }));\n    };\n\n    const interval = setInterval(hybridPoll, this.config.pollInterval * 2); // Slower polling\n    this.fallbackIntervals.set('hybrid-poll', interval);\n  }\n\n  /**\n   * Enter emergency read-only mode\n   */\n  private enterEmergencyMode(): void {\n    logger.error('üö® Entering emergency read-only mode');\n\n    // Disable all writes\n    window.dispatchEvent(new CustomEvent('feed-emergency-mode', {\n      detail: {\n        message: 'HIVE is in cost-control mode. Some features temporarily disabled.',\n        allowWrites: false,\n        showBanner: true\n      }\n    }));\n  }\n\n  /**\n   * Get configuration for current mode\n   */\n  getModeConfig(mode: FeedMode = this.currentMode): any {\n    const baseConfig = {\n      mode,\n      timestamp: new Date(),\n      costMetrics: firebaseCostMonitor.getMetrics()\n    };\n\n    switch (mode) {\n      case FeedMode.REALTIME_FULL:\n        return {\n          ...baseConfig,\n          maxListenersPerUser: 5,\n          enableAllListeners: true,\n          pollInterval: null\n        };\n\n      case FeedMode.REALTIME_LIMITED:\n        return {\n          ...baseConfig,\n          maxListenersPerUser: 3,\n          enableAllListeners: false,\n          priorityOnly: true,\n          pollInterval: null\n        };\n\n      case FeedMode.HYBRID:\n        return {\n          ...baseConfig,\n          maxListenersPerUser: 2,\n          enableAllListeners: false,\n          pollInterval: this.config.pollInterval * 2,\n          hybridMode: true\n        };\n\n      case FeedMode.POLLING_ONLY:\n        return {\n          ...baseConfig,\n          maxListenersPerUser: 0,\n          enableAllListeners: false,\n          pollInterval: this.config.pollInterval,\n          realtimeDisabled: true\n        };\n\n      case FeedMode.EMERGENCY_READONLY:\n        return {\n          ...baseConfig,\n          maxListenersPerUser: 0,\n          enableAllListeners: false,\n          pollInterval: this.config.pollInterval * 4,\n          readOnlyMode: true,\n          showEmergencyBanner: true\n        };\n\n      default:\n        return baseConfig;\n    }\n  }\n\n  /**\n   * Check if user can use real-time features\n   */\n  canUseRealtime(userId: string): boolean {\n    if (this.currentMode === FeedMode.EMERGENCY_READONLY ||\n        this.currentMode === FeedMode.POLLING_ONLY) {\n      return false;\n    }\n\n    return firebaseCostMonitor.canCreateListener(userId);\n  }\n\n  /**\n   * Get recommended listener count for user\n   */\n  getRecommendedListenerCount(userId: string): number {\n    const config = this.getModeConfig();\n\n    switch (this.currentMode) {\n      case FeedMode.REALTIME_FULL:\n        return Math.min(5, config.maxListenersPerUser);\n      case FeedMode.REALTIME_LIMITED:\n        return Math.min(3, config.maxListenersPerUser);\n      case FeedMode.HYBRID:\n        return Math.min(2, config.maxListenersPerUser);\n      default:\n        return 0;\n    }\n  }\n\n  /**\n   * Get current status for UI display\n   */\n  getStatus(): {\n    mode: FeedMode;\n    isHealthy: boolean;\n    message: string;\n    recommendations: string[];\n  } {\n    const metrics = firebaseCostMonitor.getMetrics();\n    const costPercentage = (metrics.estimatedMonthlyCost / this.config.costThreshold) * 100;\n\n    let isHealthy = true;\n    let message = 'All systems optimal';\n    const recommendations: string[] = [];\n\n    if (this.currentMode === FeedMode.EMERGENCY_READONLY) {\n      isHealthy = false;\n      message = 'Emergency mode: High Firebase costs detected';\n      recommendations.push('Some features temporarily disabled to control costs');\n    } else if (this.currentMode === FeedMode.POLLING_ONLY) {\n      isHealthy = false;\n      message = 'Polling mode: Real-time features limited';\n      recommendations.push('Real-time updates paused to manage costs');\n    } else if (costPercentage > 80) {\n      isHealthy = false;\n      message = `Cost warning: ${Math.round(costPercentage)}% of monthly budget used`;\n      recommendations.push('Consider reducing active spaces');\n    }\n\n    return {\n      mode: this.currentMode,\n      isHealthy,\n      message,\n      recommendations\n    };\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(newConfig: Partial<FallbackConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n    logger.info('üí∞ Feed fallback config updated', this.config);\n  }\n\n  /**\n   * Get degradation history for debugging\n   */\n  getDegradationHistory(): typeof this.degradationHistory {\n    return [...this.degradationHistory];\n  }\n}\n\n// Global fallback manager\nexport const costAwareFeedManager = new CostAwareFeedManager();\n\n// React hook for components\nexport function useCostAwareFeed() {\n  const [status, setStatus] = React.useState(costAwareFeedManager.getStatus());\n  const [config, setConfig] = React.useState(costAwareFeedManager.getModeConfig());\n\n  React.useEffect(() => {\n    const handleModeChange = (event: any) => {\n      setStatus(costAwareFeedManager.getStatus());\n      setConfig(event.detail.config);\n    };\n\n    window.addEventListener('feed-mode-changed', handleModeChange);\n\n    return () => {\n      window.removeEventListener('feed-mode-changed', handleModeChange);\n    };\n  }, []);\n\n  return {\n    ...status,\n    config,\n    canUseRealtime: (userId: string) => costAwareFeedManager.canUseRealtime(userId),\n    getRecommendedListenerCount: (userId: string) =>\n      costAwareFeedManager.getRecommendedListenerCount(userId)\n  };\n}\n\nexport default costAwareFeedManager;","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/cross-platform-notifications.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":601,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":601,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":606,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":606,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Cross-Platform Notification System\n * \n * Manages notifications across all platform slices with smart routing,\n * real-time delivery, and cross-device synchronization\n */\n\nimport { type PlatformNotification } from './platform-integration';\nimport { useUnifiedStore } from './unified-state-management';\n\n// ===== NOTIFICATION TYPES =====\n\nexport interface NotificationConfig {\n  id: string;\n  type: NotificationType;\n  title: string;\n  message: string;\n  sourceSlice: 'feed' | 'spaces' | 'tools' | 'profile' | 'system';\n  sourceId: string;\n  targetUserId: string;\n  actionUrl?: string;\n  metadata: {\n    spaceId?: string;\n    toolId?: string;\n    postId?: string;\n    priority: 'low' | 'medium' | 'high' | 'urgent';\n    category: NotificationCategory;\n    tags: string[];\n    expiresAt?: string;\n    groupingKey?: string; // For grouping similar notifications\n  };\n  delivery: {\n    channels: DeliveryChannel[];\n    preferences: NotificationPreferences;\n    timing: DeliveryTiming;\n  };\n}\n\nexport type NotificationType = \n  | 'space_invite' | 'space_joined' | 'space_post' | 'space_event'\n  | 'tool_shared' | 'tool_deployed' | 'tool_interaction' | 'tool_comment'\n  | 'feed_mention' | 'feed_like' | 'feed_comment' | 'feed_share'\n  | 'profile_follow' | 'profile_achievement' | 'profile_milestone'\n  | 'system_update' | 'system_maintenance' | 'system_announcement';\n\nexport type NotificationCategory = \n  | 'social' | 'activity' | 'system' | 'achievement' | 'reminder';\n\nexport type DeliveryChannel = \n  | 'in_app' | 'push' | 'email' | 'sms' | 'desktop';\n\nexport interface NotificationPreferences {\n  enableInApp: boolean;\n  enablePush: boolean;\n  enableEmail: boolean;\n  enableDesktop: boolean;\n  quietHours?: {\n    enabled: boolean;\n    start: string; // HH:MM format\n    end: string;   // HH:MM format\n    timezone: string;\n  };\n  categorySettings: Record<NotificationCategory, {\n    enabled: boolean;\n    channels: DeliveryChannel[];\n    priority: 'low' | 'medium' | 'high';\n  }>;\n  spaceSettings: Record<string, {\n    enabled: boolean;\n    channels: DeliveryChannel[];\n    types: NotificationType[];\n  }>;\n}\n\nexport interface DeliveryTiming {\n  immediate: boolean;\n  batchWindow?: number; // Minutes to batch similar notifications\n  maxRetries: number;\n  retryDelay: number; // Milliseconds\n}\n\nexport interface NotificationTemplate {\n  type: NotificationType;\n  title: (data: any) => string;\n  message: (data: any) => string;\n  actionUrl: (data: any) => string;\n  category: NotificationCategory;\n  defaultPriority: 'low' | 'medium' | 'high';\n  defaultChannels: DeliveryChannel[];\n}\n\n// ===== NOTIFICATION TEMPLATES =====\n\nexport const NOTIFICATION_TEMPLATES: Record<NotificationType, NotificationTemplate> = {\n  // Space Notifications\n  space_invite: {\n    type: 'space_invite',\n    title: (data) => `Invited to ${data.spaceName}`,\n    message: (data) => `${data.inviterName} invited you to join ${data.spaceName}`,\n    actionUrl: (data) => `/spaces/${data.spaceId}`,\n    category: 'social',\n    defaultPriority: 'high',\n    defaultChannels: ['in_app', 'push', 'email']\n  },\n  \n  space_joined: {\n    type: 'space_joined',\n    title: (data) => `${data.memberName} joined ${data.spaceName}`,\n    message: (data) => `Welcome ${data.memberName} to the community!`,\n    actionUrl: (data) => `/spaces/${data.spaceId}/members`,\n    category: 'social',\n    defaultPriority: 'low',\n    defaultChannels: ['in_app']\n  },\n  \n  space_post: {\n    type: 'space_post',\n    title: (data) => `New post in ${data.spaceName}`,\n    message: (data) => `${data.authorName}: ${data.postPreview}`,\n    actionUrl: (data) => `/spaces/${data.spaceId}/posts/${data.postId}`,\n    category: 'activity',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  space_event: {\n    type: 'space_event',\n    title: (data) => `Event reminder: ${data.eventName}`,\n    message: (data) => `${data.eventName} starts in ${data.timeUntil}`,\n    actionUrl: (data) => `/spaces/${data.spaceId}/events/${data.eventId}`,\n    category: 'reminder',\n    defaultPriority: 'high',\n    defaultChannels: ['in_app', 'push', 'email']\n  },\n\n  // Tool Notifications\n  tool_shared: {\n    type: 'tool_shared',\n    title: (data) => `${data.toolName} shared with you`,\n    message: (data) => `${data.sharerName} shared a tool: ${data.toolDescription}`,\n    actionUrl: (data) => `/tools/${data.toolId}`,\n    category: 'social',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  tool_deployed: {\n    type: 'tool_deployed',\n    title: (data) => `${data.toolName} deployed successfully`,\n    message: (data) => `Your tool is now live in ${data.spaceName}`,\n    actionUrl: (data) => `/tools/${data.toolId}/deployments/${data.deploymentId}`,\n    category: 'achievement',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  tool_interaction: {\n    type: 'tool_interaction',\n    title: (data) => `New interaction with ${data.toolName}`,\n    message: (data) => `${data.userName} used your tool: ${data.interactionType}`,\n    actionUrl: (data) => `/tools/${data.toolId}/analytics`,\n    category: 'activity',\n    defaultPriority: 'low',\n    defaultChannels: ['in_app']\n  },\n  \n  tool_comment: {\n    type: 'tool_comment',\n    title: (data) => `Comment on ${data.toolName}`,\n    message: (data) => `${data.commenterName}: ${data.commentPreview}`,\n    actionUrl: (data) => `/tools/${data.toolId}#comment-${data.commentId}`,\n    category: 'social',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n\n  // Feed Notifications\n  feed_mention: {\n    type: 'feed_mention',\n    title: () => `You were mentioned`,\n    message: (data) => `${data.mentionerName} mentioned you in a post`,\n    actionUrl: (data) => `/feed/posts/${data.postId}`,\n    category: 'social',\n    defaultPriority: 'high',\n    defaultChannels: ['in_app', 'push', 'email']\n  },\n  \n  feed_like: {\n    type: 'feed_like',\n    title: (data) => `${data.likerName} liked your post`,\n    message: (data) => `Your post \"${data.postPreview}\" received a like`,\n    actionUrl: (data) => `/feed/posts/${data.postId}`,\n    category: 'social',\n    defaultPriority: 'low',\n    defaultChannels: ['in_app']\n  },\n  \n  feed_comment: {\n    type: 'feed_comment',\n    title: (data) => `New comment on your post`,\n    message: (data) => `${data.commenterName}: ${data.commentPreview}`,\n    actionUrl: (data) => `/feed/posts/${data.postId}#comment-${data.commentId}`,\n    category: 'social',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  feed_share: {\n    type: 'feed_share',\n    title: (data) => `${data.sharerName} shared your post`,\n    message: (data) => `Your post \"${data.postPreview}\" was shared`,\n    actionUrl: (data) => `/feed/posts/${data.postId}`,\n    category: 'social',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n\n  // Profile Notifications\n  profile_follow: {\n    type: 'profile_follow',\n    title: (data) => `${data.followerName} started following you`,\n    message: (data) => `You have a new follower: ${data.followerName}`,\n    actionUrl: (data) => `/profile/${data.followerId}`,\n    category: 'social',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  profile_achievement: {\n    type: 'profile_achievement',\n    title: (data) => `Achievement unlocked: ${data.achievementName}`,\n    message: (data) => `Congratulations! ${data.achievementDescription}`,\n    actionUrl: () => `/profile/achievements`,\n    category: 'achievement',\n    defaultPriority: 'high',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  profile_milestone: {\n    type: 'profile_milestone',\n    title: (data) => `Milestone reached: ${data.milestoneName}`,\n    message: (data) => `You've reached ${data.milestoneValue} ${data.milestoneType}!`,\n    actionUrl: () => `/profile/stats`,\n    category: 'achievement',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n\n  // System Notifications\n  system_update: {\n    type: 'system_update',\n    title: (data) => `HIVE ${data.updateType} Available`,\n    message: (data) => `New features and improvements: ${data.updateSummary}`,\n    actionUrl: () => `/updates`,\n    category: 'system',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  },\n  \n  system_maintenance: {\n    type: 'system_maintenance',\n    title: () => `Scheduled Maintenance`,\n    message: (data) => `HIVE will be offline ${data.startTime} - ${data.endTime} for maintenance`,\n    actionUrl: () => `/status`,\n    category: 'system',\n    defaultPriority: 'high',\n    defaultChannels: ['in_app', 'push', 'email']\n  },\n  \n  system_announcement: {\n    type: 'system_announcement',\n    title: (data) => data.title,\n    message: (data) => data.message,\n    actionUrl: (data) => data.actionUrl || '/announcements',\n    category: 'system',\n    defaultPriority: 'medium',\n    defaultChannels: ['in_app', 'push']\n  }\n};\n\n// ===== NOTIFICATION MANAGER CLASS =====\n\nexport class CrossPlatformNotificationManager {\n  private userPreferences: Map<string, NotificationPreferences> = new Map();\n  private deliveryQueue: Map<string, NotificationConfig[]> = new Map();\n  private batchingTimers: Map<string, NodeJS.Timeout> = new Map();\n  private retryQueue: Map<string, { config: NotificationConfig; attempt: number }> = new Map();\n\n  constructor() {\n    this.initializeServiceWorker();\n    this.startBatchProcessor();\n  }\n\n  /**\n   * Create and send a notification\n   */\n  async createNotification(\n    type: NotificationType,\n    targetUserId: string,\n    data: any,\n    options: Partial<NotificationConfig> = {}\n  ): Promise<string> {\n    const template = NOTIFICATION_TEMPLATES[type];\n    if (!template) {\n      throw new Error(`Unknown notification type: ${type}`);\n    }\n\n    const notificationId = `notif_${type}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    \n    const config: NotificationConfig = {\n      id: notificationId,\n      type,\n      title: template.title(data),\n      message: template.message(data),\n      sourceSlice: (options.sourceSlice || this.getSourceSliceFromType(type)) as 'feed' | 'spaces' | 'tools' | 'profile' | 'system',\n      sourceId: options.sourceId || data.id || 'unknown',\n      targetUserId,\n      actionUrl: template.actionUrl(data),\n      metadata: {\n        priority: options.metadata?.priority || template.defaultPriority,\n        category: template.category,\n        tags: options.metadata?.tags || [],\n        ...options.metadata\n      },\n      delivery: {\n        channels: template.defaultChannels,\n        preferences: await this.getUserPreferences(targetUserId),\n        timing: {\n          immediate: true,\n          maxRetries: 3,\n          retryDelay: 5000,\n          ...options.delivery?.timing\n        }\n      }\n    };\n\n    // Apply user preferences\n    const filteredConfig = await this.applyUserPreferences(config);\n    if (!filteredConfig) {\n      return notificationId;\n    }\n\n    // Check for batching\n    if (this.shouldBatch(filteredConfig)) {\n      this.addToBatch(filteredConfig);\n    } else {\n      await this.deliverNotification(filteredConfig);\n    }\n\n    return notificationId;\n  }\n\n  /**\n   * Send notification immediately\n   */\n  async sendNotification(config: NotificationConfig): Promise<boolean> {\n    try {\n      const deliveryResults = await Promise.allSettled(\n        config.delivery.channels.map(channel => this.deliverToChannel(config, channel))\n      );\n\n      const successCount = deliveryResults.filter(result => result.status === 'fulfilled').length;\n      const success = successCount > 0;\n\n      if (success) {\n        // Store in unified state\n        const store = useUnifiedStore.getState();\n        const platformNotification: PlatformNotification = {\n          id: config.id,\n          userId: config.targetUserId,\n          type: config.type as any,\n          title: config.title,\n          message: config.message,\n          actionUrl: config.actionUrl,\n          metadata: {\n            sourceSlice: config.sourceSlice,\n            sourceId: config.sourceId,\n            priority: config.metadata.priority as 'low' | 'medium' | 'high',\n            read: false,\n            timestamp: new Date().toISOString()\n          }\n        };\n        \n        store.addNotification(platformNotification);\n\n        // Log delivery\n        await this.logNotificationDelivery(config, deliveryResults);\n      } else {\n        // Add to retry queue\n        this.addToRetryQueue(config);\n      }\n\n      return success;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Get user notification preferences\n   */\n  async getUserPreferences(userId: string): Promise<NotificationPreferences> {\n    if (this.userPreferences.has(userId)) {\n      return this.userPreferences.get(userId)!;\n    }\n\n    try {\n      const response = await fetch(`/api/profile/notifications/preferences?userId=${userId}`);\n      if (response.ok) {\n        const preferences = await response.json();\n        this.userPreferences.set(userId, preferences);\n        return preferences;\n      }\n    } catch (error) {\n      console.error('Failed to fetch user notification preferences:', error);\n    }\n\n    // Return default preferences\n    const defaultPreferences: NotificationPreferences = {\n      enableInApp: true,\n      enablePush: true,\n      enableEmail: false,\n      enableDesktop: true,\n      categorySettings: {\n        social: { enabled: true, channels: ['in_app', 'push'], priority: 'medium' },\n        activity: { enabled: true, channels: ['in_app'], priority: 'low' },\n        system: { enabled: true, channels: ['in_app', 'push'], priority: 'high' },\n        achievement: { enabled: true, channels: ['in_app', 'push'], priority: 'high' },\n        reminder: { enabled: true, channels: ['in_app', 'push', 'email'], priority: 'high' }\n      },\n      spaceSettings: {}\n    };\n\n    this.userPreferences.set(userId, defaultPreferences);\n    return defaultPreferences;\n  }\n\n  /**\n   * Update user notification preferences\n   */\n  async updateUserPreferences(userId: string, preferences: Partial<NotificationPreferences>): Promise<void> {\n    try {\n      const response = await fetch('/api/profile/notifications/preferences', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId, preferences })\n      });\n\n      if (response.ok) {\n        const current = await this.getUserPreferences(userId);\n        const updated = { ...current, ...preferences };\n        this.userPreferences.set(userId, updated);\n      }\n    } catch (error) {\n      console.error('Failed to update user notification preferences:', error);\n    }\n  }\n\n  // ===== PRIVATE METHODS =====\n\n  private getSourceSliceFromType(type: NotificationType): string {\n    if (type.startsWith('space_')) return 'spaces';\n    if (type.startsWith('tool_')) return 'tools';\n    if (type.startsWith('feed_')) return 'feed';\n    if (type.startsWith('profile_')) return 'profile';\n    return 'system';\n  }\n\n  private async applyUserPreferences(config: NotificationConfig): Promise<NotificationConfig | null> {\n    const preferences = config.delivery.preferences;\n    \n    // Check if category is enabled\n    const categorySettings = preferences.categorySettings[config.metadata.category];\n    if (!categorySettings.enabled) {\n      return null;\n    }\n\n    // Check quiet hours\n    if (preferences.quietHours?.enabled) {\n      const now = new Date();\n      const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;\n      \n      if (this.isInQuietHours(currentTime, preferences.quietHours)) {\n        // Only allow urgent notifications during quiet hours\n        if (config.metadata.priority !== 'urgent') {\n          return null;\n        }\n      }\n    }\n\n    // Filter channels based on preferences\n    const allowedChannels = config.delivery.channels.filter(channel => {\n      switch (channel) {\n        case 'in_app': return preferences.enableInApp;\n        case 'push': return preferences.enablePush;\n        case 'email': return preferences.enableEmail;\n        case 'desktop': return preferences.enableDesktop;\n        default: return false;\n      }\n    });\n\n    if (allowedChannels.length === 0) {\n      return null;\n    }\n\n    return {\n      ...config,\n      delivery: {\n        ...config.delivery,\n        channels: allowedChannels\n      }\n    };\n  }\n\n  private isInQuietHours(currentTime: string, quietHours: NonNullable<NotificationPreferences['quietHours']>): boolean {\n    const start = quietHours.start;\n    const end = quietHours.end;\n    \n    // Handle case where quiet hours span midnight\n    if (start > end) {\n      return currentTime >= start || currentTime <= end;\n    } else {\n      return currentTime >= start && currentTime <= end;\n    }\n  }\n\n  private shouldBatch(config: NotificationConfig): boolean {\n    return config.metadata.groupingKey !== undefined && config.delivery.timing.batchWindow !== undefined;\n  }\n\n  private addToBatch(config: NotificationConfig): void {\n    const batchKey = `${config.targetUserId}_${config.metadata.groupingKey}`;\n    \n    if (!this.deliveryQueue.has(batchKey)) {\n      this.deliveryQueue.set(batchKey, []);\n    }\n    \n    this.deliveryQueue.get(batchKey)!.push(config);\n    \n    // Set or reset batch timer\n    if (this.batchingTimers.has(batchKey)) {\n      clearTimeout(this.batchingTimers.get(batchKey)!);\n    }\n    \n    const timer = setTimeout(() => {\n      this.processBatch(batchKey);\n    }, (config.delivery.timing.batchWindow || 5) * 60 * 1000); // Convert minutes to milliseconds\n    \n    this.batchingTimers.set(batchKey, timer);\n  }\n\n  private async processBatch(batchKey: string): Promise<void> {\n    const notifications = this.deliveryQueue.get(batchKey);\n    if (!notifications || notifications.length === 0) return;\n\n    // Create batched notification\n    const batchedConfig = this.createBatchedNotification(notifications);\n    await this.deliverNotification(batchedConfig);\n\n    // Clean up\n    this.deliveryQueue.delete(batchKey);\n    this.batchingTimers.delete(batchKey);\n  }\n\n  private createBatchedNotification(notifications: NotificationConfig[]): NotificationConfig {\n    const first = notifications[0];\n    const count = notifications.length;\n\n    return {\n      ...first,\n      id: `batch_${first.id}`,\n      title: `${count} new ${first.metadata.category} notifications`,\n      message: `You have ${count} new notifications from ${first.sourceSlice}`,\n      actionUrl: `/${first.sourceSlice}`,\n      metadata: {\n        ...first.metadata,\n        priority: 'medium'\n      }\n    };\n  }\n\n  private async deliverNotification(config: NotificationConfig): Promise<boolean> {\n    return await this.sendNotification(config);\n  }\n\n  private async deliverToChannel(config: NotificationConfig, channel: DeliveryChannel): Promise<boolean> {\n    switch (channel) {\n      case 'in_app':\n        return await this.deliverInApp(config);\n      case 'push':\n        return await this.deliverPush(config);\n      case 'email':\n        return await this.deliverEmail(config);\n      case 'desktop':\n        return await this.deliverDesktop(config);\n      default:\n        return false;\n    }\n  }\n\n  private async deliverInApp(config: NotificationConfig): Promise<boolean> {\n    // In-app notifications are handled by the unified state management\n    return true;\n  }\n\n  private async deliverPush(config: NotificationConfig): Promise<boolean> {\n    try {\n      if ('serviceWorker' in navigator && 'PushManager' in window) {\n        const registration = await navigator.serviceWorker.ready;\n        \n        if (registration.pushManager) {\n          // This would typically use the Push API with your server\n          return true;\n        }\n      }\n      return false;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  private async deliverEmail(config: NotificationConfig): Promise<boolean> {\n    try {\n      const response = await fetch('/api/notifications/email', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(config)\n      });\n      \n      return response.ok;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  private async deliverDesktop(config: NotificationConfig): Promise<boolean> {\n    try {\n      if ('Notification' in window) {\n        const permission = await Notification.requestPermission();\n        \n        if (permission === 'granted') {\n          new Notification(config.title, {\n            body: config.message,\n            icon: '/hive-logo-notification.png',\n            badge: '/hive-badge.png',\n            tag: config.id,\n            requireInteraction: config.metadata.priority === 'urgent',\n            // Remove unsupported actions property\n          });\n          \n          return true;\n        }\n      }\n      return false;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  private addToRetryQueue(config: NotificationConfig): void {\n    this.retryQueue.set(config.id, { config, attempt: 0 });\n    \n    setTimeout(() => {\n      this.processRetryQueue();\n    }, config.delivery.timing.retryDelay);\n  }\n\n  private async processRetryQueue(): Promise<void> {\n    for (const [id, { config, attempt }] of this.retryQueue.entries()) {\n      if (attempt >= config.delivery.timing.maxRetries) {\n        this.retryQueue.delete(id);\n        continue;\n      }\n\n      const success = await this.sendNotification(config);\n      \n      if (success) {\n        this.retryQueue.delete(id);\n      } else {\n        this.retryQueue.set(id, { config, attempt: attempt + 1 });\n      }\n    }\n  }\n\n  private async logNotificationDelivery(config: NotificationConfig, results: PromiseSettledResult<boolean>[]): Promise<void> {\n    try {\n      await fetch('/api/notifications/delivery-log', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          notificationId: config.id,\n          userId: config.targetUserId,\n          type: config.type,\n          channels: config.delivery.channels,\n          results: results.map((result, index) => ({\n            channel: config.delivery.channels[index],\n            success: result.status === 'fulfilled' && result.value,\n            error: result.status === 'rejected' ? result.reason : null\n          })),\n          timestamp: new Date().toISOString()\n        })\n      });\n    } catch (error) {\n      console.error('Failed to log notification delivery results:', error);\n    }\n  }\n\n  private initializeServiceWorker(): void {\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register('/sw-notifications.js')\n        .then(registration => {\n          console.log('Service worker registered successfully:', registration);\n        })\n        .catch(error => {\n          console.error('Failed to register service worker:', error);\n        });\n    }\n  }\n\n  private startBatchProcessor(): void {\n    // Process batches every minute\n    setInterval(() => {\n      this.processRetryQueue();\n    }, 60000);\n  }\n}\n\n// ===== SINGLETON INSTANCE =====\n\nlet notificationManagerInstance: CrossPlatformNotificationManager | null = null;\n\nexport function getNotificationManager(): CrossPlatformNotificationManager {\n  if (!notificationManagerInstance) {\n    notificationManagerInstance = new CrossPlatformNotificationManager();\n  }\n  return notificationManagerInstance;\n}\n\n// ===== CONVENIENCE FUNCTIONS =====\n\nexport async function sendSpaceInvite(targetUserId: string, inviterName: string, spaceId: string, spaceName: string): Promise<void> {\n  const manager = getNotificationManager();\n  await manager.createNotification('space_invite', targetUserId, {\n    inviterName,\n    spaceId,\n    spaceName\n  });\n}\n\nexport async function sendToolShare(targetUserId: string, sharerName: string, toolId: string, toolName: string, toolDescription: string): Promise<void> {\n  const manager = getNotificationManager();\n  await manager.createNotification('tool_shared', targetUserId, {\n    sharerName,\n    toolId,\n    toolName,\n    toolDescription\n  });\n}\n\nexport async function sendFeedMention(targetUserId: string, mentionerName: string, postId: string, postPreview: string): Promise<void> {\n  const manager = getNotificationManager();\n  await manager.createNotification('feed_mention', targetUserId, {\n    mentionerName,\n    postId,\n    postPreview\n  });\n}\n\nexport async function sendAchievement(targetUserId: string, achievementName: string, achievementDescription: string): Promise<void> {\n  const manager = getNotificationManager();\n  await manager.createNotification('profile_achievement', targetUserId, {\n    achievementName,\n    achievementDescription\n  });\n}\n\nexport async function sendSystemAnnouncement(targetUserId: string, title: string, message: string, actionUrl?: string): Promise<void> {\n  const manager = getNotificationManager();\n  await manager.createNotification('system_announcement', targetUserId, {\n    title,\n    message,\n    actionUrl\n  });\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/csrf-protection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/dev-auth-helper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/element-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/email-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/email.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/env.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/error-monitoring.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/error-reporting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/error-resilience-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feature-flags.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feature-gates.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":426,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":426,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'feature' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":427,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":427,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'level' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":428,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":428,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stats' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":429,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":429,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'calculateEngagementScore' is defined but never used. Allowed unused vars must match /^_/u.","line":438,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":438,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Feature Gating System\n *\n * Philosophy: \"Earn Your Voice\"\n * Users must invest time and engagement before unlocking features.\n * This creates scarcity, value, and psychological investment.\n */\n\nimport { differenceInDays, differenceInHours } from 'date-fns';\n\nexport type UserLevel = 'lurker' | 'reactor' | 'commenter' | 'poster' | 'creator' | 'elite';\n\nexport interface UserStats {\n  // Identity\n  userId: string;\n  createdAt: Date;\n\n  // Profile completion\n  profileCompleteness: number; // 0-100\n  hasAvatar: boolean;\n  hasBio: boolean;\n  hasInterests: boolean;\n\n  // Engagement metrics\n  totalViews: number;\n  totalDwellTime: number; // seconds\n  totalLikes: number;\n  totalComments: number;\n  totalPosts: number;\n\n  // Quality metrics\n  flaggedContent: number;\n  reportedContent: number;\n\n  // Social metrics\n  followers: number;\n  following: number;\n  mutualFollows: number;\n  spaceMemberships: number;\n\n  // Activity metrics\n  lastActiveAt: Date;\n  consecutiveDays: number;\n  totalDaysActive: number;\n}\n\nexport interface FeatureAccess {\n  // Core permissions\n  canView: boolean;\n  canLike: boolean;\n  canComment: boolean;\n  canPost: boolean;\n  canUploadMedia: boolean;\n  canCreateEvents: boolean;\n  canBuildTools: boolean;\n  canStartRituals: boolean;\n  canGoLive: boolean;\n\n  // Daily limits\n  dailyLikesLimit: number;\n  dailyCommentsLimit: number;\n  dailyPostsLimit: number;\n\n  // Remaining today\n  likesRemaining: number;\n  commentsRemaining: number;\n  postsRemaining: number;\n\n  // Next unlock info\n  currentLevel: UserLevel;\n  nextLevel: UserLevel | null;\n  nextUnlockFeature: string | null;\n  nextUnlockProgress: number; // 0-100\n  nextUnlockRequirements: string[];\n  estimatedUnlockTime: string | null;\n}\n\nexport interface UnlockRequirement {\n  met: boolean;\n  description: string;\n  progress: number; // 0-100\n}\n\n/**\n * Calculate user's current level based on stats\n */\nexport function calculateUserLevel(stats: UserStats): UserLevel {\n  const daysSinceJoined = differenceInDays(new Date(), stats.createdAt);\n\n  // Elite: 180+ days, creator for 90+ days\n  if (daysSinceJoined >= 180 && stats.totalPosts >= 100) {\n    return 'elite';\n  }\n\n  // Creator: 30+ days, proven poster\n  if (\n    daysSinceJoined >= 30 &&\n    stats.totalPosts >= 5 &&\n    stats.profileCompleteness === 100 &&\n    stats.flaggedContent === 0\n  ) {\n    return 'creator';\n  }\n\n  // Poster: 14+ days, proven commenter\n  if (\n    daysSinceJoined >= 14 &&\n    stats.totalComments >= 10 &&\n    stats.profileCompleteness >= 100 &&\n    stats.mutualFollows >= 1 &&\n    stats.flaggedContent === 0\n  ) {\n    return 'poster';\n  }\n\n  // Commenter: 7+ days, proven reactor\n  if (\n    daysSinceJoined >= 7 &&\n    stats.totalLikes >= 30 &&\n    stats.profileCompleteness >= 80 &&\n    stats.following >= 5 &&\n    stats.totalDaysActive >= 3\n  ) {\n    return 'commenter';\n  }\n\n  // Reactor: 3+ days, proven lurker\n  if (\n    daysSinceJoined >= 3 &&\n    stats.totalViews >= 50 &&\n    stats.profileCompleteness >= 60 &&\n    stats.spaceMemberships >= 2 &&\n    stats.totalDwellTime >= 600 // 10 minutes\n  ) {\n    return 'reactor';\n  }\n\n  // Lurker: Default starting level\n  return 'lurker';\n}\n\n/**\n * Get feature access for user level\n */\nexport function getFeatureAccess(\n  stats: UserStats,\n  todayStats?: { likes: number; comments: number; posts: number }\n): FeatureAccess {\n  const level = calculateUserLevel(stats);\n  const today = todayStats || { likes: 0, comments: 0, posts: 0 };\n\n  // Define limits per level\n  const limits = {\n    lurker: { likes: 0, comments: 0, posts: 0 },\n    reactor: { likes: 20, comments: 0, posts: 0 },\n    commenter: { likes: 50, comments: 10, posts: 0 },\n    poster: { likes: 100, comments: 25, posts: 3 },\n    creator: { likes: Infinity, comments: Infinity, posts: 10 },\n    elite: { likes: Infinity, comments: Infinity, posts: Infinity }\n  };\n\n  const currentLimits = limits[level];\n\n  // Calculate next unlock\n  const nextLevelMap: Record<UserLevel, UserLevel | null> = {\n    lurker: 'reactor',\n    reactor: 'commenter',\n    commenter: 'poster',\n    poster: 'creator',\n    creator: 'elite',\n    elite: null\n  };\n\n  const nextLevel = nextLevelMap[level];\n  const { feature: nextFeature, progress, requirements, timeEstimate } =\n    getNextUnlockInfo(stats, level, nextLevel);\n\n  return {\n    // Core permissions\n    canView: true, // Always true\n    canLike: level !== 'lurker',\n    canComment: ['commenter', 'poster', 'creator', 'elite'].includes(level),\n    canPost: ['poster', 'creator', 'elite'].includes(level),\n    canUploadMedia: ['creator', 'elite'].includes(level),\n    canCreateEvents: ['creator', 'elite'].includes(level),\n    canBuildTools: ['creator', 'elite'].includes(level),\n    canStartRituals: ['creator', 'elite'].includes(level),\n    canGoLive: level === 'elite',\n\n    // Daily limits\n    dailyLikesLimit: currentLimits.likes,\n    dailyCommentsLimit: currentLimits.comments,\n    dailyPostsLimit: currentLimits.posts,\n\n    // Remaining today\n    likesRemaining: Math.max(0, currentLimits.likes - today.likes),\n    commentsRemaining: Math.max(0, currentLimits.comments - today.comments),\n    postsRemaining: Math.max(0, currentLimits.posts - today.posts),\n\n    // Next unlock info\n    currentLevel: level,\n    nextLevel,\n    nextUnlockFeature: nextFeature,\n    nextUnlockProgress: progress,\n    nextUnlockRequirements: requirements,\n    estimatedUnlockTime: timeEstimate\n  };\n}\n\n/**\n * Get detailed requirements for next unlock\n */\nfunction getNextUnlockInfo(\n  stats: UserStats,\n  currentLevel: UserLevel,\n  nextLevel: UserLevel | null\n): {\n  feature: string | null;\n  progress: number;\n  requirements: string[];\n  timeEstimate: string | null;\n} {\n  if (!nextLevel) {\n    return {\n      feature: null,\n      progress: 100,\n      requirements: [],\n      timeEstimate: null\n    };\n  }\n\n  const daysSinceJoined = differenceInDays(new Date(), stats.createdAt);\n\n  switch (nextLevel) {\n    case 'reactor': {\n      const requirements = [\n        { met: daysSinceJoined >= 3, description: `Wait ${Math.max(0, 3 - daysSinceJoined)} more days` },\n        { met: stats.profileCompleteness >= 60, description: `Complete profile (${stats.profileCompleteness}% done)` },\n        { met: stats.spaceMemberships >= 2, description: `Join ${Math.max(0, 2 - stats.spaceMemberships)} more spaces` },\n        { met: stats.totalDwellTime >= 600, description: `Spend ${Math.max(0, 10 - Math.floor(stats.totalDwellTime / 60))} more minutes reading` }\n      ];\n\n      const progress = (requirements.filter(r => r.met).length / requirements.length) * 100;\n      const unmetRequirements = requirements.filter(r => !r.met).map(r => r.description);\n\n      return {\n        feature: 'Reactions & Likes',\n        progress,\n        requirements: unmetRequirements,\n        timeEstimate: estimateTimeToUnlock(requirements, daysSinceJoined, 3)\n      };\n    }\n\n    case 'commenter': {\n      const requirements = [\n        { met: daysSinceJoined >= 7, description: `Wait ${Math.max(0, 7 - daysSinceJoined)} more days` },\n        { met: stats.totalLikes >= 30, description: `Give ${Math.max(0, 30 - stats.totalLikes)} more likes` },\n        { met: stats.profileCompleteness >= 80, description: `Complete profile (${stats.profileCompleteness}% done)` },\n        { met: stats.following >= 5, description: `Follow ${Math.max(0, 5 - stats.following)} more people` }\n      ];\n\n      const progress = (requirements.filter(r => r.met).length / requirements.length) * 100;\n      const unmetRequirements = requirements.filter(r => !r.met).map(r => r.description);\n\n      return {\n        feature: 'Commenting',\n        progress,\n        requirements: unmetRequirements,\n        timeEstimate: estimateTimeToUnlock(requirements, daysSinceJoined, 7)\n      };\n    }\n\n    case 'poster': {\n      const requirements = [\n        { met: daysSinceJoined >= 14, description: `Wait ${Math.max(0, 14 - daysSinceJoined)} more days` },\n        { met: stats.totalComments >= 10, description: `Write ${Math.max(0, 10 - stats.totalComments)} more comments` },\n        { met: stats.profileCompleteness >= 100, description: `Complete profile (${stats.profileCompleteness}% done)` },\n        { met: stats.mutualFollows >= 1, description: 'Get someone to follow you back' }\n      ];\n\n      const progress = (requirements.filter(r => r.met).length / requirements.length) * 100;\n      const unmetRequirements = requirements.filter(r => !r.met).map(r => r.description);\n\n      return {\n        feature: 'Posting',\n        progress,\n        requirements: unmetRequirements,\n        timeEstimate: estimateTimeToUnlock(requirements, daysSinceJoined, 14)\n      };\n    }\n\n    case 'creator': {\n      const requirements = [\n        { met: daysSinceJoined >= 30, description: `Wait ${Math.max(0, 30 - daysSinceJoined)} more days` },\n        { met: stats.totalPosts >= 5, description: `Create ${Math.max(0, 5 - stats.totalPosts)} more posts` },\n        { met: stats.flaggedContent === 0, description: 'Maintain clean record' },\n        { met: stats.followers >= 10, description: `Gain ${Math.max(0, 10 - stats.followers)} more followers` }\n      ];\n\n      const progress = (requirements.filter(r => r.met).length / requirements.length) * 100;\n      const unmetRequirements = requirements.filter(r => !r.met).map(r => r.description);\n\n      return {\n        feature: 'Media, Events & Tools',\n        progress,\n        requirements: unmetRequirements,\n        timeEstimate: estimateTimeToUnlock(requirements, daysSinceJoined, 30)\n      };\n    }\n\n    default:\n      return {\n        feature: null,\n        progress: 0,\n        requirements: [],\n        timeEstimate: null\n      };\n  }\n}\n\n/**\n * Estimate time until unlock\n */\nfunction estimateTimeToUnlock(\n  requirements: { met: boolean; description: string }[],\n  currentDays: number,\n  requiredDays: number\n): string | null {\n  if (requirements.every(r => r.met)) {\n    return 'Ready to unlock!';\n  }\n\n  const daysRemaining = Math.max(0, requiredDays - currentDays);\n\n  if (daysRemaining > 0) {\n    if (daysRemaining === 1) return 'Tomorrow';\n    if (daysRemaining < 7) return `${daysRemaining} days`;\n    if (daysRemaining < 14) return '1 week';\n    if (daysRemaining < 30) return `${Math.ceil(daysRemaining / 7)} weeks`;\n    return `${Math.ceil(daysRemaining / 30)} months`;\n  }\n\n  // If time requirement is met, estimate based on other requirements\n  const unmetCount = requirements.filter(r => !r.met).length;\n  if (unmetCount === 1) return 'Almost there!';\n\n  return 'Keep engaging!';\n}\n\n/**\n * Check if user should see a phantom engagement\n */\nexport function shouldShowPhantomEngagement(stats: UserStats): {\n  show: boolean;\n  type: 'profile_view' | 'like' | 'follow' | null;\n} {\n  const hoursSinceJoined = differenceInHours(new Date(), stats.createdAt);\n  const level = calculateUserLevel(stats);\n\n  // New users get phantom profile views\n  if (hoursSinceJoined < 24 && Math.random() < 0.3) {\n    return { show: true, type: 'profile_view' };\n  }\n\n  // First comment gets phantom like\n  if (stats.totalComments === 1 && Math.random() < 0.8) {\n    return { show: true, type: 'like' };\n  }\n\n  // Struggling users get phantom follow\n  if (level === 'lurker' && hoursSinceJoined > 48 && stats.followers === 0 && Math.random() < 0.5) {\n    return { show: true, type: 'follow' };\n  }\n\n  return { show: false, type: null };\n}\n\n/**\n * Generate celebration message for unlock\n */\nexport function getUnlockCelebration(feature: string): {\n  title: string;\n  message: string;\n  icon: string;\n  cta: string;\n} {\n  const celebrations: Record<string, any> = {\n    'Reactions & Likes': {\n      title: 'üéâ Reactions Unlocked!',\n      message: 'You can now like and react to posts. Your voice is getting stronger!',\n      icon: '‚ù§Ô∏è',\n      cta: 'React to a Post'\n    },\n    'Commenting': {\n      title: 'üí¨ Comments Unlocked!',\n      message: 'You can now comment and join conversations. Make your voice heard!',\n      icon: 'üí¨',\n      cta: 'Write Your First Comment'\n    },\n    'Posting': {\n      title: 'üöÄ You Can Post Now!',\n      message: 'After earning your voice, you can finally create posts. Make it count!',\n      icon: '‚ú®',\n      cta: 'Create Your First Post'\n    },\n    'Media, Events & Tools': {\n      title: 'üé® Creator Mode Activated!',\n      message: 'Upload images, create events, and build tools. You\\'re now a HIVE creator!',\n      icon: 'üé®',\n      cta: 'Explore Creator Tools'\n    }\n  };\n\n  return celebrations[feature] || {\n    title: 'New Feature Unlocked!',\n    message: 'You\\'ve earned access to new capabilities.',\n    icon: 'üéâ',\n    cta: 'Explore'\n  };\n}\n\n/**\n * Track feature unlock for analytics\n */\nexport function trackUnlock(\n  userId: string,\n  feature: string,\n  level: UserLevel,\n  stats: UserStats\n): void {\n  // This would send to your analytics service\n  // Removed analytics tracking\n}\n\n/**\n * Calculate overall engagement score (0-100)\n */\nfunction calculateEngagementScore(stats: UserStats): number {\n  const weights = {\n    profileCompleteness: 0.2,\n    socialActivity: 0.3,\n    contentCreation: 0.3,\n    consistency: 0.2\n  };\n\n  const scores = {\n    profileCompleteness: stats.profileCompleteness,\n    socialActivity: Math.min(100, (stats.totalLikes + stats.followers * 2 + stats.following) / 2),\n    contentCreation: Math.min(100, (stats.totalComments * 5 + stats.totalPosts * 10)),\n    consistency: Math.min(100, stats.consecutiveDays * 10)\n  };\n\n  return Object.keys(weights).reduce((total, key) => {\n    const k = key as keyof typeof weights;\n    return total + (scores[k] * weights[k]);\n  }, 0);\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feature-reveal-system.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'featureId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":487,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":487,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'university' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":488,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":488,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'delayMinutes' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":489,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":489,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { dbAdmin } from '@/lib/firebase-admin';\n\n/**\n * Feature Reveal System\n * \n * Philosophy: Features should feel like gifts earned through community participation,\n * not arbitrary unlocks. Each reveal should feel like a natural evolution of the\n * platform that the community has \"unlocked\" together.\n */\n\n// Feature definition\nexport interface Feature {\n  id: string;\n  name: string;\n  description: string;\n  category: 'communication' | 'creation' | 'community' | 'personalization' | 'moderation' | 'analytics';\n  \n  // Technical details\n  component?: string;           // React component to enable\n  apiEndpoint?: string;         // API endpoint to activate\n  permission?: string;          // Permission to grant\n  configFlag?: string;          // Configuration flag to set\n  \n  // Revelation details\n  unlockAnimation?: string;     // Animation for the reveal moment\n  tutorialUrl?: string;         // Onboarding for the new feature\n  announcementText?: string;    // Campus-wide announcement text\n  \n  // Dependencies\n  dependsOn: string[];          // Other features this requires\n  enablesFeatures: string[];    // Features this enables\n  \n  // Metadata\n  isReversible: boolean;        // Can be locked again\n  tier: 'basic' | 'advanced' | 'premium' | 'experimental';\n  estimatedUsage: number;       // Expected usage percentage (0-100)\n  \n  createdAt: Date;\n  version: string;\n}\n\n// Feature unlock record\nexport interface FeatureUnlockRecord {\n  id: string;\n  featureId: string;\n  scope: 'user' | 'space' | 'campus' | 'platform';\n  targetId: string;             // User ID, space ID, university ID, or 'global'\n  \n  // Unlock context\n  unlockedBy: 'ritual' | 'admin' | 'achievement' | 'purchase' | 'beta';\n  sourceId?: string;            // Ritual ID, achievement ID, etc.\n  \n  // Status\n  status: 'pending' | 'active' | 'revoked' | 'expired';\n  unlockedAt: Date;\n  expiresAt?: Date;\n  revokedAt?: Date;\n  revokedReason?: string;\n  \n  // Analytics\n  usageCount: number;\n  firstUsedAt?: Date;\n  lastUsedAt?: Date;\n  \n  // Metadata\n  unlockMetadata: Record<string, any>;\n}\n\n// Campus feature state\nexport interface CampusFeatureState {\n  university: string;\n  featureId: string;\n  \n  // Unlock progress\n  unlockProgress: number;       // 0-100 percentage\n  participantsNeeded: number;\n  participantsCurrent: number;\n  \n  // Status\n  isUnlocked: boolean;\n  unlockedAt?: Date;\n  \n  // Community impact\n  adoptionRate: number;         // % of eligible users using feature\n  satisfactionScore: number;    // User feedback score (0-100)\n  \n  // Unlock conditions\n  ritualId?: string;            // Which ritual unlocks this\n  thresholdType: 'participation' | 'completion' | 'time' | 'custom';\n  threshold: number;\n  \n  updatedAt: Date;\n}\n\n/**\n * Feature Reveal System Manager\n */\nexport class FeatureRevealSystem {\n  \n  /**\n   * Register a new feature in the system\n   */\n  async registerFeature(feature: Omit<Feature, 'id' | 'createdAt'>): Promise<string> {\n    const featureDoc = {\n      ...feature,\n      createdAt: new Date(),\n      version: '1.0.0'\n    };\n    \n    const docRef = await dbAdmin.collection('features').add(featureDoc);\n    \n    return docRef.id;\n  }\n  \n  /**\n   * Check and trigger feature unlocks for a ritual milestone\n   */\n  async checkRitualFeatureUnlocks(\n    ritualId: string, \n    university: string, \n    participationData: {\n      totalParticipants: number;\n      totalEligible: number;\n      participationRate: number;\n    }\n  ): Promise<string[]> {\n    const unlockedFeatures: string[] = [];\n    \n    try {\n      // Get ritual's feature unlocks\n      const ritualDoc = await dbAdmin.collection('rituals').doc(ritualId).get();\n      if (!ritualDoc.exists) return unlockedFeatures;\n      \n      const ritual = ritualDoc.data()!;\n      const featureUnlocks = ritual.featureUnlocks || [];\n      \n      for (const unlock of featureUnlocks) {\n        const shouldUnlock = this.shouldUnlockFeature(unlock, participationData);\n        \n        if (shouldUnlock) {\n          const unlocked = await this.unlockFeature(\n            unlock.featureId,\n            unlock.scope,\n            unlock.scope === 'campus' ? university : 'global',\n            {\n              unlockedBy: 'ritual',\n              sourceId: ritualId,\n              participationRate: participationData.participationRate,\n              milestone: unlock.name\n            }\n          );\n          \n          if (unlocked) {\n            unlockedFeatures.push(unlock.featureId);\n            \n            // Schedule reveal announcement\n            await this.scheduleFeatureReveal(\n              unlock.featureId, \n              university, \n              unlock.announceDelay || 0\n            );\n          }\n        }\n      }\n      \n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n    \n    return unlockedFeatures;\n  }\n  \n  /**\n   * Unlock a feature for a specific scope\n   */\n  async unlockFeature(\n    featureId: string,\n    scope: 'user' | 'space' | 'campus' | 'platform',\n    targetId: string,\n    metadata: {\n      unlockedBy: 'ritual' | 'admin' | 'achievement' | 'purchase' | 'beta';\n      sourceId?: string;\n      [key: string]: any;\n    }\n  ): Promise<boolean> {\n    try {\n      // Check if already unlocked\n      const existingUnlock = await this.getFeatureUnlock(featureId, scope, targetId);\n      if (existingUnlock && existingUnlock.status === 'active') {\n        return false; // Already unlocked\n      }\n      \n      // Get feature details\n      const feature = await this.getFeature(featureId);\n      if (!feature) {\n        return false;\n      }\n      \n      // Check dependencies\n      const dependenciesMet = await this.checkFeatureDependencies(\n        feature.dependsOn, \n        scope, \n        targetId\n      );\n      \n      if (!dependenciesMet) {\n        return false;\n      }\n      \n      // Create unlock record\n      const unlockRecord: Omit<FeatureUnlockRecord, 'id'> = {\n        featureId,\n        scope,\n        targetId,\n        unlockedBy: metadata.unlockedBy,\n        sourceId: metadata.sourceId,\n        status: 'active',\n        unlockedAt: new Date(),\n        usageCount: 0,\n        unlockMetadata: metadata\n      };\n      \n      await dbAdmin.collection('feature_unlocks').add(unlockRecord);\n      \n      // Update campus feature state if campus-scoped\n      if (scope === 'campus') {\n        await this.updateCampusFeatureState(featureId, targetId, {\n          isUnlocked: true,\n          unlockedAt: new Date()\n        });\n      }\n      \n      // Trigger dependent features\n      await this.checkDependentFeatures(featureId, scope, targetId);\n      \n      return true;\n      \n    } catch (error) {\n      return false;\n    }\n  }\n  \n  /**\n   * Check if user/space/campus has access to a feature\n   */\n  async hasFeatureAccess(\n    featureId: string,\n    userId: string,\n    spaceId?: string,\n    university?: string\n  ): Promise<boolean> {\n    try {\n      // Check in order of specificity: user -> space -> campus -> platform\n      \n      // User-specific unlock\n      const userUnlock = await this.getFeatureUnlock(featureId, 'user', userId);\n      if (userUnlock && userUnlock.status === 'active') return true;\n      \n      // Space-specific unlock\n      if (spaceId) {\n        const spaceUnlock = await this.getFeatureUnlock(featureId, 'space', spaceId);\n        if (spaceUnlock && spaceUnlock.status === 'active') return true;\n      }\n      \n      // Campus-wide unlock\n      if (university) {\n        const campusUnlock = await this.getFeatureUnlock(featureId, 'campus', university);\n        if (campusUnlock && campusUnlock.status === 'active') return true;\n      }\n      \n      // Platform-wide unlock\n      const platformUnlock = await this.getFeatureUnlock(featureId, 'platform', 'global');\n      if (platformUnlock && platformUnlock.status === 'active') return true;\n      \n      return false;\n      \n    } catch (error) {\n      return false;\n    }\n  }\n  \n  /**\n   * Record feature usage for analytics\n   */\n  async recordFeatureUsage(\n    featureId: string,\n    userId: string,\n    context: {\n      action: string;\n      metadata?: Record<string, any>;\n    }\n  ): Promise<void> {\n    try {\n      // Find the unlock record\n      const unlockRecord = await this.getUserFeatureUnlock(featureId, userId);\n      if (!unlockRecord) return;\n      \n      // Update usage statistics\n      await dbAdmin.collection('feature_unlocks').doc(unlockRecord.id).update({\n        usageCount: unlockRecord.usageCount + 1,\n        lastUsedAt: new Date(),\n        firstUsedAt: unlockRecord.firstUsedAt || new Date()\n      });\n      \n      // Log usage event for analytics\n      await dbAdmin.collection('feature_usage_log').add({\n        featureId,\n        userId,\n        action: context.action,\n        metadata: context.metadata || {},\n        timestamp: new Date()\n      });\n      \n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n  }\n  \n  /**\n   * Get feature unlock progress for a campus\n   */\n  async getCampusFeatureProgress(\n    university: string,\n    featureId?: string\n  ): Promise<CampusFeatureState[]> {\n    try {\n      let query = dbAdmin.collection('campus_feature_states')\n        .where('university', '==', university);\n      \n      if (featureId) {\n        query = query.where('featureId', '==', featureId);\n      }\n      \n      const snapshot = await query.get();\n      \n      return snapshot.docs.map(doc => ({\n        ...doc.data(),\n        unlockedAt: doc.data().unlockedAt?.toDate(),\n        updatedAt: doc.data().updatedAt?.toDate()\n      })) as CampusFeatureState[];\n      \n    } catch (error) {\n      return [];\n    }\n  }\n  \n  /**\n   * Get all features unlocked for a user\n   */\n  async getUserUnlockedFeatures(userId: string, university?: string): Promise<Feature[]> {\n    try {\n      const features: Feature[] = [];\n      \n      // Get all feature unlock records for this user context\n      const unlocks = await dbAdmin.collection('feature_unlocks')\n        .where('status', '==', 'active')\n        .get();\n      \n      const relevantUnlocks = unlocks.docs.filter(doc => {\n        const data = doc.data();\n        return (\n          (data.scope === 'user' && data.targetId === userId) ||\n          (data.scope === 'campus' && data.targetId === university) ||\n          (data.scope === 'platform' && data.targetId === 'global')\n        );\n      });\n      \n      // Get feature details for each unlock\n      for (const unlockDoc of relevantUnlocks) {\n        const feature = await this.getFeature(unlockDoc.data().featureId);\n        if (feature) {\n          features.push(feature);\n        }\n      }\n      \n      return features;\n      \n    } catch (error) {\n      return [];\n    }\n  }\n  \n  /**\n   * Private helper methods\n   */\n  \n  private async getFeature(featureId: string): Promise<Feature | null> {\n    try {\n      const doc = await dbAdmin.collection('features').doc(featureId).get();\n      if (!doc.exists) return null;\n      \n      return {\n        id: doc.id,\n        ...doc.data(),\n        createdAt: doc.data()!.createdAt?.toDate() || new Date()\n      } as Feature;\n    } catch (error) {\n      return null;\n    }\n  }\n  \n  private async getFeatureUnlock(\n    featureId: string,\n    scope: string,\n    targetId: string\n  ): Promise<FeatureUnlockRecord | null> {\n    try {\n      const snapshot = await dbAdmin.collection('feature_unlocks')\n        .where('featureId', '==', featureId)\n        .where('scope', '==', scope)\n        .where('targetId', '==', targetId)\n        .where('status', '==', 'active')\n        .limit(1)\n        .get();\n      \n      if (snapshot.empty) return null;\n      \n      const doc = snapshot.docs[0];\n      return {\n        id: doc.id,\n        ...doc.data(),\n        unlockedAt: doc.data().unlockedAt?.toDate() || new Date(),\n        expiresAt: doc.data().expiresAt?.toDate(),\n        revokedAt: doc.data().revokedAt?.toDate(),\n        firstUsedAt: doc.data().firstUsedAt?.toDate(),\n        lastUsedAt: doc.data().lastUsedAt?.toDate()\n      } as FeatureUnlockRecord;\n    } catch (error) {\n      return null;\n    }\n  }\n  \n  private async getUserFeatureUnlock(\n    featureId: string,\n    userId: string\n  ): Promise<FeatureUnlockRecord | null> {\n    // Check user-specific unlock first, then broader scopes\n    const userUnlock = await this.getFeatureUnlock(featureId, 'user', userId);\n    if (userUnlock) return userUnlock;\n    \n    // TODO: Check space and campus unlocks for this user\n    return null;\n  }\n  \n  private shouldUnlockFeature(\n    unlock: any,\n    participationData: { participationRate: number; totalParticipants: number }\n  ): boolean {\n    return participationData.participationRate >= unlock.participationThreshold;\n  }\n  \n  private async checkFeatureDependencies(\n    dependencies: string[],\n    scope: string,\n    targetId: string\n  ): Promise<boolean> {\n    for (const depId of dependencies) {\n      const hasAccess = await this.getFeatureUnlock(depId, scope, targetId);\n      if (!hasAccess || hasAccess.status !== 'active') {\n        return false;\n      }\n    }\n    return true;\n  }\n  \n  private async checkDependentFeatures(\n    _featureId: string,\n    _scope: string,\n    _targetId: string\n  ): Promise<void> {\n    // TODO: Check if unlocking this feature enables other features\n  }\n  \n  private async updateCampusFeatureState(\n    featureId: string,\n    university: string,\n    updates: Partial<CampusFeatureState>\n  ): Promise<void> {\n    const docId = `${university}_${featureId}`;\n    await dbAdmin.collection('campus_feature_states').doc(docId).update({\n      ...updates,\n      updatedAt: new Date()\n    });\n  }\n  \n  private async scheduleFeatureReveal(\n    featureId: string,\n    university: string,\n    delayMinutes: number\n  ): Promise<void> {\n    // TODO: Schedule campus-wide announcement\n  }\n}\n\n/**\n * Pre-defined features that can be unlocked through rituals\n */\nexport const coreFeatures: Omit<Feature, 'id' | 'createdAt'>[] = [\n  {\n    name: 'Rich Text Posting',\n    description: 'Advanced formatting, mentions, and media in posts',\n    category: 'communication',\n    component: 'RichTextEditor',\n    configFlag: 'rich_text_enabled',\n    unlockAnimation: 'text_enhancement',\n    tutorialUrl: '/tutorials/rich-text',\n    announcementText: 'Your campus has unlocked rich text posting! Express yourself with style. ‚ú®',\n    dependsOn: [],\n    enablesFeatures: ['advanced_mentions', 'media_embeds'],\n    isReversible: false,\n    tier: 'basic',\n    estimatedUsage: 85,\n    version: '1.0.0'\n  },\n  {\n    name: 'Custom Space Themes',\n    description: 'Personalize your spaces with custom colors and layouts',\n    category: 'personalization',\n    component: 'SpaceThemeEditor',\n    permission: 'customize_space',\n    unlockAnimation: 'theme_reveal',\n    announcementText: 'Spaces can now be customized! Make your community visually unique. üé®',\n    dependsOn: ['rich_text_posting'],\n    enablesFeatures: ['advanced_layouts'],\n    isReversible: false,\n    tier: 'advanced',\n    estimatedUsage: 45,\n    version: '1.0.0'\n  },\n  {\n    name: 'Tool Marketplace',\n    description: 'Browse, fork, and share tools created by your campus community',\n    category: 'creation',\n    component: 'ToolMarketplace',\n    apiEndpoint: '/api/tools/marketplace',\n    unlockAnimation: 'marketplace_open',\n    tutorialUrl: '/tutorials/tool-marketplace',\n    announcementText: 'The Tool Marketplace is now open! Discover amazing tools built by your peers. üõ†Ô∏è',\n    dependsOn: [],\n    enablesFeatures: ['tool_ratings', 'tool_analytics'],\n    isReversible: false,\n    tier: 'advanced',\n    estimatedUsage: 60,\n    version: '1.0.0'\n  },\n  {\n    name: 'Real-time Chat',\n    description: 'Live messaging within spaces for immediate conversations',\n    category: 'communication',\n    component: 'RealtimeChat',\n    apiEndpoint: '/api/chat/websocket',\n    unlockAnimation: 'chat_activation',\n    announcementText: 'Real-time chat is live! Connect instantly with your space members. üí¨',\n    dependsOn: ['rich_text_posting'],\n    enablesFeatures: ['voice_messages', 'file_sharing'],\n    isReversible: true,\n    tier: 'premium',\n    estimatedUsage: 70,\n    version: '1.0.0'\n  },\n  {\n    name: 'Advanced Analytics',\n    description: 'Detailed insights into space engagement and user behavior',\n    category: 'analytics',\n    component: 'AnalyticsDashboard',\n    permission: 'view_analytics',\n    unlockAnimation: 'data_visualization',\n    announcementText: 'Advanced analytics unlocked! Understand your community better. üìä',\n    dependsOn: ['tool_marketplace'],\n    enablesFeatures: ['export_data', 'custom_reports'],\n    isReversible: false,\n    tier: 'premium',\n    estimatedUsage: 25,\n    version: '1.0.0'\n  }\n];\n\n/**\n * Global feature reveal system instance\n */\nexport const featureRevealSystem = new FeatureRevealSystem();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feed-actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'limit' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":272,"column":73,"nodeType":null,"messageId":"unusedVar","endLine":272,"endColumn":78}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Feed Actions - Real implementations for post interactions\n * Replaces stub functions with working Firebase operations\n */\n\nimport {\n  collection,\n  doc,\n  addDoc,\n  updateDoc,\n  arrayUnion,\n  arrayRemove,\n  serverTimestamp,\n  increment,\n  getDoc,\n  query,\n  orderBy,\n  getDocs\n} from 'firebase/firestore';\nimport { db } from './firebase';\n\ninterface PostData {\n  content: string;\n  type: string;\n  visibility: string;\n  attachments: any[];\n  mentions: string[];\n  tags: string[];\n  poll?: any;\n  event?: any;\n  location?: any;\n}\n\n/**\n * Create a new post in the feed\n */\nexport async function createPost(userId: string, spaceId: string | null, postData: PostData) {\n  if (!userId) throw new Error('User must be authenticated to create posts');\n\n  try {\n    // Determine the collection based on whether it's a space post or general feed\n    const postsRef = spaceId\n      ? collection(db, 'spaces', spaceId, 'posts')\n      : collection(db, 'posts');\n\n    const newPost = {\n      ...postData,\n      authorId: userId,\n      spaceId: spaceId || null,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp(),\n      likeCount: 0,\n      commentCount: 0,\n      shareCount: 0,\n      likes: [],\n      campusId: 'ub-buffalo', // Campus isolation for vBETA\n      isActive: true,\n      isPinned: false,\n    };\n\n    const docRef = await addDoc(postsRef, newPost);\n\n    // Update user's post count\n    const userRef = doc(db, 'users', userId);\n    await updateDoc(userRef, {\n      'stats.postCount': increment(1),\n      'lastActivityAt': serverTimestamp()\n    });\n\n    // If it's a space post, update space activity\n    if (spaceId) {\n      const spaceRef = doc(db, 'spaces', spaceId);\n      await updateDoc(spaceRef, {\n        'stats.postCount': increment(1),\n        'lastActivityAt': serverTimestamp()\n      });\n    }\n\n    return { id: docRef.id, ...newPost };\n  } catch (error) {\n    console.error('Error creating post:', error);\n    throw new Error('Failed to create post. Please try again.');\n  }\n}\n\n/**\n * Like or unlike a post\n */\nexport async function toggleLikePost(userId: string, postId: string, spaceId?: string) {\n  if (!userId) throw new Error('User must be authenticated to like posts');\n\n  try {\n    const postRef = spaceId\n      ? doc(db, 'spaces', spaceId, 'posts', postId)\n      : doc(db, 'posts', postId);\n\n    const postSnap = await getDoc(postRef);\n    if (!postSnap.exists()) {\n      throw new Error('Post not found');\n    }\n\n    const postData = postSnap.data();\n    const likes = postData.likes || [];\n    const isLiked = likes.includes(userId);\n\n    // Toggle like status\n    await updateDoc(postRef, {\n      likes: isLiked ? arrayRemove(userId) : arrayUnion(userId),\n      likeCount: increment(isLiked ? -1 : 1),\n      updatedAt: serverTimestamp()\n    });\n\n    // Create notification for post author (if liking, not unliking)\n    if (!isLiked && postData.authorId !== userId) {\n      await addDoc(collection(db, 'notifications'), {\n        type: 'like',\n        recipientId: postData.authorId,\n        senderId: userId,\n        postId: postId,\n        spaceId: spaceId || null,\n        message: 'liked your post',\n        read: false,\n        createdAt: serverTimestamp(),\n        campusId: 'ub-buffalo'\n      });\n    }\n\n    return !isLiked; // Return new like status\n  } catch (error) {\n    console.error('Error toggling like:', error);\n    throw new Error('Failed to update like status. Please try again.');\n  }\n}\n\n/**\n * Add a comment to a post\n */\nexport async function addComment(userId: string, postId: string, content: string, spaceId?: string) {\n  if (!userId) throw new Error('User must be authenticated to comment');\n  if (!content.trim()) throw new Error('Comment cannot be empty');\n\n  try {\n    // Get post reference\n    const postRef = spaceId\n      ? doc(db, 'spaces', spaceId, 'posts', postId)\n      : doc(db, 'posts', postId);\n\n    const postSnap = await getDoc(postRef);\n    if (!postSnap.exists()) {\n      throw new Error('Post not found');\n    }\n\n    // Create comment in subcollection\n    const commentsRef = collection(postRef, 'comments');\n    const newComment = {\n      content: content.trim(),\n      authorId: userId,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp(),\n      likeCount: 0,\n      likes: [],\n      campusId: 'ub-buffalo'\n    };\n\n    const commentDoc = await addDoc(commentsRef, newComment);\n\n    // Update post comment count\n    await updateDoc(postRef, {\n      commentCount: increment(1),\n      lastActivityAt: serverTimestamp()\n    });\n\n    // Create notification for post author\n    const postData = postSnap.data();\n    if (postData.authorId !== userId) {\n      await addDoc(collection(db, 'notifications'), {\n        type: 'comment',\n        recipientId: postData.authorId,\n        senderId: userId,\n        postId: postId,\n        commentId: commentDoc.id,\n        spaceId: spaceId || null,\n        message: 'commented on your post',\n        preview: content.substring(0, 100),\n        read: false,\n        createdAt: serverTimestamp(),\n        campusId: 'ub-buffalo'\n      });\n    }\n\n    return { id: commentDoc.id, ...newComment };\n  } catch (error) {\n    console.error('Error adding comment:', error);\n    throw new Error('Failed to add comment. Please try again.');\n  }\n}\n\n/**\n * Share a post (repost functionality)\n */\nexport async function sharePost(userId: string, postId: string, spaceId?: string, message?: string) {\n  if (!userId) throw new Error('User must be authenticated to share posts');\n\n  try {\n    // Get original post\n    const postRef = spaceId\n      ? doc(db, 'spaces', spaceId, 'posts', postId)\n      : doc(db, 'posts', postId);\n\n    const postSnap = await getDoc(postRef);\n    if (!postSnap.exists()) {\n      throw new Error('Post not found');\n    }\n\n    const originalPost = postSnap.data();\n\n    // Create share/repost\n    const shareData = {\n      type: 'share',\n      originalPostId: postId,\n      originalAuthorId: originalPost.authorId,\n      authorId: userId,\n      content: message || '',\n      sharedContent: {\n        content: originalPost.content,\n        attachments: originalPost.attachments || [],\n        type: originalPost.type\n      },\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp(),\n      likeCount: 0,\n      commentCount: 0,\n      shareCount: 0,\n      likes: [],\n      campusId: 'ub-buffalo',\n      isActive: true\n    };\n\n    const shareRef = await addDoc(collection(db, 'posts'), shareData);\n\n    // Update original post share count\n    await updateDoc(postRef, {\n      shareCount: increment(1)\n    });\n\n    // Notify original author\n    if (originalPost.authorId !== userId) {\n      await addDoc(collection(db, 'notifications'), {\n        type: 'share',\n        recipientId: originalPost.authorId,\n        senderId: userId,\n        postId: postId,\n        shareId: shareRef.id,\n        message: 'shared your post',\n        preview: message?.substring(0, 100) || null,\n        read: false,\n        createdAt: serverTimestamp(),\n        campusId: 'ub-buffalo'\n      });\n    }\n\n    return { id: shareRef.id, ...shareData };\n  } catch (error) {\n    console.error('Error sharing post:', error);\n    throw new Error('Failed to share post. Please try again.');\n  }\n}\n\n/**\n * Get comments for a post\n */\nexport async function getPostComments(postId: string, spaceId?: string, limit = 20) {\n  try {\n    const postRef = spaceId\n      ? doc(db, 'spaces', spaceId, 'posts', postId)\n      : doc(db, 'posts', postId);\n\n    const commentsQuery = query(\n      collection(postRef, 'comments'),\n      orderBy('createdAt', 'desc')\n    );\n\n    const snapshot = await getDocs(commentsQuery);\n    return snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n  } catch (error) {\n    console.error('Error fetching comments:', error);\n    throw new Error('Failed to load comments');\n  }\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feed-aggregation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feed-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/feed-session-tracker.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'type' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":98,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Feed Session Tracker\n * Production-quality session tracking for behavioral metrics\n * Replaces Math.random() with real user session data\n */\n\nimport { logger } from './logger';\n\ninterface SessionMetrics {\n  sessionId: string;\n  userId: string;\n  startTime: number;\n  currentTime: number;\n  scrollDepth: number;\n  engagementCount: number;\n  lastEngagementTime: number;\n  completionStage: number; // 0-1 based on actual user progress\n  hasReachedMilestone: boolean;\n  feedItemsViewed: Set<string>;\n  feedItemsEngaged: Set<string>;\n}\n\nclass FeedSessionTracker {\n  private sessions: Map<string, SessionMetrics> = new Map();\n  private readonly MILESTONE_THRESHOLD = 0.7; // 70% completion target\n\n  /**\n   * Start or get existing session for user\n   */\n  getSession(userId: string, sessionId?: string): SessionMetrics {\n    const id = sessionId || `${userId}_${Date.now()}`;\n\n    if (!this.sessions.has(id)) {\n      this.sessions.set(id, {\n        sessionId: id,\n        userId,\n        startTime: Date.now(),\n        currentTime: Date.now(),\n        scrollDepth: 0,\n        engagementCount: 0,\n        lastEngagementTime: Date.now(),\n        completionStage: 0,\n        hasReachedMilestone: false,\n        feedItemsViewed: new Set(),\n        feedItemsEngaged: new Set()\n      });\n\n      logger.info('New feed session started', { userId, sessionId: id });\n    }\n\n    return this.sessions.get(id)!;\n  }\n\n  /**\n   * Update session metrics\n   */\n  updateSession(sessionId: string, updates: Partial<SessionMetrics>): SessionMetrics {\n    const session = this.sessions.get(sessionId);\n    if (!session) {\n      throw new Error(`Session ${sessionId} not found`);\n    }\n\n    // Update session data\n    Object.assign(session, updates);\n    session.currentTime = Date.now();\n\n    // Calculate completion stage based on real metrics\n    session.completionStage = this.calculateCompletionStage(session);\n\n    // Check milestone achievement\n    if (!session.hasReachedMilestone && session.completionStage >= this.MILESTONE_THRESHOLD) {\n      session.hasReachedMilestone = true;\n      logger.info('User reached 70% completion milestone', {\n        userId: session.userId,\n        sessionId,\n        duration: (session.currentTime - session.startTime) / 1000,\n        engagementCount: session.engagementCount\n      });\n    }\n\n    return session;\n  }\n\n  /**\n   * Track feed item view\n   */\n  trackView(sessionId: string, feedItemId: string): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.feedItemsViewed.add(feedItemId);\n      this.updateSession(sessionId, {});\n    }\n  }\n\n  /**\n   * Track feed item engagement\n   */\n  trackEngagement(sessionId: string, feedItemId: string, type: 'like' | 'comment' | 'share'): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.feedItemsEngaged.add(feedItemId);\n      session.engagementCount++;\n      session.lastEngagementTime = Date.now();\n      this.updateSession(sessionId, { engagementCount: session.engagementCount });\n    }\n  }\n\n  /**\n   * Calculate actual completion stage based on user behavior\n   * Not random - based on real engagement metrics\n   */\n  private calculateCompletionStage(session: SessionMetrics): number {\n    const sessionDuration = (session.currentTime - session.startTime) / 1000; // seconds\n    const viewEngagementRatio = session.feedItemsEngaged.size / Math.max(1, session.feedItemsViewed.size);\n\n    // Weight different factors\n    const timeWeight = Math.min(1, sessionDuration / 300); // 5 minutes = full weight\n    const scrollWeight = session.scrollDepth / 100;\n    const engagementWeight = Math.min(1, session.engagementCount / 10); // 10 engagements = full weight\n    const ratioWeight = viewEngagementRatio;\n\n    // Calculate weighted completion stage\n    const completionStage = (\n      timeWeight * 0.2 +\n      scrollWeight * 0.3 +\n      engagementWeight * 0.3 +\n      ratioWeight * 0.2\n    );\n\n    return Math.min(1, completionStage);\n  }\n\n  /**\n   * Get variability factor based on user's session pattern\n   * Not random - based on engagement velocity\n   */\n  getVariabilityFactor(session: SessionMetrics): number {\n    const recentEngagement = Date.now() - session.lastEngagementTime < 30000; // Active in last 30s\n    const engagementVelocity = session.engagementCount / Math.max(1, (session.currentTime - session.startTime) / 60000);\n\n    // Higher variability for highly engaged users\n    if (recentEngagement && engagementVelocity > 2) {\n      return 0.15 + (engagementVelocity / 20); // 0.15-0.2 range\n    } else if (engagementVelocity > 1) {\n      return 0.1 + (engagementVelocity / 30); // 0.1-0.15 range\n    }\n\n    return 0.05; // Low variability for passive viewers\n  }\n\n  /**\n   * Determine reward probability based on actual session progress\n   * Not random - deterministic based on user behavior\n   */\n  getRewardProbability(session: SessionMetrics): number {\n    const stage = session.completionStage;\n\n    // Before 70%: High probability to maintain engagement\n    if (stage < 0.7) {\n      return 0.8 - (stage * 0.2); // 0.8 to 0.66 as they progress\n    }\n\n    // At 70%: Guaranteed reward\n    if (stage >= 0.69 && stage <= 0.71) {\n      return 1.0;\n    }\n\n    // After 70%: Lower probability\n    return 0.4 - ((stage - 0.7) * 0.3); // Decreases from 0.4\n  }\n\n  /**\n   * Clean up old sessions (call periodically)\n   */\n  cleanupSessions(maxAgeMs: number = 3600000): void {\n    const now = Date.now();\n    const toDelete: string[] = [];\n\n    this.sessions.forEach((session, id) => {\n      if (now - session.currentTime > maxAgeMs) {\n        toDelete.push(id);\n      }\n    });\n\n    toDelete.forEach(id => {\n      const session = this.sessions.get(id);\n      if (session) {\n        logger.info('Cleaning up old session', {\n          sessionId: id,\n          userId: session.userId,\n          duration: (session.currentTime - session.startTime) / 1000,\n          completionStage: session.completionStage,\n          engagementCount: session.engagementCount\n        });\n      }\n      this.sessions.delete(id);\n    });\n  }\n\n  /**\n   * Export session metrics for analytics\n   */\n  exportMetrics(sessionId: string): SessionMetrics | null {\n    return this.sessions.get(sessionId) || null;\n  }\n}\n\n// Singleton instance\nexport const feedSessionTracker = new FeedSessionTracker();\n\n// Clean up old sessions every 15 minutes\nif (typeof setInterval !== 'undefined') {\n  setInterval(() => {\n    feedSessionTracker.cleanupSessions();\n  }, 15 * 60 * 1000);\n}\n\nexport type { SessionMetrics };","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-admin.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-admin.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-admin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-auth-email.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-auth-integration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-cost-monitor.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'spaceId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":99,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":99,"endColumn":63},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'report' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":248,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":248,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\n\n/**\n * Firebase Cost Monitoring and Control System\n * Prevents HIVE from unexpected Firebase bills\n */\n\nexport interface CostMetrics {\n  readsPerMinute: number;\n  writesPerMinute: number;\n  listenersActive: number;\n  estimatedMonthlyCost: number;\n  lastReset: Date;\n}\n\nexport interface CostLimits {\n  maxListenersPerUser: number;\n  maxReadsPerUserPerMinute: number;\n  maxTotalListeners: number;\n  dailyReadLimit: number;\n  emergencyShutoffThreshold: number;\n}\n\nclass FirebaseCostMonitor {\n  private metrics: CostMetrics = {\n    readsPerMinute: 0,\n    writesPerMinute: 0,\n    listenersActive: 0,\n    estimatedMonthlyCost: 0,\n    lastReset: new Date()\n  };\n\n  private limits: CostLimits = {\n    maxListenersPerUser: 5,        // Limit each user to 5 concurrent listeners\n    maxReadsPerUserPerMinute: 50,  // Max 50 reads per user per minute\n    maxTotalListeners: 1000,       // Max 1000 total concurrent listeners\n    dailyReadLimit: 100000,        // Max 100k reads per day\n    emergencyShutoffThreshold: 500 // Emergency shutoff at $500/month estimate\n  };\n\n  private userReads = new Map<string, { count: number; lastMinute: number }>();\n  private activeListeners = new Map<string, string[]>(); // userId -> listenerIds\n  private costHistory: { timestamp: Date; cost: number }[] = [];\n\n  // Cost per operation (Firebase pricing as of 2024)\n  private readonly COST_PER_READ = 0.00000036; // $0.36 per 100k reads\n  private readonly COST_PER_WRITE = 0.00000108; // $1.08 per 100k writes\n  private readonly COST_PER_LISTENER_HOUR = 0.0001; // Estimated WebSocket cost\n\n  constructor() {\n    // Reset metrics every minute\n    setInterval(() => this.resetMinutelyMetrics(), 60000);\n\n    // Cost report every 5 minutes\n    setInterval(() => this.logCostReport(), 300000);\n\n    // Emergency monitoring every 10 seconds\n    setInterval(() => this.checkEmergencyLimits(), 10000);\n  }\n\n  /**\n   * Track a Firestore read operation\n   */\n  trackRead(userId: string, readCount: number = 1): boolean {\n    const currentMinute = Math.floor(Date.now() / 60000);\n    const userReadData = this.userReads.get(userId) || { count: 0, lastMinute: currentMinute };\n\n    // Reset if new minute\n    if (userReadData.lastMinute < currentMinute) {\n      userReadData.count = 0;\n      userReadData.lastMinute = currentMinute;\n    }\n\n    // Check user limit\n    if (userReadData.count + readCount > this.limits.maxReadsPerUserPerMinute) {\n      return false; // Deny the read\n    }\n\n    // Update metrics\n    userReadData.count += readCount;\n    this.userReads.set(userId, userReadData);\n    this.metrics.readsPerMinute += readCount;\n\n    return true;\n  }\n\n  /**\n   * Track a Firestore write operation\n   */\n  trackWrite(userId: string, writeCount: number = 1): void {\n    this.metrics.writesPerMinute += writeCount;\n  }\n\n  /**\n   * Register a new real-time listener\n   */\n  registerListener(userId: string, listenerId: string, spaceId?: string): boolean {\n    const userListeners = this.activeListeners.get(userId) || [];\n\n    // Check per-user listener limit\n    if (userListeners.length >= this.limits.maxListenersPerUser) {\n      return false;\n    }\n\n    // Check total listener limit\n    if (this.getTotalListenerCount() >= this.limits.maxTotalListeners) {\n      return false;\n    }\n\n    // Register listener\n    userListeners.push(listenerId);\n    this.activeListeners.set(userId, userListeners);\n    this.metrics.listenersActive = this.getTotalListenerCount();\n\n    return true;\n  }\n\n  /**\n   * Unregister a listener\n   */\n  unregisterListener(userId: string, listenerId: string): void {\n    const userListeners = this.activeListeners.get(userId) || [];\n    const filteredListeners = userListeners.filter(id => id !== listenerId);\n\n    if (filteredListeners.length > 0) {\n      this.activeListeners.set(userId, filteredListeners);\n    } else {\n      this.activeListeners.delete(userId);\n    }\n\n    this.metrics.listenersActive = this.getTotalListenerCount();\n  }\n\n  /**\n   * Get current cost metrics\n   */\n  getMetrics(): CostMetrics {\n    this.updateCostEstimate();\n    return { ...this.metrics };\n  }\n\n  /**\n   * Check if user can create more listeners\n   */\n  canCreateListener(userId: string): boolean {\n    const userListeners = this.activeListeners.get(userId) || [];\n    const totalListeners = this.getTotalListenerCount();\n\n    return (\n      userListeners.length < this.limits.maxListenersPerUser &&\n      totalListeners < this.limits.maxTotalListeners\n    );\n  }\n\n  /**\n   * Get user's current read quota usage\n   */\n  getUserReadUsage(userId: string): { used: number; limit: number; percentage: number } {\n    const currentMinute = Math.floor(Date.now() / 60000);\n    const userReadData = this.userReads.get(userId) || { count: 0, lastMinute: currentMinute };\n\n    // Reset if new minute\n    if (userReadData.lastMinute < currentMinute) {\n      userReadData.count = 0;\n    }\n\n    const used = userReadData.count;\n    const limit = this.limits.maxReadsPerUserPerMinute;\n    const percentage = Math.round((used / limit) * 100);\n\n    return { used, limit, percentage };\n  }\n\n  /**\n   * Emergency cost controls\n   */\n  private checkEmergencyLimits(): void {\n    this.updateCostEstimate();\n\n    // Emergency shutoff if estimated monthly cost too high\n    if (this.metrics.estimatedMonthlyCost > this.limits.emergencyShutoffThreshold) {\n      this.triggerEmergencyShutoff();\n    }\n\n    // Warn if approaching limits\n    if (this.metrics.estimatedMonthlyCost > this.limits.emergencyShutoffThreshold * 0.8) {\n      // Warning logged via monitoring system\n    }\n  }\n\n  /**\n   * Emergency shutoff - disable all real-time features\n   */\n  private triggerEmergencyShutoff(): void {\n    // Broadcast emergency event to all components\n    window.dispatchEvent(new CustomEvent('firebase-emergency-shutoff', {\n      detail: {\n        reason: 'cost_limit_exceeded',\n        currentCost: this.metrics.estimatedMonthlyCost,\n        limit: this.limits.emergencyShutoffThreshold\n      }\n    }));\n\n    // Clear all active listeners\n    this.activeListeners.clear();\n    this.metrics.listenersActive = 0;\n\n  }\n\n  /**\n   * Calculate estimated monthly cost\n   */\n  private updateCostEstimate(): void {\n    const hoursInMonth = 30 * 24;\n    const minutesInMonth = hoursInMonth * 60;\n\n    // Read costs\n    const monthlyReads = this.metrics.readsPerMinute * minutesInMonth;\n    const readCost = monthlyReads * this.COST_PER_READ;\n\n    // Write costs\n    const monthlyWrites = this.metrics.writesPerMinute * minutesInMonth;\n    const writeCost = monthlyWrites * this.COST_PER_WRITE;\n\n    // Listener costs (rough estimate)\n    const listenerCost = this.metrics.listenersActive * this.COST_PER_LISTENER_HOUR * hoursInMonth;\n\n    this.metrics.estimatedMonthlyCost = readCost + writeCost + listenerCost;\n  }\n\n  /**\n   * Reset per-minute metrics\n   */\n  private resetMinutelyMetrics(): void {\n    this.metrics.readsPerMinute = 0;\n    this.metrics.writesPerMinute = 0;\n    this.metrics.lastReset = new Date();\n  }\n\n  /**\n   * Log cost report for monitoring\n   */\n  private logCostReport(): void {\n    this.updateCostEstimate();\n\n    const report = {\n      timestamp: new Date(),\n      metrics: this.metrics,\n      activeUsers: this.activeListeners.size,\n      avgListenersPerUser: this.getTotalListenerCount() / Math.max(1, this.activeListeners.size),\n      topUsers: Array.from(this.activeListeners.entries())\n        .map(([userId, listeners]) => ({ userId, listenerCount: listeners.length }))\n        .sort((a, b) => b.listenerCount - a.listenerCount)\n        .slice(0, 5)\n    };\n\n\n    // Store for historical analysis\n    this.costHistory.push({\n      timestamp: new Date(),\n      cost: this.metrics.estimatedMonthlyCost\n    });\n\n    // Keep last 24 hours of history\n    const oneDayAgo = Date.now() - 24 * 60 * 60 * 1000;\n    this.costHistory = this.costHistory.filter(entry => entry.timestamp.getTime() > oneDayAgo);\n  }\n\n  /**\n   * Get total listener count across all users\n   */\n  private getTotalListenerCount(): number {\n    return Array.from(this.activeListeners.values())\n      .reduce((total, listeners) => total + listeners.length, 0);\n  }\n\n  /**\n   * Get cost optimization suggestions\n   */\n  getOptimizationSuggestions(): string[] {\n    const suggestions: string[] = [];\n    const metrics = this.getMetrics();\n\n    if (metrics.listenersActive > 100) {\n      suggestions.push('Consider reducing listener count during low-activity periods');\n    }\n\n    if (metrics.readsPerMinute > 1000) {\n      suggestions.push('Implement client-side caching to reduce Firestore reads');\n    }\n\n    const avgListenersPerUser = metrics.listenersActive / Math.max(1, this.activeListeners.size);\n    if (avgListenersPerUser > 3) {\n      suggestions.push('Users have too many concurrent listeners - implement listener prioritization');\n    }\n\n    if (metrics.estimatedMonthlyCost > 100) {\n      suggestions.push('Consider implementing pagination or time-based filtering');\n    }\n\n    return suggestions;\n  }\n\n  /**\n   * Update cost limits (for admin configuration)\n   */\n  updateLimits(newLimits: Partial<CostLimits>): void {\n    this.limits = { ...this.limits, ...newLimits };\n  }\n}\n\n// Global cost monitor instance\nexport const firebaseCostMonitor = new FirebaseCostMonitor();\n\n// Helper function to check if operation should proceed\nexport function shouldProceedWithFirebaseOp(userId: string, action: 'read' | 'write' | 'listen'): boolean {\n  switch (action) {\n    case 'read':\n      return firebaseCostMonitor.trackRead(userId, 1);\n    case 'listen':\n      return firebaseCostMonitor.canCreateListener(userId);\n    case 'write':\n      firebaseCostMonitor.trackWrite(userId, 1);\n      return true; // Writes are generally allowed but tracked\n    default:\n      return true;\n  }\n}\n\n// React hook for cost monitoring in components\nexport function useFirebaseCostMonitor() {\n  const [metrics, setMetrics] = React.useState<CostMetrics>(firebaseCostMonitor.getMetrics());\n\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setMetrics(firebaseCostMonitor.getMetrics());\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return {\n    metrics,\n    suggestions: firebaseCostMonitor.getOptimizationSuggestions(),\n    canCreateListener: (userId: string) => firebaseCostMonitor.canCreateListener(userId),\n    getUserReadUsage: (userId: string) => firebaseCostMonitor.getUserReadUsage(userId)\n  };\n}\n\nexport default firebaseCostMonitor;\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-optimized.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FirebaseStorage' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Optimized Firebase imports to reduce bundle size\n * Only import what we actually use\n */\n\n// Core Firebase - minimal imports\nimport { initializeApp, getApps, getApp, type FirebaseApp } from 'firebase/app';\n\n// Auth - only required functions\nimport {\n  getAuth,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  sendEmailVerification,\n  signOut,\n  onAuthStateChanged,\n  type Auth,\n  type User\n} from 'firebase/auth';\n\n// Firestore - only required functions\nimport {\n  getFirestore,\n  collection,\n  doc,\n  getDoc,\n  getDocs,\n  setDoc,\n  updateDoc,\n  deleteDoc,\n  query,\n  where,\n  orderBy,\n  limit,\n  onSnapshot,\n  serverTimestamp,\n  Timestamp,\n  type Firestore,\n  type DocumentData,\n  type QueryConstraint,\n  type CollectionReference,\n  type DocumentReference\n} from 'firebase/firestore';\n\n// Storage - only if needed\nimport {\n  getStorage,\n  ref,\n  uploadBytes,\n  getDownloadURL,\n  deleteObject,\n  FirebaseStorage\n} from 'firebase/storage';\n\n// Analytics - load lazily\nlet analytics: any = null;\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\n};\n\n// Initialize Firebase app\nconst app: FirebaseApp = getApps().length === 0 ? initializeApp(firebaseConfig) : getApp();\n\n// Initialize services\nexport const auth: Auth = getAuth(app);\nexport const db: Firestore = getFirestore(app);\nexport const storage: Storage = getStorage(app);\n\n// Lazy load analytics only when needed\nexport const getAnalytics = async () => {\n  if (!analytics && typeof window !== 'undefined') {\n    const { getAnalytics: initAnalytics, isSupported } = await import('firebase/analytics');\n    if (await isSupported()) {\n      analytics = initAnalytics(app);\n    }\n  }\n  return analytics;\n};\n\n// Export optimized functions\nexport {\n  // Auth\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  sendEmailVerification,\n  signOut,\n  onAuthStateChanged,\n\n  // Firestore\n  collection,\n  doc,\n  getDoc,\n  getDocs,\n  setDoc,\n  updateDoc,\n  deleteDoc,\n  query,\n  where,\n  orderBy,\n  limit,\n  onSnapshot,\n  serverTimestamp,\n  Timestamp,\n\n  // Storage\n  ref,\n  uploadBytes,\n  getDownloadURL,\n  deleteObject,\n\n  // Types\n  type User,\n  type DocumentData,\n  type QueryConstraint,\n  type CollectionReference,\n  type DocumentReference\n};\n\n// Helper to get timestamp\nexport const getTimestamp = () => serverTimestamp();\n\n// Helper for batch operations (lazy loaded)\nexport const getBatch = async () => {\n  const { writeBatch } = await import('firebase/firestore');\n  return writeBatch(db);\n};\n\n// Helper for transactions (lazy loaded)\nexport const runTransaction = async (updateFunction: any) => {\n  const { runTransaction: firestoreTransaction } = await import('firebase/firestore');\n  return firestoreTransaction(db, updateFunction);\n};","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase-realtime.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'channel' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":519,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":519,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'listener' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":520,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":520,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Database, getDatabase, ref, push, set, onValue, off, serverTimestamp, DataSnapshot } from 'firebase/database';\nimport { app } from '@hive/core';\nimport { logger } from './structured-logger';\n\n/**\n * Firebase Realtime Database Helper for HIVE Platform\n * Handles real-time messaging, presence, and broadcasting\n */\n\nexport interface RealtimeMessage {\n  id: string;\n  type: 'chat' | 'notification' | 'tool_update' | 'presence' | 'system';\n  channel: string;\n  senderId: string;\n  targetUsers?: string[];\n  content: any;\n  metadata: {\n    timestamp: any; // Firebase ServerValue.TIMESTAMP\n    priority: 'low' | 'normal' | 'high' | 'urgent';\n    requiresAck: boolean;\n    expiresAt?: any;\n    retryCount: number;\n  };\n  delivery?: {\n    sent: string[];\n    delivered: string[];\n    read: string[];\n    failed: string[];\n  };\n}\n\nexport interface PresenceData {\n  userId: string;\n  status: 'online' | 'offline' | 'away';\n  lastSeen: any; // Firebase ServerValue.TIMESTAMP\n  connectionId?: string;\n  currentSpace?: string;\n  activity?: string;\n  metadata?: {\n    platform: string;\n    version: string;\n  };\n}\n\nexport interface ChatMessage {\n  id: string;\n  spaceId: string;\n  userId: string;\n  content: string;\n  type: 'text' | 'image' | 'file' | 'poll' | 'system';\n  timestamp: any;\n  reactions?: {\n    [emoji: string]: string[]; // array of user IDs\n  };\n  edited?: boolean;\n  editedAt?: any;\n  replyTo?: string;\n  mentions?: string[];\n  attachments?: {\n    type: 'image' | 'file';\n    url: string;\n    name: string;\n    size: number;\n  }[];\n}\n\nexport interface TypingIndicator {\n  userId: string;\n  spaceId: string;\n  timestamp: any;\n  isTyping: boolean;\n}\n\nexport class FirebaseRealtimeService {\n  private database: Database;\n  private listeners: Map<string, any[]> = new Map();\n\n  constructor() {\n    this.database = getDatabase(app);\n  }\n\n  /**\n   * Send a message to a specific channel\n   */\n  async sendMessage(message: Omit<RealtimeMessage, 'id'>): Promise<string> {\n    try {\n      const messagesRef = ref(this.database, `channels/${message.channel}/messages`);\n      const messageRef = push(messagesRef);\n      \n      const messageWithId: RealtimeMessage = {\n        ...message,\n        id: messageRef.key!,\n        metadata: {\n          ...message.metadata,\n          timestamp: serverTimestamp()\n        }\n      };\n\n      await set(messageRef, messageWithId);\n      \n      // Update channel's last activity\n      await set(ref(this.database, `channels/${message.channel}/lastActivity`), serverTimestamp());\n      \n      logger.info('Message sent to channel', { \n        id: messageRef.key, \n        channel: message.channel,\n        type: message.type \n      });\n\n      return messageRef.key!;\n    } catch (error) {\n      logger.error('Error sending message', { error: error instanceof Error ? error.message : String(error), channel: message.channel });\n      throw error;\n    }\n  }\n\n  /**\n   * Send a chat message to a space\n   */\n  async sendChatMessage(spaceId: string, userId: string, content: string, type: ChatMessage['type'] = 'text'): Promise<string> {\n    try {\n      const chatRef = ref(this.database, `chats/${spaceId}/messages`);\n      const messageRef = push(chatRef);\n      \n      const chatMessage: ChatMessage = {\n        id: messageRef.key!,\n        spaceId,\n        userId,\n        content,\n        type,\n        timestamp: serverTimestamp()\n      };\n\n      await set(messageRef, chatMessage);\n      \n      // Update space's last message info\n      await set(ref(this.database, `chats/${spaceId}/lastMessage`), {\n        id: messageRef.key,\n        userId,\n        timestamp: serverTimestamp(),\n        preview: content.substring(0, 100)\n      });\n\n      // Send notification via message system\n      await this.sendMessage({\n        type: 'notification',\n        channel: `space:${spaceId}:chat`,\n        senderId: userId,\n        content: {\n          type: 'new_chat_message',\n          spaceId,\n          id: messageRef.key,\n          preview: content.substring(0, 100)\n        },\n        metadata: {\n          timestamp: serverTimestamp(),\n          priority: 'normal',\n          requiresAck: false,\n          retryCount: 0\n        }\n      });\n\n      return messageRef.key!;\n    } catch (error) {\n      logger.error('Error sending chat message', { error: error instanceof Error ? error.message : String(error), spaceId, userId });\n      throw error;\n    }\n  }\n\n  /**\n   * Update user presence\n   */\n  async updatePresence(userId: string, presenceData: Omit<PresenceData, 'userId'>): Promise<void> {\n    try {\n      const presenceRef = ref(this.database, `presence/${userId}`);\n      const fullPresenceData: PresenceData = {\n        userId,\n        ...presenceData,\n        lastSeen: serverTimestamp()\n      };\n\n      await set(presenceRef, fullPresenceData);\n\n      // Broadcast presence update to relevant spaces\n      if (presenceData.currentSpace) {\n        await this.sendMessage({\n          type: 'presence',\n          channel: `space:${presenceData.currentSpace}:presence`,\n          senderId: 'system',\n          content: {\n            userId,\n            status: presenceData.status,\n            activity: presenceData.activity\n          },\n          metadata: {\n            timestamp: serverTimestamp(),\n            priority: 'low',\n            requiresAck: false,\n            retryCount: 0\n          }\n        });\n      }\n\n      logger.info('User presence updated', { userId, status: presenceData.status });\n    } catch (error) {\n      logger.error('Error updating presence', { error: error instanceof Error ? error.message : String(error), userId });\n      throw error;\n    }\n  }\n\n  /**\n   * Set typing indicator\n   */\n  async setTypingIndicator(spaceId: string, userId: string, isTyping: boolean): Promise<void> {\n    try {\n      const typingRef = ref(this.database, `typing/${spaceId}/${userId}`);\n      \n      if (isTyping) {\n        const typingData: TypingIndicator = {\n          userId,\n          spaceId,\n          timestamp: serverTimestamp(),\n          isTyping: true\n        };\n        await set(typingRef, typingData);\n      } else {\n        await set(typingRef, null); // Remove typing indicator\n      }\n\n      // Broadcast typing status\n      await this.sendMessage({\n        type: 'system',\n        channel: `space:${spaceId}:typing`,\n        senderId: userId,\n        content: {\n          isTyping,\n          userId\n        },\n        metadata: {\n          timestamp: serverTimestamp(),\n          priority: 'low',\n          requiresAck: false,\n          retryCount: 0\n        }\n      });\n    } catch (error) {\n      logger.error('Error setting typing indicator', { error: error instanceof Error ? error.message : String(error), spaceId, userId });\n      throw error;\n    }\n  }\n\n  /**\n   * Send tool state update\n   */\n  async sendToolUpdate(toolId: string, spaceId: string, userId: string, updateData: any): Promise<void> {\n    try {\n      // Store tool state\n      await set(ref(this.database, `tools/${toolId}/state`), {\n        ...updateData,\n        lastUpdated: serverTimestamp(),\n        updatedBy: userId\n      });\n\n      // Broadcast update to space\n      await this.sendMessage({\n        type: 'tool_update',\n        channel: `space:${spaceId}:tools`,\n        senderId: userId,\n        content: {\n          toolId,\n          updateType: updateData.type || 'state_change',\n          data: updateData\n        },\n        metadata: {\n          timestamp: serverTimestamp(),\n          priority: 'normal',\n          requiresAck: true,\n          retryCount: 0\n        }\n      });\n\n      logger.info('Tool update sent', { toolId, spaceId, userId });\n    } catch (error) {\n      logger.error('Error sending tool update', { error: error instanceof Error ? error.message : String(error), toolId, spaceId });\n      throw error;\n    }\n  }\n\n  /**\n   * Send system notification\n   */\n  async sendNotification(userId: string | string[], notification: {\n    title: string;\n    message: string;\n    type: 'info' | 'success' | 'warning' | 'error';\n    actionUrl?: string;\n    metadata?: any;\n  }): Promise<void> {\n    try {\n      const userIds = Array.isArray(userId) ? userId : [userId];\n      \n      for (const uid of userIds) {\n        await this.sendMessage({\n          type: 'notification',\n          channel: `user:${uid}:notifications`,\n          senderId: 'system',\n          targetUsers: [uid],\n          content: notification,\n          metadata: {\n            timestamp: serverTimestamp(),\n            priority: notification.type === 'error' ? 'high' : 'normal',\n            requiresAck: true,\n            retryCount: 0\n          }\n        });\n      }\n\n      logger.info('Notification sent', { userIds: userIds.join(','), type: notification.type });\n    } catch (error) {\n      logger.error('Error sending notification', { error: error instanceof Error ? error.message : String(error), userId: Array.isArray(userId) ? userId.join(',') : userId });\n      throw error;\n    }\n  }\n\n  /**\n   * Listen to channel messages\n   */\n  listenToChannel(channel: string, callback: (messages: RealtimeMessage[]) => void): () => void {\n    const channelRef = ref(this.database, `channels/${channel}/messages`);\n    \n    const listener = onValue(channelRef, (snapshot: DataSnapshot) => {\n      const messages: RealtimeMessage[] = [];\n      snapshot.forEach((childSnapshot) => {\n        messages.push(childSnapshot.val());\n      });\n      \n      // Sort by timestamp\n      messages.sort((a, b) => (a.metadata.timestamp || 0) - (b.metadata.timestamp || 0));\n      callback(messages);\n    });\n\n    // Store listener for cleanup\n    if (!this.listeners.has(channel)) {\n      this.listeners.set(channel, []);\n    }\n    this.listeners.get(channel)!.push(listener);\n\n    // Return cleanup function\n    return () => {\n      off(channelRef, 'value', listener);\n      const channelListeners = this.listeners.get(channel);\n      if (channelListeners) {\n        const index = channelListeners.indexOf(listener);\n        if (index > -1) {\n          channelListeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  /**\n   * Listen to chat messages for a space\n   */\n  listenToChat(spaceId: string, callback: (messages: ChatMessage[]) => void): () => void {\n    const chatRef = ref(this.database, `chats/${spaceId}/messages`);\n    \n    const listener = onValue(chatRef, (snapshot: DataSnapshot) => {\n      const messages: ChatMessage[] = [];\n      snapshot.forEach((childSnapshot) => {\n        messages.push(childSnapshot.val());\n      });\n      \n      // Sort by timestamp\n      messages.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n      callback(messages);\n    });\n\n    // Store listener for cleanup\n    const listenerKey = `chat:${spaceId}`;\n    if (!this.listeners.has(listenerKey)) {\n      this.listeners.set(listenerKey, []);\n    }\n    this.listeners.get(listenerKey)!.push(listener);\n\n    return () => {\n      off(chatRef, 'value', listener);\n      const chatListeners = this.listeners.get(listenerKey);\n      if (chatListeners) {\n        const index = chatListeners.indexOf(listener);\n        if (index > -1) {\n          chatListeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  /**\n   * Listen to presence updates for a space\n   */\n  listenToPresence(spaceId: string, callback: (presence: Record<string, PresenceData>) => void): () => void {\n    const presenceRef = ref(this.database, 'presence');\n    \n    const listener = onValue(presenceRef, (snapshot: DataSnapshot) => {\n      const allPresence: Record<string, PresenceData> = {};\n      snapshot.forEach((childSnapshot) => {\n        const presenceData = childSnapshot.val();\n        if (presenceData.currentSpace === spaceId) {\n          allPresence[childSnapshot.key!] = presenceData;\n        }\n      });\n      \n      callback(allPresence);\n    });\n\n    const listenerKey = `presence:${spaceId}`;\n    if (!this.listeners.has(listenerKey)) {\n      this.listeners.set(listenerKey, []);\n    }\n    this.listeners.get(listenerKey)!.push(listener);\n\n    return () => {\n      off(presenceRef, 'value', listener);\n      const presenceListeners = this.listeners.get(listenerKey);\n      if (presenceListeners) {\n        const index = presenceListeners.indexOf(listener);\n        if (index > -1) {\n          presenceListeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  /**\n   * Listen to typing indicators for a space\n   */\n  listenToTyping(spaceId: string, callback: (typing: Record<string, TypingIndicator>) => void): () => void {\n    const typingRef = ref(this.database, `typing/${spaceId}`);\n    \n    const listener = onValue(typingRef, (snapshot: DataSnapshot) => {\n      const typing: Record<string, TypingIndicator> = {};\n      snapshot.forEach((childSnapshot) => {\n        typing[childSnapshot.key!] = childSnapshot.val();\n      });\n      \n      callback(typing);\n    });\n\n    const listenerKey = `typing:${spaceId}`;\n    if (!this.listeners.has(listenerKey)) {\n      this.listeners.set(listenerKey, []);\n    }\n    this.listeners.get(listenerKey)!.push(listener);\n\n    return () => {\n      off(typingRef, 'value', listener);\n      const typingListeners = this.listeners.get(listenerKey);\n      if (typingListeners) {\n        const index = typingListeners.indexOf(listener);\n        if (index > -1) {\n          typingListeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  /**\n   * Get message history for a channel\n   */\n  async getMessageHistory(channel: string, limit: number = 50): Promise<RealtimeMessage[]> {\n    try {\n      const messagesRef = ref(this.database, `channels/${channel}/messages`);\n      // In a production app, you'd use Firebase's query methods to limit and paginate\n      // For now, we'll get all messages and limit client-side\n      \n      return new Promise((resolve, reject) => {\n        onValue(messagesRef, (snapshot: DataSnapshot) => {\n          const messages: RealtimeMessage[] = [];\n          snapshot.forEach((childSnapshot) => {\n            messages.push(childSnapshot.val());\n          });\n          \n          // Sort by timestamp and limit\n          messages.sort((a, b) => (b.metadata.timestamp || 0) - (a.metadata.timestamp || 0));\n          resolve(messages.slice(0, limit));\n        }, reject, { onlyOnce: true });\n      });\n    } catch (error) {\n      logger.error('Error getting message history', { error: error instanceof Error ? error.message : String(error), channel });\n      throw error;\n    }\n  }\n\n  /**\n   * Mark messages as read\n   */\n  async markMessagesAsRead(channel: string, userId: string, messageIds: string[]): Promise<void> {\n    try {\n      for (const messageId of messageIds) {\n        const readRef = ref(this.database, `channels/${channel}/messages/${messageId}/delivery/read`);\n        // Add userId to read array if not already present\n        // This is a simplified implementation - in production you'd use transactions\n        onValue(readRef, (snapshot) => {\n          const currentRead = snapshot.val() || [];\n          if (!currentRead.includes(userId)) {\n            set(readRef, [...currentRead, userId]);\n          }\n        }, { onlyOnce: true });\n      }\n    } catch (error) {\n      logger.error('Error marking messages as read', { error: error instanceof Error ? error.message : String(error), channel, userId });\n      throw error;\n    }\n  }\n\n  /**\n   * Clean up all listeners\n   */\n  cleanup(): void {\n    this.listeners.forEach((listeners, channel) => {\n      listeners.forEach(listener => {\n        // The actual cleanup would depend on the channel type\n        // This is a simplified cleanup\n      });\n    });\n    this.listeners.clear();\n  }\n}\n\n// Export singleton instance\nexport const realtimeService = new FirebaseRealtimeService();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/firebase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/form-validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/handle-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/join-waitlist.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/mappers/space-mapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/middleware/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/middleware/error-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/middleware/index.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AuthenticatedHandler' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":60}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Platform Middleware\n *\n * Consolidated middleware system that eliminates duplication across 200+ API routes\n *\n * Usage Examples:\n *\n * // Basic auth + error handling (most common)\n * export const POST = withAuthAndErrors(async (request, context) => {\n *   const userId = getUserId(request);\n *   // ... handler logic\n *   return respond.success({ userId });\n * });\n *\n * // Admin-only route\n * export const DELETE = withAdminAuthAndErrors(async (request, context) => {\n *   // ... admin logic\n *   return respond.noContent();\n * });\n *\n * // Public route with error handling\n * export const GET = withErrors(async (request, context) => {\n *   // ... public logic\n *   return respond.success(data);\n * });\n */\n\n// Core middleware\nexport {\n  withAuth,\n  withAdminAuth,\n  getUserId,\n  getUserEmail,\n  type AuthenticatedRequest,\n  type AuthenticatedHandler,\n  type AuthenticatedRouteContext,\n  type RouteParams,\n  type NextRouteHandler\n} from './auth';\n\nexport {\n  withErrorHandling,\n  handleApiError,\n  parseJsonBody,\n  validateRequestBody\n} from './error-handler';\n\nexport {\n  ResponseFormatter,\n  withResponse,\n  respond,\n  isSuccessResponse,\n  isErrorResponse,\n  type ApiSuccessResponse,\n  type ApiErrorResponse,\n  type ApiResponse\n} from './response';\n\n// Combined middleware wrappers\nimport { withAuth, withAdminAuth, type AuthenticatedHandler, type AuthenticatedRouteContext, type AuthenticatedRequest, type RouteParams } from './auth';\nimport { withErrorHandling, type ApiHandler } from './error-handler';\nimport { withResponse, type ResponseFormatter } from './response';\nimport { z } from 'zod';\n\n/**\n * Most common pattern: Auth + Error Handling + Response Formatting\n * Replaces 15+ lines of boilerplate in most protected routes\n */\nexport function withAuthAndErrors<TAdditional extends RouteParams = RouteParams>(\n  handler: (\n    request: AuthenticatedRequest,\n    context: AuthenticatedRouteContext & TAdditional,\n    respond: typeof ResponseFormatter\n  ) => Promise<Response>\n): ApiHandler {\n  return withErrorHandling(\n    withAuth<TAdditional>(\n      withResponse<AuthenticatedRouteContext & TAdditional, AuthenticatedRequest>(\n        async (request, context, respond) => handler(request, context, respond)\n      )\n    )\n  );\n}\n\n/**\n * Admin routes pattern: Admin Auth + Error Handling + Response Formatting\n */\nexport function withAdminAuthAndErrors<TAdditional extends RouteParams = RouteParams>(\n  handler: (\n    request: AuthenticatedRequest,\n    context: AuthenticatedRouteContext & TAdditional,\n    respond: typeof ResponseFormatter\n  ) => Promise<Response>\n): ApiHandler {\n  return withErrorHandling(\n    withAdminAuth<TAdditional>(\n      withResponse<AuthenticatedRouteContext & TAdditional, AuthenticatedRequest>(\n        async (request, context, respond) => handler(request, context, respond)\n      )\n    )\n  );\n}\n\n/**\n * Public routes pattern: any Handling + Response Formatting only\n */\nexport function withErrors<T extends any>(\n  handler: (\n    request: any,\n    context: T,\n    respond: typeof ResponseFormatter\n  ) => Promise<Response>\n): ApiHandler {\n  return withErrorHandling(\n    withResponse(handler)\n  );\n}\n\n/**\n * Validation middleware for POST/PUT routes\n * Combines JSON parsing + Zod validation + error handling\n */\nexport function withValidation<TSchema, TContext extends any>(\n  schema: z.ZodSchema<TSchema>,\n  handler: (\n    request: any,\n    context: TContext,\n    body: TSchema,\n    respond: typeof ResponseFormatter\n  ) => Promise<Response>\n): ApiHandler {\n  return withErrorHandling(async (request, context) => {\n    const { validateRequestBody } = await import('./error-handler');\n    const body = await validateRequestBody(request, schema);\n    return withResponse(\n      async (req, ctx, respond) => handler(req, ctx as TContext, body, respond)\n    )(request, context);\n  });\n}\n\n/**\n * Full stack middleware: Auth + Validation + Error Handling + Response\n * For protected routes that need request validation\n */\nexport function withAuthValidationAndErrors<TSchema, TAdditional extends RouteParams = RouteParams>(\n  schema: z.ZodSchema<TSchema>,\n  handler: (\n    request: AuthenticatedRequest,\n    context: AuthenticatedRouteContext & TAdditional,\n    body: TSchema,\n    respond: typeof ResponseFormatter\n  ) => Promise<Response>\n): ApiHandler {\n  return withAuthAndErrors<TAdditional>(async (request, context, respond) => {\n    const { validateRequestBody } = await import('./error-handler');\n    const body = await validateRequestBody(request, schema);\n    return handler(request, context, body, respond);\n  });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/middleware/response.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/migration-helpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/notifications-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/onboarding-bridge-temp.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onboardingData' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":120,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":120,"endColumn":71}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Temporary Onboarding Bridge\n * Working implementation to fix the import resolution issue\n */\n\nimport { useCallback } from 'react';\nimport { useAuth } from \"@hive/auth-logic\";\n\nexport interface OnboardingData {\n  fullName: string;\n  userType: 'student' | 'alumni' | 'faculty';\n  firstName?: string;\n  lastName?: string;\n  major: string;\n  academicLevel?: string;\n  graduationYear: number;\n  handle: string;\n  avatarUrl?: string;\n  interests?: string[];\n  builderRequestSpaces?: string[];\n  consentGiven: boolean;\n}\n\nexport interface OnboardingResult {\n  success: boolean;\n  user?: any;\n  builderRequestsCreated?: number;\n  error?: string;\n}\n\n/**\n * Temporary working implementation of useOnboardingBridge\n */\nexport function useOnboardingBridge() {\n  const unifiedAuth = useAuth();\n\n  const completeOnboarding = useCallback(async (\n    onboardingData: OnboardingData\n  ): Promise<OnboardingResult> => {\n    try {\n      if (!unifiedAuth.isAuthenticated || !unifiedAuth.user) {\n        throw new Error('User must be authenticated to complete onboarding');\n      }\n\n      // Validate required fields\n      const requiredFields: (keyof OnboardingData)[] = [\n        'fullName', 'userType', 'major', 'graduationYear', 'handle', 'consentGiven'\n      ];\n      \n      for (const field of requiredFields) {\n        if (!onboardingData[field]) {\n          throw new Error(`Required field missing: ${field}`);\n        }\n      }\n\n      if (!onboardingData.consentGiven) {\n        throw new Error('User consent is required to complete onboarding');\n      }\n\n      // Make direct API call to complete onboarding\n      const response = await fetch('/api/auth/complete-onboarding', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${await unifiedAuth.getAuthToken?.() || ''}`,\n        },\n        body: JSON.stringify(onboardingData),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok) {\n        throw new Error(result.error || 'Onboarding completion failed');\n      }\n\n        // Handle development user update if provided\n      if (result.devUserUpdate && typeof window !== 'undefined') {\n        localStorage.setItem('dev_auth_mode', 'true');\n        localStorage.setItem('dev_user', JSON.stringify(result.devUserUpdate));\n\n        // Trigger storage event for auth hook to pick up changes\n        window.dispatchEvent(new StorageEvent('storage', {\n          key: 'dev_user',\n          newValue: JSON.stringify(result.devUserUpdate)\n        }));\n      }\n\n      // Update the auth state to reflect onboarding is complete\n      if (unifiedAuth.refreshUser) {\n        await unifiedAuth.refreshUser();\n      }\n\n      return {\n        success: true,\n        user: result.user,\n        builderRequestsCreated: result.builderRequestsCreated || 0,\n      };\n\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  }, [unifiedAuth]);\n\n  const needsOnboarding = useCallback(() => {\n    return !unifiedAuth.user?.onboardingCompleted;\n  }, [unifiedAuth.user]);\n\n  const getOnboardingProgress = useCallback(() => {\n    return {\n      completedSteps: 7,\n      totalSteps: 7,\n      percentage: 100,\n      isComplete: true,\n    };\n  }, []);\n\n  const createPostOnboardingSpaces = useCallback(async (onboardingData: OnboardingData) => {\n    // This would normally create cohort spaces based on major/graduation year\n\n    return {\n      cohortSpaces: [],\n      joinedSpaces: [],\n      totalSpaces: 0,\n    };\n  }, []);\n\n  return {\n    completeOnboarding,\n    needsOnboarding,\n    getOnboardingProgress,\n    createPostOnboardingSpaces,\n    isAuthenticated: unifiedAuth.isAuthenticated,\n    user: unifiedAuth.user,\n    isLoading: unifiedAuth.isLoading,\n    error: unifiedAuth.error || '',\n    canAccessFeature: unifiedAuth.canAccessFeature,\n    hasValidSession: unifiedAuth.hasValidSession,\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/performance-monitoring.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'name' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":304,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":304,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Performance Monitoring & Analytics\n * Comprehensive performance tracking for platform optimization\n */\n\nimport { useState, useEffect } from 'react';\n\nexport interface PerformanceMetric {\n  name: string;\n  value: number;\n  rating: 'good' | 'needs-improvement' | 'poor';\n  timestamp: number;\n}\n\n// Enhanced metrics for comprehensive monitoring\nexport interface EnhancedPerformanceMetric {\n  id: string;\n  timestamp: Date;\n  type: MetricType;\n  value: number;\n  unit: string;\n  labels: Record<string, string>;\n  userId?: string;\n  spaceId?: string;\n  endpoint?: string;\n  component?: string;\n}\n\nexport enum MetricType {\n  // API Performance\n  _API_RESPONSE_TIME = 'api_response_time',\n  _API_ERROR_RATE = 'api_error_rate',\n  _API_THROUGHPUT = 'api_throughput',\n  \n  // Database Performance\n  _DB_QUERY_TIME = 'db_query_time',\n  _DB_CONNECTION_COUNT = 'db_connection_count',\n  _DB_ERROR_RATE = 'db_error_rate',\n  \n  // Frontend Performance\n  _PAGE_LOAD_TIME = 'page_load_time',\n  _COMPONENT_RENDER_TIME = 'component_render_time',\n  _BUNDLE_SIZE = 'bundle_size',\n  \n  // User Experience\n  _TIME_TO_INTERACTIVE = 'time_to_interactive',\n  _FIRST_CONTENTFUL_PAINT = 'first_contentful_paint',\n  _CUMULATIVE_LAYOUT_SHIFT = 'cumulative_layout_shift',\n  \n  // Platform Integration\n  _INTEGRATION_LATENCY = 'integration_latency',\n  _CACHE_HIT_RATE = 'cache_hit_rate',\n  _WEBSOCKET_CONNECTION_TIME = 'websocket_connection_time',\n  \n  // Business Metrics\n  _USER_ENGAGEMENT = 'user_engagement',\n  _FEATURE_USAGE = 'feature_usage',\n  _CONVERSION_RATE = 'conversion_rate',\n  \n  // System Health\n  _MEMORY_USAGE = 'memory_usage',\n  _CPU_USAGE = 'cpu_usage',\n  _ERROR_COUNT = 'error_count'\n}\n\nexport interface WebVitalsMetrics {\n  LCP?: PerformanceMetric; // Largest Contentful Paint\n  FID?: PerformanceMetric; // First Input Delay  \n  CLS?: PerformanceMetric; // Cumulative Layout Shift\n  FCP?: PerformanceMetric; // First Contentful Paint\n  TTFB?: PerformanceMetric; // Time to First Byte\n}\n\n// Enhanced Performance Collector\nexport class HivePerformanceCollector {\n  private enhancedMetrics: EnhancedPerformanceMetric[] = [];\n  private batchSize: number = 50;\n  private flushInterval: number = 30000; // 30 seconds\n  private flushTimer: NodeJS.Timeout | null = null;\n  private collectors: Map<string, () => EnhancedPerformanceMetric[]> = new Map();\n\n  constructor(config: {\n    batchSize?: number;\n    flushInterval?: number;\n    autoStart?: boolean;\n  } = {}) {\n    this.batchSize = config.batchSize || 50;\n    this.flushInterval = config.flushInterval || 30000;\n    \n    if (config.autoStart !== false) {\n      this.start();\n    }\n\n    this.setupBuiltInCollectors();\n  }\n\n  private setupBuiltInCollectors(): void {\n    // Web Vitals Collector\n    if (typeof window !== 'undefined') {\n      this.registerCollector('web-vitals', () => {\n        const metrics: EnhancedPerformanceMetric[] = [];\n        \n        // Performance Observer for navigation timing\n        if ('performance' in window && 'getEntriesByType' in performance) {\n          const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\n          if (navigation) {\n            metrics.push({\n              id: `nav_${Date.now()}`,\n              timestamp: new Date(),\n              type: MetricType._PAGE_LOAD_TIME,\n              value: navigation.loadEventEnd - navigation.fetchStart,\n              unit: 'ms',\n              labels: { page: window.location.pathname }\n            });\n\n            if (navigation.domContentLoadedEventEnd) {\n              metrics.push({\n                id: `dcl_${Date.now()}`,\n                timestamp: new Date(),\n                type: MetricType._TIME_TO_INTERACTIVE,\n                value: navigation.domContentLoadedEventEnd - navigation.fetchStart,\n                unit: 'ms',\n                labels: { page: window.location.pathname }\n              });\n            }\n          }\n        }\n\n        return metrics;\n      });\n\n      // Memory Usage Collector\n      this.registerCollector('memory', () => {\n        const metrics: EnhancedPerformanceMetric[] = [];\n        \n        if ('memory' in performance) {\n          const memory = (performance as any).memory;\n          metrics.push({\n            id: `mem_${Date.now()}`,\n            timestamp: new Date(),\n            type: MetricType._MEMORY_USAGE,\n            value: memory.usedJSHeapSize,\n            unit: 'bytes',\n            labels: { type: 'used_heap' }\n          });\n        }\n\n        return metrics;\n      });\n    }\n\n    // Node.js Metrics Collector\n    if (typeof process !== 'undefined') {\n      this.registerCollector('node-metrics', () => {\n        const metrics: EnhancedPerformanceMetric[] = [];\n        \n        const memUsage = process.memoryUsage();\n        metrics.push({\n          id: `node_mem_${Date.now()}`,\n          timestamp: new Date(),\n          type: MetricType._MEMORY_USAGE,\n          value: memUsage.heapUsed,\n          unit: 'bytes',\n          labels: { type: 'heap_used', runtime: 'node' }\n        });\n\n        if (process.cpuUsage) {\n          const cpuUsage = process.cpuUsage();\n          metrics.push({\n            id: `node_cpu_${Date.now()}`,\n            timestamp: new Date(),\n            type: MetricType._CPU_USAGE,\n            value: cpuUsage.user + cpuUsage.system,\n            unit: 'microseconds',\n            labels: { runtime: 'node' }\n          });\n        }\n\n        return metrics;\n      });\n    }\n  }\n\n  registerCollector(name: string, collector: () => EnhancedPerformanceMetric[]): void {\n    this.collectors.set(name, collector);\n  }\n\n  unregisterCollector(name: string): void {\n    this.collectors.delete(name);\n  }\n\n  record(metric: Omit<EnhancedPerformanceMetric, 'id' | 'timestamp'>): void {\n    const fullMetric: EnhancedPerformanceMetric = {\n      id: `${metric.type}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: new Date(),\n      ...metric\n    };\n\n    this.enhancedMetrics.push(fullMetric);\n\n    if (this.enhancedMetrics.length >= this.batchSize) {\n      this.flush();\n    }\n  }\n\n  recordApiCall(endpoint: string, method: string, responseTime: number, status: number): void {\n    this.record({\n      type: MetricType._API_RESPONSE_TIME,\n      value: responseTime,\n      unit: 'ms',\n      labels: { endpoint, method, status: status.toString() },\n      endpoint\n    });\n\n    this.record({\n      type: MetricType._API_THROUGHPUT,\n      value: 1,\n      unit: 'requests',\n      labels: { endpoint, method },\n      endpoint\n    });\n\n    if (status >= 400) {\n      this.record({\n        type: MetricType._API_ERROR_RATE,\n        value: 1,\n        unit: 'errors',\n        labels: { endpoint, method, status: status.toString() },\n        endpoint\n      });\n    }\n  }\n\n  recordComponentRender(component: string, renderTime: number): void {\n    this.record({\n      type: MetricType._COMPONENT_RENDER_TIME,\n      value: renderTime,\n      unit: 'ms',\n      labels: { component },\n      component\n    });\n  }\n\n  recordUserEngagement(action: string, userId: string, spaceId?: string): void {\n    this.record({\n      type: MetricType._USER_ENGAGEMENT,\n      value: 1,\n      unit: 'actions',\n      labels: { action },\n      userId,\n      spaceId\n    });\n  }\n\n  recordFeatureUsage(feature: string, userId: string, usage: number = 1): void {\n    this.record({\n      type: MetricType._FEATURE_USAGE,\n      value: usage,\n      unit: 'usage',\n      labels: { feature },\n      userId\n    });\n  }\n\n  recordIntegrationLatency(integration: string, latency: number): void {\n    this.record({\n      type: MetricType._INTEGRATION_LATENCY,\n      value: latency,\n      unit: 'ms',\n      labels: { integration }\n    });\n  }\n\n  recordCacheMetrics(action: 'hit' | 'miss', cacheType: string): void {\n    this.record({\n      type: MetricType._CACHE_HIT_RATE,\n      value: action === 'hit' ? 1 : 0,\n      unit: 'ratio',\n      labels: { operation: action, cache_type: cacheType }\n    });\n  }\n\n  recordDatabaseQuery(query: string, duration: number, success: boolean): void {\n    this.record({\n      type: MetricType._DB_QUERY_TIME,\n      value: duration,\n      unit: 'ms',\n      labels: { query_type: query, success: success.toString() }\n    });\n\n    if (!success) {\n      this.record({\n        type: MetricType._DB_ERROR_RATE,\n        value: 1,\n        unit: 'errors',\n        labels: { query_type: query }\n      });\n    }\n  }\n\n  private collectFromRegisteredCollectors(): EnhancedPerformanceMetric[] {\n    const collectedMetrics: EnhancedPerformanceMetric[] = [];\n    \n    for (const [name, collector] of this.collectors) {\n      try {\n        const metrics = collector();\n        collectedMetrics.push(...metrics);\n      } catch (error) {\n        // Intentionally suppressed - non-critical error\n      }\n    }\n\n    return collectedMetrics;\n  }\n\n  async flush(): Promise<void> {\n    if (this.enhancedMetrics.length === 0) return;\n\n    // Collect from registered collectors\n    const collectedMetrics = this.collectFromRegisteredCollectors();\n    const allMetrics = [...this.enhancedMetrics, ...collectedMetrics];\n\n    // Clear current metrics\n    this.enhancedMetrics = [];\n\n    try {\n      await this.sendMetrics(allMetrics);\n    } catch (error) {\n      // Re-add metrics for retry (keep only recent ones)\n      this.enhancedMetrics.unshift(...allMetrics.slice(-10));\n    }\n  }\n\n  private async sendMetrics(metrics: EnhancedPerformanceMetric[]): Promise<void> {\n    if (typeof window !== 'undefined') {\n      // Browser environment - send to analytics endpoint\n      try {\n        await fetch('/api/analytics/metrics', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ metrics })\n        });\n      } catch (error) {\n        // Fallback to local storage for offline scenarios\n        this.storeMetricsLocally(metrics);\n      }\n    } else {\n      // Server environment - log to console or external service\n    }\n  }\n\n  private storeMetricsLocally(metrics: EnhancedPerformanceMetric[]): void {\n    if (typeof window !== 'undefined' && window.localStorage) {\n      try {\n        const existing = localStorage.getItem('hive_metrics_queue') || '[]';\n        const queue = JSON.parse(existing);\n        queue.push(...metrics);\n        \n        // Keep only last 500 metrics in local storage\n        const truncated = queue.slice(-500);\n        localStorage.setItem('hive_metrics_queue', JSON.stringify(truncated));\n      } catch (error) {\n        // Intentionally suppressed - non-critical error\n      }\n    }\n  }\n\n  start(): void {\n    if (this.flushTimer) return;\n    \n    this.flushTimer = setInterval(() => {\n      this.flush();\n    }, this.flushInterval);\n  }\n\n  stop(): void {\n    if (this.flushTimer) {\n      clearInterval(this.flushTimer);\n      this.flushTimer = null;\n    }\n    \n    // Flush remaining metrics\n    this.flush();\n  }\n\n  getMetrics(): EnhancedPerformanceMetric[] {\n    return [...this.enhancedMetrics];\n  }\n\n  getMetricsSummary(): Record<MetricType, {\n    count: number;\n    average: number;\n    min: number;\n    max: number;\n    latest: number;\n  }> {\n    const summary: Record<string, any> = {};\n    \n    const allMetrics = [...this.enhancedMetrics, ...this.collectFromRegisteredCollectors()];\n    \n    for (const metric of allMetrics) {\n      if (!summary[metric.type]) {\n        summary[metric.type] = {\n          count: 0,\n          total: 0,\n          min: Infinity,\n          max: -Infinity,\n          latest: 0\n        };\n      }\n      \n      const stats = summary[metric.type];\n      stats.count++;\n      stats.total += metric.value;\n      stats.min = Math.min(stats.min, metric.value);\n      stats.max = Math.max(stats.max, metric.value);\n      stats.latest = metric.value;\n    }\n    \n    // Calculate averages\n    for (const type in summary) {\n      const stats = summary[type];\n      stats.average = stats.total / stats.count;\n      delete stats.total;\n    }\n    \n    return summary as any;\n  }\n}\n\nclass PerformanceMonitor {\n  private metrics: WebVitalsMetrics = {};\n  private isClient = typeof window !== 'undefined';\n  private enhancedCollector: HivePerformanceCollector;\n\n  constructor() {\n    this.enhancedCollector = new HivePerformanceCollector();\n    if (this.isClient) {\n      this.initializeTracking();\n    }\n  }\n\n  private initializeTracking() {\n    // Track Core Web Vitals\n    this.trackLCP();\n    this.trackFID();\n    this.trackCLS();\n    this.trackFCP();\n    this.trackTTFB();\n  }\n\n  private trackLCP() {\n    if ('PerformanceObserver' in window) {\n      const observer = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        const lastEntry = entries[entries.length - 1] as any;\n        \n        this.metrics.LCP = {\n          name: 'LCP',\n          value: lastEntry.startTime,\n          rating: this.getRating('LCP', lastEntry.startTime),\n          timestamp: Date.now()\n        };\n        \n        this.reportMetric(this.metrics.LCP);\n      });\n      \n      observer.observe({ entryTypes: ['largest-contentful-paint'] });\n    }\n  }\n\n  private trackFID() {\n    if ('PerformanceObserver' in window) {\n      const observer = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        entries.forEach((entry: any) => {\n          this.metrics.FID = {\n            name: 'FID',\n            value: entry.processingStart - entry.startTime,\n            rating: this.getRating('FID', entry.processingStart - entry.startTime),\n            timestamp: Date.now()\n          };\n          \n          this.reportMetric(this.metrics.FID);\n        });\n      });\n      \n      observer.observe({ entryTypes: ['first-input'] });\n    }\n  }\n\n  private trackCLS() {\n    if ('PerformanceObserver' in window) {\n      let clsValue = 0;\n      \n      const observer = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        entries.forEach((entry: any) => {\n          if (!entry.hadRecentInput) {\n            clsValue += entry.value;\n          }\n        });\n        \n        this.metrics.CLS = {\n          name: 'CLS',\n          value: clsValue,\n          rating: this.getRating('CLS', clsValue),\n          timestamp: Date.now()\n        };\n        \n        this.reportMetric(this.metrics.CLS);\n      });\n      \n      observer.observe({ entryTypes: ['layout-shift'] });\n    }\n  }\n\n  private trackFCP() {\n    if ('PerformanceObserver' in window) {\n      const observer = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        entries.forEach((entry: any) => {\n          if (entry.name === 'first-contentful-paint') {\n            this.metrics.FCP = {\n              name: 'FCP',\n              value: entry.startTime,\n              rating: this.getRating('FCP', entry.startTime),\n              timestamp: Date.now()\n            };\n            \n            this.reportMetric(this.metrics.FCP);\n          }\n        });\n      });\n      \n      observer.observe({ entryTypes: ['paint'] });\n    }\n  }\n\n  private trackTTFB() {\n    if (typeof window !== 'undefined' && 'performance' in window) {\n      const navigationEntry = performance.getEntriesByType('navigation')[0] as any;\n      \n      if (navigationEntry) {\n        const ttfb = navigationEntry.responseStart - navigationEntry.requestStart;\n        \n        this.metrics.TTFB = {\n          name: 'TTFB',\n          value: ttfb,\n          rating: this.getRating('TTFB', ttfb),\n          timestamp: Date.now()\n        };\n        \n        this.reportMetric(this.metrics.TTFB);\n      }\n    }\n  }\n\n  private getRating(metric: string, value: number): 'good' | 'needs-improvement' | 'poor' {\n    const thresholds = {\n      LCP: { good: 2500, poor: 4000 },\n      FID: { good: 100, poor: 300 },\n      CLS: { good: 0.1, poor: 0.25 },\n      FCP: { good: 1800, poor: 3000 },\n      TTFB: { good: 800, poor: 1800 }\n    };\n\n    const threshold = thresholds[metric as keyof typeof thresholds];\n    if (!threshold) return 'good';\n\n    if (value <= threshold.good) return 'good';\n    if (value <= threshold.poor) return 'needs-improvement';\n    return 'poor';\n  }\n\n  private reportMetric(metric: PerformanceMetric) {\n    // In development, log to console\n    if (process.env.NODE_ENV === 'development') {\n      console.group(`üìä ${metric.name} Performance`);\n      console.groupEnd();\n    }\n\n    // In production, send to analytics\n    if (process.env.NODE_ENV === 'production') {\n      this.sendToAnalytics(metric);\n    }\n  }\n\n  private async sendToAnalytics(metric: PerformanceMetric) {\n    try {\n      // Send to your analytics service\n      await fetch('/api/analytics/performance', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          metric: metric.name,\n          value: metric.value,\n          rating: metric.rating,\n          timestamp: metric.timestamp,\n          url: window.location.href,\n          userAgent: navigator.userAgent,\n        }),\n      });\n    } catch (error) {\n      // Silently fail in production\n      if (process.env.NODE_ENV === 'development') {\n        console.error('Performance monitoring error:', error);\n      }\n    }\n  }\n\n  // Public API\n  public getMetrics(): WebVitalsMetrics {\n    return { ...this.metrics };\n  }\n\n  public getMetricRating(metricName: keyof WebVitalsMetrics): string {\n    const metric = this.metrics[metricName];\n    return metric ? metric.rating : 'unknown';\n  }\n\n  public getAllRatings(): Record<string, string> {\n    const ratings: Record<string, string> = {};\n    Object.entries(this.metrics).forEach(([key, metric]) => {\n      if (metric) {\n        ratings[key] = metric.rating;\n      }\n    });\n    return ratings;\n  }\n}\n\n// Singleton instances\nexport const performanceMonitor = new PerformanceMonitor();\nlet globalCollector: HivePerformanceCollector | null = null;\n\nexport function getGlobalCollector(): HivePerformanceCollector {\n  if (!globalCollector) {\n    globalCollector = new HivePerformanceCollector();\n  }\n  return globalCollector;\n}\n\nexport function initializePerformanceMonitoring(config?: {\n  batchSize?: number;\n  flushInterval?: number;\n  enableAutoCollection?: boolean;\n}): HivePerformanceCollector {\n  globalCollector = new HivePerformanceCollector({\n    batchSize: config?.batchSize,\n    flushInterval: config?.flushInterval,\n    autoStart: config?.enableAutoCollection !== false\n  });\n\n  // Setup browser-specific collectors\n  if (typeof window !== 'undefined') {\n    // Unload handler to flush metrics\n    window.addEventListener('beforeunload', () => {\n      globalCollector?.flush();\n    });\n\n    // Page visibility change handler\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'hidden') {\n        globalCollector?.flush();\n      }\n    });\n\n    // Error tracking\n    window.addEventListener('error', (event) => {\n      globalCollector?.record({\n        type: MetricType._ERROR_COUNT,\n        value: 1,\n        unit: 'errors',\n        labels: {\n          message: event.message,\n          filename: event.filename || 'unknown',\n          line: event.lineno?.toString() || 'unknown'\n        }\n      });\n    });\n\n    // Unhandled promise rejection tracking\n    window.addEventListener('unhandledrejection', (event) => {\n      globalCollector?.record({\n        type: MetricType._ERROR_COUNT,\n        value: 1,\n        unit: 'errors',\n        labels: {\n          type: 'unhandled_promise_rejection',\n          reason: event.reason?.toString() || 'unknown'\n        }\n      });\n    });\n  }\n\n  return globalCollector;\n}\n\n// Performance Monitor for React Components\nexport function usePerformanceMonitor(componentName: string) {\n  const collector = getGlobalCollector();\n  \n  return {\n    startRender: () => {\n      const start = performance.now();\n      return () => {\n        const end = performance.now();\n        collector.recordComponentRender(componentName, end - start);\n      };\n    },\n    \n    recordUserAction: (action: string, userId?: string, spaceId?: string) => {\n      if (userId) {\n        collector.recordUserEngagement(action, userId, spaceId);\n      }\n    },\n    \n    recordFeatureUsage: (feature: string, userId?: string) => {\n      if (userId) {\n        collector.recordFeatureUsage(`${componentName}:${feature}`, userId);\n      }\n    }\n  };\n}\n\n// API Performance Wrapper\nexport function withApiMetrics<T extends (..._args: any[]) => Promise<any>>(\n  fn: T,\n  endpoint: string,\n  method: string = 'GET'\n): T {\n  return (async (..._args: any[]) => {\n    const collector = getGlobalCollector();\n    const start = performance.now();\n    let status = 200;\n    \n    try {\n      const result = await fn(..._args);\n      return result;\n    } catch (error: any) {\n      status = error.response?.status || 500;\n      throw error;\n    } finally {\n      const end = performance.now();\n      collector.recordApiCall(endpoint, method, end - start, status);\n    }\n  }) as T;\n}\n\n// Database Query Performance Wrapper\nexport function withDatabaseMetrics<T extends (...args: any[]) => Promise<any>>(\n  fn: T,\n  _queryType: string\n): T {\n  return (async (..._args: any[]) => {\n    const collector = getGlobalCollector();\n    const start = performance.now();\n    let success = true;\n    \n    try {\n      const result = await fn(..._args);\n      return result;\n    } catch (error) {\n      success = false;\n      throw error;\n    } finally {\n      const end = performance.now();\n      collector.recordDatabaseQuery(_queryType, end - start, success);\n    }\n  }) as T;\n}\n\n// Hook for React components\nexport function usePerformanceMetrics() {\n  const [metrics, setMetrics] = useState<WebVitalsMetrics>({});\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setMetrics(performanceMonitor.getMetrics());\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return metrics;\n}\n\n// Enhanced hook for comprehensive metrics\nexport function useEnhancedPerformanceMetrics() {\n  const [metrics, setMetrics] = useState<EnhancedPerformanceMetric[]>([]);\n  const [summary, setSummary] = useState<Record<MetricType, any>>({} as any);\n\n  useEffect(() => {\n    const collector = getGlobalCollector();\n    const interval = setInterval(() => {\n      setMetrics(collector.getMetrics());\n      setSummary(collector.getMetricsSummary());\n    }, 5000); // Update every 5 seconds\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return { metrics, summary };\n}\n\n// Web Vitals reporting for Next.js\nexport function reportWebVitals(metric: any) {\n  const performanceMetric: PerformanceMetric = {\n    name: metric.name,\n    value: metric.value,\n    rating: performanceMonitor['getRating'](metric.name, metric.value),\n    timestamp: Date.now()\n  };\n\n  performanceMonitor['reportMetric'](performanceMetric);\n  \n  // Also record in enhanced collector\n  const collector = getGlobalCollector();\n  let metricType: MetricType;\n  \n  switch (metric.name) {\n    case 'LCP':\n      metricType = MetricType._FIRST_CONTENTFUL_PAINT;\n      break;\n    case 'CLS':\n      metricType = MetricType._CUMULATIVE_LAYOUT_SHIFT;\n      break;\n    case 'FCP':\n      metricType = MetricType._FIRST_CONTENTFUL_PAINT;\n      break;\n    default:\n      metricType = MetricType._PAGE_LOAD_TIME;\n  }\n  \n  collector.record({\n    type: metricType,\n    value: metric.value,\n    unit: 'ms',\n    labels: { \n      metric_name: metric.name,\n      rating: performanceMetric.rating,\n      page: typeof window !== 'undefined' ? window.location.pathname : 'unknown'\n    }\n  });\n}\n\n// Export convenience functions\nexport const recordMetric = (metric: Omit<EnhancedPerformanceMetric, 'id' | 'timestamp'>) => {\n  getGlobalCollector().record(metric);\n};\n\nexport const recordApiCall = (endpoint: string, method: string, responseTime: number, status: number) => {\n  getGlobalCollector().recordApiCall(endpoint, method, responseTime, status);\n};\n\nexport const recordUserAction = (action: string, userId: string, spaceId?: string) => {\n  getGlobalCollector().recordUserEngagement(action, userId, spaceId);\n};\n\nexport const recordFeatureUsage = (feature: string, userId: string) => {\n  getGlobalCollector().recordFeatureUsage(feature, userId);\n};\n\nexport const recordComponentRender = (component: string, renderTime: number) => {\n  getGlobalCollector().recordComponentRender(component, renderTime);\n};\n\nexport const recordIntegrationLatency = (integration: string, latency: number) => {\n  getGlobalCollector().recordIntegrationLatency(integration, latency);\n};\n\nexport const recordCacheHit = (cacheType: string, hit: boolean) => {\n  getGlobalCollector().recordCacheMetrics(hit ? 'hit' : 'miss', cacheType);\n};\n\nexport const recordDatabaseQuery = (query: string, duration: number, success: boolean) => {\n  getGlobalCollector().recordDatabaseQuery(query, duration, success);\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/permission-system.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'spaceRules' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":144,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":144,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Permission Cascading System\n *\n * Resolves permissions hierarchically: Space Rules ‚Üí User Role ‚Üí Tool Requirements\n * Ensures consistent permission handling across the unified interface\n */\n\nimport type { SpaceType, SpaceTypeRules } from './space-type-rules';\n\nexport type UserRole = 'owner' | 'admin' | 'moderator' | 'member' | 'guest';\n\nexport type Permission =\n  // Content permissions\n  | 'posts:create' | 'posts:edit' | 'posts:delete' | 'posts:pin'\n  | 'events:create' | 'events:edit' | 'events:delete' | 'events:manage'\n  | 'members:view' | 'members:invite' | 'members:remove' | 'members:promote'\n\n  // Tool permissions\n  | 'tools:view' | 'tools:install' | 'tools:configure' | 'tools:remove'\n\n  // Space permissions\n  | 'space:settings' | 'space:delete' | 'space:transfer'\n\n  // Data permissions\n  | 'data:export' | 'analytics:view' | 'moderation:access';\n\nexport interface UserPermissions {\n  id: string;\n  spaceId: string;\n  role: UserRole;\n  customPermissions?: Permission[];\n  restrictions?: Permission[];\n}\n\nexport interface ToolPermissions {\n  toolId: string;\n  requiredRole?: UserRole;\n  requiredPermissions?: Permission[];\n  restrictedInSpaceTypes?: SpaceType[];\n  specialRequirements?: string[];\n}\n\n/**\n * Base permission matrix for user roles\n */\nconst ROLE_PERMISSIONS: Record<UserRole, Permission[]> = {\n  owner: [\n    // All permissions\n    'posts:create', 'posts:edit', 'posts:delete', 'posts:pin',\n    'events:create', 'events:edit', 'events:delete', 'events:manage',\n    'members:view', 'members:invite', 'members:remove', 'members:promote',\n    'tools:view', 'tools:install', 'tools:configure', 'tools:remove',\n    'space:settings', 'space:delete', 'space:transfer',\n    'data:export', 'analytics:view', 'moderation:access'\n  ],\n\n  admin: [\n    'posts:create', 'posts:edit', 'posts:delete', 'posts:pin',\n    'events:create', 'events:edit', 'events:delete', 'events:manage',\n    'members:view', 'members:invite', 'members:remove', 'members:promote',\n    'tools:view', 'tools:install', 'tools:configure', 'tools:remove',\n    'space:settings',\n    'data:export', 'analytics:view', 'moderation:access'\n  ],\n\n  moderator: [\n    'posts:create', 'posts:edit', 'posts:delete', 'posts:pin',\n    'events:create', 'events:edit', 'events:delete',\n    'members:view', 'members:invite',\n    'tools:view',\n    'moderation:access'\n  ],\n\n  member: [\n    'posts:create', 'posts:edit',\n    'events:create',\n    'members:view',\n    'tools:view'\n  ],\n\n  guest: [\n    'members:view'\n  ]\n};\n\n/**\n * Space type permission modifications\n */\nconst SPACE_TYPE_PERMISSION_MODIFIERS: Record<SpaceType, {\n  restrictions: Permission[];\n  additions: Record<UserRole, Permission[]>;\n}> = {\n  student_organizations: {\n    restrictions: [],\n    additions: {\n      owner: [],\n      admin: [],\n      moderator: [],\n      member: ['events:create'], // Members can create events\n      guest: []\n    }\n  },\n\n  university_organizations: {\n    restrictions: ['space:delete'], // University orgs can't be deleted by users\n    additions: {\n      owner: ['data:export'], // Enhanced data access\n      admin: ['data:export'],\n      moderator: [],\n      member: [],\n      guest: []\n    }\n  },\n\n  greek_life_spaces: {\n    restrictions: ['members:view'], // Member info is more restricted\n    additions: {\n      owner: [],\n      admin: [],\n      moderator: [],\n      member: ['events:create'], // Members can plan social events\n      guest: []\n    }\n  },\n\n  residential_spaces: {\n    restrictions: ['space:delete', 'space:transfer'], // Housing managed spaces\n    additions: {\n      owner: [],\n      admin: ['tools:install'], // RAs can install maintenance tools\n      moderator: [],\n      member: ['tools:view'], // Residents can use booking tools\n      guest: []\n    }\n  }\n};\n\n/**\n * Resolve effective permissions for a user in a space\n */\nexport function resolveUserPermissions(\n  userPermissions: UserPermissions,\n  spaceType: SpaceType,\n  spaceRules: SpaceTypeRules\n): Permission[] {\n  // Start with base role permissions\n  let effectivePermissions = [...ROLE_PERMISSIONS[userPermissions.role]];\n\n  // Apply space type modifications\n  const spaceModifiers = SPACE_TYPE_PERMISSION_MODIFIERS[spaceType];\n\n  // Add space-type specific permissions\n  const additionalPermissions = spaceModifiers.additions[userPermissions.role] || [];\n  effectivePermissions.push(...additionalPermissions);\n\n  // Remove space-type restrictions\n  effectivePermissions = effectivePermissions.filter(\n    permission => !spaceModifiers.restrictions.includes(permission)\n  );\n\n  // Apply custom permissions (additions)\n  if (userPermissions.customPermissions) {\n    effectivePermissions.push(...userPermissions.customPermissions);\n  }\n\n  // Apply restrictions (removals)\n  if (userPermissions.restrictions) {\n    effectivePermissions = effectivePermissions.filter(\n      permission => !userPermissions.restrictions!.includes(permission)\n    );\n  }\n\n  // Remove duplicates\n  return [...new Set(effectivePermissions)];\n}\n\n/**\n * Check if user has specific permission\n */\nexport function hasPermission(\n  userPermissions: UserPermissions,\n  spaceType: SpaceType,\n  spaceRules: SpaceTypeRules,\n  requiredPermission: Permission\n): boolean {\n  const effectivePermissions = resolveUserPermissions(userPermissions, spaceType, spaceRules);\n  return effectivePermissions.includes(requiredPermission);\n}\n\n/**\n * Check if user can use a specific tool\n */\nexport function canUseToolInSpace(\n  userPermissions: UserPermissions,\n  spaceType: SpaceType,\n  spaceRules: SpaceTypeRules,\n  toolPermissions: ToolPermissions\n): { canUse: boolean; reason?: string } {\n  // Check if tool is restricted in this space type\n  if (toolPermissions.restrictedInSpaceTypes?.includes(spaceType)) {\n    return {\n      canUse: false,\n      reason: `This tool is not available in ${spaceType.replace('_', ' ')} spaces`\n    };\n  }\n\n  // Check minimum role requirement\n  if (toolPermissions.requiredRole) {\n    const roleHierarchy: Record<UserRole, number> = {\n      guest: 0,\n      member: 1,\n      moderator: 2,\n      admin: 3,\n      owner: 4\n    };\n\n    if (roleHierarchy[userPermissions.role] < roleHierarchy[toolPermissions.requiredRole]) {\n      return {\n        canUse: false,\n        reason: `This tool requires ${toolPermissions.requiredRole} role or higher`\n      };\n    }\n  }\n\n  // Check specific permission requirements\n  if (toolPermissions.requiredPermissions) {\n    const effectivePermissions = resolveUserPermissions(userPermissions, spaceType, spaceRules);\n\n    for (const requiredPermission of toolPermissions.requiredPermissions) {\n      if (!effectivePermissions.includes(requiredPermission)) {\n        return {\n          canUse: false,\n          reason: `Missing required permission: ${requiredPermission}`\n        };\n      }\n    }\n  }\n\n  return { canUse: true };\n}\n\n/**\n * Get permission summary for debugging/admin interface\n */\nexport function getPermissionSummary(\n  userPermissions: UserPermissions,\n  spaceType: SpaceType,\n  spaceRules: SpaceTypeRules\n): {\n  role: UserRole;\n  basePermissions: Permission[];\n  spaceModifications: {\n    additions: Permission[];\n    restrictions: Permission[];\n  };\n  customModifications: {\n    additions: Permission[];\n    restrictions: Permission[];\n  };\n  effectivePermissions: Permission[];\n} {\n  const basePermissions = ROLE_PERMISSIONS[userPermissions.role];\n  const spaceModifiers = SPACE_TYPE_PERMISSION_MODIFIERS[spaceType];\n  const effectivePermissions = resolveUserPermissions(userPermissions, spaceType, spaceRules);\n\n  return {\n    role: userPermissions.role,\n    basePermissions,\n    spaceModifications: {\n      additions: spaceModifiers.additions[userPermissions.role] || [],\n      restrictions: spaceModifiers.restrictions\n    },\n    customModifications: {\n      additions: userPermissions.customPermissions || [],\n      restrictions: userPermissions.restrictions || []\n    },\n    effectivePermissions\n  };\n}\n\n/**\n * Tool permission presets for common tool types\n */\nexport const TOOL_PERMISSION_PRESETS: Record<string, ToolPermissions> = {\n  // Project management tools\n  project_management: {\n    toolId: 'generic_project_management',\n    requiredRole: 'member',\n    requiredPermissions: ['posts:create', 'events:create']\n  },\n\n  // Administrative tools\n  administrative: {\n    toolId: 'generic_administrative',\n    requiredRole: 'admin',\n    requiredPermissions: ['space:settings', 'data:export']\n  },\n\n  // Social planning tools\n  social_planning: {\n    toolId: 'generic_social_planning',\n    requiredRole: 'member',\n    requiredPermissions: ['events:create']\n  },\n\n  // Resource booking tools\n  resource_booking: {\n    toolId: 'generic_resource_booking',\n    requiredRole: 'member',\n    restrictedInSpaceTypes: ['greek_life_spaces'] // May not be relevant for Greek life\n  },\n\n  // Member development tools\n  member_development: {\n    toolId: 'generic_member_development',\n    requiredRole: 'moderator',\n    requiredPermissions: ['members:view']\n  },\n\n  // Analytics tools\n  analytics: {\n    toolId: 'generic_analytics',\n    requiredRole: 'admin',\n    requiredPermissions: ['analytics:view', 'data:export']\n  }\n};\n\n/**\n * Get tool permissions based on tool type\n */\nexport function getToolPermissions(toolType: string, customPermissions?: Partial<ToolPermissions>): ToolPermissions {\n  const preset = TOOL_PERMISSION_PRESETS[toolType];\n\n  if (!preset) {\n    // Default permissions for unknown tool types\n    return {\n      toolId: 'unknown',\n      requiredRole: 'member',\n      requiredPermissions: ['tools:view'],\n      ...customPermissions\n    };\n  }\n\n  return {\n    ...preset,\n    ...customPermissions\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/platform-integration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/platform-wide-search.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/production-auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'admin' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Production-safe authentication service\n * NO DEVELOPMENT BYPASSES - PRODUCTION ONLY\n */\n\nimport * as admin from 'firebase-admin';\nimport { getAuth } from 'firebase-admin/auth';\nimport { NextRequest } from 'next/server';\nimport { currentEnvironment } from './env';\nimport { captureError, LogLevel } from './error-monitoring';\nimport { logSecurityEvent } from './structured-logger';\n\n/**\n * CRITICAL: List of FORBIDDEN tokens that should NEVER work in any environment\n */\nconst FORBIDDEN_TOKENS = [\n  'test-token',\n  'dev-token',\n  'DEV_MODE',\n  'development-token',\n  'bypass-token',\n  'admin-token',\n  'debug-token'\n] as const;\n\n/**\n * Production authentication error types\n */\nexport class ProductionAuthError extends Error {\n  constructor(\n    message: string,\n    public readonly _code: string,\n    public readonly _statusCode: number = 401\n  ) {\n    super(message);\n    this.name = 'ProductionAuthError';\n  }\n}\n\n/**\n * Validated token result\n */\nexport interface ValidatedToken {\n  uid: string;\n  email: string;\n  emailVerified: boolean;\n  customClaims?: Record<string, any>;\n  iat: number;\n  exp: number;\n}\n\n/**\n * PRODUCTION-SAFE token validation - NO BYPASSES ALLOWED\n */\nexport async function validateProductionToken(\n  token: string,\n  request: NextRequest,\n  context?: {\n    operation?: string;\n    requireEmailVerification?: boolean;\n  }\n): Promise<ValidatedToken> {\n  const startTime = Date.now();\n  const requestId = request.headers.get('x-request-id') || 'unknown';\n  \n  // SECURITY: Check for forbidden development tokens\n  if (FORBIDDEN_TOKENS.includes(token as any)) {\n    const securityIncident = {\n      severity: 'CRITICAL',\n      type: 'forbidden_token_attempt',\n      token: token,\n      environment: currentEnvironment,\n      action: context?.operation,\n      requestId,\n      ip: request.headers.get('x-forwarded-for') ||\n          request.headers.get('x-real-ip') ||\n          request.headers.get('cf-connecting-ip') || undefined,\n      userAgent: request.headers.get('user-agent') || undefined,\n      timestamp: new Date().toISOString()\n    };\n\n    // Log security incident\n    \n    // Send to monitoring\n    await logSecurityEvent('bypass_attempt', {\n      requestId,\n      ip: securityIncident.ip,\n      userAgent: securityIncident.userAgent,\n      action: context?.operation || 'token_validation',\n      tags: {\n        severity: 'critical',\n        tokenType: 'forbidden',\n        environment: currentEnvironment\n      },\n      extra: securityIncident\n    });\n\n    // Capture in error monitoring\n    await captureError(new Error('Forbidden token attempted in production'), {\n      level: LogLevel.ERROR,\n      tags: {\n        security_incident: 'true',\n        forbidden_token: 'true',\n        environment: currentEnvironment\n      },\n      extra: securityIncident\n    });\n\n    throw new ProductionAuthError(\n      'Authentication failed',\n      'FORBIDDEN_TOKEN',\n      403\n    );\n  }\n\n  // SECURITY: Basic token format validation\n  if (!token || typeof token !== 'string' || token.length < 10) {\n    throw new ProductionAuthError(\n      'Invalid token format',\n      'INVALID_FORMAT',\n      400\n    );\n  }\n\n  // SECURITY: Check for suspicious patterns\n  const suspiciousPatterns = [\n    /dev_/i,\n    /test_/i,\n    /debug/i,\n    /bypass/i,\n    /admin_/i,\n    /mock/i\n  ];\n\n  for (const pattern of suspiciousPatterns) {\n    if (pattern.test(token)) {\n      await logSecurityEvent('bypass_attempt', {\n        requestId,\n        action: context?.operation || 'token_validation',\n        tags: {\n          severity: 'high',\n          pattern: pattern.toString(),\n          environment: currentEnvironment\n        }\n      });\n\n      throw new ProductionAuthError(\n        'Authentication failed',\n        'SUSPICIOUS_TOKEN',\n        403\n      );\n    }\n  }\n\n  try {\n    // Use Firebase Admin SDK for token validation\n    const auth = getAuth();\n    const decodedToken = await auth.verifyIdToken(token, true); // checkRevoked = true\n\n    // Additional security checks\n    const now = Math.floor(Date.now() / 1000);\n    \n    // Check token expiration with buffer\n    if (decodedToken.exp <= now) {\n      throw new ProductionAuthError(\n        'Token expired',\n        'TOKEN_EXPIRED',\n        401\n      );\n    }\n\n    // Check token age (not too old)\n    const maxAge = 24 * 60 * 60; // 24 hours\n    if (now - decodedToken.iat > maxAge) {\n      throw new ProductionAuthError(\n        'Token too old',\n        'TOKEN_TOO_OLD',\n        401\n      );\n    }\n\n    // Require email verification if specified\n    if (context?.requireEmailVerification && !decodedToken.email_verified) {\n      throw new ProductionAuthError(\n        'Email verification required',\n        'EMAIL_NOT_VERIFIED',\n        403\n      );\n    }\n\n    // Validate required fields\n    if (!decodedToken.id || !decodedToken.email) {\n      throw new ProductionAuthError(\n        'Invalid token claims',\n        'INVALID_CLAIMS',\n        400\n      );\n    }\n\n    const duration = Date.now() - startTime;\n    \n    // Log successful validation (but not the token itself)\n    await logSecurityEvent('invalid_token', {\n      requestId,\n      userId: decodedToken.id,\n      action: context?.operation || 'token_validation',\n      tags: {\n        result: 'success',\n        duration: duration.toString()\n      }\n    });\n\n    return {\n      uid: decodedToken.id,\n      email: decodedToken.email!,\n      emailVerified: decodedToken.email_verified || false,\n      customClaims: decodedToken.customClaims,\n      iat: decodedToken.iat,\n      exp: decodedToken.exp\n    };\n\n  } catch (error) {\n    const duration = Date.now() - startTime;\n\n    // Log failed validation\n    await logSecurityEvent('invalid_token', {\n      requestId,\n      action: context?.operation || 'token_validation',\n      tags: {\n        result: 'failure',\n        duration: duration.toString(),\n        errorType: error instanceof Error ? error.constructor.name : 'unknown'\n      }\n    });\n\n    // Handle Firebase-specific errors\n    if (error && typeof error === 'object' && 'code' in error) {\n      const firebaseError = error as { code: string; message: string };\n      \n      switch (firebaseError.code) {\n        case 'auth/id-token-expired':\n          throw new ProductionAuthError('Token expired', 'TOKEN_EXPIRED', 401);\n        case 'auth/id-token-revoked':\n          throw new ProductionAuthError('Token revoked', 'TOKEN_REVOKED', 401);\n        case 'auth/invalid-id-token':\n          throw new ProductionAuthError('Invalid token', 'INVALID_TOKEN', 401);\n        case 'auth/user-disabled':\n          throw new ProductionAuthError('Account disabled', 'ACCOUNT_DISABLED', 403);\n        case 'auth/user-not-found':\n          throw new ProductionAuthError('Account not found', 'ACCOUNT_NOT_FOUND', 404);\n        default:\n          throw new ProductionAuthError('Authentication failed', 'AUTH_FAILED', 401);\n      }\n    }\n\n    // Re-throw ProductionAuthError as-is\n    if (error instanceof ProductionAuthError) {\n      throw error;\n    }\n\n    // Generic error\n    throw new ProductionAuthError('Authentication failed', 'AUTH_FAILED', 401);\n  }\n}\n\n/**\n * Extract and validate token from Authorization header\n */\nexport async function extractAndValidateToken(\n  request: NextRequest,\n  context?: {\n    operation?: string;\n    requireEmailVerification?: boolean;\n  }\n): Promise<ValidatedToken> {\n  const authHeader = request.headers.get('authorization');\n  \n  if (!authHeader) {\n    throw new ProductionAuthError(\n      'Authorization header required',\n      'MISSING_AUTH_HEADER',\n      401\n    );\n  }\n\n  if (!authHeader.startsWith('Bearer ')) {\n    throw new ProductionAuthError(\n      'Invalid authorization format',\n      'INVALID_AUTH_FORMAT',\n      401\n    );\n  }\n\n  const token = authHeader.substring(7).trim();\n  \n  if (!token) {\n    throw new ProductionAuthError(\n      'Token required',\n      'MISSING_TOKEN',\n      401\n    );\n  }\n\n  return validateProductionToken(token, request, context);\n}\n\n/**\n * PRODUCTION ONLY: No development features allowed\n */\nexport function isProductionEnvironment(): boolean {\n  // In production, this should ALWAYS return true\n  // Never allow development features in production builds\n  return process.env.NODE_ENV === 'production' || \n         process.env.VERCEL_ENV === 'production' ||\n         currentEnvironment === 'production';\n}\n\n/**\n * Security audit log for authentication events\n */\nexport async function auditAuthEvent(\n  event: 'success' | 'failure' | 'forbidden' | 'suspicious',\n  request: NextRequest,\n  context?: {\n    userId?: string;\n    operation?: string;\n    error?: string;\n    threats?: string;\n    securityLevel?: string;\n  }\n): Promise<void> {\n  const auditData = {\n    event,\n    timestamp: new Date().toISOString(),\n    environment: currentEnvironment,\n    requestId: request.headers.get('x-request-id') || undefined,\n    userId: context?.userId,\n    action: context?.operation,\n    ip: request.headers.get('x-forwarded-for') ||\n        request.headers.get('x-real-ip') ||\n        request.headers.get('cf-connecting-ip') || undefined,\n    userAgent: request.headers.get('user-agent') || undefined,\n    path: new URL(request.url).pathname,\n    error: context?.error\n  };\n\n  // Always log security events\n\n  // Send to structured logging\n  await logSecurityEvent('invalid_token', {\n    requestId: auditData.requestId || undefined,\n    userId: auditData.userId,\n    ip: auditData.ip || undefined,\n    userAgent: auditData.userAgent || undefined,\n    operation: auditData.operation || 'auth_event',\n    tags: {\n      authEvent: event,\n      environment: auditData.environment,\n      path: auditData.path\n    },\n    extra: auditData\n  });\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/profile-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/profile-security.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'ProfileSystem' is not defined.","line":157,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":157,"endColumn":25},{"ruleId":"no-undef","severity":2,"message":"'ProfileSystem' is not defined.","line":363,"column":39,"nodeType":"Identifier","messageId":"undef","endLine":363,"endColumn":52}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Profile Security Layer\n * Implements the security architecture for the profile vertical slice\n * Including connection permissions, ghost mode, and privacy controls\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { dbAdmin } from './firebase-admin';\nimport { logger } from './structured-logger';\nimport { getUserId, type AuthenticatedRequest } from './middleware';\nimport * as admin from 'firebase-admin';\n\n// Connection visibility levels from PRD\nexport enum ConnectionVisibility {\n  GHOST = 'ghost',           // Invisible\n  FRIENDS = 'friends',       // Friends only\n  CONNECTIONS = 'connections', // Visible in shared contexts\n  CAMPUS = 'campus'          // All students\n}\n\n// Connection types from two-tier model\nexport enum ConnectionType {\n  NONE = 'none',\n  CONNECTION = 'connection', // Automatic from shared spaces\n  FRIEND = 'friend'          // Intentional with mutual approval\n}\n\n// Profile field access levels\nexport interface FieldAccessControl {\n  field: string;\n  requiredLevel: ConnectionType;\n  respectsGhostMode: boolean;\n}\n\n// Complete field access matrix\nexport const PROFILE_FIELD_ACCESS: FieldAccessControl[] = [\n  // Always visible (even in ghost mode)\n  { field: 'name', requiredLevel: ConnectionType.NONE, respectsGhostMode: false },\n  { field: 'year', requiredLevel: ConnectionType.NONE, respectsGhostMode: false },\n  { field: 'major', requiredLevel: ConnectionType.NONE, respectsGhostMode: false },\n  { field: 'pronouns', requiredLevel: ConnectionType.NONE, respectsGhostMode: false },\n\n  // Connection level access\n  { field: 'profile', requiredLevel: ConnectionType.CONNECTION, respectsGhostMode: true },\n  { field: 'spaceContext', requiredLevel: ConnectionType.CONNECTION, respectsGhostMode: true },\n  { field: 'availability', requiredLevel: ConnectionType.CONNECTION, respectsGhostMode: true },\n  { field: 'vibeStatus', requiredLevel: ConnectionType.CONNECTION, respectsGhostMode: true },\n\n  // Friend level access\n  { field: 'schedule', requiredLevel: ConnectionType.FRIEND, respectsGhostMode: true },\n  { field: 'fullProfile', requiredLevel: ConnectionType.FRIEND, respectsGhostMode: true },\n  { field: 'messaging', requiredLevel: ConnectionType.FRIEND, respectsGhostMode: true },\n  { field: 'beacon', requiredLevel: ConnectionType.FRIEND, respectsGhostMode: true },\n  { field: 'photoCarousel', requiredLevel: ConnectionType.FRIEND, respectsGhostMode: true }\n];\n\n/**\n * Campus isolation enforcement\n * All queries must be scoped to the user's campus\n */\nexport async function enforceCompusIsolation(userId: string): Promise<string> {\n  try {\n    const userDoc = await dbAdmin.collection('users').doc(userId).get();\n    if (!userDoc.exists) {\n      throw new Error('User not found');\n    }\n\n    const userData = userDoc.data();\n    // For vBETA, hardcoded to UB Buffalo\n    return userData?.campusId || 'ub-buffalo';\n  } catch (error) {\n    logger.error('Campus isolation check failed', { userId, error: error instanceof Error ? error.message : String(error) });\n    // Default to UB for vBETA\n    return 'ub-buffalo';\n  }\n}\n\n/**\n * Check connection type between two users\n */\nexport async function getConnectionType(\n  viewerId: string,\n  targetId: string\n): Promise<ConnectionType> {\n  if (viewerId === targetId) {\n    return ConnectionType.FRIEND; // Users always have full access to their own profile\n  }\n\n  try {\n    // Check if they are friends\n    const friendshipQuery = await dbAdmin\n      .collection('friendships')\n      .where('users', 'array-contains', viewerId)\n      .get();\n\n    const isFriend = friendshipQuery.docs.some(doc => {\n      const data = doc.data();\n      return data.users.includes(targetId) && data.status === 'accepted';\n    });\n\n    if (isFriend) {\n      return ConnectionType.FRIEND;\n    }\n\n    // Check if they share any spaces (automatic connection)\n    const viewerSpaces = await dbAdmin\n      .collection('spaces')\n      .where('members', 'array-contains', viewerId)\n      .where('isActive', '==', true)\n      .get();\n\n    const viewerSpaceIds = viewerSpaces.docs.map(doc => doc.id);\n\n    const targetSpaces = await dbAdmin\n      .collection('spaces')\n      .where('members', 'array-contains', targetId)\n      .where('isActive', '==', true)\n      .get();\n\n    const targetSpaceIds = targetSpaces.docs.map(doc => doc.id);\n\n    const hasSharedSpace = viewerSpaceIds.some(id => targetSpaceIds.includes(id));\n\n    if (hasSharedSpace) {\n      return ConnectionType.CONNECTION;\n    }\n\n    return ConnectionType.NONE;\n  } catch (error) {\n    logger.error('Connection type check failed', { userId: viewerId, targetId, error: error instanceof Error ? error.message : String(error) });\n    return ConnectionType.NONE;\n  }\n}\n\n/**\n * Check if user has ghost mode enabled\n */\nexport async function isGhostModeActive(userId: string): Promise<boolean> {\n  try {\n    const userDoc = await dbAdmin.collection('users').doc(userId).get();\n    if (!userDoc.exists) {\n      return false;\n    }\n\n    const userData = userDoc.data();\n    return userData?.privacy?.ghostMode === true;\n  } catch (error) {\n    logger.error('Ghost mode check failed', { userId, error: error instanceof Error ? error.message : String(error) });\n    return false;\n  }\n}\n\n/**\n * Filter profile data based on connection level and privacy settings\n */\nexport async function filterProfileData(\n  profile: ProfileSystem,\n  viewerId: string,\n  targetId: string\n): Promise<FilteredProfile> {\n  if (viewerId === targetId) {\n    return profile as FilteredProfile;\n  }\n\n  const connectionType = await getConnectionType(viewerId, targetId);\n  const isGhost = await isGhostModeActive(targetId);\n\n  const profileRecord = profile as unknown as Record<string, unknown>;\n  const filteredRecord: Record<string, unknown> = {};\n\n  for (const control of PROFILE_FIELD_ACCESS) {\n    const fieldPath = control.field.split('.');\n    const sourceValue = getNestedField(profileRecord, fieldPath);\n\n    if (sourceValue === undefined) {\n      continue;\n    }\n\n    const hasConnectionLevel = connectionType >= control.requiredLevel;\n    const ghostBlocked = isGhost && control.respectsGhostMode && connectionType !== ConnectionType.FRIEND;\n\n    if (hasConnectionLevel && !ghostBlocked) {\n      setNestedField(filteredRecord, fieldPath, sourceValue);\n    }\n  }\n\n  filteredRecord._connectionType = connectionType;\n  filteredRecord._ghostModeActive = isGhost;\n\n  return filteredRecord as FilteredProfile;\n}\n\n/**\n * Rate limiting for profile operations\n */\nfunction getNestedField(source: Record<string, unknown>, path: string[]): unknown {\n  return path.reduce<unknown>((current, key) => {\n    if (!current || typeof current !== 'object') {\n      return undefined;\n    }\n    return (current as Record<string, unknown>)[key];\n  }, source);\n}\n\nfunction setNestedField(target: Record<string, unknown>, path: string[], value: unknown): void {\n  let current: Record<string, unknown> = target;\n\n  for (let index = 0; index < path.length - 1; index += 1) {\n    const key = path[index];\n    const existing = current[key];\n\n    if (!existing || typeof existing !== 'object') {\n      current[key] = {};\n    }\n\n    current = current[key] as Record<string, unknown>;\n  }\n\n  current[path[path.length - 1]] = value as unknown;\n}\n\n/**\n * Rate limiting for profile operations\n */\nconst rateLimitMap = new Map<string, { count: number; resetTime: number }>();\n\nexport function checkRateLimit(\n  userId: string,\n  action: string,\n  limit: number = 60,\n  windowMs: number = 60000\n): boolean {\n  const key = `${userId}:${action}`;\n  const now = Date.now();\n\n  const current = rateLimitMap.get(key);\n\n  if (!current || current.resetTime < now) {\n    rateLimitMap.set(key, {\n      count: 1,\n      resetTime: now + windowMs\n    });\n    return true;\n  }\n\n  if (current.count >= limit) {\n    return false;\n  }\n\n  current.count++;\n  return true;\n}\n\n/**\n * Audit logging for sensitive operations\n */\nexport async function auditLog(\n  userId: string,\n  action: string,\n  details: Record<string, unknown>\n): Promise<void> {\n  try {\n    await dbAdmin.collection('audit_logs').add({\n      userId,\n      operation: action,\n      details,\n      timestamp: admin.firestore.FieldValue.serverTimestamp(),\n      ip: details.ip || 'unknown',\n      userAgent: details.userAgent || 'unknown'\n    });\n  } catch (error) {\n    logger.error('Audit logging failed', { userId, error: error instanceof Error ? error.message : String(error) });\n  }\n}\n\n/**\n * Middleware for profile route protection\n */\nexport function withProfileSecurity(\n  handler: Function,\n  options: {\n    requireAuth?: boolean;\n    checkGhostMode?: boolean;\n    auditOperation?: string;\n    rateLimit?: { limit: number; window: number };\n  } = {}\n) {\n  return async (req: NextRequest | AuthenticatedRequest, context: Record<string, unknown>) => {\n    try {\n      // Check authentication if required\n      if (options.requireAuth) {\n        const userId = getUserId(req as AuthenticatedRequest);\n        if (!userId) {\n          return NextResponse.json(\n            { error: 'Authentication required' },\n            { status: 401 }\n          );\n        }\n\n        // Check rate limiting\n        if (options.rateLimit) {\n          const allowed = checkRateLimit(\n            userId,\n            options.auditOperation || 'profile_operation',\n            options.rateLimit.limit,\n            options.rateLimit.window\n          );\n\n          if (!allowed) {\n            return NextResponse.json(\n              { error: 'Rate limit exceeded' },\n              { status: 429 }\n            );\n          }\n        }\n\n        // Enforce campus isolation\n        const campusId = await enforceCompusIsolation(userId);\n        req.headers.set('x-campus-id', campusId);\n\n        // Audit sensitive operations\n        if (options.auditOperation) {\n          await auditLog(userId, options.auditOperation, {\n            ip: req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip'),\n            userAgent: req.headers.get('user-agent'),\n            method: req.method,\n            url: req.url\n          });\n        }\n      }\n\n      // Execute the handler\n      return await handler(req, context);\n    } catch (error) {\n      logger.error('Profile security middleware error', { error: error instanceof Error ? error.message : String(error) });\n      return NextResponse.json(\n        { error: 'Internal server error' },\n        { status: 500 }\n      );\n    }\n  };\n}\n\n/**\n * Privacy control enforcement\n */\nexport interface PrivacySettings {\n  ghostMode: boolean;\n  visibilityLevel: ConnectionVisibility;\n  scheduleSharing: {\n    friends: boolean;\n    connections: boolean;\n  };\n  availabilityBroadcast: {\n    friends: boolean;\n    connections: boolean;\n    campus: boolean;\n  };\n  discoveryParticipation: boolean;\n  spaceActivityVisibility: Map<string, boolean>;\n}\n\nexport type FilteredProfile = Partial<ProfileSystem> & {\n  _connectionType?: ConnectionType;\n  _ghostModeActive?: boolean;\n};\n\nexport async function getPrivacySettings(userId: string): Promise<PrivacySettings> {\n  try {\n    const userDoc = await dbAdmin.collection('users').doc(userId).get();\n    if (!userDoc.exists) {\n      throw new Error('User not found');\n    }\n\n    const userData = userDoc.data();\n    const privacy = userData?.privacy || {};\n\n    return {\n      ghostMode: privacy.ghostMode || false,\n      visibilityLevel: privacy.visibilityLevel || ConnectionVisibility.CONNECTIONS,\n      scheduleSharing: {\n        friends: privacy.scheduleSharing?.friends !== false,\n        connections: privacy.scheduleSharing?.connections || false\n      },\n      availabilityBroadcast: {\n        friends: privacy.availabilityBroadcast?.friends !== false,\n        connections: privacy.availabilityBroadcast?.connections !== false,\n        campus: privacy.availabilityBroadcast?.campus || false\n      },\n      discoveryParticipation: privacy.discoveryParticipation !== false,\n      spaceActivityVisibility: new Map(Object.entries(privacy.spaceActivityVisibility || {}))\n    };\n  } catch (error) {\n    logger.error('Privacy settings fetch failed', { userId, error: error instanceof Error ? error.message : String(error) });\n    // Return default privacy settings\n    return {\n      ghostMode: false,\n      visibilityLevel: ConnectionVisibility.CONNECTIONS,\n      scheduleSharing: { friends: true, connections: false },\n      availabilityBroadcast: { friends: true, connections: true, campus: false },\n      discoveryParticipation: true,\n      spaceActivityVisibility: new Map()\n    };\n  }\n}\n\n/**\n * Connection permission checker\n */\nexport async function canViewField(\n  viewerId: string,\n  targetId: string,\n  fieldName: string\n): Promise<boolean> {\n  // User can always view their own fields\n  if (viewerId === targetId) {\n    return true;\n  }\n\n  const connectionType = await getConnectionType(viewerId, targetId);\n  const fieldControl = PROFILE_FIELD_ACCESS.find(f => f.field === fieldName);\n\n  if (!fieldControl) {\n    // Unknown field, deny by default\n    return false;\n  }\n\n  // Check connection level requirement\n  if (connectionType < fieldControl.requiredLevel) {\n    return false;\n  }\n\n  // Check ghost mode\n  if (fieldControl.respectsGhostMode) {\n    const isGhost = await isGhostModeActive(targetId);\n    if (isGhost && connectionType !== ConnectionType.FRIEND) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nconst ProfileSecurityService = {\n  enforceCompusIsolation,\n  getConnectionType,\n  isGhostModeActive,\n  filterProfileData,\n  checkRateLimit,\n  auditLog,\n  withProfileSecurity,\n  getPrivacySettings,\n  canViewField\n};\n\nexport default ProfileSecurityService;\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/profile-transformers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rate-limit-redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rate-limit-simple.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rate-limit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rate-limiter-redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rate-limiter.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'oneDayAgo' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":45,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * REAL Rate Limiting Implementation\n * Not just comments about rate limiting\n */\n\ninterface RateLimitEntry {\n  count: number;\n  firstAttempt: number;\n  lastAttempt: number;\n}\n\n// In-memory store (replace with Redis in production for distributed systems)\nconst rateLimitStore = new Map<string, RateLimitEntry>();\n\n// Admin-specific rate limit store (stricter limits)\nconst adminRateLimitStore = new Map<string, RateLimitEntry>();\n\n// Failed login attempts tracking\nconst failedLoginAttempts = new Map<string, number>();\n\n// Cleanup old entries every 5 minutes\nlet cleanupInterval: NodeJS.Timeout | null = null;\n\n// Only set up cleanup in Node.js environment (not browser)\nif (typeof process !== 'undefined' && process.versions && process.versions.node) {\n  cleanupInterval = setInterval(() => {\n    const now = Date.now();\n    const oneHourAgo = now - 60 * 60 * 1000;\n\n    // Clean up rate limit store\n    for (const [key, entry] of rateLimitStore.entries()) {\n      if (entry.lastAttempt < oneHourAgo) {\n        rateLimitStore.delete(key);\n      }\n    }\n\n    // Clean up admin rate limit store\n    for (const [key, entry] of adminRateLimitStore.entries()) {\n      if (entry.lastAttempt < oneHourAgo) {\n        adminRateLimitStore.delete(key);\n      }\n    }\n\n    // Clean up failed login attempts older than 24 hours\n    const oneDayAgo = now - 24 * 60 * 60 * 1000;\n    for (const [key, _] of failedLoginAttempts.entries()) {\n      // Since we don't store timestamps for failed logins,\n      // we'll clear all entries periodically\n      // This prevents indefinite memory growth\n      if (Math.random() > 0.9) { // 10% chance to clear old entries\n        failedLoginAttempts.delete(key);\n      }\n    }\n  }, 5 * 60 * 1000);\n\n  // Ensure interval is cleared on process exit\n  if (cleanupInterval) {\n    cleanupInterval.unref(); // Allow process to exit even with interval running\n  }\n}\n\n// Export cleanup function for testing or manual cleanup\nexport function stopRateLimiterCleanup(): void {\n  if (cleanupInterval) {\n    clearInterval(cleanupInterval);\n    cleanupInterval = null;\n  }\n}\n\n// Clear all rate limit data (useful for testing)\nexport function clearAllRateLimitData(): void {\n  rateLimitStore.clear();\n  adminRateLimitStore.clear();\n  failedLoginAttempts.clear();\n}\n\nexport interface RateLimitConfig {\n  windowMs: number;  // Time window in milliseconds\n  maxRequests: number;  // Max requests per window\n  identifier: string;  // Unique identifier (IP, userId, etc)\n  isAdmin?: boolean;  // Use stricter admin limits\n}\n\n/**\n * Check if request should be rate limited\n * @returns true if request should be blocked\n */\nexport function checkRateLimit(config: RateLimitConfig): {\n  limited: boolean;\n  remaining: number;\n  resetAt: number;\n} {\n  const { windowMs, maxRequests, identifier, isAdmin = false } = config;\n  const store = isAdmin ? adminRateLimitStore : rateLimitStore;\n  const now = Date.now();\n\n  const entry = store.get(identifier);\n\n  if (!entry) {\n    // First request\n    store.set(identifier, {\n      count: 1,\n      firstAttempt: now,\n      lastAttempt: now\n    });\n\n    return {\n      limited: false,\n      remaining: maxRequests - 1,\n      resetAt: now + windowMs\n    };\n  }\n\n  // Check if window has expired\n  if (now - entry.firstAttempt > windowMs) {\n    // Reset window\n    store.set(identifier, {\n      count: 1,\n      firstAttempt: now,\n      lastAttempt: now\n    });\n\n    return {\n      limited: false,\n      remaining: maxRequests - 1,\n      resetAt: now + windowMs\n    };\n  }\n\n  // Within window\n  if (entry.count >= maxRequests) {\n    // Rate limited\n    return {\n      limited: true,\n      remaining: 0,\n      resetAt: entry.firstAttempt + windowMs\n    };\n  }\n\n  // Increment counter\n  entry.count++;\n  entry.lastAttempt = now;\n  store.set(identifier, entry);\n\n  return {\n    limited: false,\n    remaining: maxRequests - entry.count,\n    resetAt: entry.firstAttempt + windowMs\n  };\n}\n\n/**\n * Track failed login attempt\n */\nexport function trackFailedLogin(identifier: string): number {\n  const current = failedLoginAttempts.get(identifier) || 0;\n  const newCount = current + 1;\n  failedLoginAttempts.set(identifier, newCount);\n\n  // Block after 5 failed attempts\n  if (newCount >= 5) {\n    console.error(`[SECURITY] Account locked after ${newCount} failed login attempts: ${identifier}`);\n  }\n\n  return newCount;\n}\n\n/**\n * Reset failed login attempts (on successful login)\n */\nexport function resetFailedLogins(identifier: string): void {\n  failedLoginAttempts.delete(identifier);\n}\n\n/**\n * Check if account is locked due to failed attempts\n */\nexport function isAccountLocked(identifier: string): boolean {\n  const attempts = failedLoginAttempts.get(identifier) || 0;\n  return attempts >= 5;\n}\n\n// Preset configurations\nexport const RATE_LIMITS = {\n  // General API endpoints\n  api: {\n    windowMs: 60 * 1000, // 1 minute\n    maxRequests: 60  // 60 requests per minute\n  },\n\n  // Authentication endpoints\n  auth: {\n    windowMs: 15 * 60 * 1000, // 15 minutes\n    maxRequests: 5  // 5 attempts per 15 minutes\n  },\n\n  // Admin API endpoints\n  adminApi: {\n    windowMs: 60 * 1000, // 1 minute\n    maxRequests: 30  // Stricter: 30 requests per minute\n  },\n\n  // Admin login\n  adminAuth: {\n    windowMs: 60 * 60 * 1000, // 1 hour\n    maxRequests: 3  // Only 3 admin login attempts per hour\n  },\n\n  // Magic link sending\n  magicLink: {\n    windowMs: 60 * 60 * 1000, // 1 hour\n    maxRequests: 3  // 3 magic links per hour\n  }\n};","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/real-time-feed-listeners.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":77,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":86}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { db } from '@hive/core';\nimport { collection, query, where, onSnapshot, orderBy, limit, Unsubscribe, Timestamp } from 'firebase/firestore';\nimport { logger } from './structured-logger';\nimport { firebaseCostMonitor, shouldProceedWithFirebaseOp } from './firebase-cost-monitor';\n\n// Types for real-time feed updates\nexport interface RealtimeFeedItem {\n  id: string;\n  type: 'post' | 'event' | 'ritual_start' | 'space_join' | 'milestone';\n  spaceId?: string;\n  content: {\n    title: string;\n    description?: string;\n    authorId?: string;\n    authorName?: string;\n    createdAt: Date;\n    [key: string]: any;\n  };\n  priority: number;\n  timestamp: number;\n}\n\nexport interface FeedUpdateCallback {\n  (items: RealtimeFeedItem[], updateType: 'added' | 'modified' | 'removed'): void;\n}\n\n/**\n * Real-time Feed Listener Manager\n * Replaces the old 15-minute polling system with instant Firebase updates\n */\nexport class RealtimeFeedManager {\n  private unsubscribers: Map<string, Unsubscribe> = new Map();\n  private isActive = true;\n  private userId: string;\n  private spaceIds: string[] = [];\n\n  constructor(userId: string) {\n    this.userId = userId;\n\n    // Pause listeners when tab is hidden (save Firebase costs)\n    document.addEventListener('visibilitychange', () => {\n      if (document.hidden) {\n        this.pauseNonCriticalListeners();\n      } else {\n        this.resumeListeners();\n      }\n    });\n\n    // Listen for emergency shutoff events\n    window.addEventListener('firebase-emergency-shutoff', () => {\n      logger.error('üö® Emergency shutoff received - destroying all listeners');\n      this.destroy();\n    });\n  }\n\n  /**\n   * Start listening for real-time feed updates\n   */\n  async startFeedListeners(userSpaceIds: string[], callback: FeedUpdateCallback): Promise<void> {\n    // COST CONTROL: Check if user can create listeners\n    if (!shouldProceedWithFirebaseOp(this.userId, 'listen')) {\n      logger.warn('‚ö†Ô∏è User exceeded listener limits, falling back to polling mode', { userId: this.userId });\n      return;\n    }\n\n    // COST CONTROL: Limit spaces to prevent listener explosion\n    this.spaceIds = userSpaceIds.slice(0, 5); // Reduced from 10 to 5 for cost control\n\n    logger.info('üî¥ Starting cost-controlled real-time feed listeners', {\n      userId: this.userId,\n      spaceCount: this.spaceIds.length,\n      costLimits: firebaseCostMonitor.getUserReadUsage(this.userId)\n    });\n\n    // Priority-based listener setup (most important first)\n    // 1. Listen to ritual activity (high priority)\n    this.setupRitualListener(callback);\n\n    // 2. Listen to new posts (medium priority, throttled)\n    this.setupThrottledPostsListener(callback);\n\n    // 3. Listen to live events (high priority when near)\n    this.setupEventsListener(callback);\n\n    // 4. Listen to space membership changes (low priority)\n    if (this.spaceIds.length <= 3) { // Only if few spaces\n      this.setupSpaceMembershipListener(callback);\n    }\n  }\n\n  /**\n   * Setup real-time posts listener\n   */\n  private setupPostsListener(callback: FeedUpdateCallback): void {\n    if (this.spaceIds.length === 0) return;\n\n    const postsQuery = query(\n      collection(db, 'spaces'),\n      where('id', 'in', this.spaceIds.slice(0, 10)), // Firestore 'in' limit\n      where('isActive', '==', true)\n    );\n\n    const unsubscribe = onSnapshot(postsQuery, (spacesSnapshot) => {\n      // Listen to posts in each space\n      spacesSnapshot.docs.forEach(spaceDoc => {\n        const spaceId = spaceDoc.id;\n        this.setupSpacePostsListener(spaceId, callback);\n      });\n    });\n\n    this.unsubscribers.set('posts', unsubscribe);\n  }\n\n  /**\n   * Throttled posts listener with cost controls\n   */\n  private setupThrottledPostsListener(callback: FeedUpdateCallback): void {\n    if (this.spaceIds.length === 0) return;\n\n    // COST CONTROL: Only listen to top 3 most active spaces\n    const prioritySpaces = this.spaceIds.slice(0, 3);\n\n    prioritySpaces.forEach(spaceId => {\n      this.setupSpacePostsListener(spaceId, callback);\n    });\n  }\n\n  /**\n   * Listen to posts within a specific space\n   */\n  private setupSpacePostsListener(spaceId: string, callback: FeedUpdateCallback): void {\n    const postsQuery = query(\n      collection(db, 'spaces', spaceId, 'posts'),\n      where('isDeleted', '==', false),\n      where('campusId', '==', 'ub-buffalo'), // Campus isolation\n      where('createdAt', '>', new Date(Date.now() - 24 * 60 * 60 * 1000)), // Last 24 hours\n      orderBy('createdAt', 'desc'),\n      limit(10)\n    );\n\n    // Register listener with cost monitor\n    const listenerId = `space-posts-${spaceId}`;\n    if (!firebaseCostMonitor.registerListener(this.userId, listenerId, spaceId)) {\n      logger.warn('‚ö†Ô∏è Cannot register posts listener - limit exceeded', { userId: this.userId, spaceId });\n      return;\n    }\n\n    const unsubscribe = onSnapshot(postsQuery, (snapshot) => {\n      // COST CONTROL: Track reads\n      if (!shouldProceedWithFirebaseOp(this.userId, 'read')) {\n        logger.warn('‚ö†Ô∏è User exceeded read limits - throttling posts listener', { userId: this.userId });\n        return;\n      }\n\n      const newItems: RealtimeFeedItem[] = [];\n\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n          const postData = change.doc.data();\n          const createdAt = postData.createdAt?.toDate() || new Date();\n\n          // COST CONTROL: Skip old posts (prevent flooding on initial load)\n          if (Date.now() - createdAt.getTime() > 2 * 60 * 1000) return; // Reduced to 2 minutes\n\n          newItems.push({\n            id: change.doc.id,\n            type: 'post',\n            spaceId,\n            content: {\n              title: postData.title || 'New Post',\n              description: postData.content,\n              authorId: postData.authorId,\n              authorName: postData.authorName,\n              createdAt,\n              reactions: postData.reactions || {},\n              toolId: postData.toolId\n            },\n            priority: this.calculateRealtimePriority(postData, createdAt),\n            timestamp: createdAt.getTime()\n          });\n        }\n      });\n\n      if (newItems.length > 0) {\n        logger.info('üìù New posts detected', { count: newItems.length, spaceId });\n        callback(newItems, 'added');\n      }\n    });\n\n    this.unsubscribers.set(`space-posts-${spaceId}`, unsubscribe);\n\n    // Cleanup function that unregisters from cost monitor\n    const originalUnsubscribe = unsubscribe;\n    this.unsubscribers.set(`space-posts-${spaceId}`, () => {\n      originalUnsubscribe();\n      firebaseCostMonitor.unregisterListener(this.userId, listenerId);\n    });\n  }\n\n  /**\n   * Setup real-time events listener\n   */\n  private setupEventsListener(callback: FeedUpdateCallback): void {\n    if (this.spaceIds.length === 0) return;\n\n    // Listen to events starting soon or recently started\n    const now = new Date();\n    const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);\n    const twoHoursFromNow = new Date(now.getTime() + 2 * 60 * 60 * 1000);\n\n    this.spaceIds.forEach(spaceId => {\n      const eventsQuery = query(\n        collection(db, 'spaces', spaceId, 'events'),\n        where('isDeleted', '==', false),\n        where('campusId', '==', 'ub-buffalo'),\n        where('startTime', '>', oneHourAgo),\n        where('startTime', '<=', twoHoursFromNow),\n        orderBy('startTime', 'asc'),\n        limit(5)\n      );\n\n      const unsubscribe = onSnapshot(eventsQuery, (snapshot) => {\n        const liveEvents: RealtimeFeedItem[] = [];\n\n        snapshot.docs.forEach((eventDoc) => {\n          const eventData = eventDoc.data();\n          const startTime = eventData.startTime?.toDate() || new Date();\n          const timeDiff = startTime.getTime() - now.getTime();\n\n          // Events starting in next 30 minutes get high priority\n          if (timeDiff > 0 && timeDiff <= 30 * 60 * 1000) {\n            liveEvents.push({\n              id: eventDoc.id,\n              type: 'event',\n              spaceId,\n              content: {\n                title: eventData.title,\n                description: eventData.description,\n                startTime,\n                endTime: eventData.endTime?.toDate(),\n                location: eventData.location,\n                createdAt: eventData.createdAt?.toDate() || startTime\n              },\n              priority: 95, // High priority for live events\n              timestamp: startTime.getTime()\n            });\n          }\n        });\n\n        if (liveEvents.length > 0) {\n          logger.info('üéâ Live events detected', { count: liveEvents.length });\n          callback(liveEvents, 'added');\n        }\n      });\n\n      this.unsubscribers.set(`events-${spaceId}`, unsubscribe);\n    });\n  }\n\n  /**\n   * Setup ritual activity listener\n   */\n  private setupRitualListener(callback: FeedUpdateCallback): void {\n    const ritualsQuery = query(\n      collection(db, 'rituals'),\n      where('status', 'in', ['active', 'scheduled']),\n      where('universities', 'array-contains', 'university_buffalo'),\n      orderBy('createdAt', 'desc'),\n      limit(5)\n    );\n\n    const unsubscribe = onSnapshot(ritualsQuery, (snapshot) => {\n      const ritualUpdates: RealtimeFeedItem[] = [];\n\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added' || change.type === 'modified') {\n          const ritualData = change.doc.data();\n          const updatedAt = ritualData.updatedAt?.toDate() || new Date();\n\n          // Only surface recent ritual changes\n          if (Date.now() - updatedAt.getTime() < 10 * 60 * 1000) { // Last 10 minutes\n            ritualUpdates.push({\n              id: change.doc.id,\n              type: 'ritual_start',\n              content: {\n                title: `üé≠ ${ritualData.title}`,\n                description: ritualData.description,\n                createdAt: updatedAt,\n                ritualType: ritualData.type,\n                participantCount: ritualData.stats?.totalParticipants || 0\n              },\n              priority: 90,\n              timestamp: updatedAt.getTime()\n            });\n          }\n        }\n      });\n\n      if (ritualUpdates.length > 0) {\n        logger.info('üé≠ Ritual updates detected', { count: ritualUpdates.length });\n        callback(ritualUpdates, 'added');\n      }\n    });\n\n    this.unsubscribers.set('rituals', unsubscribe);\n  }\n\n  /**\n   * Listen to space membership changes\n   */\n  private setupSpaceMembershipListener(callback: FeedUpdateCallback): void {\n    const membershipQuery = query(\n      collection(db, 'space_memberships'),\n      where('userId', '==', this.userId),\n      where('campusId', '==', 'ub-buffalo')\n    );\n\n    const unsubscribe = onSnapshot(membershipQuery, (snapshot) => {\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n          const membershipData = change.doc.data();\n          const spaceId = membershipData.spaceId;\n\n          // User joined a new space - start listening to its content\n          if (!this.spaceIds.includes(spaceId)) {\n            this.spaceIds.push(spaceId);\n            this.setupSpacePostsListener(spaceId, callback);\n\n            logger.info('‚ú® User joined new space, adding listeners', { spaceId });\n\n            // Notify about the space join\n            callback([{\n              id: `join-${spaceId}`,\n              type: 'space_join',\n              spaceId,\n              content: {\n                title: `Joined ${membershipData.spaceName}`,\n                description: 'You can now see posts and events from this space',\n                createdAt: new Date()\n              },\n              priority: 85,\n              timestamp: Date.now()\n            }], 'added');\n          }\n        }\n      });\n    });\n\n    this.unsubscribers.set('memberships', unsubscribe);\n  }\n\n  /**\n   * Calculate priority for real-time content\n   */\n  private calculateRealtimePriority(data: any, timestamp: Date): number {\n    let priority = 70; // Base priority\n\n    const ageInMinutes = (Date.now() - timestamp.getTime()) / (1000 * 60);\n\n    // Boost very recent content\n    if (ageInMinutes < 5) priority += 20;\n    else if (ageInMinutes < 15) priority += 15;\n    else if (ageInMinutes < 30) priority += 10;\n\n    // Boost tool shares\n    if (data.type === 'toolshare') priority += 10;\n\n    // Boost content with early engagement\n    const reactionCount = Object.values(data.reactions || {}).reduce((sum: number, count: any) => sum + count, 0);\n    if (reactionCount > 0) priority += Math.min(reactionCount * 2, 15);\n\n    return Math.min(priority, 100);\n  }\n\n  /**\n   * Pause non-critical listeners when tab is hidden\n   */\n  private pauseNonCriticalListeners(): void {\n    if (!this.isActive) return;\n\n    // Keep critical listeners active (DMs, rituals)\n    // Pause heavy listeners (posts, events) to save costs\n    this.spaceIds.forEach(spaceId => {\n      const postsUnsub = this.unsubscribers.get(`space-posts-${spaceId}`);\n      const eventsUnsub = this.unsubscribers.get(`events-${spaceId}`);\n\n      if (postsUnsub) {\n        postsUnsub();\n        this.unsubscribers.delete(`space-posts-${spaceId}`);\n      }\n      if (eventsUnsub) {\n        eventsUnsub();\n        this.unsubscribers.delete(`events-${spaceId}`);\n      }\n    });\n\n    logger.info('‚è∏Ô∏è Paused non-critical real-time listeners');\n  }\n\n  /**\n   * Resume listeners when tab becomes visible\n   */\n  private resumeListeners(): void {\n    if (!this.isActive) return;\n\n    // Restart paused listeners\n    this.spaceIds.forEach(spaceId => {\n      if (!this.unsubscribers.has(`space-posts-${spaceId}`)) {\n        // Restart with a no-op callback - the main callback will be re-established\n        this.setupSpacePostsListener(spaceId, () => {});\n      }\n    });\n\n    logger.info('‚ñ∂Ô∏è Resumed real-time listeners');\n  }\n\n  /**\n   * Stop all listeners and cleanup\n   */\n  destroy(): void {\n    this.isActive = false;\n\n    this.unsubscribers.forEach((unsubscribe, key) => {\n      unsubscribe();\n      logger.debug(`Unsubscribed from ${key}`);\n    });\n\n    this.unsubscribers.clear();\n    logger.info('üßπ Cleaned up all real-time feed listeners');\n  }\n}\n\n// Global registry for feed managers\nconst feedManagers = new Map<string, RealtimeFeedManager>();\n\nexport function getRealtimeFeedManager(userId: string): RealtimeFeedManager {\n  if (!feedManagers.has(userId)) {\n    feedManagers.set(userId, new RealtimeFeedManager(userId));\n  }\n  return feedManagers.get(userId)!;\n}\n\nexport function cleanupRealtimeFeedManager(userId: string): void {\n  const manager = feedManagers.get(userId);\n  if (manager) {\n    manager.destroy();\n    feedManagers.delete(userId);\n  }\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/real-time-feed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/realtime-optimization.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":248,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":248,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Real-time System Optimization & Performance Manager\n * Handles connection pooling, message batching, fallback systems, and performance monitoring\n */\n\nimport { logger } from './structured-logger';\nimport { sseRealtimeService, RealtimeMessage } from './sse-realtime-service';\nimport { realtimeService as firebaseRealtimeService } from './firebase-realtime';\n\ninterface ConnectionMetrics {\n  connectionId: string;\n  userId: string;\n  establishedAt: number;\n  messagesReceived: number;\n  messagesSent: number;\n  lastActivity: number;\n  averageLatency: number;\n  errorCount: number;\n  reconnectionCount: number;\n}\n\ninterface SystemMetrics {\n  totalConnections: number;\n  activeConnections: number;\n  messagesPerSecond: number;\n  averageLatency: number;\n  errorRate: number;\n  memoryUsage: number;\n  cpuUsage: number;\n  lastUpdated: number;\n}\n\ninterface MessageBatch {\n  id: string;\n  userId: string;\n  messages: RealtimeMessage[];\n  priority: 'low' | 'normal' | 'high' | 'urgent';\n  scheduledFor: number;\n  createdAt: number;\n  size: number;\n}\n\ninterface FallbackConfig {\n  enableFirebaseRealtime: boolean;\n  enablePolling: boolean;\n  pollingInterval: number;\n  maxRetries: number;\n  retryBackoff: number;\n  healthCheckInterval: number;\n}\n\nexport class RealtimeOptimizationManager {\n  private connectionMetrics: Map<string, ConnectionMetrics> = new Map();\n  private systemMetrics: SystemMetrics = {\n    totalConnections: 0,\n    activeConnections: 0,\n    messagesPerSecond: 0,\n    averageLatency: 0,\n    errorRate: 0,\n    memoryUsage: 0,\n    cpuUsage: 0,\n    lastUpdated: Date.now()\n  };\n\n  private messageBatches: Map<string, MessageBatch[]> = new Map();\n  private batchProcessor: NodeJS.Timeout | null = null;\n  private metricsCollector: NodeJS.Timeout | null = null;\n  private healthChecker: NodeJS.Timeout | null = null;\n\n  private fallbackConfig: FallbackConfig = {\n    enableFirebaseRealtime: true,\n    enablePolling: false,\n    pollingInterval: 5000,\n    maxRetries: 3,\n    retryBackoff: 1000,\n    healthCheckInterval: 30000\n  };\n\n  private performanceThresholds = {\n    maxLatency: 2000, // ms\n    maxErrorRate: 0.05, // 5%\n    maxMemoryUsage: 512, // MB\n    maxConnectionsPerUser: 3,\n    batchSize: 10,\n    batchTimeout: 1000 // ms\n  };\n\n  constructor() {\n    this.startOptimizationServices();\n  }\n\n  /**\n   * Start all optimization services\n   */\n  private startOptimizationServices(): void {\n    this.startMessageBatchProcessor();\n    this.startMetricsCollection();\n    this.startHealthMonitoring();\n    logger.info('Real-time optimization services started');\n  }\n\n  /**\n   * Connection Management & Pooling\n   */\n  public registerConnection(connectionId: string, userId: string): void {\n    const now = Date.now();\n    const existingConnections = Array.from(this.connectionMetrics.values())\n      .filter(metrics => metrics.userId === userId);\n\n    // Enforce connection limits per user\n    if (existingConnections.length >= this.performanceThresholds.maxConnectionsPerUser) {\n      const oldestConnection = existingConnections\n        .sort((a, b) => a.establishedAt - b.establishedAt)[0];\n      \n      this.closeConnection(oldestConnection.connectionId, 'connection_limit_exceeded');\n    }\n\n    this.connectionMetrics.set(connectionId, {\n      connectionId,\n      userId,\n      establishedAt: now,\n      messagesReceived: 0,\n      messagesSent: 0,\n      lastActivity: now,\n      averageLatency: 0,\n      errorCount: 0,\n      reconnectionCount: 0\n    });\n\n    this.updateSystemMetrics();\n    logger.info('Connection registered for optimization', { connectionId, userId });\n  }\n\n  public unregisterConnection(connectionId: string): void {\n    this.connectionMetrics.delete(connectionId);\n    this.updateSystemMetrics();\n    logger.info('Connection unregistered from optimization', { connectionId });\n  }\n\n  private closeConnection(connectionId: string, reason: string): void {\n    // This would be implemented to actually close the SSE connection\n    logger.info('Connection closed by optimization manager', { connectionId, reason });\n    this.unregisterConnection(connectionId);\n  }\n\n  /**\n   * Message Batching & Optimization\n   */\n  public async optimizeMessageDelivery(\n    userId: string,\n    messages: RealtimeMessage[]\n  ): Promise<void> {\n    // Sort messages by priority\n    const prioritizedMessages = this.prioritizeMessages(messages);\n    \n    // Check if we should batch or send immediately\n    if (this.shouldBatchMessages(userId, prioritizedMessages)) {\n      await this.addToBatch(userId, prioritizedMessages);\n    } else {\n      await this.sendImmediately(prioritizedMessages);\n    }\n  }\n\n  private prioritizeMessages(messages: RealtimeMessage[]): RealtimeMessage[] {\n    const priorityOrder = { 'urgent': 0, 'high': 1, 'normal': 2, 'low': 3 };\n    \n    return messages.sort((a, b) => {\n      const aPriority = priorityOrder[a.metadata.priority] ?? 2;\n      const bPriority = priorityOrder[b.metadata.priority] ?? 2;\n      return aPriority - bPriority;\n    });\n  }\n\n  private shouldBatchMessages(userId: string, messages: RealtimeMessage[]): boolean {\n    // Don't batch urgent messages\n    if (messages.some(msg => msg.metadata.priority === 'urgent')) {\n      return false;\n    }\n\n    // Check current system load\n    if (this.systemMetrics.messagesPerSecond > 100) {\n      return true; // Batch under high load\n    }\n\n    // Check user's current batch status\n    const userBatches = this.messageBatches.get(userId) || [];\n    return userBatches.length > 0; // Continue batching if already batching\n  }\n\n  private async addToBatch(userId: string, messages: RealtimeMessage[]): Promise<void> {\n    if (!this.messageBatches.has(userId)) {\n      this.messageBatches.set(userId, []);\n    }\n\n    const batches = this.messageBatches.get(userId)!;\n    const now = Date.now();\n\n    const newBatch: MessageBatch = {\n      id: `batch_${userId}_${now}`,\n      userId,\n      messages,\n      priority: this.getHighestPriority(messages),\n      scheduledFor: now + this.performanceThresholds.batchTimeout,\n      createdAt: now,\n      size: messages.length\n    };\n\n    batches.push(newBatch);\n    \n    // Enforce batch limits\n    if (batches.length > 10) {\n      await this.processBatch(batches.shift()!);\n    }\n  }\n\n  private getHighestPriority(messages: RealtimeMessage[]): 'low' | 'normal' | 'high' | 'urgent' {\n    const priorities = messages.map(msg => msg.metadata.priority);\n    if (priorities.includes('urgent')) return 'urgent';\n    if (priorities.includes('high')) return 'high';\n    if (priorities.includes('normal')) return 'normal';\n    return 'low';\n  }\n\n  private async sendImmediately(messages: RealtimeMessage[]): Promise<void> {\n    for (const message of messages) {\n      try {\n        await sseRealtimeService.sendMessage(message);\n        this.recordMessageSent(message);\n      } catch (error) {\n        await this.handleMessageFailure(message, error);\n      }\n    }\n  }\n\n  /**\n   * Batch Processing\n   */\n  private startMessageBatchProcessor(): void {\n    this.batchProcessor = setInterval(async () => {\n      await this.processPendingBatches();\n    }, 500); // Process every 500ms\n  }\n\n  private async processPendingBatches(): Promise<void> {\n    const now = Date.now();\n    const processPromises: Promise<void>[] = [];\n\n    for (const [userId, batches] of this.messageBatches.entries()) {\n      const readyBatches = batches.filter(batch => batch.scheduledFor <= now);\n      \n      for (const batch of readyBatches) {\n        processPromises.push(this.processBatch(batch));\n        \n        // Remove processed batch\n        const index = batches.indexOf(batch);\n        if (index > -1) {\n          batches.splice(index, 1);\n        }\n      }\n    }\n\n    if (processPromises.length > 0) {\n      await Promise.all(processPromises);\n    }\n  }\n\n  private async processBatch(batch: MessageBatch): Promise<void> {\n    try {\n      // Send all messages in batch\n      await Promise.all(\n        batch.messages.map(message => \n          sseRealtimeService.sendMessage(message)\n        )\n      );\n\n      batch.messages.forEach(message => this.recordMessageSent(message));\n      \n      logger.info('Batch processed successfully', {\n        metadata: {\n          batchId: batch.id,\n          messageCount: batch.messages.length\n        }\n      });\n    } catch (error) {\n      logger.error('Batch processing failed', {\n        error: error instanceof Error ? error.message : String(error),\n        metadata: {\n          batchId: batch.id,\n          messageCount: batch.messages.length\n        }\n      });\n      \n      // Handle individual message failures\n      for (const message of batch.messages) {\n        await this.handleMessageFailure(message, error);\n      }\n    }\n  }\n\n  /**\n   * Performance Monitoring\n   */\n  private startMetricsCollection(): void {\n    this.metricsCollector = setInterval(() => {\n      this.updateSystemMetrics();\n      this.analyzePerformance();\n    }, 5000); // Collect every 5 seconds\n  }\n\n  private updateSystemMetrics(): void {\n    const now = Date.now();\n    const connections = Array.from(this.connectionMetrics.values());\n\n    this.systemMetrics = {\n      totalConnections: connections.length,\n      activeConnections: connections.filter(c => now - c.lastActivity < 60000).length,\n      messagesPerSecond: this.calculateMessagesPerSecond(),\n      averageLatency: this.calculateAverageLatency(),\n      errorRate: this.calculateErrorRate(),\n      memoryUsage: this.getMemoryUsage(),\n      cpuUsage: this.getCpuUsage(),\n      lastUpdated: now\n    };\n  }\n\n  private calculateMessagesPerSecond(): number {\n    const now = Date.now();\n    const recentWindow = 60000; // 1 minute\n    \n    let messageCount = 0;\n    for (const metrics of this.connectionMetrics.values()) {\n      if (now - metrics.lastActivity < recentWindow) {\n        messageCount += metrics.messagesReceived + metrics.messagesSent;\n      }\n    }\n    \n    return messageCount / 60; // Messages per second over last minute\n  }\n\n  private calculateAverageLatency(): number {\n    const connections = Array.from(this.connectionMetrics.values());\n    if (connections.length === 0) return 0;\n    \n    const totalLatency = connections.reduce((sum, conn) => sum + conn.averageLatency, 0);\n    return totalLatency / connections.length;\n  }\n\n  private calculateErrorRate(): number {\n    const connections = Array.from(this.connectionMetrics.values());\n    if (connections.length === 0) return 0;\n    \n    const totalMessages = connections.reduce((sum, conn) => \n      sum + conn.messagesReceived + conn.messagesSent, 0);\n    const totalErrors = connections.reduce((sum, conn) => sum + conn.errorCount, 0);\n    \n    return totalMessages > 0 ? totalErrors / totalMessages : 0;\n  }\n\n  private getMemoryUsage(): number {\n    if (typeof process !== 'undefined' && process.memoryUsage) {\n      return process.memoryUsage().heapUsed / 1024 / 1024; // MB\n    }\n    return 0;\n  }\n\n  private getCpuUsage(): number {\n    // This is a simplified implementation\n    // In production, you'd use proper CPU monitoring\n    return 0;\n  }\n\n  private analyzePerformance(): void {\n    const metrics = this.systemMetrics;\n    \n    // Check latency\n    if (metrics.averageLatency > this.performanceThresholds.maxLatency) {\n      logger.warn('High latency detected', { metadata: { latency: metrics.averageLatency } });\n      this.handleHighLatency();\n    }\n    \n    // Check error rate\n    if (metrics.errorRate > this.performanceThresholds.maxErrorRate) {\n      logger.warn('High error rate detected', { metadata: { errorRate: metrics.errorRate } });\n      this.handleHighErrorRate();\n    }\n    \n    // Check memory usage\n    if (metrics.memoryUsage > this.performanceThresholds.maxMemoryUsage) {\n      logger.warn('High memory usage detected', { metadata: { memoryUsage: metrics.memoryUsage } });\n      this.handleHighMemoryUsage();\n    }\n  }\n\n  /**\n   * Health Monitoring & Fallbacks\n   */\n  private startHealthMonitoring(): void {\n    this.healthChecker = setInterval(async () => {\n      await this.performHealthCheck();\n    }, this.fallbackConfig.healthCheckInterval);\n  }\n\n  private async performHealthCheck(): Promise<void> {\n    try {\n      // Test SSE endpoint\n      const sseHealthy = await this.testSSEHealth();\n      \n      // Test Firebase Realtime\n      const firebaseHealthy = await this.testFirebaseHealth();\n      \n      if (!sseHealthy && !firebaseHealthy) {\n        logger.error('All real-time systems unhealthy, enabling polling fallback');\n        this.enablePollingFallback();\n      } else if (!sseHealthy && firebaseHealthy) {\n        logger.warn('SSE unhealthy, falling back to Firebase Realtime');\n        this.enableFirebaseFallback();\n      }\n      \n      logger.info('Health check completed', { metadata: { sseHealthy, firebaseHealthy } });\n    } catch (error) {\n      logger.error('Health check failed', { error: error instanceof Error ? error.message : String(error) });\n    }\n  }\n\n  private async testSSEHealth(): Promise<boolean> {\n    try {\n      // Simple health test - attempt to create a test connection\n      const testMessage = {\n        type: 'system' as const,\n        channel: 'health_check',\n        senderId: 'system',\n        content: { test: true },\n        metadata: {\n          timestamp: new Date().toISOString(),\n          priority: 'low' as const,\n          requiresAck: false,\n          retryCount: 0\n        }\n      };\n      \n      await sseRealtimeService.sendMessage(testMessage);\n      return true;\n    } catch (error) {\n      logger.error('SSE health check failed', { error: error instanceof Error ? error.message : String(error) });\n      return false;\n    }\n  }\n\n  private async testFirebaseHealth(): Promise<boolean> {\n    try {\n      if (!this.fallbackConfig.enableFirebaseRealtime) {\n        return false;\n      }\n      \n      // Test Firebase connection\n      await firebaseRealtimeService.sendMessage({\n        type: 'system',\n        channel: 'health_check',\n        senderId: 'system',\n        content: { test: true },\n        metadata: {\n          timestamp: new Date(),\n          priority: 'low',\n          requiresAck: false,\n          retryCount: 0\n        }\n      });\n      \n      return true;\n    } catch (error) {\n      logger.error('Firebase health check failed', { error: error instanceof Error ? error.message : String(error) });\n      return false;\n    }\n  }\n\n  /**\n   * Fallback Handling\n   */\n  private enableFirebaseFallback(): void {\n    // Switch message routing to Firebase Realtime Database\n    logger.info('Enabling Firebase Realtime fallback');\n  }\n\n  private enablePollingFallback(): void {\n    if (!this.fallbackConfig.enablePolling) {\n      this.fallbackConfig.enablePolling = true;\n      logger.info('Enabling polling fallback');\n      \n      // Start polling service\n      this.startPollingFallback();\n    }\n  }\n\n  private startPollingFallback(): void {\n    // Implementation would set up polling-based updates\n    logger.info('Polling fallback started');\n  }\n\n  /**\n   * Error Handling & Recovery\n   */\n  private async handleMessageFailure(message: RealtimeMessage, error: any): Promise<void> {\n    logger.error('Message delivery failed', {\n      id: message.id,\n      error: error instanceof Error ? error.message : String(error),\n      metadata: {\n        retryCount: message.metadata.retryCount\n      }\n    });\n\n    // Retry with backoff\n    if (message.metadata.retryCount < this.fallbackConfig.maxRetries) {\n      const delay = this.fallbackConfig.retryBackoff * Math.pow(2, message.metadata.retryCount);\n      \n      setTimeout(async () => {\n        const retryMessage = {\n          ...message,\n          metadata: {\n            ...message.metadata,\n            retryCount: message.metadata.retryCount + 1\n          }\n        };\n        \n        try {\n          await sseRealtimeService.sendMessage(retryMessage);\n          this.recordMessageSent(retryMessage);\n        } catch (retryError) {\n          await this.handleMessageFailure(retryMessage, retryError);\n        }\n      }, delay);\n    } else {\n      // Max retries exceeded, try fallback\n      await this.tryFallbackDelivery(message);\n    }\n  }\n\n  private async tryFallbackDelivery(message: RealtimeMessage): Promise<void> {\n    try {\n      if (this.fallbackConfig.enableFirebaseRealtime) {\n        await firebaseRealtimeService.sendMessage(message);\n        logger.info('Message delivered via Firebase fallback', { id: message.id });\n      } else {\n        logger.error('Message delivery completely failed', { id: message.id });\n      }\n    } catch (error) {\n      logger.error('Fallback delivery also failed', { id: message.id, error: error instanceof Error ? error.message : String(error) });\n    }\n  }\n\n  private handleHighLatency(): void {\n    // Implement latency reduction strategies\n    logger.info('Implementing latency reduction measures');\n    \n    // Increase batch timeout to reduce frequency\n    this.performanceThresholds.batchTimeout = Math.min(\n      this.performanceThresholds.batchTimeout * 1.2, \n      5000\n    );\n  }\n\n  private handleHighErrorRate(): void {\n    // Implement error rate reduction strategies\n    logger.info('Implementing error rate reduction measures');\n    \n    // Increase retry backoff\n    this.fallbackConfig.retryBackoff = Math.min(\n      this.fallbackConfig.retryBackoff * 1.5, \n      10000\n    );\n  }\n\n  private handleHighMemoryUsage(): void {\n    // Implement memory optimization\n    logger.info('Implementing memory optimization measures');\n    \n    // Clean up old metrics\n    this.cleanupOldMetrics();\n    \n    // Reduce batch sizes\n    this.performanceThresholds.batchSize = Math.max(\n      this.performanceThresholds.batchSize * 0.8, \n      5\n    );\n  }\n\n  private cleanupOldMetrics(): void {\n    const now = Date.now();\n    const maxAge = 24 * 60 * 60 * 1000; // 24 hours\n    \n    for (const [connectionId, metrics] of this.connectionMetrics.entries()) {\n      if (now - metrics.lastActivity > maxAge) {\n        this.connectionMetrics.delete(connectionId);\n      }\n    }\n  }\n\n  /**\n   * Utility Methods\n   */\n  private recordMessageSent(message: RealtimeMessage): void {\n    // Update metrics for sent messages\n    for (const metrics of this.connectionMetrics.values()) {\n      if (message.targetUsers?.includes(metrics.userId)) {\n        metrics.messagesSent++;\n        metrics.lastActivity = Date.now();\n      }\n    }\n  }\n\n  /**\n   * Public API\n   */\n  public getSystemMetrics(): SystemMetrics {\n    return { ...this.systemMetrics };\n  }\n\n  public getConnectionMetrics(connectionId: string): ConnectionMetrics | null {\n    return this.connectionMetrics.get(connectionId) || null;\n  }\n\n  public updateConfiguration(config: Partial<FallbackConfig>): void {\n    this.fallbackConfig = { ...this.fallbackConfig, ...config };\n    logger.info('Real-time optimization configuration updated', { metadata: { config } });\n  }\n\n  public async shutdown(): Promise<void> {\n    if (this.batchProcessor) {\n      clearInterval(this.batchProcessor);\n      this.batchProcessor = null;\n    }\n    \n    if (this.metricsCollector) {\n      clearInterval(this.metricsCollector);\n      this.metricsCollector = null;\n    }\n    \n    if (this.healthChecker) {\n      clearInterval(this.healthChecker);\n      this.healthChecker = null;\n    }\n    \n    // Process remaining batches\n    await this.processPendingBatches();\n    \n    logger.info('Real-time optimization manager shut down');\n  }\n}\n\n// Export singleton instance\nexport const realtimeOptimizationManager = new RealtimeOptimizationManager();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/redis-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/ritual-templates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rituals-framework.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ritualId' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":524,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":524,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ritual' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":524,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":524,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { dbAdmin } from '@/lib/firebase-admin';\n\n/**\n * HIVE Rituals Framework - Platform-Wide Experiences\n * \n * Philosophy: Create genuine campus culture through shared moments that feel\n * organic, meaningful, and uniquely HIVE. Not gamification - but genuine\n * community formation through collective experiences.\n */\n\n// Core ritual types\nexport type RitualType = \n  | 'onboarding'        // Week 1-2: First experiences\n  | 'seasonal'          // Recurring campus moments\n  | 'achievement'       // Milestone celebrations\n  | 'community'         // Space interactions\n  | 'creative'          // Tool/content creation\n  | 'emergency'         // Spontaneous campus-wide moments\n  | 'legacy';           // Long-term campus traditions\n\n// Ritual status lifecycle\nexport type RitualStatus = \n  | 'draft'             // Being designed\n  | 'scheduled'         // Planned for future\n  | 'active'            // Currently running\n  | 'completed'         // Finished successfully\n  | 'paused'            // Temporarily halted\n  | 'cancelled'         // Ended without completion\n  | 'archived';         // Historical record\n\n// Participation requirement types\nexport type ParticipationType = \n  | 'individual'        // Single user actions\n  | 'collective'        // Group achievements\n  | 'progressive'       // Building over time\n  | 'competitive'       // Space vs space\n  | 'collaborative'     // Cross-space cooperation\n  | 'creative'          // Content/tool creation\n  | 'social';           // Interaction-based\n\n// Feature unlock scopes\nexport type UnlockScope = \n  | 'user'              // Individual user unlock\n  | 'space'             // Entire space unlock\n  | 'campus'            // University-wide unlock\n  | 'platform';         // All universities unlock\n\n/**\n * Core Ritual Definition\n */\nexport interface Ritual {\n  id: string;\n  \n  // Identity\n  name: string;\n  title: string;                    // Display title\n  description: string;\n  tagline: string;                  // Short memorable phrase\n  \n  // Classification\n  type: RitualType;\n  category: string;                 // Custom category for grouping\n  tags: string[];\n  \n  // Timing\n  status: RitualStatus;\n  startTime: Date;\n  endTime?: Date;\n  duration?: number;                // Minutes for timed rituals\n  timezone: string;                 // Campus timezone\n  \n  // Scope\n  universities: string[];           // Which campuses participate\n  isGlobal: boolean;               // Cross-campus ritual\n  \n  // Participation\n  participationType: ParticipationType;\n  maxParticipants?: number;\n  minParticipants?: number;\n  requiresInvitation: boolean;\n  \n  // Requirements\n  prerequisites: {\n    minSpaceMemberships?: number;\n    requiredFeatures?: string[];\n    completedRituals?: string[];\n    accountAge?: number;            // Days since signup\n    academicStatus?: string[];      // freshman, sophomore, etc.\n  };\n  \n  // Mechanics\n  actions: RitualAction[];\n  milestones: RitualMilestone[];\n  rewards: RitualReward[];\n  \n  // Features to unlock\n  featureUnlocks: FeatureUnlock[];\n  \n  // Analytics\n  metrics: {\n    participationRate: number;\n    completionRate: number;\n    engagementScore: number;\n    socialImpact: number;\n  };\n  \n  // Metadata\n  createdBy: string;\n  createdAt: Date;\n  updatedAt: Date;\n  version: number;\n}\n\n/**\n * Ritual Action - Something participants can do\n */\nexport interface RitualAction {\n  id: string;\n  type: 'post' | 'join_space' | 'create_tool' | 'interact' | 'vote' | 'share' | 'comment' | 'attend';\n  name: string;\n  description: string;\n  \n  // Requirements\n  isRequired: boolean;\n  weight: number;                   // Contribution to completion (0-100)\n  \n  // Constraints\n  maxOccurrences?: number;          // How many times can be done\n  timeLimit?: number;               // Minutes to complete\n  \n  // Context\n  targetType?: string;              // What to interact with\n  requiredContent?: string[];       // Keywords/tags required\n  \n  // Validation\n  validationRules: {\n    minLength?: number;\n    requiresMedia?: boolean;\n    mustMentionUsers?: boolean;\n    bannedWords?: string[];\n  };\n}\n\n/**\n * Ritual Milestone - Progress checkpoints\n */\nexport interface RitualMilestone {\n  id: string;\n  name: string;\n  description: string;\n  \n  // Criteria\n  participantThreshold: number;     // Number of participants needed\n  progressThreshold: number;        // Percentage complete (0-100)\n  timeThreshold?: Date;             // Must be reached by this time\n  \n  // Rewards\n  unlocks?: string[];               // Features unlocked at this milestone\n  celebration?: {\n    message: string;\n    animation?: string;\n    badgeAwarded?: string;\n  };\n  \n  // Status\n  isReached: boolean;\n  reachedAt?: Date;\n}\n\n/**\n * Ritual Reward - What participants earn\n */\nexport interface RitualReward {\n  id: string;\n  type: 'badge' | 'feature' | 'access' | 'recognition' | 'tool' | 'customization';\n  name: string;\n  description: string;\n  \n  // Eligibility\n  requiresCompletion: boolean;      // Must complete entire ritual\n  minimumParticipation: number;     // Percentage participation required (0-100)\n  \n  // Value\n  rarity: 'common' | 'uncommon' | 'rare' | 'epic' | 'legendary';\n  isTimeLimited: boolean;\n  expiresAt?: Date;\n  \n  // Content\n  iconUrl?: string;\n  animationUrl?: string;\n  specialEffects?: string[];\n  \n  // Scope\n  unlockScope: UnlockScope;\n}\n\n/**\n * Feature Unlock - New capabilities revealed\n */\nexport interface FeatureUnlock {\n  id: string;\n  featureId: string;               // Internal feature identifier\n  name: string;\n  description: string;\n  \n  // Unlock conditions\n  participationThreshold: number;   // % of eligible users must participate\n  scope: UnlockScope;\n  isReversible: boolean;           // Can be locked again if participation drops\n  \n  // Timing\n  unlockDelay?: number;            // Minutes after threshold is met\n  announceDelay?: number;          // Minutes before announcing unlock\n  \n  // Content\n  revealAnimation?: string;\n  announcementText?: string;\n  tutorialUrl?: string;\n}\n\n/**\n * User Participation Record\n */\nexport interface RitualParticipation {\n  id: string;\n  ritualId: string;\n  userId: string;\n  \n  // Status\n  status: 'invited' | 'joined' | 'active' | 'completed' | 'dropped';\n  joinedAt: Date;\n  completedAt?: Date;\n  lastActiveAt: Date;\n  \n  // Progress\n  actionsCompleted: string[];       // Action IDs completed\n  progressPercentage: number;       // 0-100\n  \n  // Engagement\n  timeSpent: number;               // Minutes actively participating\n  interactionCount: number;        // Number of ritual-related actions\n  socialScore: number;             // How much they engaged with others\n  \n  // Rewards earned\n  rewardsEarned: string[];         // Reward IDs\n  badgesAwarded: string[];         // Badge IDs\n  featuresUnlocked: string[];      // Feature IDs\n  \n  // Analytics\n  entryPoint: string;              // How they discovered this ritual\n  deviceType: string;              // mobile, desktop, tablet\n  completionQuality: number;       // 0-100 based on engagement depth\n}\n\n/**\n * Campus Ritual State - University-wide progress\n */\nexport interface CampusRitualState {\n  ritualId: string;\n  university: string;\n  \n  // Participation\n  totalEligible: number;           // Students who can participate\n  totalParticipants: number;       // Students who joined\n  totalCompleted: number;          // Students who finished\n  \n  // Progress\n  overallProgress: number;         // 0-100 percentage complete\n  milestonesReached: string[];     // Milestone IDs achieved\n  \n  // Timing\n  startedAt: Date;\n  expectedEndAt?: Date;\n  actualEndAt?: Date;\n  \n  // Social dynamics\n  viralityScore: number;           // How organically it spread (0-100)\n  crossSpaceEngagement: number;    // Interaction between different spaces\n  retentionRate: number;           // % who stayed active throughout\n  \n  // Outcomes\n  featuresUnlocked: string[];      // Features unlocked for this campus\n  culturalImpact: number;          // Long-term engagement boost (0-100)\n  \n  // Status\n  isSuccessful: boolean;           // Met minimum success criteria\n  successMessage?: string;         // Campus-specific celebration message\n}\n\n/**\n * Ritual Framework Manager\n */\nexport class RitualFramework {\n  \n  /**\n   * Create and schedule a new ritual\n   */\n  async createRitual(ritual: Omit<Ritual, 'id' | 'createdAt' | 'updatedAt' | 'version'>): Promise<string> {\n    const ritualDoc = {\n      ...ritual,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      version: 1,\n      metrics: {\n        participationRate: 0,\n        completionRate: 0,\n        engagementScore: 0,\n        socialImpact: 0\n      }\n    };\n    \n    const docRef = await dbAdmin.collection('rituals').add(ritualDoc);\n    \n    // Initialize campus states for participating universities\n    await this.initializeCampusStates(docRef.id, ritual.universities);\n    \n    return docRef.id;\n  }\n  \n  /**\n   * Start a ritual (activate it)\n   */\n  async startRitual(ritualId: string): Promise<void> {\n    const ritual = await this.getRitual(ritualId);\n    if (!ritual) throw new Error('Ritual not found');\n    \n    // Update ritual status\n    await dbAdmin.collection('rituals').doc(ritualId).update({\n      status: 'active',\n      startTime: new Date(),\n      updatedAt: new Date()\n    });\n    \n    // Initialize participation tracking\n    await this.initializeParticipationTracking(ritualId, ritual.universities);\n    \n    // Send campus-wide notifications\n    await this.broadcastRitualStart(ritualId, ritual);\n    \n  }\n  \n  /**\n   * Register user participation in a ritual\n   */\n  async joinRitual(ritualId: string, userId: string, entryPoint = 'direct'): Promise<boolean> {\n    const ritual = await this.getRitual(ritualId);\n    if (!ritual || ritual.status !== 'active') return false;\n    \n    // Check if user meets prerequisites\n    const meetsRequirements = await this.checkUserEligibility(userId, ritual);\n    if (!meetsRequirements) return false;\n    \n    // Check if already participating\n    const existingParticipation = await this.getUserParticipation(ritualId, userId);\n    if (existingParticipation) return false;\n    \n    // Create participation record\n    const participation: Omit<RitualParticipation, 'id'> = {\n      ritualId,\n      userId,\n      status: 'joined',\n      joinedAt: new Date(),\n      lastActiveAt: new Date(),\n      actionsCompleted: [],\n      progressPercentage: 0,\n      timeSpent: 0,\n      interactionCount: 0,\n      socialScore: 0,\n      rewardsEarned: [],\n      badgesAwarded: [],\n      featuresUnlocked: [],\n      entryPoint,\n      deviceType: 'web', // TODO: Detect device type\n      completionQuality: 0\n    };\n    \n    await dbAdmin.collection('ritual_participation').add(participation);\n    \n    // Update campus state\n    await this.updateCampusParticipation(ritualId, ritual.universities, 'joined');\n    \n    return true;\n  }\n  \n  /**\n   * Record ritual action completion\n   */\n  async recordAction(\n    ritualId: string, \n    userId: string, \n    actionId: string, \n    _metadata: Record<string, any> = {}\n  ): Promise<void> {\n    const participation = await this.getUserParticipation(ritualId, userId);\n    if (!participation) throw new Error('User not participating in ritual');\n    \n    // Validate action\n    const ritual = await this.getRitual(ritualId);\n    if (!ritual) throw new Error('Ritual not found');\n    \n    const action = ritual.actions.find(a => a.id === actionId);\n    if (!action) throw new Error('Action not found');\n    \n    // Check if already completed (for single-completion actions)\n    if (action.maxOccurrences === 1 && participation.actionsCompleted.includes(actionId)) {\n      return; // Already completed\n    }\n    \n    // Update participation record\n    const updatedActions = [...participation.actionsCompleted, actionId];\n    const newProgress = this.calculateProgress(ritual, updatedActions);\n    \n    await dbAdmin.collection('ritual_participation').doc(participation.id).update({\n      actionsCompleted: updatedActions,\n      progressPercentage: newProgress,\n      lastActiveAt: new Date(),\n      interactionCount: participation.interactionCount + 1\n    });\n    \n    // Check for completion\n    if (newProgress >= 100) {\n      await this.completeUserParticipation(ritualId, userId);\n    }\n    \n    // Check for milestone achievements\n    await this.checkMilestones(ritualId);\n    \n  }\n  \n  /**\n   * Get ritual by ID\n   */\n  private async getRitual(ritualId: string): Promise<Ritual | null> {\n    const doc = await dbAdmin.collection('rituals').doc(ritualId).get();\n    if (!doc.exists) return null;\n    \n    return { id: doc.id, ...doc.data() } as Ritual;\n  }\n  \n  /**\n   * Get user's participation in a ritual\n   */\n  private async getUserParticipation(ritualId: string, userId: string): Promise<RitualParticipation | null> {\n    const snapshot = await dbAdmin.collection('ritual_participation')\n      .where('ritualId', '==', ritualId)\n      .where('userId', '==', userId)\n      .limit(1)\n      .get();\n    \n    if (snapshot.empty) return null;\n    \n    const doc = snapshot.docs[0];\n    return { id: doc.id, ...doc.data() } as RitualParticipation;\n  }\n  \n  /**\n   * Check if user meets ritual prerequisites\n   */\n  private async checkUserEligibility(_userId: string, _ritual: Ritual): Promise<boolean> {\n    // TODO: Implement eligibility checking based on:\n    // - Space memberships\n    // - Account age\n    // - Completed rituals\n    // - Academic status\n    // - Required features\n    \n    return true; // Simplified for now\n  }\n  \n  /**\n   * Calculate progress percentage based on completed actions\n   */\n  private calculateProgress(ritual: Ritual, completedActions: string[]): number {\n    if (ritual.actions.length === 0) return 100;\n    \n    const totalWeight = ritual.actions.reduce((sum, action) => sum + action.weight, 0);\n    const completedWeight = ritual.actions\n      .filter(action => completedActions.includes(action.id))\n      .reduce((sum, action) => sum + action.weight, 0);\n    \n    return Math.min(100, (completedWeight / totalWeight) * 100);\n  }\n  \n  /**\n   * Initialize campus states for participating universities\n   */\n  private async initializeCampusStates(ritualId: string, universities: string[]): Promise<void> {\n    const batch = dbAdmin.batch();\n    \n    for (const university of universities) {\n      const campusState: Omit<CampusRitualState, 'ritualId' | 'university'> = {\n        totalEligible: 0, // Will be calculated when ritual starts\n        totalParticipants: 0,\n        totalCompleted: 0,\n        overallProgress: 0,\n        milestonesReached: [],\n        startedAt: new Date(),\n        viralityScore: 0,\n        crossSpaceEngagement: 0,\n        retentionRate: 0,\n        featuresUnlocked: [],\n        culturalImpact: 0,\n        isSuccessful: false\n      };\n      \n      const ref = dbAdmin.collection('campus_ritual_states').doc(`${ritualId}_${university}`);\n      batch.set(ref, { ritualId, university, ...campusState });\n    }\n    \n    await batch.commit();\n  }\n  \n  /**\n   * Initialize participation tracking when ritual starts\n   */\n  private async initializeParticipationTracking(_ritualId: string, _universities: string[]): Promise<void> {\n    // TODO: Calculate eligible participants per university\n    // Update campus states with realistic totalEligible numbers\n  }\n  \n  /**\n   * Send campus-wide ritual start notifications\n   */\n  private async broadcastRitualStart(ritualId: string, ritual: Ritual): Promise<void> {\n    // TODO: Integrate with notification system\n  }\n  \n  /**\n   * Update campus participation counters\n   */\n  private async updateCampusParticipation(\n    _ritualId: string, \n    _universities: string[], \n    _action: 'joined' | 'completed'\n  ): Promise<void> {\n    // TODO: Update campus state counters\n  }\n  \n  /**\n   * Complete user's ritual participation\n   */\n  private async completeUserParticipation(ritualId: string, userId: string): Promise<void> {\n    const participation = await this.getUserParticipation(ritualId, userId);\n    if (!participation) return;\n    \n    await dbAdmin.collection('ritual_participation').doc(participation.id).update({\n      status: 'completed',\n      completedAt: new Date(),\n      progressPercentage: 100\n    });\n    \n    // Award rewards\n    await this.awardRitualRewards(ritualId, userId);\n    \n  }\n  \n  /**\n   * Award rewards to user for ritual completion\n   */\n  private async awardRitualRewards(_ritualId: string, _userId: string): Promise<void> {\n    // TODO: Implement reward system\n    // - Award badges\n    // - Unlock features\n    // - Grant special access\n  }\n  \n  /**\n   * Check and trigger milestone achievements\n   */\n  private async checkMilestones(_ritualId: string): Promise<void> {\n    // TODO: Check if any milestones have been reached\n    // - Calculate participation thresholds\n    // - Trigger celebrations\n    // - Unlock features\n  }\n}\n\n/**\n * Global ritual framework instance\n */\nexport const ritualFramework = new RitualFramework();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/rss-import.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'totalImported' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":173,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":173,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'totalImported' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":466,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":466,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'successfulFeeds' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":467,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":467,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { dbAdmin } from '@/lib/firebase-admin';\nimport { type CampusEvent } from '@/lib/feed-aggregation';\n\n/**\n * RSS Import System for Campus Events\n * \n * Strategy:\n * 1. Import from university RSS feeds (events, announcements)\n * 2. Process and validate imported content\n * 3. Store as campus events with source tracking\n * 4. Schedule regular imports (daily)\n */\n\n// RSS feed configuration\nexport interface RSSFeedConfig {\n  id: string;\n  name: string;\n  url: string;\n  university: string;\n  category: 'events' | 'announcements' | 'news' | 'academics';\n  isActive: boolean;\n  lastImportTime?: Date;\n  importFrequency: number; // hours\n  maxItemsPerImport: number;\n  contentFilters: {\n    keywords: string[];\n    excludeKeywords: string[];\n    minWordCount: number;\n  };\n}\n\n// RSS import result\nexport interface ImportResult {\n  feedId: string;\n  success: boolean;\n  itemsProcessed: number;\n  itemsImported: number;\n  itemsSkipped: number;\n  errors: string[];\n  lastImportTime: Date;\n}\n\n// RSS item data structure\ninterface RSSItem {\n  title: string;\n  description: string;\n  link: string;\n  pubDate: Date;\n  category?: string;\n  author?: string;\n  content?: string;\n}\n\n/**\n * RSS Import Manager\n */\nexport class RSSImportManager {\n  private userAgent = 'HIVE Campus Feed Bot 1.0';\n  \n  /**\n   * Import content from an RSS feed\n   */\n  async importFromFeed(feedConfig: RSSFeedConfig): Promise<ImportResult> {\n    const result: ImportResult = {\n      feedId: feedConfig.id,\n      success: false,\n      itemsProcessed: 0,\n      itemsImported: 0,\n      itemsSkipped: 0,\n      errors: [],\n      lastImportTime: new Date()\n    };\n\n    try {\n      \n      // Fetch RSS feed\n      const response = await fetch(feedConfig.url, {\n        headers: {\n          'User-Agent': this.userAgent,\n          'Accept': 'application/rss+xml, application/xml, text/xml'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const xmlContent = await response.text();\n      \n      // Parse RSS XML\n      const rssItems = this.parseRSSXML(xmlContent);\n      result.itemsProcessed = rssItems.length;\n\n\n      // Process each item\n      for (const item of rssItems) {\n        try {\n          // Check if item should be imported\n          if (!this.shouldImportItem(item, feedConfig)) {\n            result.itemsSkipped++;\n            continue;\n          }\n\n          // Check if item already exists\n          if (await this.itemExists(item, feedConfig)) {\n            result.itemsSkipped++;\n            continue;\n          }\n\n          // Convert RSS item to campus event\n          const campusEvent = this.convertToCampusEvent(item, feedConfig);\n          \n          // Save to database\n          await this.saveCampusEvent(campusEvent);\n          result.itemsImported++;\n\n        } catch (itemError) {\n          const errorMessage = itemError instanceof Error ? itemError.message : String(itemError);\n          result.errors.push(`Item \"${item.title}\": ${errorMessage}`);\n        }\n      }\n\n      // Update feed config with last import time\n      await this.updateFeedLastImport(feedConfig.id, result.lastImportTime);\n\n      result.success = true;\n\n    } catch (error: any) {\n      result.errors.push(error.message);\n    }\n\n    return result;\n  }\n\n  /**\n   * Import from all active RSS feeds\n   */\n  async importFromAllFeeds(): Promise<ImportResult[]> {\n    const feedConfigs = await this.getActiveFeedConfigs();\n    const results: ImportResult[] = [];\n\n\n    // Process feeds in parallel with limited concurrency\n    const concurrency = 3;\n    for (let i = 0; i < feedConfigs.length; i += concurrency) {\n      const batch = feedConfigs.slice(i, i + concurrency);\n      \n      const batchPromises = batch.map(config => this.importFromFeed(config));\n      const batchResults = await Promise.allSettled(batchPromises);\n      \n      batchResults.forEach((result, index) => {\n        if (result.status === 'fulfilled') {\n          results.push(result.value);\n        } else {\n          results.push({\n            feedId: batch[index].id,\n            success: false,\n            itemsProcessed: 0,\n            itemsImported: 0,\n            itemsSkipped: 0,\n            errors: [result.reason.message || 'Unknown error'],\n            lastImportTime: new Date()\n          });\n        }\n      });\n\n      // Small delay between batches to avoid overwhelming servers\n      if (i + concurrency < feedConfigs.length) {\n        await new Promise(resolve => setTimeout(resolve, 1000));\n      }\n    }\n\n    const totalImported = results.reduce((sum, r) => sum + r.itemsImported, 0);\n\n    return results;\n  }\n\n  /**\n   * Parse RSS XML content\n   */\n  private parseRSSXML(xmlContent: string): RSSItem[] {\n    // Note: In production, use a proper XML parser like 'fast-xml-parser'\n    // This is a simplified parser for demonstration\n    \n    const items: RSSItem[] = [];\n    \n    try {\n      // Extract items using regex (simplified approach)\n      const itemMatches = xmlContent.match(/<item[^>]*>[\\s\\S]*?<\\/item>/gi) || [];\n      \n      for (const itemXml of itemMatches) {\n        const item: RSSItem = {\n          title: this.extractXMLValue(itemXml, 'title') || 'Untitled',\n          description: this.extractXMLValue(itemXml, 'description') || '',\n          link: this.extractXMLValue(itemXml, 'link') || '',\n          pubDate: this.parseDate(this.extractXMLValue(itemXml, 'pubDate')),\n          category: this.extractXMLValue(itemXml, 'category'),\n          author: this.extractXMLValue(itemXml, 'author'),\n          content: this.extractXMLValue(itemXml, 'content:encoded')\n        };\n        \n        items.push(item);\n      }\n\n    } catch (error) {\n      // Intentionally suppressed - RSS parsing failures should not break import\n    }\n    \n    return items;\n  }\n\n  /**\n   * Extract value from XML using tag name\n   */\n  private extractXMLValue(xml: string, tagName: string): string | undefined {\n    const regex = new RegExp(`<${tagName}[^>]*>([\\\\s\\\\S]*?)<\\\\/${tagName}>`, 'i');\n    const match = xml.match(regex);\n    return match ? match[1].trim().replace(/<!\\[CDATA\\[|\\]\\]>/g, '') : undefined;\n  }\n\n  /**\n   * Parse date string to Date object\n   */\n  private parseDate(dateString?: string): Date {\n    if (!dateString) return new Date();\n    \n    // Try to parse various date formats\n    const date = new Date(dateString);\n    return isNaN(date.getTime()) ? new Date() : date;\n  }\n\n  /**\n   * Check if RSS item should be imported based on filters\n   */\n  private shouldImportItem(item: RSSItem, feedConfig: RSSFeedConfig): boolean {\n    const { contentFilters } = feedConfig;\n    \n    // Check minimum word count\n    const wordCount = (item.title + ' ' + item.description).split(/\\s+/).length;\n    if (wordCount < contentFilters.minWordCount) {\n      return false;\n    }\n\n    const content = (item.title + ' ' + item.description + ' ' + (item.content || '')).toLowerCase();\n\n    // Check exclude keywords\n    if (contentFilters.excludeKeywords.some(keyword => content.includes(keyword.toLowerCase()))) {\n      return false;\n    }\n\n    // Check include keywords (if any specified)\n    if (contentFilters.keywords.length > 0) {\n      if (!contentFilters.keywords.some(keyword => content.includes(keyword.toLowerCase()))) {\n        return false;\n      }\n    }\n\n    // Check if content is too old (more than 30 days)\n    const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n    if (item.pubDate < thirtyDaysAgo) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Check if RSS item already exists in database\n   */\n  private async itemExists(item: RSSItem, feedConfig: RSSFeedConfig): Promise<boolean> {\n    try {\n      // Check by link (most reliable identifier)\n      if (item.link) {\n        const existingByLink = await dbAdmin.collection('campus_events')\n          .where('importSource', '==', feedConfig.id)\n          .where('originalLink', '==', item.link)\n          .limit(1)\n          .get();\n        \n        if (!existingByLink.empty) return true;\n      }\n\n      // Check by title and date (fallback)\n      const existingByTitle = await dbAdmin.collection('campus_events')\n        .where('importSource', '==', feedConfig.id)\n        .where('title', '==', item.title)\n        .where('createdAt', '>=', new Date(item.pubDate.getTime() - 60000)) // 1 minute tolerance\n        .where('createdAt', '<=', new Date(item.pubDate.getTime() + 60000))\n        .limit(1)\n        .get();\n\n      return !existingByTitle.empty;\n\n    } catch (error) {\n      return false; // If we can't check, assume it doesn't exist\n    }\n  }\n\n  /**\n   * Convert RSS item to campus event\n   */\n  private convertToCampusEvent(item: RSSItem, feedConfig: RSSFeedConfig): CampusEvent {\n    // Extract potential event date from content\n    const eventDate = this.extractEventDate(item) || item.pubDate;\n    \n    return {\n      id: '', // Will be set by Firestore\n      title: this.cleanTitle(item.title),\n      description: this.cleanDescription(item.description),\n      category: item.category || feedConfig.category,\n      startDate: eventDate,\n      location: this.extractLocation(item),\n      organizer: item.author || feedConfig.university,\n      tags: this.extractTags(item, feedConfig),\n      importSource: feedConfig.id,\n      isPublic: true,\n      createdAt: new Date(),\n      originalLink: item.link,\n      university: feedConfig.university\n    } as CampusEvent & { originalLink: string; university: string };\n  }\n\n  /**\n   * Save campus event to database\n   */\n  private async saveCampusEvent(event: CampusEvent): Promise<void> {\n    await dbAdmin.collection('campus_events').add({\n      ...event,\n      createdAt: new Date(),\n      updatedAt: new Date()\n    });\n  }\n\n  /**\n   * Get active RSS feed configurations\n   */\n  private async getActiveFeedConfigs(): Promise<RSSFeedConfig[]> {\n    try {\n      const snapshot = await dbAdmin.collection('rss_feeds')\n        .where('isActive', '==', true)\n        .get();\n\n      return snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      })) as RSSFeedConfig[];\n\n    } catch (error) {\n      return [];\n    }\n  }\n\n  /**\n   * Update feed's last import time\n   */\n  private async updateFeedLastImport(feedId: string, lastImportTime: Date): Promise<void> {\n    try {\n      await dbAdmin.collection('rss_feeds').doc(feedId).update({\n        lastImportTime,\n        updatedAt: new Date()\n      });\n    } catch (error) {\n      // Intentionally suppressed - timestamp update failure is non-critical\n    }\n  }\n\n  /**\n   * Extract event date from content (look for date patterns)\n   */\n  private extractEventDate(item: RSSItem): Date | null {\n    const content = item.title + ' ' + item.description;\n    \n    // Look for date patterns like \"March 15\", \"3/15/2024\", etc.\n    const datePatterns = [\n      /(\\w+\\s+\\d{1,2},?\\s+\\d{4})/g, // March 15, 2024\n      /(\\d{1,2}\\/\\d{1,2}\\/\\d{4})/g, // 3/15/2024\n      /(\\d{1,2}-\\d{1,2}-\\d{4})/g    // 3-15-2024\n    ];\n\n    for (const pattern of datePatterns) {\n      const matches = content.match(pattern);\n      if (matches) {\n        const date = new Date(matches[0]);\n        if (!isNaN(date.getTime()) && date > new Date()) {\n          return date;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Extract location from content\n   */\n  private extractLocation(item: RSSItem): string | undefined {\n    const content = item.title + ' ' + item.description;\n    \n    // Look for location patterns\n    const locationPatterns = [\n      /(?:at|in|location:?)\\s+([^,.!?]+)/i,\n      /room\\s+(\\w+)/i,\n      /building\\s+(\\w+)/i\n    ];\n\n    for (const pattern of locationPatterns) {\n      const match = content.match(pattern);\n      if (match) {\n        return match[1].trim();\n      }\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Extract tags from content\n   */\n  private extractTags(item: RSSItem, feedConfig: RSSFeedConfig): string[] {\n    const tags: string[] = [feedConfig.category];\n\n    if (item.category) {\n      tags.push(item.category.toLowerCase());\n    }\n\n    // Add university tag\n    tags.push(feedConfig.university.toLowerCase());\n\n    return [...new Set(tags)]; // Remove duplicates\n  }\n\n  /**\n   * Clean and format title\n   */\n  private cleanTitle(title: string): string {\n    return title\n      .replace(/<[^>]*>/g, '') // Remove HTML tags\n      .replace(/&[^;]+;/g, ' ') // Remove HTML entities\n      .trim()\n      .substring(0, 200); // Limit length\n  }\n\n  /**\n   * Clean and format description\n   */\n  private cleanDescription(description: string): string {\n    return description\n      .replace(/<[^>]*>/g, '') // Remove HTML tags\n      .replace(/&[^;]+;/g, ' ') // Remove HTML entities\n      .trim()\n      .substring(0, 1000); // Limit length\n  }\n}\n\n/**\n * Global RSS import manager instance\n */\nexport const rssImportManager = new RSSImportManager();\n\n/**\n * Background job to run RSS imports\n */\nexport async function runScheduledRSSImports(): Promise<ImportResult[]> {\n  const results = await rssImportManager.importFromAllFeeds();\n\n  const totalImported = results.reduce((sum, r) => sum + r.itemsImported, 0);\n  const successfulFeeds = results.filter(r => r.success).length;\n\n\n  return results;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/search-engine.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-auth-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-error-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-firebase-admin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-firebase-queries.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cursor' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":74,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'orderBy' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":75,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'orderDirection' is assigned a value but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":76,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Secure Firebase Queries with Campus Isolation\n *\n * Server-side utilities for Firebase Admin SDK that enforce campus isolation\n * CRITICAL: All space-related queries MUST use these functions\n */\n\nimport { dbAdmin } from '@/lib/firebase-admin';\nimport { logger } from '@/lib/logger';\nimport * as admin from 'firebase-admin';\n\n// Hardcoded for UB launch - will be dynamic in multi-campus rollout\nexport const CURRENT_CAMPUS_ID = 'ub-buffalo';\n\n/**\n * Validates that a space belongs to the current campus and user has access\n */\nexport async function validateSecureSpaceAccess(\n  spaceId: string,\n  userId?: string\n): Promise<{\n  isValid: boolean;\n  space?: admin.firestore.DocumentData;\n  error?: string;\n}> {\n  try {\n    const spaceDoc = await dbAdmin.collection('spaces').doc(spaceId).get();\n\n    if (!spaceDoc.exists) {\n      return { isValid: false, error: 'Space not found' };\n    }\n\n    const spaceData = spaceDoc.data()!;\n\n    // Critical: Validate campus isolation\n    if (spaceData.campusId !== CURRENT_CAMPUS_ID) {\n      logger.error('SECURITY: Cross-campus space access blocked', {\n        spaceId,\n        spaceCampusId: spaceData.campusId,\n        currentCampusId: CURRENT_CAMPUS_ID,\n        userId\n      });\n      return { isValid: false, error: 'Access denied - campus mismatch' };\n    }\n\n    // Validate space is active\n    if (!spaceData.isActive) {\n      return { isValid: false, error: 'Space is not active' };\n    }\n\n    return { isValid: true, space: spaceData };\n  } catch (error) {\n    logger.error('Error validating secure space access', { spaceId, userId, error: error instanceof Error ? error.message : String(error) });\n    return { isValid: false, error: 'Validation failed' };\n  }\n}\n\n/**\n * Get a campus-isolated spaces query\n */\nexport function getSecureSpacesQuery() {\n  return dbAdmin.collection('spaces')\n    .where('campusId', '==', CURRENT_CAMPUS_ID)\n    .where('isActive', '==', true);\n}\n\n/**\n * Get spaces with cursor-based pagination (simplified to avoid compound indexes)\n */\nexport async function getSecureSpacesWithCursor({\n  filterType,\n  searchTerm,\n  limit = 50,\n  cursor,\n  orderBy = 'createdAt',\n  orderDirection = 'desc'\n}: {\n  filterType?: string;\n  searchTerm?: string;\n  limit?: number;\n  cursor?: string;\n  orderBy?: string;\n  orderDirection?: 'asc' | 'desc';\n}): Promise<{\n  spaces: admin.firestore.DocumentData[];\n  nextCursor?: string;\n  hasMore: boolean;\n}> {\n  try {\n    // Simplified query to avoid compound index requirements\n    // Only use campus isolation and active status\n    let query = dbAdmin.collection('spaces')\n      .where('campusId', '==', CURRENT_CAMPUS_ID)\n      .where('isActive', '==', true);\n\n    // For development: limit to reasonable number\n    query = query.limit(Math.min(limit + 1, 100));\n\n    const snapshot = await query.get();\n    let docs = snapshot.docs;\n\n    // Client-side filtering to avoid compound index requirements\n    if (filterType && filterType !== 'all') {\n      docs = docs.filter(doc => doc.data().type === filterType);\n    }\n\n    if (searchTerm) {\n      docs = docs.filter(doc => {\n        const data = doc.data();\n        return data.name_lowercase?.includes(searchTerm.toLowerCase()) ||\n               data.description?.toLowerCase().includes(searchTerm.toLowerCase());\n      });\n    }\n\n    // Apply limit after filtering\n    const hasMore = docs.length > limit;\n    const spaces = hasMore ? docs.slice(0, limit) : docs;\n    const nextCursor = hasMore && spaces.length > 0 ? spaces[spaces.length - 1].id : undefined;\n\n    return {\n      spaces: spaces.map(doc => ({ id: doc.id, ...doc.data() })),\n      nextCursor,\n      hasMore\n    };\n  } catch (error) {\n    logger.error('Error in getSecureSpacesWithCursor:', { error: error instanceof Error ? error.message : String(error) });\n    return {\n      spaces: [],\n      nextCursor: undefined,\n      hasMore: false\n    };\n  }\n}\n\n/**\n * Get campus-isolated space membership query\n */\nexport function getSecureSpaceMembersQuery(spaceId: string) {\n  return dbAdmin.collection('spaceMembers')\n    .where('spaceId', '==', spaceId)\n    .where('isActive', '==', true);\n}\n\n/**\n * Validates user membership in a space with campus isolation\n */\nexport async function validateSecureSpaceMembership(\n  userId: string,\n  spaceId: string\n): Promise<{\n  isValid: boolean;\n  membership?: admin.firestore.DocumentData;\n  space?: admin.firestore.DocumentData;\n  error?: string;\n}> {\n  try {\n    // First validate space access\n    const spaceValidation = await validateSecureSpaceAccess(spaceId, userId);\n    if (!spaceValidation.isValid) {\n      return { isValid: false, error: spaceValidation.error };\n    }\n\n    // Check user membership\n    const membershipQuery = dbAdmin.collection('spaceMembers')\n      .where('spaceId', '==', spaceId)\n      .where('userId', '==', userId)\n      .where('isActive', '==', true)\n      .limit(1);\n\n    const membershipSnapshot = await membershipQuery.get();\n\n    if (membershipSnapshot.empty) {\n      return { isValid: false, error: 'User is not a member of this space' };\n    }\n\n    const membershipData = membershipSnapshot.docs[0].data();\n\n    return {\n      isValid: true,\n      membership: membershipData,\n      space: spaceValidation.space\n    };\n  } catch (error) {\n    logger.error('Error validating secure space membership', { userId, spaceId, error: error instanceof Error ? error.message : String(error) });\n    return { isValid: false, error: 'Validation failed' };\n  }\n}\n\n/**\n * Validates if user can join a specific space (campus + space rules)\n */\nexport async function validateSpaceJoinability(\n  userId: string,\n  spaceId: string\n): Promise<{\n  canJoin: boolean;\n  space?: admin.firestore.DocumentData;\n  error?: string;\n}> {\n  try {\n    // Validate space access\n    const spaceValidation = await validateSecureSpaceAccess(spaceId, userId);\n    if (!spaceValidation.isValid) {\n      return { canJoin: false, error: spaceValidation.error };\n    }\n\n    const space = spaceValidation.space!;\n\n    // Check if space is private\n    if (space.isPrivate) {\n      return { canJoin: false, error: 'Space is private and requires invitation' };\n    }\n\n    // Check if user is already a member\n    const existingMemberQuery = dbAdmin.collection('spaceMembers')\n      .where('spaceId', '==', spaceId)\n      .where('userId', '==', userId)\n      .where('isActive', '==', true)\n      .limit(1);\n\n    const existingSnapshot = await existingMemberQuery.get();\n    if (!existingSnapshot.empty) {\n      return { canJoin: false, error: 'User is already a member' };\n    }\n\n    // Greek life exclusive check\n    if (space.spaceType === 'greek_life') {\n      const greekMemberQuery = dbAdmin.collection('spaceMembers')\n        .where('userId', '==', userId)\n        .where('isActive', '==', true);\n\n      const greekSnapshot = await greekMemberQuery.get();\n\n      for (const memberDoc of greekSnapshot.docs) {\n        const memberData = memberDoc.data();\n        const memberSpaceDoc = await dbAdmin.collection('spaces').doc(memberData.spaceId).get();\n\n        if (memberSpaceDoc.exists) {\n          const memberSpace = memberSpaceDoc.data()!;\n          if (memberSpace.type === 'greek_life' && memberSpace.campusId === CURRENT_CAMPUS_ID) {\n            return { canJoin: false, error: 'User can only join one Greek life organization' };\n          }\n        }\n      }\n    }\n\n    return { canJoin: true, space };\n  } catch (error) {\n    logger.error('Error validating space joinability', { userId, spaceId, error: error instanceof Error ? error.message : String(error) });\n    return { canJoin: false, error: 'Validation failed' };\n  }\n}\n\n/**\n * Add campus metadata to any document being created\n */\nexport function addSecureCampusMetadata(data: Record<string, any>): Record<string, any> {\n  return {\n    ...data,\n    campusId: CURRENT_CAMPUS_ID,\n    createdAt: admin.firestore.FieldValue.serverTimestamp(),\n    updatedAt: admin.firestore.FieldValue.serverTimestamp()\n  };\n}\n\n/**\n * Audit security violations\n */\nexport function auditSecurityViolation(\n  action: string,\n  details: Record<string, any>\n): void {\n  logger.error('SECURITY_VIOLATION', {\n    action,\n    operation: action,\n    timestamp: new Date().toISOString(),\n    currentCampusId: CURRENT_CAMPUS_ID,\n    ...details\n  });\n\n  // In production, trigger alerts\n  if (process.env.NODE_ENV === 'production') {\n    // TODO: Send to monitoring service\n  }\n}\n\n/**\n * Get secure user data with campus validation\n */\nexport async function getSecureUserData(userId: string): Promise<{\n  isValid: boolean;\n  user?: admin.firestore.DocumentData;\n  error?: string;\n}> {\n  try {\n    const userDoc = await dbAdmin.collection('users').doc(userId).get();\n\n    if (!userDoc.exists) {\n      return { isValid: false, error: 'User not found' };\n    }\n\n    const userData = userDoc.data()!;\n\n    // Validate user belongs to current campus\n    if (userData.campusId !== CURRENT_CAMPUS_ID) {\n      auditSecurityViolation('cross_campus_user_access', {\n        userId,\n        userCampus: userData.campusId,\n        currentCampus: CURRENT_CAMPUS_ID\n      });\n      return { isValid: false, error: 'User not authorized for this campus' };\n    }\n\n    return { isValid: true, user: userData };\n  } catch (error) {\n    logger.error('Error getting secure user data', { userId, error: error instanceof Error ? error.message : String(error) });\n    return { isValid: false, error: 'User validation failed' };\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-input-validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-rate-limiter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/secure-session-manager.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SessionMetadata' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * PRODUCTION-SECURE session management with comprehensive security controls\n * Implements secure session handling, token rotation, and threat detection\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { SignJWT, jwtVerify } from 'jose';\nimport { logSecurityEvent } from './structured-logger';\nimport { currentEnvironment, env } from './env';\nimport { SecurityScanner } from './secure-input-validation';\nimport type { SessionData, SessionMetadata, SessionSecurityLevel } from \"@hive/core\";\n\n/**\n * Session configuration with security-first design\n */\nconst SESSION_CONFIG = {\n  // Cookie settings\n  COOKIE_NAME: 'hive_session',\n  REFRESH_COOKIE_NAME: 'hive_refresh',\n  \n  // Security timeouts\n  ACCESS_TOKEN_LIFETIME: 15 * 60 * 1000, // 15 minutes\n  REFRESH_TOKEN_LIFETIME: 7 * 24 * 60 * 60 * 1000, // 7 days\n  SESSION_ABSOLUTE_TIMEOUT: 30 * 24 * 60 * 60 * 1000, // 30 days max\n  \n  // Rotation thresholds\n  ROTATION_THRESHOLD: 5 * 60 * 1000, // Rotate if token expires in 5 minutes\n  MAX_ROTATION_ATTEMPTS: 3,\n  \n  // Security limits\n  MAX_CONCURRENT_SESSIONS: 5,\n  SUSPICIOUS_ACTIVITY_THRESHOLD: 10,\n  \n  // Cookie options\n  COOKIE_OPTIONS: {\n    httpOnly: true,\n    secure: currentEnvironment === 'production',\n    sameSite: 'strict' as const,\n    path: '/',\n    maxAge: 7 * 24 * 60 * 60 // 7 days\n  }\n} as const;\n\n/**\n * Refresh token data\n */\ninterface RefreshTokenData {\n  sessionId: string;\n  userId: string;\n  issuedAt: number;\n  expiresAt: number;\n  rotationCount: number;\n  fingerprint: string;\n}\n\n/**\n * Session validation result\n */\nexport interface SessionValidationResult {\n  valid: boolean;\n  session?: SessionData;\n  needsRotation: boolean;\n  securityViolation?: string;\n  action: 'allow' | 'rotate' | 'block' | 'elevate';\n}\n\n/**\n * Security-first session manager\n */\nexport class SecureSessionManager {\n  private static jwtSecret: Uint8Array;\n  private static sessionStore = new Map<string, SessionData>();\n  private static securityEvents = new Map<string, number>();\n\n  /**\n   * Initialize JWT secret securely\n   */\n  private static getJwtSecret(): Uint8Array {\n    if (!this.jwtSecret) {\n      const secret = env.NEXTAUTH_SECRET;\n      if (!secret) {\n        throw new Error('JWT_SECRET not configured');\n      }\n      \n      // Validate secret strength\n      if (secret.length < 32) {\n        throw new Error('JWT_SECRET must be at least 32 characters');\n      }\n      \n      this.jwtSecret = new TextEncoder().encode(secret);\n    }\n    return this.jwtSecret;\n  }\n\n  /**\n   * Generate secure fingerprint for session binding\n   */\n  private static generateFingerprint(request: NextRequest): string {\n    const userAgent = request.headers.get('user-agent') || '';\n    const acceptLanguage = request.headers.get('accept-language') || '';\n    const acceptEncoding = request.headers.get('accept-encoding') || '';\n    \n    // Create fingerprint from stable headers\n    const components = [\n      userAgent.substring(0, 100), // Limit length\n      acceptLanguage,\n      acceptEncoding\n    ].join('|');\n    \n    // Simple hash (in production, use crypto.subtle.digest)\n    let hash = 0;\n    for (let i = 0; i < components.length; i++) {\n      const char = components.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash; // Convert to 32-bit integer\n    }\n    \n    return Math.abs(hash).toString(36);\n  }\n\n  /**\n   * Create new secure session\n   */\n  static async createSession(\n    userData: {\n      userId: string;\n      email: string;\n      handle: string;\n      schoolId: string;\n    },\n    request: NextRequest\n  ): Promise<{\n    accessToken: string;\n    refreshToken: string;\n    expiresAt: number;\n  }> {\n    const now = Date.now();\n    const sessionId = `sess_${now}_${Math.random().toString(36).substr(2, 9)}`;\n    const fingerprint = this.generateFingerprint(request);\n    \n    const sessionData: SessionData = {\n      ...userData,\n      issuedAt: now,\n      expiresAt: now + SESSION_CONFIG.ACCESS_TOKEN_LIFETIME,\n      sessionId,\n      fingerprint,\n      lastActivity: now,\n      rotationCount: 0,\n      securityLevel: 'standard' as SessionSecurityLevel,\n      metadata: {\n        userAgent: request.headers.get('user-agent') || '',\n        ip: request.headers.get('x-forwarded-for') || 'unknown',\n        createdAt: now,\n        lastRotated: now\n      }\n    };\n\n    // Store session securely\n    this.sessionStore.set(sessionId, sessionData);\n\n    // Create JWT tokens\n    const secret = this.getJwtSecret();\n    \n    const accessToken = await new SignJWT({\n      sub: userData.userId,\n      sid: sessionId,\n      fp: fingerprint,\n      scp: 'access',\n      iat: Math.floor(now / 1000),\n      exp: Math.floor(sessionData.expiresAt / 1000)\n    })\n      .setProtectedHeader({ alg: 'HS256', typ: 'JWT' })\n      .sign(secret);\n\n    const refreshTokenData: RefreshTokenData = {\n      sessionId,\n      userId: userData.userId,\n      issuedAt: now,\n      expiresAt: now + SESSION_CONFIG.REFRESH_TOKEN_LIFETIME,\n      rotationCount: 0,\n      fingerprint\n    };\n\n    const refreshToken = await new SignJWT({\n      sub: userData.userId,\n      sid: sessionId,\n      fp: fingerprint,\n      scp: 'refresh',\n      rtc: 0,\n      iat: Math.floor(now / 1000),\n      exp: Math.floor(refreshTokenData.expiresAt / 1000)\n    })\n      .setProtectedHeader({ alg: 'HS256', typ: 'JWT' })\n      .sign(secret);\n\n    // Log session creation\n    await logSecurityEvent('invalid_token', {\n      action: 'session_created',\n      tags: {\n        userId: userData.userId,\n        sessionId,\n        environment: currentEnvironment,\n        userAgent: sessionData.metadata.userAgent.substring(0, 100)\n      }\n    });\n\n    return {\n      accessToken,\n      refreshToken,\n      expiresAt: sessionData.expiresAt\n    };\n  }\n\n  /**\n   * Validate session with comprehensive security checks\n   */\n  static async validateSession(\n    request: NextRequest\n  ): Promise<SessionValidationResult> {\n    try {\n      const authHeader = request.headers.get('authorization');\n      const cookieToken = request.cookies.get(SESSION_CONFIG.COOKIE_NAME)?.value;\n      \n      const token = authHeader?.startsWith('Bearer ') \n        ? authHeader.substring(7)\n        : cookieToken;\n\n      if (!token) {\n        return { valid: false, needsRotation: false, action: 'block' };\n      }\n\n      // SECURITY: Scan token for suspicious patterns\n      const tokenScan = SecurityScanner.scanInput(token, 'session_token');\n      if (tokenScan.level === 'dangerous') {\n        await logSecurityEvent('invalid_token', {\n          action: 'dangerous_token_detected',\n          tags: {\n            threats: tokenScan.threats.join(','),\n            environment: currentEnvironment\n          }\n        });\n        return { \n          valid: false, \n          needsRotation: false, \n          action: 'block',\n          securityViolation: 'dangerous_token'\n        };\n      }\n\n      // Verify JWT\n      const secret = this.getJwtSecret();\n      const { payload } = await jwtVerify(token, secret, {\n        algorithms: ['HS256']\n      });\n\n      const sessionId = payload.sid as string;\n      const fingerprint = payload.fp as string;\n      const scope = payload.scp as string;\n\n      if (scope !== 'access') {\n        return { \n          valid: false, \n          needsRotation: false, \n          action: 'block',\n          securityViolation: 'invalid_scope'\n        };\n      }\n\n      // Get session data\n      const sessionData = this.sessionStore.get(sessionId);\n      if (!sessionData) {\n        return { \n          valid: false, \n          needsRotation: false, \n          action: 'block',\n          securityViolation: 'session_not_found'\n        };\n      }\n\n      // SECURITY: Validate fingerprint\n      const currentFingerprint = this.generateFingerprint(request);\n      if (fingerprint !== currentFingerprint) {\n        await logSecurityEvent('invalid_token', {\n          action: 'fingerprint_mismatch',\n          tags: {\n            userId: sessionData.userId,\n            sessionId,\n            environment: currentEnvironment\n          }\n        });\n        \n        return { \n          valid: false, \n          needsRotation: false, \n          action: 'block',\n          securityViolation: 'fingerprint_mismatch'\n        };\n      }\n\n      // SECURITY: Check for session hijacking patterns\n      const suspiciousActivity = await this.detectSuspiciousActivity(sessionData, request);\n      if (suspiciousActivity.detected) {\n        return {\n          valid: false,\n          needsRotation: false,\n          action: 'block',\n          securityViolation: suspiciousActivity.reason\n        };\n      }\n\n      // Update last activity\n      sessionData.lastActivity = Date.now();\n\n      // Check if rotation is needed\n      const now = Date.now();\n      const timeUntilExpiry = sessionData.expiresAt - now;\n      const needsRotation = timeUntilExpiry < SESSION_CONFIG.ROTATION_THRESHOLD;\n\n      // Check for absolute session timeout\n      const sessionAge = now - sessionData.metadata.createdAt;\n      if (sessionAge > SESSION_CONFIG.SESSION_ABSOLUTE_TIMEOUT) {\n        return {\n          valid: false,\n          needsRotation: false,\n          action: 'block',\n          securityViolation: 'session_expired'\n        };\n      }\n\n      return {\n        valid: true,\n        session: sessionData,\n        needsRotation,\n        action: needsRotation ? 'rotate' : 'allow'\n      };\n\n    } catch (error) {\n      await logSecurityEvent('invalid_token', {\n        action: 'session_validation_error',\n        tags: {\n          error: error instanceof Error ? error.message : String(error),\n          environment: currentEnvironment\n        }\n      });\n\n      return { \n        valid: false, \n        needsRotation: false, \n        action: 'block',\n        securityViolation: 'validation_error'\n      };\n    }\n  }\n\n  /**\n   * Rotate session tokens for enhanced security\n   */\n  static async rotateSession(\n    sessionData: SessionData,\n    _request: NextRequest\n  ): Promise<{\n    accessToken: string;\n    refreshToken: string;\n    expiresAt: number;\n  } | null> {\n    try {\n      // Check rotation limits\n      if (sessionData.rotationCount >= SESSION_CONFIG.MAX_ROTATION_ATTEMPTS) {\n        await logSecurityEvent('invalid_token', {\n          action: 'max_rotations_exceeded',\n          tags: {\n            userId: sessionData.userId,\n            sessionId: sessionData.sessionId,\n            rotationCount: sessionData.rotationCount.toString()\n          }\n        });\n        return null;\n      }\n\n      const now = Date.now();\n      \n      // Update session data\n      sessionData.issuedAt = now;\n      sessionData.expiresAt = now + SESSION_CONFIG.ACCESS_TOKEN_LIFETIME;\n      sessionData.rotationCount++;\n      sessionData.metadata.lastRotated = now;\n\n      // Generate new tokens\n      const secret = this.getJwtSecret();\n      \n      const accessToken = await new SignJWT({\n        sub: sessionData.userId,\n        sid: sessionData.sessionId,\n        fp: sessionData.fingerprint,\n        scp: 'access',\n        iat: Math.floor(now / 1000),\n        exp: Math.floor(sessionData.expiresAt / 1000)\n      })\n        .setProtectedHeader({ alg: 'HS256', typ: 'JWT' })\n        .sign(secret);\n\n      const refreshToken = await new SignJWT({\n        sub: sessionData.userId,\n        sid: sessionData.sessionId,\n        fp: sessionData.fingerprint,\n        scp: 'refresh',\n        rtc: sessionData.rotationCount,\n        iat: Math.floor(now / 1000),\n        exp: Math.floor((now + SESSION_CONFIG.REFRESH_TOKEN_LIFETIME) / 1000)\n      })\n        .setProtectedHeader({ alg: 'HS256', typ: 'JWT' })\n        .sign(secret);\n\n      // Update stored session\n      this.sessionStore.set(sessionData.sessionId, sessionData);\n\n      await logSecurityEvent('invalid_token', {\n        action: 'session_rotated',\n        tags: {\n          userId: sessionData.userId,\n          sessionId: sessionData.sessionId,\n          rotationCount: sessionData.rotationCount.toString()\n        }\n      });\n\n      return {\n        accessToken,\n        refreshToken,\n        expiresAt: sessionData.expiresAt\n      };\n\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Detect suspicious session activity\n   */\n  private static async detectSuspiciousActivity(\n    sessionData: SessionData,\n    request: NextRequest\n  ): Promise<{ detected: boolean; reason?: string }> {\n    const currentIp = request.headers.get('x-forwarded-for') || 'unknown';\n    const currentUserAgent = request.headers.get('user-agent') || '';\n\n    // Check for IP address changes\n    if (sessionData.metadata.ip !== currentIp && sessionData.metadata.ip !== 'unknown') {\n      // Allow IP changes but log them\n      await logSecurityEvent('invalid_token', {\n        action: 'ip_address_change',\n        tags: {\n          userId: sessionData.userId,\n          sessionId: sessionData.sessionId,\n          previousIp: sessionData.metadata.ip,\n          currentIp\n        }\n      });\n    }\n\n    // Check for significant User-Agent changes\n    const userAgentSimilarity = this.calculateStringSimilarity(\n      sessionData.metadata.userAgent,\n      currentUserAgent\n    );\n\n    if (userAgentSimilarity < 0.8) {\n      await logSecurityEvent('invalid_token', {\n        action: 'user_agent_change',\n        tags: {\n          userId: sessionData.userId,\n          sessionId: sessionData.sessionId,\n          similarity: userAgentSimilarity.toString()\n        }\n      });\n\n      // Don't block on user agent changes but increase security level\n      if (sessionData.securityLevel === 'standard') {\n        sessionData.securityLevel = 'elevated';\n      }\n    }\n\n    // Check activity patterns\n    const now = Date.now();\n    const timeSinceLastActivity = now - sessionData.lastActivity;\n    \n    // Detect rapid consecutive requests (potential bot activity)\n    if (timeSinceLastActivity < 100) { // Less than 100ms\n      const userId = sessionData.userId;\n      const eventCount = this.securityEvents.get(userId) || 0;\n      this.securityEvents.set(userId, eventCount + 1);\n\n      if (eventCount > SESSION_CONFIG.SUSPICIOUS_ACTIVITY_THRESHOLD) {\n        return {\n          detected: true,\n          reason: 'rapid_requests'\n        };\n      }\n    }\n\n    return { detected: false };\n  }\n\n  /**\n   * Calculate string similarity for user agent comparison\n   */\n  private static calculateStringSimilarity(str1: string, str2: string): number {\n    const longer = str1.length > str2.length ? str1 : str2;\n    const shorter = str1.length > str2.length ? str2 : str1;\n    \n    if (longer.length === 0) return 1.0;\n    \n    const editDistance = this.levenshteinDistance(longer, shorter);\n    return (longer.length - editDistance) / longer.length;\n  }\n\n  /**\n   * Calculate Levenshtein distance\n   */\n  private static levenshteinDistance(str1: string, str2: string): number {\n    const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\n\n    for (let i = 0; i <= str1.length; i++) matrix[0][i] = i;\n    for (let j = 0; j <= str2.length; j++) matrix[j][0] = j;\n\n    for (let j = 1; j <= str2.length; j++) {\n      for (let i = 1; i <= str1.length; i++) {\n        const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\n        matrix[j][i] = Math.min(\n          matrix[j][i - 1] + 1,\n          matrix[j - 1][i] + 1,\n          matrix[j - 1][i - 1] + indicator\n        );\n      }\n    }\n\n    return matrix[str2.length][str1.length];\n  }\n\n  /**\n   * Revoke session\n   */\n  static async revokeSession(sessionId: string, reason: string): Promise<void> {\n    const sessionData = this.sessionStore.get(sessionId);\n    if (sessionData) {\n      this.sessionStore.delete(sessionId);\n      \n      await logSecurityEvent('invalid_token', {\n        action: 'session_revoked',\n        tags: {\n          userId: sessionData.userId,\n          sessionId,\n          reason,\n          environment: currentEnvironment\n        }\n      });\n    }\n  }\n\n  /**\n   * Clean up expired sessions\n   */\n  static async cleanupExpiredSessions(): Promise<void> {\n    const now = Date.now();\n    let cleanedCount = 0;\n\n    for (const [sessionId, sessionData] of this.sessionStore.entries()) {\n      if (sessionData.expiresAt < now || \n          (now - sessionData.metadata.createdAt) > SESSION_CONFIG.SESSION_ABSOLUTE_TIMEOUT) {\n        this.sessionStore.delete(sessionId);\n        cleanedCount++;\n      }\n    }\n\n    if (cleanedCount > 0) {\n      // Expired sessions cleaned\n    }\n  }\n\n  /**\n   * Set secure session cookies\n   */\n  static setSessionCookies(\n    response: NextResponse,\n    tokens: { accessToken: string; refreshToken: string }\n  ): void {\n    response.cookies.set(\n      SESSION_CONFIG.COOKIE_NAME,\n      tokens.accessToken,\n      SESSION_CONFIG.COOKIE_OPTIONS\n    );\n\n    response.cookies.set(\n      SESSION_CONFIG.REFRESH_COOKIE_NAME,\n      tokens.refreshToken,\n      {\n        ...SESSION_CONFIG.COOKIE_OPTIONS,\n        maxAge: 7 * 24 * 60 * 60 // 7 days for refresh token\n      }\n    );\n  }\n\n  /**\n   * Clear session cookies\n   */\n  static clearSessionCookies(response: NextResponse): void {\n    response.cookies.delete(SESSION_CONFIG.COOKIE_NAME);\n    response.cookies.delete(SESSION_CONFIG.REFRESH_COOKIE_NAME);\n  }\n}\n\n// Run cleanup every 30 minutes\nsetInterval(() => {\n  SecureSessionManager.cleanupExpiredSessions();\n}, 30 * 60 * 1000);\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/security-middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SecurityContext' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Security Middleware\n * Critical security checks for all API routes\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { checkRateLimit, validateCampusAccess } from '@hive/firebase';\nimport { logger } from './logger';\n\ninterface SecurityContext {\n  userId: string;\n  campusId: string;\n  email: string;\n  ipAddress: string;\n  userAgent: string;\n}\n\n/**\n * NEVER allow dev bypasses in production\n */\nexport function blockDevBypassesInProduction(): boolean {\n  if (process.env.NODE_ENV === 'production') {\n    // Check for dev bypass environment variables\n    const dangerousVars = [\n      'NEXT_PUBLIC_BYPASS_AUTH',\n      'NEXT_PUBLIC_USE_EMULATOR',\n      'BYPASS_RATE_LIMIT',\n      'SKIP_AUTH_CHECK',\n      'DEV_MODE'\n    ];\n\n    for (const varName of dangerousVars) {\n      if (process.env[varName] === 'true' || process.env[varName] === '1') {\n        logger.error('CRITICAL: Dev bypass detected in production!', {\n          variable: varName,\n          value: process.env[varName]\n        });\n\n        // Kill the server in production if bypasses are detected\n        if (process.env.NODE_ENV === 'production') {\n          throw new Error(`Security violation: ${varName} cannot be enabled in production`);\n        }\n      }\n    }\n  }\n\n  return true;\n}\n\n/**\n * Enforce campus isolation\n */\nexport function enforceCampusIsolation(\n  userCampusId: string,\n  requestedCampusId: string,\n  context?: string\n): boolean {\n  if (!validateCampusAccess(userCampusId, requestedCampusId)) {\n    logger.warn('Campus isolation violation', {\n      userCampusId,\n      requestedCampusId,\n      context,\n      timestamp: new Date().toISOString()\n    });\n\n    // In production, this is a critical security violation\n    if (process.env.NODE_ENV === 'production') {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Rate limiting with IP-based tracking\n */\nexport function enforceRateLimit(\n  request: NextRequest,\n  identifier?: string,\n  maxRequests: number = 60,\n  windowMs: number = 60000\n): { allowed: boolean; remaining: number; resetTime: number } {\n  // Get IP address\n  const ip = request.headers.get('x-forwarded-for')?.split(',')[0] ||\n    request.headers.get('x-real-ip') ||\n    'unknown';\n\n  // Create rate limit key\n  const rateLimitKey = identifier ? `${identifier}:${ip}` : ip;\n\n  // Check rate limit\n  const allowed = checkRateLimit(rateLimitKey, maxRequests, windowMs);\n\n  if (!allowed) {\n    logger.warn('Rate limit exceeded', {\n      identifier: rateLimitKey,\n      ip,\n      maxRequests,\n      window: `${windowMs}ms`\n    });\n  }\n\n  return {\n    allowed,\n    remaining: allowed ? maxRequests - 1 : 0,\n    resetTime: Date.now() + windowMs\n  };\n}\n\n/**\n * Validate request origin\n */\nexport function validateOrigin(request: NextRequest): boolean {\n  const origin = request.headers.get('origin');\n  const referer = request.headers.get('referer');\n\n  // In production, enforce strict origin checking\n  if (process.env.NODE_ENV === 'production') {\n    const allowedOrigins = [\n      process.env.NEXT_PUBLIC_APP_URL,\n      'https://hive.college',\n      'https://www.hive.college',\n      'https://app.hive.college'\n    ].filter(Boolean) as string[];\n\n    if (origin && !allowedOrigins.includes(origin)) {\n      logger.warn('Invalid origin detected', {\n        origin,\n        referer: referer || undefined,\n        allowedOrigins\n      });\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Sanitize user input\n */\nexport function sanitizeInput<T extends Record<string, any>>(\n  input: T,\n  allowedFields: string[]\n): Partial<T> {\n  const sanitized: Partial<T> = {};\n\n  for (const field of allowedFields) {\n    if (field in input) {\n      const value = input[field];\n\n      // Remove any potential XSS attempts\n      if (typeof value === 'string') {\n        // Remove script tags and event handlers\n        const cleaned = value\n          .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\n          .replace(/on\\w+\\s*=\\s*\"[^\"]*\"/gi, '')\n          .replace(/on\\w+\\s*=\\s*'[^']*'/gi, '')\n          .replace(/javascript:/gi, '');\n\n        sanitized[field as keyof T] = cleaned as any;\n      } else {\n        sanitized[field as keyof T] = value;\n      }\n    }\n  }\n\n  return sanitized;\n}\n\n/**\n * Validate email domain for campus\n */\nexport function validateEmailDomain(email: string, allowedDomain: string): boolean {\n  const emailDomain = email.split('@')[1]?.toLowerCase();\n  return emailDomain === allowedDomain.toLowerCase();\n}\n\n/**\n * Create secure session token\n */\nexport function createSecureToken(data: any, secret: string): string {\n  const crypto = require('crypto');\n\n  // Create payload with expiration\n  const payload = {\n    ...data,\n    exp: Date.now() + (24 * 60 * 60 * 1000), // 24 hours\n    iat: Date.now()\n  };\n\n  // Create signature\n  const hmac = crypto.createHmac('sha256', secret);\n  hmac.update(JSON.stringify(payload));\n  const signature = hmac.digest('hex');\n\n  // Combine payload and signature\n  const token = Buffer.from(JSON.stringify(payload)).toString('base64') + '.' + signature;\n\n  return token;\n}\n\n/**\n * Verify secure token\n */\nexport function verifySecureToken(token: string, secret: string): { valid: boolean; data?: any } {\n  try {\n    const crypto = require('crypto');\n    const [payloadBase64, signature] = token.split('.');\n\n    if (!payloadBase64 || !signature) {\n      return { valid: false };\n    }\n\n    // Decode payload\n    const payload = JSON.parse(Buffer.from(payloadBase64, 'base64').toString());\n\n    // Check expiration\n    if (payload.exp && payload.exp < Date.now()) {\n      return { valid: false };\n    }\n\n    // Verify signature\n    const hmac = crypto.createHmac('sha256', secret);\n    hmac.update(JSON.stringify(payload));\n    const expectedSignature = hmac.digest('hex');\n\n    if (signature !== expectedSignature) {\n      return { valid: false };\n    }\n\n    return { valid: true, data: payload };\n  } catch (error) {\n    logger.error('Token verification failed', { error: error instanceof Error ? error.message : String(error) });\n    return { valid: false };\n  }\n}\n\n/**\n * Security headers for API responses\n */\nexport function getSecurityHeaders(): Record<string, string> {\n  return {\n    'X-Content-Type-Options': 'nosniff',\n    'X-Frame-Options': 'DENY',\n    'X-XSS-Protection': '1; mode=block',\n    'Referrer-Policy': 'strict-origin-when-cross-origin',\n    'Permissions-Policy': 'camera=(), microphone=(), geolocation=()',\n    'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',\n    'Content-Security-Policy': \"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.firebase.com https://*.firebaseio.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://*.firebase.com https://*.firebaseio.com wss://*.firebaseio.com\"\n  };\n}\n\n/**\n * Main security middleware\n */\nexport async function withSecurity(\n  request: NextRequest,\n  handler: (request: NextRequest) => Promise<NextResponse>\n): Promise<NextResponse> {\n  try {\n    // Block dev bypasses in production\n    blockDevBypassesInProduction();\n\n    // Validate origin\n    if (!validateOrigin(request)) {\n      return NextResponse.json(\n        { error: 'Invalid origin' },\n        { status: 403, headers: getSecurityHeaders() }\n      );\n    }\n\n    // Apply rate limiting\n    const rateLimitResult = enforceRateLimit(request);\n    if (!rateLimitResult.allowed) {\n      return NextResponse.json(\n        { error: 'Too many requests' },\n        {\n          status: 429,\n          headers: {\n            ...getSecurityHeaders(),\n            'Retry-After': String(Math.ceil(rateLimitResult.resetTime / 1000)),\n            'X-RateLimit-Limit': '60',\n            'X-RateLimit-Remaining': String(rateLimitResult.remaining),\n            'X-RateLimit-Reset': String(rateLimitResult.resetTime)\n          }\n        }\n      );\n    }\n\n    // Execute handler\n    const response = await handler(request);\n\n    // Add security headers to response\n    const securityHeaders = getSecurityHeaders();\n    Object.entries(securityHeaders).forEach(([key, value]) => {\n      response.headers.set(key, value as string);\n    });\n\n    return response;\n  } catch (error) {\n    logger.error('Security middleware error', { error: error instanceof Error ? error.message : String(error) });\n\n    return NextResponse.json(\n      { error: 'Security check failed' },\n      { status: 500, headers: getSecurityHeaders() }\n    );\n  }\n}\n\n// Initialize on module load\nblockDevBypassesInProduction();","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/security-service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":385,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":385,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Security service for handling development bypasses and production security\n * Centralizes all security-related logic to prevent bypass vulnerabilities\n */\n\nimport { NextRequest } from 'next/server';\nimport { currentEnvironment, isDevelopment } from './env';\nimport { captureError, LogLevel } from './error-monitoring';\nimport { logSecurityEvent } from './structured-logger';\n\n/**\n * Security configuration for different environments\n */\nconst SECURITY_CONFIG = {\n  development: {\n    allowTestTokens: true,\n    allowDevMagicLinks: true,\n    allowSchoolBypass: true,\n    strictValidation: false,\n    logSensitiveData: true\n  },\n  staging: {\n    allowTestTokens: false,\n    allowDevMagicLinks: false,\n    allowSchoolBypass: false,\n    strictValidation: true,\n    logSensitiveData: false\n  },\n  production: {\n    allowTestTokens: false,\n    allowDevMagicLinks: false,\n    allowSchoolBypass: false,\n    strictValidation: true,\n    logSensitiveData: false\n  }\n} as const;\n\n/**\n * Development bypass tokens that should never work in production\n */\nconst DEV_BYPASS_TOKENS = [\n  'test-token',\n  'DEV_MODE',\n  'dev-token',\n  'development-token',\n  'bypass-token'\n] as const;\n\n/**\n * Test user IDs that should only work in development\n */\nconst DEV_TEST_USERS = [\n  'test-user',\n  'dev-user',\n  'admin-test',\n  'test-admin'\n] as const;\n\n/**\n * Check if a token is a development bypass token\n */\nexport function isDevBypassToken(token: string): boolean {\n  // Check hardcoded dev tokens\n  if (DEV_BYPASS_TOKENS.includes(token as any)) {\n    return true;\n  }\n  \n  // Check debug session tokens (dev_session_userId_timestamp_random)\n  if (token.startsWith('dev_session_')) {\n    return true;\n  }\n  \n  return false;\n}\n\n/**\n * Check if a user ID is a test user\n */\nexport function isTestUserId(userId: string): boolean {\n  return DEV_TEST_USERS.includes(userId as any);\n}\n\n/**\n * Extract user ID from debug session token\n * Debug tokens format: dev_session_userId_timestamp_random\n */\nfunction extractUserIdFromDebugToken(token: string): string | null {\n  if (!token.startsWith('dev_session_')) {\n    return null;\n  }\n\n  try {\n    // Parse token: dev_session_userId_timestamp_random\n    const parts = token.split('_');\n    if (parts.length < 3) {\n      return 'debug-user'; // Fallback\n    }\n\n    // Extract userId (everything between dev_session_ and the last two parts)\n    let userId: string;\n    if (parts.length >= 4) {\n      userId = parts.slice(2, -2).join('_');\n      // If userId is empty after slicing, use all parts after dev_session_\n      if (!userId) {\n        userId = parts.slice(2).join('_');\n      }\n    } else {\n      // For shorter tokens, take everything after dev_session_\n      userId = parts.slice(2).join('_');\n    }\n    \n    return userId || 'debug-user';\n  } catch (error) {\n    return 'debug-user';\n  }\n}\n\n/**\n * Get security configuration for current environment\n */\nexport function getSecurityConfig() {\n  return SECURITY_CONFIG[currentEnvironment as keyof typeof SECURITY_CONFIG];\n}\n\n/**\n * Validate development bypass attempt\n * Returns true if bypass is allowed, false if it should be blocked\n */\nexport async function validateDevBypass(\n  token: string,\n  request: NextRequest,\n  context?: {\n    userId?: string;\n    operation?: string;\n    path?: string;\n  }\n): Promise<{\n  allowed: boolean;\n  reason?: string;\n  securityAlert?: boolean;\n}> {\n  const config = getSecurityConfig();\n  const isDevToken = isDevBypassToken(token);\n\n  // If not a dev token, no bypass attempt\n  if (!isDevToken) {\n    return { allowed: true };\n  }\n\n  // In development, allow dev tokens\n  if (config.allowTestTokens && isDevelopment) {\n    // Development bypass token validated\n    return { allowed: true, reason: 'Development environment' };\n  }\n\n  // In staging/production, dev tokens are a security violation\n  if (!config.allowTestTokens) {\n    // Log security incident\n    const securityContext = {\n      token: isDevToken ? '[DEV_TOKEN_BLOCKED]' : token,\n      environment: currentEnvironment,\n      userAgent: request.headers.get('user-agent') || undefined,\n      ip: request.headers.get('x-forwarded-for') || \n          request.headers.get('x-real-ip') || \n          request.headers.get('cf-connecting-ip') || undefined,\n      path: context?.path || new URL(request.url).pathname,\n      action: context?.operation,\n      timestamp: new Date().toISOString()\n    };\n\n\n    // Structured security logging\n    await logSecurityEvent('bypass_attempt', {\n      requestId: securityContext.token, // Using token as identifier\n      ip: securityContext.ip,\n      userAgent: securityContext.userAgent,\n      action: context?.operation,\n      tags: {\n        bypassType: 'dev_token',\n        environment: currentEnvironment,\n        alertLevel: 'critical'\n      },\n      extra: securityContext\n    });\n\n    // Capture as security incident\n    try {\n      await captureError(new Error('Development bypass token used in production'), {\n        level: LogLevel.ERROR,\n        tags: {\n          security_incident: 'true',\n          bypass_attempt: 'true',\n          environment: currentEnvironment,\n          token_type: 'dev_bypass'\n        },\n        extra: securityContext\n      });\n    } catch (error) {\n      // Intentionally suppressed - security logging failure should not break auth\n    }\n\n    return {\n      allowed: false,\n      reason: 'Development bypasses are disabled in production',\n      securityAlert: true\n    };\n  }\n\n  return { allowed: false, reason: 'Invalid configuration state' };\n}\n\n/**\n * Validate magic link bypass for development\n */\nexport async function validateMagicLinkBypass(\n  token: string,\n  email: string,\n  request: NextRequest\n): Promise<{\n  allowed: boolean;\n  reason?: string;\n  securityAlert?: boolean;\n}> {\n  const config = getSecurityConfig();\n\n  // Check if this is a dev magic link\n  if (token === 'DEV_MODE') {\n    if (config.allowDevMagicLinks && isDevelopment) {\n      return { allowed: true, reason: 'Development environment' };\n    }\n\n    if (!config.allowDevMagicLinks) {\n      \n      // Structured security logging\n      await logSecurityEvent('bypass_attempt', {\n        ip: request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || undefined,\n        userAgent: request.headers.get('user-agent') || undefined,\n        action: 'magic_link_verify',\n        tags: {\n          bypassType: 'dev_magic_link',\n          environment: currentEnvironment,\n          alertLevel: 'critical'\n        },\n        extra: {\n          email: email.replace(/(.{3}).*@/, '$1***@'),\n          timestamp: new Date().toISOString()\n        }\n      });\n      \n      try {\n        await captureError(new Error('DEV_MODE magic link used in production'), {\n          level: LogLevel.ERROR,\n          tags: {\n            security_incident: 'true',\n            magic_link_bypass: 'true',\n            environment: currentEnvironment\n          },\n          extra: {\n            email: email.replace(/(.{3}).*@/, '$1***@'), // Masked email\n            ip: request.headers.get('x-forwarded-for') || undefined,\n            userAgent: request.headers.get('user-agent') || undefined,\n            timestamp: new Date().toISOString()\n          }\n        });\n      } catch (error) {\n        // Intentionally suppressed - security logging failure should not break auth\n      }\n\n      return {\n        allowed: false,\n        reason: 'Development magic links are disabled in production',\n        securityAlert: true\n      };\n    }\n  }\n\n  return { allowed: true };\n}\n\n/**\n * Validate school domain bypass for development\n */\nexport function validateSchoolBypass(email: string, requiredDomain?: string): {\n  allowed: boolean;\n  reason?: string;\n} {\n  const config = getSecurityConfig();\n\n  // If no required domain or school bypass is allowed, permit any email\n  if (!requiredDomain || config.allowSchoolBypass) {\n    return { allowed: true };\n  }\n\n  // Check if email matches required domain\n  const emailDomain = email.split('@')[1]?.toLowerCase();\n  const normalizedDomain = requiredDomain.toLowerCase();\n\n  if (emailDomain === normalizedDomain) {\n    return { allowed: true };\n  }\n\n  return {\n    allowed: false,\n    reason: `Email must be from ${requiredDomain} domain`\n  };\n}\n\n/**\n * Secure token validation - ensures dev tokens don't work in production\n */\nexport async function validateAuthToken(\n  token: string,\n  request: NextRequest,\n  context?: {\n    operation?: string;\n    requireRealAuth?: boolean;\n  }\n): Promise<{\n  valid: boolean;\n  userId?: string;\n  reason?: string;\n  securityAlert?: boolean;\n}> {\n  // First check for dev bypass attempts\n  const bypassValidation = await validateDevBypass(token, request, {\n    operation: context?.operation,\n    path: new URL(request.url).pathname\n  });\n\n  if (!bypassValidation.allowed) {\n    return {\n      valid: false,\n      reason: bypassValidation.reason,\n      securityAlert: bypassValidation.securityAlert\n    };\n  }\n\n  // If it's a dev token and bypass is allowed, extract user ID\n  if (isDevBypassToken(token) && bypassValidation.allowed) {\n    // Handle debug session tokens\n    if (token.startsWith('dev_session_')) {\n      const userId = extractUserIdFromDebugToken(token);\n      return {\n        valid: true,\n        userId: userId || 'debug-user',\n        reason: 'Debug session token'\n      };\n    }\n    \n    // Handle legacy dev tokens\n    return {\n      valid: true,\n      userId: 'test-user',\n      reason: 'Development bypass token'\n    };\n  }\n\n  // For real Firebase tokens, validate with production auth service\n  try {\n    const { validateProductionToken } = await import('./production-auth');\n    const result = await validateProductionToken(token, request, {\n      operation: context?.operation\n    });\n    \n    return {\n      valid: true,\n      userId: result.uid,\n      reason: 'Valid Firebase token'\n    };\n    \n  } catch (error: any) {\n    // Production auth service throws errors for invalid tokens\n    return {\n      valid: false,\n      reason: error.message || 'Token validation failed',\n      securityAlert: error.httpStatus === 403\n    };\n  }\n}\n\n/**\n * Environment-aware logging that respects security settings\n */\nexport function secureLog(level: 'info' | 'warn' | 'error', message: string, data?: any): void {\n  const config = getSecurityConfig();\n\n  if (level === 'error') {\n    console.error(`[Security] ${message}`, data);\n  } else if (level === 'warn') {\n    console.warn(`[Security] ${message}`, data);\n  } else {\n    console.log(`[Security] ${message}`, data);\n  }\n}\n\n/**\n * Check if current request is from a development environment\n * Used for additional security checks\n */\nexport function isRequestFromDevelopment(request: NextRequest): boolean {\n  const host = request.headers.get('host');\n  const origin = request.headers.get('origin');\n  \n  const devIndicators = [\n    'localhost',\n    '127.0.0.1',\n    '.local',\n    ':3000',\n    ':3001'\n  ];\n\n  return devIndicators.some(indicator => \n    host?.includes(indicator) || origin?.includes(indicator)\n  );\n}\n\n/**\n * Production security middleware - blocks known dev patterns\n */\nexport async function blockDevPatternsInProduction(\n  request: NextRequest\n): Promise<{ blocked: boolean; reason?: string }> {\n  if (isDevelopment) {\n    return { blocked: false };\n  }\n\n  const authHeader = request.headers.get('authorization');\n  \n  // Check for dev tokens in headers\n  if (authHeader) {\n    const token = authHeader.replace('Bearer ', '');\n    if (isDevBypassToken(token)) {\n      // Log the security incident\n      await logSecurityEvent('bypass_attempt', {\n        ip: request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || undefined,\n        userAgent: request.headers.get('user-agent') || undefined,\n        path: new URL(request.url).pathname,\n        tags: {\n          tokenType: token.startsWith('dev_session_') ? 'debug_session' : 'dev_bypass',\n          environment: currentEnvironment,\n          alertLevel: 'critical'\n        }\n      });\n      \n      return {\n        blocked: true,\n        reason: 'Development token detected in production environment'\n      };\n    }\n  }\n\n  // For POST requests, we'll check the body separately in each route\n  // to avoid consuming the request stream here\n  return { blocked: false };\n}\n\n/**\n * Check request body for development patterns (call this after parsing JSON)\n */\nexport function checkBodyForDevPatterns(body: any): { blocked: boolean; reason?: string } {\n  if (isDevelopment) {\n    return { blocked: false };\n  }\n\n  const devPatterns = ['DEV_MODE', 'test-token', 'dev-user', 'bypass'];\n  const bodyString = JSON.stringify(body).toLowerCase();\n  \n  for (const pattern of devPatterns) {\n    if (bodyString.includes(pattern.toLowerCase())) {\n      return {\n        blocked: true,\n        reason: `Development pattern '${pattern}' detected in production`\n      };\n    }\n  }\n\n  return { blocked: false };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/server-auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'admin' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Server-side authentication utilities for HIVE\n * \n * Provides proper typing for server-side auth operations\n * and replaces the broken getCurrentUser from auth-logic.\n */\n\nimport * as admin from 'firebase-admin';\nimport { getAuth } from 'firebase-admin/auth';\nimport { NextRequest } from 'next/server';\n\nexport interface AuthUser {\n  uid: string;\n  id: string; // Alias for uid for backwards compatibility\n  email: string;\n  emailVerified: boolean;\n  displayName?: string;\n  photoURL?: string;\n\n  // HIVE-specific properties\n  handle?: string;\n  schoolId?: string;\n  userType?: 'student' | 'faculty' | 'staff' | 'alumni';\n  isOnboarded?: boolean;\n  isBuilder?: boolean;\n\n  // Firebase properties\n  customClaims?: Record<string, any>;\n}\n\nexport interface SessionUser {\n  uid: string;\n  id: string; // Alias for uid for backwards compatibility\n  email: string;\n  emailVerified: boolean;\n  displayName?: string;\n  photoURL?: string;\n  handle?: string;\n  schoolId?: string;\n  userType?: 'student' | 'faculty' | 'staff' | 'alumni';\n  isOnboarded?: boolean;\n  isBuilder?: boolean;\n}\n\n/**\n * Get the current authenticated user from request headers\n */\nexport async function getCurrentUser(request?: NextRequest): Promise<AuthUser | null> {\n  try {\n    // In development, allow bypass for testing\n    if (process.env.NODE_ENV === 'development') {\n      const devBypass = process.env.DEV_AUTH_BYPASS;\n      if (devBypass === 'true') {\n        return {\n          uid: 'dev-user-id',\n          id: 'dev-user-id',\n          email: 'dev@example.com',\n          emailVerified: true,\n          displayName: 'Dev User',\n          handle: 'dev_user',\n          schoolId: 'ub',\n          userType: 'student',\n          isOnboarded: true,\n          isBuilder: true\n        };\n      }\n    }\n\n    // Get token from Authorization header\n    const token = request?.headers.get('authorization')?.replace('Bearer ', '');\n    if (!token) {\n      return null;\n    }\n\n    // Verify the token with Firebase Admin\n    const decodedToken = await getAuth().verifyIdToken(token);\n    \n    return {\n      uid: decodedToken.uid,\n      id: decodedToken.uid, // Alias for backwards compatibility\n      email: decodedToken.email || '',\n      emailVerified: decodedToken.email_verified || false,\n      displayName: decodedToken.name,\n      photoURL: decodedToken.picture,\n      handle: decodedToken.handle,\n      schoolId: decodedToken.schoolId,\n      userType: decodedToken.userType as 'student' | 'faculty' | 'staff' | 'alumni',\n      isOnboarded: decodedToken.isOnboarded || false,\n      isBuilder: decodedToken.isBuilder || false,\n      customClaims: decodedToken\n    };\n\n  } catch (error) {\n    console.error('Error getting current user:', error);\n    return null;\n  }\n}\n\n/**\n * Get user from session data (for non-request contexts)\n */\nexport async function getUserFromSession(sessionData: any): Promise<SessionUser | null> {\n  if (!sessionData?.id) {\n    return null;\n  }\n\n  return {\n    uid: sessionData.id,\n    id: sessionData.id, // Alias for backwards compatibility\n    email: sessionData.email || '',\n    emailVerified: sessionData.emailVerified || false,\n    displayName: sessionData.displayName,\n    photoURL: sessionData.photoURL,\n    handle: sessionData.handle,\n    schoolId: sessionData.schoolId,\n    userType: sessionData.userType,\n    isOnboarded: sessionData.isOnboarded || false,\n    isBuilder: sessionData.isBuilder || false\n  };\n}\n\n/**\n * Check if user has required permissions\n */\nexport function hasPermission(user: AuthUser | SessionUser | null, permission: string): boolean {\n  if (!user) return false;\n  \n  // Basic permission checks\n  switch (permission) {\n    case 'read:profile':\n      return true; // All authenticated users can read profiles\n    case 'write:profile':\n      return true; // All authenticated users can write their own profile\n    case 'create:tools':\n      return user.isBuilder || user.userType === 'faculty';\n    case 'admin:spaces':\n      return user.userType === 'faculty' || user.userType === 'staff';\n    default:\n      return false;\n  }\n}\n\n/**\n * Check if user belongs to a specific school\n */\nexport function belongsToSchool(user: AuthUser | SessionUser | null, schoolId: string): boolean {\n  return user?.schoolId === schoolId;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/session-middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/session-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/session.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/space-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/space-cache.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/space-permissions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/space-query-optimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/space-type-rules.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/sse-realtime-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/structured-logger.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":171,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":171,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Structured logging service for HIVE platform\n * Replaces console.log with proper logging levels and metadata\n */\n\nimport type { HiveUser, Space, Post, HiveEvent, AppError } from '@/types/global';\n\nexport enum LogLevel {\n  DEBUG = 0,\n  INFO = 1,\n  WARN = 2,\n  ERROR = 3,\n  CRITICAL = 4,\n}\n\nexport interface LogContext {\n  userId?: string;\n  campusId?: string;\n  spaceId?: string;\n  action?: string;\n  metadata?: Record<string, unknown>;\n  error?: any | AppError;\n  user?: Partial<HiveUser>;\n  space?: Partial<Space>;\n  post?: Partial<Post>;\n  event?: Partial<HiveEvent>;\n  // Statistics\n  connectionCount?: number;\n  friendCount?: number;\n  detectCount?: number;\n  // Allow additional properties for flexibility\n  [key: string]: any;\n}\n\nclass StructuredLogger {\n  private static instance: StructuredLogger;\n  private logLevel: LogLevel;\n  private isDevelopment: boolean;\n  private logs: Array<Record<string, unknown>> = [];\n\n  private constructor() {\n    this.isDevelopment = process.env.NODE_ENV !== 'production';\n    this.logLevel = this.isDevelopment ? LogLevel.DEBUG : LogLevel.INFO;\n  }\n\n  static getInstance(): StructuredLogger {\n    if (!StructuredLogger.instance) {\n      StructuredLogger.instance = new StructuredLogger();\n    }\n    return StructuredLogger.instance;\n  }\n\n  private formatMessage(\n    level: LogLevel,\n    message: string,\n    context?: LogContext\n  ): Record<string, unknown> {\n    return {\n      timestamp: new Date().toISOString(),\n      level: LogLevel[level],\n      message,\n      ...context,\n      environment: this.isDevelopment ? 'development' : 'production',\n    };\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    return level >= this.logLevel;\n  }\n\n  private output(logObject: Record<string, unknown>): void {\n    // In production, send to logging service\n    if (!this.isDevelopment) {\n      // TODO: Send to logging service (e.g., Sentry, LogRocket, etc.)\n      this.sendToLoggingService(logObject);\n    }\n\n    // In development, output to console with color coding\n    if (this.isDevelopment) {\n      const level = String(logObject.level);\n      const color = this.getConsoleColor(level);\n\n       \n      console.log(\n        `%c[${level}]%c ${logObject.message}`,\n        `color: ${color}; font-weight: bold`,\n        'color: inherit',\n        logObject\n      );\n    }\n\n    // Store in memory for debugging (limited buffer)\n    this.logs.push(logObject);\n    if (this.logs.length > 100) {\n      this.logs.shift();\n    }\n  }\n\n  private getConsoleColor(level: string): string {\n    switch (level) {\n      case 'DEBUG': return '#888';\n      case 'INFO': return '#2196F3';\n      case 'WARN': return '#FF9800';\n      case 'ERROR': return '#F44336';\n      case 'CRITICAL': return '#D32F2F';\n      default: return '#000';\n    }\n  }\n\n  private sendToLoggingService(logObject: Record<string, unknown>): void {\n    // Implementation would send to actual logging service\n    // For now, this is a placeholder\n    if (typeof window !== 'undefined' && window.navigator.sendBeacon) {\n      // Use sendBeacon for reliability\n      const blob = new Blob([JSON.stringify(logObject)], { type: 'application/json' });\n      window.navigator.sendBeacon('/api/logs', blob);\n    }\n  }\n\n  debug(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      this.output(this.formatMessage(LogLevel.DEBUG, message, context));\n    }\n  }\n\n  info(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.INFO)) {\n      this.output(this.formatMessage(LogLevel.INFO, message, context));\n    }\n  }\n\n  warn(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.WARN)) {\n      this.output(this.formatMessage(LogLevel.WARN, message, context));\n    }\n  }\n\n  error(message: string, error?: any, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.ERROR)) {\n      const errorContext = {\n        ...context,\n        error: error ? {\n          name: error.name,\n          message: error.message,\n          stack: error.stack,\n        } : undefined,\n      };\n      this.output(this.formatMessage(LogLevel.ERROR, message, errorContext));\n    }\n  }\n\n  critical(message: string, error?: any, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.CRITICAL)) {\n      const errorContext = {\n        ...context,\n        error: error ? {\n          name: error.name,\n          message: error.message,\n          stack: error.stack,\n        } : undefined,\n      };\n      this.output(this.formatMessage(LogLevel.CRITICAL, message, errorContext));\n\n      // Critical errors should also trigger alerts in production\n      if (!this.isDevelopment) {\n        this.triggerAlert(message, error);\n      }\n    }\n  }\n\n  private triggerAlert(message: string, error?: any): void {\n    // Would integrate with alerting service (PagerDuty, etc.)\n    // Placeholder implementation\n  }\n\n  // Performance logging\n  time(label: string): void {\n    if (this.isDevelopment) {\n       \n      console.time(label);\n    }\n  }\n\n  timeEnd(label: string): void {\n    if (this.isDevelopment) {\n       \n      console.timeEnd(label);\n    }\n  }\n\n  // Analytics event logging\n  logEvent(eventName: string, properties?: Record<string, unknown>): void {\n    this.info(`Event: ${eventName}`, {\n      action: eventName,\n      metadata: properties,\n    });\n  }\n\n  // API request logging\n  logApiRequest(\n    method: string,\n    path: string,\n    statusCode: number,\n    duration: number,\n    userId?: string\n  ): void {\n    const level = statusCode >= 500 ? LogLevel.ERROR :\n                  statusCode >= 400 ? LogLevel.WARN :\n                  LogLevel.INFO;\n\n    if (this.shouldLog(level)) {\n      this.output(this.formatMessage(\n        level,\n        `API ${method} ${path} - ${statusCode}`,\n        {\n          userId,\n          action: `api_${method.toLowerCase()}`,\n          metadata: {\n            path,\n            statusCode,\n            duration: `${duration}ms`,\n          },\n        }\n      ));\n    }\n  }\n\n  // Get recent logs for debugging\n  getRecentLogs(count = 10): Array<Record<string, unknown>> {\n    return this.logs.slice(-count);\n  }\n\n  // Clear logs (useful for testing)\n  clearLogs(): void {\n    this.logs = [];\n  }\n\n  // Set log level dynamically\n  setLogLevel(level: LogLevel): void {\n    this.logLevel = level;\n  }\n}\n\n// Export singleton instance\nexport const logger = StructuredLogger.getInstance();\n\n// Export convenience functions\nexport const logDebug = (message: string, context?: LogContext) =>\n  logger.debug(message, context);\n\nexport const logInfo = (message: string, context?: LogContext) =>\n  logger.info(message, context);\n\nexport const logWarn = (message: string, context?: LogContext) =>\n  logger.warn(message, context);\n\nexport const logError = (message: string, error?: any, context?: LogContext) =>\n  logger.error(message, error, context);\n\nexport const logCritical = (message: string, error?: any, context?: LogContext) =>\n  logger.critical(message, error, context);\n\nexport const logEvent = (eventName: string, properties?: Record<string, any>) =>\n  logger.logEvent(eventName, properties);\n\nexport const logApiRequest = (\n  method: string,\n  path: string,\n  statusCode: number,\n  duration: number,\n  userId?: string\n) => logger.logApiRequest(method, path, statusCode, duration, userId);\n\n// Security event logging\nexport const logSecurityEvent = async (\n  eventType: string,\n  context?: LogContext & {\n    severity?: 'low' | 'medium' | 'high' | 'critical';\n    ipAddress?: string;\n    userAgent?: string;\n    endpoint?: string;\n    operation?: string;\n    requestId?: string;\n    ip?: string;\n    tags?: Record<string, string>;\n    extra?: Record<string, unknown>;\n  }\n) => {\n  const message = context?.operation || eventType;\n  const securityContext = {\n    ...context,\n    action: `security_${eventType}`,\n    metadata: {\n      ...context?.metadata,\n      ...context?.tags,\n      ...context?.extra,\n      securityEvent: true,\n      eventType,\n      severity: context?.severity || 'medium',\n    },\n  };\n\n  const level = context?.severity === 'critical' ? LogLevel.CRITICAL :\n               context?.severity === 'high' ? LogLevel.ERROR :\n               context?.severity === 'medium' ? LogLevel.WARN :\n               LogLevel.INFO;\n\n  if (level === LogLevel.CRITICAL) {\n    logger.critical(`Security Event: ${message}`, undefined, securityContext);\n  } else if (level === LogLevel.ERROR) {\n    logger.error(`Security Event: ${message}`, undefined, securityContext);\n  } else if (level === LogLevel.WARN) {\n    logger.warn(`Security Event: ${message}`, securityContext);\n  } else {\n    logger.info(`Security Event: ${message}`, securityContext);\n  }\n};\n\n// Create a request-specific logger\nexport const createRequestLogger = (requestId: string, userId?: string) => {\n  return {\n    log: (message: string, context?: LogContext) =>\n      logger.info(message, { ...context, metadata: { ...context?.metadata, requestId }, userId }),\n    error: (message: string, error?: any, context?: LogContext) =>\n      logger.error(message, error, { ...context, metadata: { ...context?.metadata, requestId }, userId }),\n    warn: (message: string, context?: LogContext) =>\n      logger.warn(message, { ...context, metadata: { ...context?.metadata, requestId }, userId }),\n    debug: (message: string, context?: LogContext) =>\n      logger.debug(message, { ...context, metadata: { ...context?.metadata, requestId }, userId }),\n  };\n};\n\n// Log API calls with detailed metrics\nexport const logApiCall = async (\n  method: string,\n  endpoint: string,\n  params: {\n    requestId?: string;\n    userId?: string;\n    statusCode?: number;\n    duration?: number;\n    error?: any;\n    metadata?: Record<string, any>;\n  }\n) => {\n  const { requestId, userId, statusCode = 200, duration = 0, error, metadata } = params;\n\n  const context: LogContext = {\n    userId,\n    action: `api_${method.toLowerCase()}`,\n    metadata: {\n      endpoint,\n      method,\n      statusCode,\n      duration: `${duration}ms`,\n      requestId,\n      ...metadata,\n    },\n  };\n\n  if (error) {\n    logger.error(`API Error: ${method} ${endpoint} - ${statusCode}`, error, context);\n  } else if (statusCode >= 400) {\n    logger.warn(`API Warning: ${method} ${endpoint} - ${statusCode}`, context);\n  } else {\n    logger.info(`API Call: ${method} ${endpoint} - ${statusCode}`, context);\n  }\n};\n\n// Log performance metrics\nexport const logPerformance = async (\n  action: string,\n  metrics: {\n    duration: number;\n    success: boolean;\n    userId?: string;\n    metadata?: Record<string, any>;\n  }\n) => {\n  const { duration, success, userId, metadata } = metrics;\n\n  const context: LogContext = {\n    userId,\n    action: `performance_${action}`,\n    metadata: {\n      operation: action,\n      duration: `${duration}ms`,\n      success,\n      ...metadata,\n    },\n  };\n\n  const message = `Performance: ${action} completed in ${duration}ms`;\n\n  if (!success) {\n    logger.warn(`${message} (failed)`, context);\n  } else if (duration > 5000) {\n    logger.warn(`${message} (slow)`, context);\n  } else {\n    logger.debug(message, context);\n  }\n};\n\n// Log authentication events in a consistent format\nexport const logAuthEvent = async (\n  event: 'login' | 'logout' | 'register' | 'verify' | 'failed_login',\n  context: {\n    userId?: string;\n    requestId?: string;\n    isTestUser?: boolean;\n    ip?: string | null;\n    userAgent?: string | null;\n    action?: string;\n    tags?: Record<string, unknown>;\n    extra?: Record<string, unknown>;\n  }\n) => {\n  const { action = `auth_${event}`, ...rest } = context;\n  logger.info(`Auth Event: ${event}`, {\n    action,\n    ...rest,\n  });\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/template-deployment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/test-integration.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logger' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'passedTests' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":33,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'totalTests' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":34,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'testResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":358,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":358,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Integration Testing Utilities for HIVE Real-time and Feature Flag Systems\n * Use these functions to test that both systems work together correctly\n */\n\nimport { realtimeService } from './firebase-realtime';\nimport { featureFlagService, UserFeatureContext, HIVE_FEATURE_FLAGS } from './feature-flags';\nimport { logger } from './structured-logger';\n\nexport interface IntegrationTestResult {\n  success: boolean;\n  testName: string;\n  duration: number;\n  result?: any;\n  error?: string;\n}\n\nexport class IntegrationTester {\n  private testResults: IntegrationTestResult[] = [];\n\n  /**\n   * Run all integration tests\n   */\n  async runAllTests(): Promise<IntegrationTestResult[]> {\n    this.testResults = [];\n    \n    \n    await this.testFeatureFlagEvaluation();\n    await this.testRealTimeMessaging();\n    await this.testFeatureFlagAndRealtimeIntegration();\n    await this.testAdminFeatureFlagCRUD();\n    \n    const passedTests = this.testResults.filter(r => r.success).length;\n    const totalTests = this.testResults.length;\n    \n    \n    return this.testResults;\n  }\n\n  /**\n   * Test feature flag evaluation system\n   */\n  private async testFeatureFlagEvaluation(): Promise<void> {\n    const testName = 'Feature Flag Evaluation';\n    const startTime = Date.now();\n    \n    try {\n      // Create test user context\n      const testUserContext: UserFeatureContext = {\n        userId: 'test-user-123',\n        userRole: 'member',\n        schoolId: 'buffalo.edu',\n        spaceIds: ['space-1', 'space-2']\n      };\n\n      // Test evaluating a feature flag\n      const result = await featureFlagService.isFeatureEnabled(\n        HIVE_FEATURE_FLAGS.REAL_TIME_CHAT,\n        testUserContext\n      );\n\n      // Test should pass if evaluation completes without error\n      this.testResults.push({\n        success: true,\n        testName,\n        duration: Date.now() - startTime,\n        result\n      });\n\n    } catch (error) {\n      this.testResults.push({\n        success: false,\n        testName,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error)\n      });\n\n    }\n  }\n\n  /**\n   * Test real-time messaging functionality\n   */\n  private async testRealTimeMessaging(): Promise<void> {\n    const testName = 'Real-time Messaging';\n    const startTime = Date.now();\n    \n    try {\n      // Test sending a message\n      const messageId = await realtimeService.sendMessage({\n        type: 'system',\n        channel: 'test:integration:messages',\n        senderId: 'test-system',\n        content: {\n          message: 'Integration test message',\n          timestamp: new Date().toISOString()\n        },\n        metadata: {\n          timestamp: new Date().toISOString(),\n          priority: 'normal',\n          requiresAck: false,\n          retryCount: 0\n        }\n      });\n\n      // Test should pass if message is sent successfully\n      this.testResults.push({\n        success: !!messageId,\n        testName,\n        duration: Date.now() - startTime,\n        result: { messageId }\n      });\n\n    } catch (error) {\n      this.testResults.push({\n        success: false,\n        testName,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error)\n      });\n\n    }\n  }\n\n  /**\n   * Test integration between feature flags and real-time messaging\n   */\n  private async testFeatureFlagAndRealtimeIntegration(): Promise<void> {\n    const testName = 'Feature Flag + Real-time Integration';\n    const startTime = Date.now();\n    \n    try {\n      const testUserContext: UserFeatureContext = {\n        userId: 'test-user-integration',\n        userRole: 'builder',\n        schoolId: 'buffalo.edu',\n        spaceIds: ['integration-space']\n      };\n\n      // Check if real-time chat is enabled for this user\n      const chatEnabled = await featureFlagService.isFeatureEnabled(\n        HIVE_FEATURE_FLAGS.REAL_TIME_CHAT,\n        testUserContext\n      );\n\n      // If chat is enabled, send a message\n      let messageResult = null;\n      if (chatEnabled.enabled) {\n        messageResult = await realtimeService.sendChatMessage(\n          'integration-space',\n          testUserContext.userId,\n          'Integration test: Chat feature is enabled!',\n          'text'\n        );\n      }\n\n      // Test notification system\n      await realtimeService.sendNotification(\n        testUserContext.userId,\n        {\n          title: 'Integration Test',\n          message: `Chat feature is ${chatEnabled.enabled ? 'enabled' : 'disabled'} for you`,\n          type: 'info',\n          metadata: { testRun: true }\n        }\n      );\n\n      this.testResults.push({\n        success: true,\n        testName,\n        duration: Date.now() - startTime,\n        result: {\n          chatEnabled: chatEnabled.enabled,\n          id: messageResult,\n          reason: chatEnabled.reason\n        }\n      });\n\n    } catch (error) {\n      this.testResults.push({\n        success: false,\n        testName,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error)\n      });\n\n    }\n  }\n\n  /**\n   * Test admin feature flag CRUD operations\n   */\n  private async testAdminFeatureFlagCRUD(): Promise<void> {\n    const testName = 'Admin Feature Flag CRUD';\n    const startTime = Date.now();\n    \n    try {\n      const testFlagId = 'test_integration_flag';\n      const adminUserId = 'test-admin';\n\n      // Create a test feature flag\n      await featureFlagService.setFeatureFlag({\n        id: testFlagId,\n        name: 'Integration Test Flag',\n        description: 'A feature flag created during integration testing',\n        category: 'experimental',\n        enabled: true,\n        rollout: {\n          type: 'percentage',\n          percentage: 50\n        },\n        analytics: {\n          trackingEnabled: true,\n          events: ['test_event']\n        }\n      }, adminUserId);\n\n      // Read the created flag\n      const createdFlag = await featureFlagService.getFeatureFlag(testFlagId);\n      \n      if (!createdFlag) {\n        throw new Error('Failed to create or retrieve test flag');\n      }\n\n      // Update the flag\n      await featureFlagService.setFeatureFlag({\n        ...createdFlag,\n        enabled: false,\n        rollout: {\n          type: 'all'\n        }\n      }, adminUserId);\n\n      // Verify the update\n      const updatedFlag = await featureFlagService.getFeatureFlag(testFlagId);\n      \n      if (!updatedFlag || updatedFlag.enabled || updatedFlag.rollout.type !== 'all') {\n        throw new Error('Flag update failed');\n      }\n\n      // Clean up - delete the test flag\n      await featureFlagService.deleteFeatureFlag(testFlagId, adminUserId);\n\n      // Verify deletion\n      const deletedFlag = await featureFlagService.getFeatureFlag(testFlagId);\n      \n      if (deletedFlag) {\n        throw new Error('Flag deletion failed');\n      }\n\n      this.testResults.push({\n        success: true,\n        testName,\n        duration: Date.now() - startTime,\n        result: {\n          created: !!createdFlag,\n          updated: !!updatedFlag,\n          deleted: !deletedFlag\n        }\n      });\n\n    } catch (error) {\n      this.testResults.push({\n        success: false,\n        testName,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error)\n      });\n\n    }\n  }\n\n  /**\n   * Test presence system functionality\n   */\n  async testPresenceSystem(): Promise<IntegrationTestResult> {\n    const testName = 'Presence System';\n    const startTime = Date.now();\n    \n    try {\n      const testUserId = 'test-presence-user';\n      const testSpaceId = 'test-space-presence';\n\n      // Update user presence\n      await realtimeService.updatePresence(testUserId, {\n        status: 'online',\n        currentSpace: testSpaceId,\n        activity: 'testing presence system',\n        metadata: {\n          platform: 'web',\n          version: '1.0.0'\n        }\n      } as any);\n\n      // Test typing indicators\n      await realtimeService.setTypingIndicator(testSpaceId, testUserId, true);\n      \n      // Wait a bit then stop typing\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      await realtimeService.setTypingIndicator(testSpaceId, testUserId, false);\n\n      const result = {\n        success: true,\n        testName,\n        duration: Date.now() - startTime,\n        result: {\n          presenceUpdated: true,\n          typingIndicatorSet: true\n        }\n      };\n\n      return result;\n    } catch (error) {\n      const result = {\n        success: false,\n        testName,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error)\n      };\n\n      return result;\n    }\n  }\n\n  /**\n   * Get test results summary\n   */\n  getTestSummary(): {\n    total: number;\n    passed: number;\n    failed: number;\n    passRate: number;\n    results: IntegrationTestResult[];\n  } {\n    const total = this.testResults.length;\n    const passed = this.testResults.filter(r => r.success).length;\n    const failed = total - passed;\n    const passRate = total > 0 ? (passed / total) * 100 : 0;\n\n    return {\n      total,\n      passed,\n      failed,\n      passRate,\n      results: this.testResults\n    };\n  }\n}\n\n// Export singleton instance\nexport const integrationTester = new IntegrationTester();\n\n// Utility function to run a quick smoke test\nexport async function runSmokeTest(): Promise<boolean> {\n  try {\n    \n    // Test basic feature flag evaluation\n    const testResult = await featureFlagService.isFeatureEnabled(\n      HIVE_FEATURE_FLAGS.REAL_TIME_CHAT,\n      {\n        userId: 'smoke-test-user',\n        userRole: 'member'\n      }\n    );\n\n    // Test basic message sending\n    await realtimeService.sendMessage({\n      type: 'system',\n      channel: 'smoke:test',\n      senderId: 'smoke-test',\n      content: { test: true },\n      metadata: {\n        timestamp: new Date().toISOString(),\n        priority: 'low',\n        requiresAck: false,\n        retryCount: 0\n      }\n    });\n\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n\n// Export the test interface for use in other parts of the application\n// IntegrationTestResult is already exported above","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/tool-execution-runtime.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/tool-navigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/transaction-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/unified-state-management.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Post' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'force' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":559,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":559,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * HIVE Unified State Management System\n * \n * Centralizes state across all platform slices with real-time synchronization\n * Manages Feed, Spaces, Tools, Profile data with optimistic updates\n */\n\nimport { create } from 'zustand';\nimport { subscribeWithSelector, devtools } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\nimport { type User, type Space, type Post, type Tool } from '@hive/core';\nimport { getPlatformIntegration, type FeedItem, type PlatformNotification } from './platform-integration';\n\n// ===== STATE INTERFACES =====\n\nexport interface UnifiedAppState {\n  // User & Authentication\n  user: User | null;\n  isAuthenticated: boolean;\n  authLoading: boolean;\n\n  // Cross-Slice Data\n  feedItems: FeedItem[];\n  userSpaces: Space[];\n  userTools: Tool[];\n  notifications: PlatformNotification[];\n\n  // UI State\n  currentSlice: 'feed' | 'spaces' | 'tools' | 'profile' | 'dashboard';\n  activeSpaceId: string | null;\n  activeToolId: string | null;\n  sidebarOpen: boolean;\n  commandPaletteOpen: boolean;\n\n  // Real-time State\n  isOnline: boolean;\n  websocketConnected: boolean;\n  lastSyncTime: string | null;\n  syncInProgress: boolean;\n\n  // Cache & Performance\n  cache: Map<string, any>;\n  cacheTimestamps: Map<string, number>;\n  optimisticUpdates: Map<string, any>;\n\n  // Loading States\n  feedLoading: boolean;\n  spacesLoading: boolean;\n  toolsLoading: boolean;\n  profileLoading: boolean;\n\n  // Error States\n  errors: {\n    feed: string | null;\n    spaces: string | null;\n    tools: string | null;\n    profile: string | null;\n    network: string | null;\n  };\n}\n\nexport interface UnifiedAppActions {\n  // Authentication Actions\n  setUser: (user: User | null) => void;\n  setAuthLoading: (loading: boolean) => void;\n  logout: () => void;\n\n  // Data Actions\n  setFeedItems: (items: FeedItem[]) => void;\n  addFeedItem: (item: FeedItem) => void;\n  updateFeedItem: (id: string, updates: Partial<FeedItem>) => void;\n  removeFeedItem: (id: string) => void;\n\n  setUserSpaces: (spaces: Space[]) => void;\n  addUserSpace: (space: Space) => void;\n  updateUserSpace: (id: string, updates: Partial<Space>) => void;\n  removeUserSpace: (id: string) => void;\n\n  setUserTools: (tools: Tool[]) => void;\n  addUserTool: (tool: Tool) => void;\n  updateUserTool: (id: string, updates: Partial<Tool>) => void;\n  removeUserTool: (id: string) => void;\n\n  setNotifications: (notifications: PlatformNotification[]) => void;\n  addNotification: (notification: PlatformNotification) => void;\n  markNotificationRead: (id: string) => void;\n  removeNotification: (id: string) => void;\n\n  // UI Actions\n  setCurrentSlice: (slice: UnifiedAppState['currentSlice']) => void;\n  setActiveSpaceId: (id: string | null) => void;\n  setActiveToolId: (id: string | null) => void;\n  setSidebarOpen: (open: boolean) => void;\n  setCommandPaletteOpen: (open: boolean) => void;\n\n  // Real-time Actions\n  setOnlineStatus: (online: boolean) => void;\n  setWebsocketStatus: (connected: boolean) => void;\n  updateLastSyncTime: () => void;\n  setSyncInProgress: (inProgress: boolean) => void;\n\n  // Loading Actions\n  setFeedLoading: (loading: boolean) => void;\n  setSpacesLoading: (loading: boolean) => void;\n  setToolsLoading: (loading: boolean) => void;\n  setProfileLoading: (loading: boolean) => void;\n\n  // Error Actions\n  setError: (slice: keyof UnifiedAppState['errors'], error: string | null) => void;\n  clearErrors: () => void;\n\n  // Cache Actions\n  setCacheItem: (key: string, value: any, ttl?: number) => void;\n  getCacheItem: (key: string) => any;\n  invalidateCache: (pattern?: string) => void;\n\n  // Optimistic Updates\n  addOptimisticUpdate: (key: string, update: any) => void;\n  resolveOptimisticUpdate: (key: string, success: boolean, actualData?: any) => void;\n  clearOptimisticUpdates: () => void;\n\n  // Data Fetching Actions\n  refreshFeed: (options?: { force?: boolean }) => Promise<void>;\n  refreshSpaces: (options?: { force?: boolean }) => Promise<void>;\n  refreshTools: (options?: { force?: boolean }) => Promise<void>;\n  refreshProfile: (options?: { force?: boolean }) => Promise<void>;\n  refreshAll: (options?: { force?: boolean }) => Promise<void>;\n\n  // Cross-Slice Actions\n  performOptimisticAction: (action: OptimisticAction) => Promise<void>;\n  syncWithServer: (slices?: string[]) => Promise<void>;\n  handleRealtimeUpdate: (update: RealtimeUpdate) => void;\n}\n\nexport interface OptimisticAction {\n  id: string;\n  type: 'create_post' | 'join_space' | 'create_tool' | 'like_post' | 'share_tool';\n  slice: string;\n  data: any;\n  apiCall: () => Promise<any>;\n  rollback?: () => void;\n}\n\nexport interface RealtimeUpdate {\n  type: string;\n  slice: string;\n  data: any;\n  timestamp: string;\n}\n\n// ===== ZUSTAND STORE =====\n\nexport const useUnifiedStore = create<UnifiedAppState & UnifiedAppActions>()(\n  devtools(\n    subscribeWithSelector(\n      immer((set, get) => ({\n        // Initial State\n        user: null,\n        isAuthenticated: false,\n        authLoading: false,\n        feedItems: [],\n        userSpaces: [],\n        userTools: [],\n        notifications: [],\n        currentSlice: 'feed',\n        activeSpaceId: null,\n        activeToolId: null,\n        sidebarOpen: true,\n        commandPaletteOpen: false,\n        isOnline: typeof navigator !== 'undefined' ? navigator.onLine : true,\n        websocketConnected: false,\n        lastSyncTime: null,\n        syncInProgress: false,\n        cache: new Map(),\n        cacheTimestamps: new Map(),\n        optimisticUpdates: new Map(),\n        feedLoading: false,\n        spacesLoading: false,\n        toolsLoading: false,\n        profileLoading: false,\n        errors: {\n          feed: null,\n          spaces: null,\n          tools: null,\n          profile: null,\n          network: null,\n        },\n\n        // Authentication Actions\n        setUser: (user) => set((state) => {\n          state.user = user;\n          state.isAuthenticated = !!user;\n        }),\n\n        setAuthLoading: (loading) => set((state) => {\n          state.authLoading = loading;\n        }),\n\n        logout: () => set((state) => {\n          state.user = null;\n          state.isAuthenticated = false;\n          state.feedItems = [];\n          state.userSpaces = [];\n          state.userTools = [];\n          state.notifications = [];\n          state.cache.clear();\n          state.cacheTimestamps.clear();\n          state.optimisticUpdates.clear();\n        }),\n\n        // Feed Actions\n        setFeedItems: (items) => set((state) => {\n          state.feedItems = items;\n        }),\n\n        addFeedItem: (item) => set((state) => {\n          state.feedItems.unshift(item);\n        }),\n\n        updateFeedItem: (id, updates) => set((state) => {\n          const index = state.feedItems.findIndex(item => item.id === id);\n          if (index !== -1) {\n            Object.assign(state.feedItems[index], updates);\n          }\n        }),\n\n        removeFeedItem: (id) => set((state) => {\n          state.feedItems = state.feedItems.filter(item => item.id !== id);\n        }),\n\n        // Spaces Actions\n        setUserSpaces: (spaces) => set((state) => {\n          state.userSpaces = spaces;\n        }),\n\n        addUserSpace: (space) => set((state) => {\n          state.userSpaces.push(space);\n        }),\n\n        updateUserSpace: (id, updates) => set((state) => {\n          const index = state.userSpaces.findIndex(space => space.id === id);\n          if (index !== -1) {\n            Object.assign(state.userSpaces[index], updates);\n          }\n        }),\n\n        removeUserSpace: (id) => set((state) => {\n          state.userSpaces = state.userSpaces.filter(space => space.id !== id);\n        }),\n\n        // Tools Actions\n        setUserTools: (tools) => set((state) => {\n          state.userTools = tools;\n        }),\n\n        addUserTool: (tool) => set((state) => {\n          state.userTools.push(tool);\n        }),\n\n        updateUserTool: (id, updates) => set((state) => {\n          const index = state.userTools.findIndex(tool => tool.id === id);\n          if (index !== -1) {\n            Object.assign(state.userTools[index], updates);\n          }\n        }),\n\n        removeUserTool: (id) => set((state) => {\n          state.userTools = state.userTools.filter(tool => tool.id !== id);\n        }),\n\n        // Notifications Actions\n        setNotifications: (notifications) => set((state) => {\n          state.notifications = notifications;\n        }),\n\n        addNotification: (notification) => set((state) => {\n          state.notifications.unshift(notification);\n        }),\n\n        markNotificationRead: (id) => set((state) => {\n          const notification = state.notifications.find(n => n.id === id);\n          if (notification) {\n            notification.metadata.read = true;\n          }\n        }),\n\n        removeNotification: (id) => set((state) => {\n          state.notifications = state.notifications.filter(n => n.id !== id);\n        }),\n\n        // UI Actions\n        setCurrentSlice: (slice) => set((state) => {\n          state.currentSlice = slice;\n        }),\n\n        setActiveSpaceId: (id) => set((state) => {\n          state.activeSpaceId = id;\n          if (id) {\n            state.currentSlice = 'spaces';\n          }\n        }),\n\n        setActiveToolId: (id) => set((state) => {\n          state.activeToolId = id;\n          if (id) {\n            state.currentSlice = 'tools';\n          }\n        }),\n\n        setSidebarOpen: (open) => set((state) => {\n          state.sidebarOpen = open;\n        }),\n\n        setCommandPaletteOpen: (open) => set((state) => {\n          state.commandPaletteOpen = open;\n        }),\n\n        // Real-time Actions\n        setOnlineStatus: (online) => set((state) => {\n          state.isOnline = online;\n          if (!online) {\n            state.websocketConnected = false;\n          }\n        }),\n\n        setWebsocketStatus: (connected) => set((state) => {\n          state.websocketConnected = connected;\n        }),\n\n        updateLastSyncTime: () => set((state) => {\n          state.lastSyncTime = new Date().toISOString();\n        }),\n\n        setSyncInProgress: (inProgress) => set((state) => {\n          state.syncInProgress = inProgress;\n        }),\n\n        // Loading Actions\n        setFeedLoading: (loading) => set((state) => {\n          state.feedLoading = loading;\n        }),\n\n        setSpacesLoading: (loading) => set((state) => {\n          state.spacesLoading = loading;\n        }),\n\n        setToolsLoading: (loading) => set((state) => {\n          state.toolsLoading = loading;\n        }),\n\n        setProfileLoading: (loading) => set((state) => {\n          state.profileLoading = loading;\n        }),\n\n        // Error Actions\n        setError: (slice, error) => set((state) => {\n          state.errors[slice] = error;\n        }),\n\n        clearErrors: () => set((state) => {\n          Object.keys(state.errors).forEach(key => {\n            state.errors[key as keyof typeof state.errors] = null;\n          });\n        }),\n\n        // Cache Actions\n        setCacheItem: (key, value, ttl = 300000) => set((state) => { // 5 minutes default TTL\n          state.cache.set(key, value);\n          state.cacheTimestamps.set(key, Date.now() + ttl);\n        }),\n\n        getCacheItem: (key) => {\n          const state = get();\n          const timestamp = state.cacheTimestamps.get(key);\n          if (timestamp && Date.now() < timestamp) {\n            return state.cache.get(key);\n          }\n          // Cache expired\n          state.cache.delete(key);\n          state.cacheTimestamps.delete(key);\n          return null;\n        },\n\n        invalidateCache: (pattern) => set((state) => {\n          if (pattern) {\n            for (const key of state.cache.keys()) {\n              if (key.includes(pattern)) {\n                state.cache.delete(key);\n                state.cacheTimestamps.delete(key);\n              }\n            }\n          } else {\n            state.cache.clear();\n            state.cacheTimestamps.clear();\n          }\n        }),\n\n        // Optimistic Updates\n        addOptimisticUpdate: (key, update) => set((state) => {\n          state.optimisticUpdates.set(key, update);\n        }),\n\n        resolveOptimisticUpdate: (key, success, actualData) => set((state) => {\n          const update = state.optimisticUpdates.get(key);\n          if (update) {\n            if (success && actualData) {\n              // Apply actual data\n              switch (update.type) {\n                case 'create_post': {\n                  const feedIndex = state.feedItems.findIndex(item => item.id === update.tempId);\n                  if (feedIndex !== -1) {\n                    state.feedItems[feedIndex] = actualData;\n                  }\n                  break;\n                }\n                case 'join_space': {\n                  const spaceIndex = state.userSpaces.findIndex(space => space.id === update.tempId);\n                  if (spaceIndex !== -1) {\n                    state.userSpaces[spaceIndex] = actualData;\n                  }\n                  break;\n                }\n                // Add more cases as needed\n              }\n            } else if (!success && update.rollback) {\n              // Rollback optimistic update\n              update.rollback();\n            }\n            state.optimisticUpdates.delete(key);\n          }\n        }),\n\n        clearOptimisticUpdates: () => set((state) => {\n          state.optimisticUpdates.clear();\n        }),\n\n        // Data Fetching Actions\n        refreshFeed: async (options = {}) => {\n          const { force = false } = options;\n          const state = get();\n          \n          if (!state.user) return;\n\n          // Check cache first\n          const cacheKey = `feed_${state.user.id}`;\n          if (!force) {\n            const cachedData = state.getCacheItem(cacheKey);\n            if (cachedData) {\n              state.setFeedItems(cachedData);\n              return;\n            }\n          }\n\n          try {\n            state.setFeedLoading(true);\n            state.setError('feed', null);\n\n            const integration = getPlatformIntegration();\n            const feedData = await integration.getUnifiedFeedData(state.user.id, {\n              limit: 20,\n              sources: ['feed', 'spaces', 'tools', 'profile']\n            });\n\n            state.setFeedItems(feedData);\n            state.setCacheItem(cacheKey, feedData);\n            state.updateLastSyncTime();\n          } catch (error) {\n            state.setError('feed', error instanceof Error ? error.message : 'Failed to refresh feed');\n          } finally {\n            state.setFeedLoading(false);\n          }\n        },\n\n        refreshSpaces: async (options = {}) => {\n          const { force = false } = options;\n          const state = get();\n          \n          if (!state.user) return;\n\n          const cacheKey = `spaces_${state.user.id}`;\n          if (!force) {\n            const cachedData = state.getCacheItem(cacheKey);\n            if (cachedData) {\n              state.setUserSpaces(cachedData);\n              return;\n            }\n          }\n\n          try {\n            state.setSpacesLoading(true);\n            state.setError('spaces', null);\n\n            const response = await fetch('/api/profile/spaces/actions', {\n              headers: {\n                'Authorization': `Bearer ${await getAuthToken()}`\n              }\n            });\n\n            if (!response.ok) {\n              throw new Error('Failed to fetch spaces');\n            }\n\n            const data = await response.json();\n            const spaces = data.spaces || [];\n\n            state.setUserSpaces(spaces);\n            state.setCacheItem(cacheKey, spaces);\n            state.updateLastSyncTime();\n          } catch (error) {\n            state.setError('spaces', error instanceof Error ? error.message : 'Failed to refresh spaces');\n          } finally {\n            state.setSpacesLoading(false);\n          }\n        },\n\n        refreshTools: async (options = {}) => {\n          const { force = false } = options;\n          const state = get();\n          \n          if (!state.user) return;\n\n          const cacheKey = `tools_${state.user.id}`;\n          if (!force) {\n            const cachedData = state.getCacheItem(cacheKey);\n            if (cachedData) {\n              state.setUserTools(cachedData);\n              return;\n            }\n          }\n\n          try {\n            state.setToolsLoading(true);\n            state.setError('tools', null);\n\n            const response = await fetch('/api/tools/personal', {\n              headers: {\n                'Authorization': `Bearer ${await getAuthToken()}`\n              }\n            });\n\n            if (!response.ok) {\n              throw new Error('Failed to fetch tools');\n            }\n\n            const data = await response.json();\n            const tools = data.tools || [];\n\n            state.setUserTools(tools);\n            state.setCacheItem(cacheKey, tools);\n            state.updateLastSyncTime();\n          } catch (error) {\n            state.setError('tools', error instanceof Error ? error.message : 'Failed to refresh tools');\n          } finally {\n            state.setToolsLoading(false);\n          }\n        },\n\n        refreshProfile: async (options = {}) => {\n          const { force = false } = options;\n          const state = get();\n          \n          if (!state.user) return;\n\n          try {\n            state.setProfileLoading(true);\n            state.setError('profile', null);\n\n            const response = await fetch('/api/profile/dashboard', {\n              headers: {\n                'Authorization': `Bearer ${await getAuthToken()}`\n              }\n            });\n\n            if (!response.ok) {\n              throw new Error('Failed to fetch profile');\n            }\n\n            const data = await response.json();\n            \n            // Update user data if needed\n            if (data.user) {\n              state.setUser({ ...state.user, ...data.user });\n            }\n\n            state.updateLastSyncTime();\n          } catch (error) {\n            state.setError('profile', error instanceof Error ? error.message : 'Failed to refresh profile');\n          } finally {\n            state.setProfileLoading(false);\n          }\n        },\n\n        refreshAll: async (options = {}) => {\n          const state = get();\n          state.setSyncInProgress(true);\n          \n          try {\n            await Promise.all([\n              state.refreshFeed(options),\n              state.refreshSpaces(options),\n              state.refreshTools(options),\n              state.refreshProfile(options)\n            ]);\n          } catch (error) {\n      // Intentionally suppressed - non-critical error\n    } finally {\n            state.setSyncInProgress(false);\n          }\n        },\n\n        // Cross-Slice Actions\n        performOptimisticAction: async (action) => {\n          const state = get();\n          \n          try {\n            // Add optimistic update\n            state.addOptimisticUpdate(action.id, action);\n\n            // Perform optimistic UI update\n            switch (action.type) {\n              case 'create_post': {\n                const tempPost: FeedItem = {\n                  id: `temp_${action.id}`,\n                  type: 'post',\n                  sourceSlice: 'feed',\n                  sourceId: `temp_${action.id}`,\n                  userId: state.user?.id || '',\n                  content: action.data,\n                  metadata: {\n                    visibility: 'public',\n                    priority: 'medium',\n                    tags: [],\n                    timestamp: new Date().toISOString()\n                  }\n                };\n                state.addFeedItem(tempPost);\n                break;\n              }\n              case 'join_space': {\n                const tempSpace: Space = {\n                  id: `temp_${action.id}`,\n                  ...action.data,\n                  memberCount: (action.data.memberCount || 0) + 1\n                };\n                state.addUserSpace(tempSpace);\n                break;\n              }\n\n              // Add more optimistic updates as needed\n            }\n\n            // Perform actual API call\n            const result = await action.apiCall();\n            \n            // Resolve optimistic update with success\n            state.resolveOptimisticUpdate(action.id, true, result);\n            \n          } catch (error) {\n            \n            // Resolve optimistic update with failure\n            state.resolveOptimisticUpdate(action.id, false);\n            \n            // Show error\n            state.setError('network', error instanceof Error ? error.message : 'Action failed');\n          }\n        },\n\n        syncWithServer: async (slices = ['feed', 'spaces', 'tools', 'profile']) => {\n          const state = get();\n          \n          if (!state.isOnline) {\n            return;\n          }\n\n          state.setSyncInProgress(true);\n          \n          try {\n            const syncPromises = slices.map(slice => {\n              switch (slice) {\n                case 'feed': return state.refreshFeed({ force: true });\n                case 'spaces': return state.refreshSpaces({ force: true });\n                case 'tools': return state.refreshTools({ force: true });\n                case 'profile': return state.refreshProfile({ force: true });\n                default: return Promise.resolve();\n              }\n            });\n\n            await Promise.all(syncPromises);\n          } catch (error) {\n            state.setError('network', 'Sync failed');\n          } finally {\n            state.setSyncInProgress(false);\n          }\n        },\n\n        handleRealtimeUpdate: (update) => {\n          const state = get();\n          \n          \n          switch (update.type) {\n            case 'feed_update':\n              if (update.data.type === 'new_post') {\n                state.addFeedItem(update.data.post);\n              } else if (update.data.type === 'post_updated') {\n                state.updateFeedItem(update.data.postId, update.data.updates);\n              }\n              break;\n\n            case 'space_activity':\n              if (update.data.type === 'member_joined') {\n                const space = state.userSpaces.find(s => s.id === update.data.spaceId);\n                if (space) {\n                  state.updateUserSpace(space.id, {\n                    memberCount: (space.memberCount || 0) + 1\n                  });\n                }\n              }\n              break;\n\n            case 'tool_interaction':\n              if (update.data.type === 'tool_deployed') {\n                const tool = state.userTools.find(t => t.id === update.data.toolId);\n                if (tool) {\n                  state.updateUserTool(tool.id, {\n                    // deploymentCount: (tool.deploymentCount || 0) + 1\n                  } as any);\n                }\n              }\n              break;\n\n            case 'notification':\n              state.addNotification(update.data);\n              break;\n\n            default:\n          }\n          \n          // Invalidate relevant cache entries\n          state.invalidateCache(update.slice);\n        }\n      }))\n    ),\n    { name: 'hive-unified-store' }\n  )\n);\n\n// ===== HELPER FUNCTIONS =====\n\nasync function getAuthToken(): Promise<string> {\n  if (typeof window === 'undefined') return '';\n  \n  try {\n    const sessionJson = localStorage.getItem('hive_session');\n    if (sessionJson) {\n      const session = JSON.parse(sessionJson);\n      return process.env.NODE_ENV === 'development' \n        ? `dev_token_${session.id}` \n        : session.token;\n    }\n  } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n  \n  return '';\n}\n\n// ===== HOOKS FOR SPECIFIC SLICES =====\n\nexport const useFeedState = () => {\n  const feedItems = useUnifiedStore(state => state.feedItems);\n  const feedLoading = useUnifiedStore(state => state.feedLoading);\n  const feedError = useUnifiedStore(state => state.errors.feed);\n  const refreshFeed = useUnifiedStore(state => state.refreshFeed);\n  const addFeedItem = useUnifiedStore(state => state.addFeedItem);\n  const updateFeedItem = useUnifiedStore(state => state.updateFeedItem);\n\n  return {\n    feedItems,\n    loading: feedLoading,\n    error: feedError,\n    refresh: refreshFeed,\n    addItem: addFeedItem,\n    updateItem: updateFeedItem\n  };\n};\n\nexport const useSpacesState = () => {\n  const userSpaces = useUnifiedStore(state => state.userSpaces);\n  const spacesLoading = useUnifiedStore(state => state.spacesLoading);\n  const spacesError = useUnifiedStore(state => state.errors.spaces);\n  const activeSpaceId = useUnifiedStore(state => state.activeSpaceId);\n  const refreshSpaces = useUnifiedStore(state => state.refreshSpaces);\n  const setActiveSpaceId = useUnifiedStore(state => state.setActiveSpaceId);\n\n  return {\n    spaces: userSpaces,\n    loading: spacesLoading,\n    error: spacesError,\n    activeSpaceId,\n    refresh: refreshSpaces,\n    setActiveSpace: setActiveSpaceId\n  };\n};\n\nexport const useToolsState = () => {\n  const userTools = useUnifiedStore(state => state.userTools);\n  const toolsLoading = useUnifiedStore(state => state.toolsLoading);\n  const toolsError = useUnifiedStore(state => state.errors.tools);\n  const activeToolId = useUnifiedStore(state => state.activeToolId);\n  const refreshTools = useUnifiedStore(state => state.refreshTools);\n  const setActiveToolId = useUnifiedStore(state => state.setActiveToolId);\n\n  return {\n    tools: userTools,\n    loading: toolsLoading,\n    error: toolsError,\n    activeToolId,\n    refresh: refreshTools,\n    setActiveTool: setActiveToolId\n  };\n};\n\nexport const useNotificationsState = () => {\n  const notifications = useUnifiedStore(state => state.notifications);\n  const addNotification = useUnifiedStore(state => state.addNotification);\n  const markNotificationRead = useUnifiedStore(state => state.markNotificationRead);\n  const removeNotification = useUnifiedStore(state => state.removeNotification);\n\n  const unreadCount = notifications.filter(n => !n.metadata.read).length;\n\n  return {\n    notifications,\n    unreadCount,\n    addNotification,\n    markAsRead: markNotificationRead,\n    removeNotification\n  };\n};\n\nexport const useRealtimeState = () => {\n  const isOnline = useUnifiedStore(state => state.isOnline);\n  const websocketConnected = useUnifiedStore(state => state.websocketConnected);\n  const lastSyncTime = useUnifiedStore(state => state.lastSyncTime);\n  const syncInProgress = useUnifiedStore(state => state.syncInProgress);\n  const syncWithServer = useUnifiedStore(state => state.syncWithServer);\n  const handleRealtimeUpdate = useUnifiedStore(state => state.handleRealtimeUpdate);\n\n  return {\n    isOnline,\n    websocketConnected,\n    lastSyncTime,\n    syncInProgress,\n    syncWithServer,\n    handleRealtimeUpdate\n  };\n};\n\n// ===== INITIALIZATION HELPER =====\n\nexport function initializeUnifiedState(user: User | null) {\n  const store = useUnifiedStore.getState();\n  \n  if (user) {\n    store.setUser(user);\n    \n    // Initialize data loading\n    Promise.all([\n      store.refreshFeed(),\n      store.refreshSpaces(),\n      store.refreshTools(),\n      store.refreshProfile()\n    ]).catch(error => {\n    });\n\n    // Set up real-time integration\n    const integration = getPlatformIntegration();\n    \n    // Subscribe to real-time updates\n    const unsubscribePlatform = integration.subscribe('platform_update', (data: any) => {\n      store.handleRealtimeUpdate({\n        type: 'platform_update',\n        slice: 'all',\n        data,\n        timestamp: new Date().toISOString()\n      });\n    });\n\n    const unsubscribeFeed = integration.subscribe('feed_update', (data: any) => {\n      store.handleRealtimeUpdate({\n        type: 'feed_update',\n        slice: 'feed',\n        data,\n        timestamp: new Date().toISOString()\n      });\n    });\n\n    const unsubscribeNotifications = integration.subscribe('notification', (data: any) => {\n      store.handleRealtimeUpdate({\n        type: 'notification',\n        slice: 'notifications',\n        data,\n        timestamp: new Date().toISOString()\n      });\n    });\n\n    // Set up online/offline detection\n    const handleOnline = () => store.setOnlineStatus(true);\n    const handleOffline = () => store.setOnlineStatus(false);\n    \n    if (typeof window !== 'undefined') {\n      window.addEventListener('online', handleOnline);\n      window.addEventListener('offline', handleOffline);\n    }\n\n    // Set up periodic sync\n    const syncInterval = setInterval(() => {\n      if (store.isOnline && !store.syncInProgress) {\n        store.syncWithServer();\n      }\n    }, 5 * 60 * 1000); // Every 5 minutes\n\n    // Return cleanup function\n    return () => {\n      unsubscribePlatform();\n      unsubscribeFeed();\n      unsubscribeNotifications();\n      \n      if (typeof window !== 'undefined') {\n        window.removeEventListener('online', handleOnline);\n        window.removeEventListener('offline', handleOffline);\n      }\n      \n      clearInterval(syncInterval);\n    };\n  }\n\n  return () => {};\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/lib/validation-middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/middleware/admin-security.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'email' is defined but never used. Allowed unused args must match /^_|^data$|^user$|^error$|^event$|^props$|^filter$/u.","line":152,"column":59,"nodeType":null,"messageId":"unusedVar","endLine":152,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport { logger } from '@/lib/logger';\n\n/**\n * Enhanced Admin Security Middleware\n * Adds multiple layers of protection for admin routes\n */\n\n// Allowed IP ranges (configure for your campus/home IPs)\nconst ALLOWED_ADMIN_IPS = process.env.ADMIN_ALLOWED_IPS?.split(',') || [];\nconst ADMIN_EMAILS = ['jwrhineh@buffalo.edu', 'noahowsh@gmail.com'];\n\n// Rate limiting map\nconst adminAccessAttempts = new Map<string, { count: number; firstAttempt: number }>();\n\nexport async function enforceAdminSecurity(\n  request: NextRequest,\n  userEmail?: string,\n  userId?: string\n): Promise<NextResponse | null> {\n  const pathname = request.nextUrl.pathname;\n  const isAdminRoute = pathname.startsWith('/admin') || pathname.startsWith('/api/admin');\n\n  if (!isAdminRoute) {\n    return null; // Not an admin route, skip checks\n  }\n\n  // 1. Check if user is in admin whitelist\n  if (userEmail && !ADMIN_EMAILS.includes(userEmail)) {\n    logger.warn('üö´ Non-admin attempted admin access', {\n      userId,\n      metadata: {\n        email: userEmail,\n        path: pathname,\n        ip: request.headers.get('x-forwarded-for')\n      }\n    });\n\n    return NextResponse.redirect(new URL('/', request.url));\n  }\n\n  // 2. IP Restriction (if configured)\n  if (ALLOWED_ADMIN_IPS.length > 0) {\n    const clientIP = request.headers.get('x-forwarded-for')?.split(',')[0] ||\n                     request.headers.get('x-real-ip') ||\n                     'unknown';\n\n    if (!ALLOWED_ADMIN_IPS.includes(clientIP)) {\n      logger.error('üîí Admin access blocked - IP not whitelisted', {\n        metadata: {\n          ip: clientIP,\n          email: userEmail,\n          path: pathname\n        }\n      });\n\n      return NextResponse.json(\n        { error: 'Access denied from this network' },\n        { status: 403 }\n      );\n    }\n  }\n\n  // 3. Rate Limiting for Admin Routes\n  const identifier = userEmail || request.headers.get('x-forwarded-for') || 'unknown';\n  const now = Date.now();\n  const attempts = adminAccessAttempts.get(identifier);\n\n  if (attempts) {\n    // Reset if more than 1 hour has passed\n    if (now - attempts.firstAttempt > 3600000) {\n      adminAccessAttempts.delete(identifier);\n    } else if (attempts.count > 100) { // 100 requests per hour max\n      logger.error('‚ö†Ô∏è Admin rate limit exceeded', {\n        metadata: {\n          identifier,\n          count: attempts.count,\n          path: pathname\n        }\n      });\n\n      return NextResponse.json(\n        { error: 'Rate limit exceeded. Try again later.' },\n        { status: 429 }\n      );\n    } else {\n      attempts.count++;\n    }\n  } else {\n    adminAccessAttempts.set(identifier, { count: 1, firstAttempt: now });\n  }\n\n  // 4. Add Security Headers for Admin Routes\n  const response = NextResponse.next();\n\n  // Strict CSP for admin\n  response.headers.set(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';\"\n  );\n\n  // Prevent framing\n  response.headers.set('X-Frame-Options', 'DENY');\n\n  // XSS Protection\n  response.headers.set('X-XSS-Protection', '1; mode=block');\n\n  // No sniffing\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n\n  // Referrer policy\n  response.headers.set('Referrer-Policy', 'same-origin');\n\n  // 5. Log all admin access\n  logger.info('üëë Admin route accessed', {\n    metadata: {\n      email: userEmail,\n      userId,\n      path: pathname,\n      method: request.method,\n      ip: request.headers.get('x-forwarded-for') || undefined,\n      userAgent: request.headers.get('user-agent') || undefined\n    }\n  });\n\n  return null; // Allow access\n}\n\n/**\n * Check if request is from a trusted network\n */\nexport function isTrustedNetwork(request: NextRequest): boolean {\n  const clientIP = request.headers.get('x-forwarded-for')?.split(',')[0] ||\n                   request.headers.get('x-real-ip');\n\n  if (!clientIP) return false;\n\n  // Campus network ranges (example - update with actual UB ranges)\n  const campusRanges = [\n    '128.205.', // UB network prefix\n    '10.', // Private network\n    '192.168.', // Local network\n    '127.0.0.1', // Localhost\n  ];\n\n  return campusRanges.some(range => clientIP.startsWith(range));\n}\n\n/**\n * Generate admin session token with enhanced security\n */\nexport function generateAdminSessionToken(userId: string, email: string): string {\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2);\n\n  // In production, use proper JWT with signing\n  return `admin_${userId}_${timestamp}_${random}`;\n}\n\n/**\n * Validate admin session token\n */\nexport function validateAdminSessionToken(token: string): boolean {\n  if (!token || !token.startsWith('admin_')) {\n    return false;\n  }\n\n  const parts = token.split('_');\n  if (parts.length !== 4) {\n    return false;\n  }\n\n  const timestamp = parseInt(parts[2]);\n  const now = Date.now();\n  const maxAge = 4 * 60 * 60 * 1000; // 4 hours for admin sessions\n\n  return (now - timestamp) < maxAge;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/scripts/test-firebase-auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'colors' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":19,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'link' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":64,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'testUid' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":92,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'claims' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":93,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\n\n/**\n * Test script for Firebase Auth email configuration\n * Run with: npx tsx src/scripts/test-firebase-auth.ts\n */\n\n// Load environment variables\nimport dotenv from 'dotenv';\nimport path from 'path';\n\n// Load .env.local file\ndotenv.config({ path: path.resolve(process.cwd(), '.env.local') });\n\nimport { getAuth } from 'firebase-admin/auth';\nimport { initializeApp, cert, getApps } from 'firebase-admin/app';\n\n// Colors for console output\nconst colors = {\n  green: '\\x1b[32m',\n  yellow: '\\x1b[33m',\n  red: '\\x1b[31m',\n  blue: '\\x1b[34m',\n  reset: '\\x1b[0m'\n};\n\nasync function testFirebaseAuth() {\n\n  try {\n    // Check if app is already initialized\n    const apps = getApps();\n    let app;\n\n    if (apps.length > 0) {\n      app = apps[0];\n    } else {\n      // Initialize Firebase Admin\n      const privateKey = process.env.FIREBASE_PRIVATE_KEY?.replace(/\\\\n/g, '\\n');\n\n      if (!privateKey) {\n        throw new Error('FIREBASE_PRIVATE_KEY not found in environment variables');\n      }\n\n      app = initializeApp({\n        credential: cert({\n          projectId: process.env.FIREBASE_PROJECT_ID || 'hive-9265c',\n          clientEmail: process.env.FIREBASE_CLIENT_EMAIL || 'firebase-adminsdk-fbsvc@hive-9265c.iam.gserviceaccount.com',\n          privateKey: privateKey,\n        })\n      });\n    }\n\n    const auth = getAuth(app);\n\n    // Test 1: Check if email provider is enabled\n    try {\n      const testEmail = 'test@buffalo.edu';\n      const actionCodeSettings = {\n        url: 'http://localhost:3000/auth/verify',\n        handleCodeInApp: true\n      };\n\n      // Try to generate a test link\n      const link = await auth.generateSignInWithEmailLink(testEmail, actionCodeSettings);\n    } catch (error: any) {\n      if (error.code === 'auth/operation-not-allowed') {\n        // Email link auth not enabled\n      } else {\n        // Other error\n      }\n    }\n\n    // Test 2: Check authorized domains\n\n    // Test 3: List recent users\n    try {\n      const listUsersResult = await auth.listUsers(5);\n      if (listUsersResult.users.length > 0) {\n        listUsersResult.users.forEach(user => {\n          // User found - test successful\n        });\n      } else {\n        // No users found\n      }\n    } catch (error: any) {\n      // Error listing users\n    }\n\n    // Test 4: Check custom claims capability\n    try {\n      // Try to set custom claims on a test user (won't actually create if email auth is disabled)\n      const testUid = 'test-user-' + Date.now();\n      const claims = { role: 'student', campus: 'ub-buffalo' };\n\n      // This will fail if the user doesn't exist, which is fine for our test\n    } catch (error) {\n      // Intentionally suppressed - non-critical error\n    }\n\n    // Summary\n\n\n    process.exit(0);\n\n  } catch (error: any) {\n    process.exit(1);\n  }\n}\n\n// Run the test\ntestFirebaseAuth().catch(console.error);","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/src/types/global.d.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'QueryDocumentSnapshot' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FirebaseUser' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Global Type Definitions for HIVE Platform\n * RED TEAM - Type Safety Initiative\n *\n * This file contains comprehensive type definitions to replace\n * the 1,526 'any' type usages found across the codebase.\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport {\n  Timestamp,\n  DocumentData,\n  QueryDocumentSnapshot,\n  DocumentReference,\n  CollectionReference,\n  Query\n} from 'firebase/firestore';\nimport { User as FirebaseUser } from 'firebase/auth';\n\n// ============================================\n// Core Domain Types\n// ============================================\n\nexport interface HiveUser {\n  id: string;\n  email: string;\n  emailVerified: boolean;\n  handle?: string;\n  firstName?: string;\n  lastName?: string;\n  fullName?: string;\n  bio?: string;\n  major?: string;\n  graduationYear?: number;\n  profileImageUrl?: string;\n  coverImageUrl?: string;\n  socialLinks?: SocialLinks;\n  interests?: string[];\n  skills?: string[];\n  campusId: string;\n  isActive: boolean;\n  isAdmin?: boolean;\n  createdAt: Timestamp | Date;\n  updatedAt: Timestamp | Date;\n  lastActiveAt?: Timestamp | Date;\n  onboardingCompleted?: boolean;\n  metadata?: UserMetadata;\n}\n\nexport interface UserMetadata {\n  loginCount?: number;\n  lastLoginAt?: Timestamp | Date;\n  lastLoginIp?: string;\n  deviceInfo?: string;\n  preferences?: UserPreferences;\n}\n\nexport interface UserPreferences {\n  theme?: 'light' | 'dark' | 'auto';\n  emailNotifications?: boolean;\n  pushNotifications?: boolean;\n  language?: string;\n  timezone?: string;\n}\n\nexport interface SocialLinks {\n  instagram?: string;\n  twitter?: string;\n  linkedin?: string;\n  github?: string;\n  website?: string;\n}\n\nexport interface Space {\n  id: string;\n  name: string;\n  slug: string;\n  description?: string;\n  category: SpaceCategory;\n  coverImageUrl?: string;\n  iconUrl?: string;\n  campusId: string;\n  createdBy: string;\n  createdAt: Timestamp | Date;\n  updatedAt: Timestamp | Date;\n  memberCount: number;\n  postCount: number;\n  isActive: boolean;\n  isPublic: boolean;\n  settings?: SpaceSettings;\n  metadata?: SpaceMetadata;\n}\n\nexport type SpaceCategory =\n  | 'academic'\n  | 'social'\n  | 'sports'\n  | 'clubs'\n  | 'housing'\n  | 'marketplace'\n  | 'events'\n  | 'other';\n\nexport interface SpaceSettings {\n  requireApproval?: boolean;\n  allowAnonymousPosts?: boolean;\n  moderationLevel?: 'none' | 'low' | 'medium' | 'high';\n  pinnedPosts?: string[];\n}\n\nexport interface SpaceMetadata {\n  totalViews?: number;\n  weeklyActiveMembers?: number;\n  trending?: boolean;\n  tags?: string[];\n}\n\nexport interface Post {\n  id: string;\n  spaceId: string;\n  authorId: string;\n  authorName?: string;\n  authorHandle?: string;\n  authorAvatar?: string;\n  content: string;\n  images?: string[];\n  attachments?: Attachment[];\n  type: PostType;\n  visibility: 'public' | 'members' | 'private';\n  campusId: string;\n  createdAt: Timestamp | Date;\n  updatedAt: Timestamp | Date;\n  likeCount: number;\n  commentCount: number;\n  shareCount: number;\n  viewCount: number;\n  isPinned?: boolean;\n  isPromoted?: boolean;\n  metadata?: PostMetadata;\n}\n\nexport type PostType =\n  | 'text'\n  | 'image'\n  | 'poll'\n  | 'event'\n  | 'marketplace'\n  | 'announcement';\n\nexport interface PostMetadata {\n  edited?: boolean;\n  editedAt?: Timestamp | Date;\n  reportCount?: number;\n  isHidden?: boolean;\n  moderationStatus?: 'pending' | 'approved' | 'rejected';\n}\n\nexport interface Comment {\n  id: string;\n  postId: string;\n  authorId: string;\n  authorName?: string;\n  authorHandle?: string;\n  authorAvatar?: string;\n  content: string;\n  createdAt: Timestamp | Date;\n  updatedAt: Timestamp | Date;\n  likeCount: number;\n  replyCount?: number;\n  parentCommentId?: string;\n  isDeleted?: boolean;\n}\n\nexport interface Attachment {\n  type: 'image' | 'video' | 'document' | 'link';\n  url: string;\n  name?: string;\n  size?: number;\n  mimeType?: string;\n  thumbnail?: string;\n}\n\n// ============================================\n// API Types\n// ============================================\n\nexport interface ApiAuthContext {\n  userId: string;\n  token: string;\n  isAdmin?: boolean;\n  user: {\n    email?: string;\n    emailVerified?: boolean;\n  };\n}\n\nexport interface ApiResponse<T = unknown> {\n  success: boolean;\n  data?: T;\n  error?: ApiError;\n  metadata?: ResponseMetadata;\n}\n\nexport interface ApiError {\n  message: string;\n  code: string;\n  details?: Record<string, unknown>;\n  statusCode?: number;\n}\n\nexport interface ResponseMetadata {\n  timestamp?: string;\n  requestId?: string;\n  version?: string;\n}\n\nexport interface PaginationParams {\n  limit?: number;\n  cursor?: string;\n  offset?: number;\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n}\n\nexport interface PaginationResponse {\n  items: any[];\n  nextCursor?: string;\n  hasMore: boolean;\n  total?: number;\n  page?: number;\n  pageSize?: number;\n}\n\n// ============================================\n// Route Handler Types\n// ============================================\n\nexport type RouteHandler<TParams = void> = TParams extends void\n  ? (request: NextRequest) => Promise<NextResponse> | NextResponse\n  : (request: NextRequest, params: TParams) => Promise<NextResponse> | NextResponse;\n\nexport type AuthenticatedRouteHandler<TParams = void> = TParams extends void\n  ? (request: NextRequest, context: ApiAuthContext) => Promise<NextResponse> | NextResponse\n  : (request: NextRequest, context: ApiAuthContext, params: TParams) => Promise<NextResponse> | NextResponse;\n\nexport interface RouteParams {\n  params: Record<string, string | string[]>;\n  searchParams?: URLSearchParams;\n}\n\nexport interface DynamicRouteParams {\n  params: {\n    [key: string]: string;\n  };\n}\n\n// ============================================\n// Firebase Types\n// ============================================\n\nexport interface FirebaseDoc extends DocumentData {\n  id: string;\n  createdAt: Timestamp;\n  updatedAt: Timestamp;\n}\n\nexport interface FirebaseQuery {\n  collection: string;\n  where?: Array<{\n    field: string;\n    operator: WhereFilterOp;\n    value: any;\n  }>;\n  orderBy?: {\n    field: string;\n    direction: 'asc' | 'desc';\n  };\n  limit?: number;\n  startAfter?: any;\n}\n\nexport type WhereFilterOp =\n  | '<' | '<=' | '==' | '!=' | '>=' | '>'\n  | 'array-contains' | 'array-contains-any'\n  | 'in' | 'not-in';\n\nexport type FirebaseTimestamp = Timestamp;\nexport type FirebaseDocRef = DocumentReference;\nexport type FirebaseCollectionRef = CollectionReference;\nexport type FirebaseQuery = Query;\n\n// ============================================\n// Form & Input Types\n// ============================================\n\nexport interface FormData<T = Record<string, unknown>> {\n  values: T;\n  errors: Partial<Record<keyof T, string>>;\n  touched: Partial<Record<keyof T, boolean>>;\n  isSubmitting: boolean;\n  isValid: boolean;\n}\n\nexport interface SelectOption<T = string> {\n  value: T;\n  label: string;\n  disabled?: boolean;\n  icon?: string;\n}\n\nexport interface FileUpload {\n  file: File;\n  url?: string;\n  progress?: number;\n  error?: string;\n  status: 'pending' | 'uploading' | 'success' | 'error';\n}\n\n// ============================================\n// Event Types\n// ============================================\n\nexport interface HiveEvent {\n  id: string;\n  title: string;\n  description?: string;\n  startDate: Date | Timestamp;\n  endDate?: Date | Timestamp;\n  location?: EventLocation;\n  organizer: EventOrganizer;\n  attendees?: string[];\n  maxAttendees?: number;\n  isPublic: boolean;\n  tags?: string[];\n  imageUrl?: string;\n  createdAt: Timestamp | Date;\n  updatedAt: Timestamp | Date;\n  campusId: string;\n}\n\nexport interface EventLocation {\n  name: string;\n  address?: string;\n  building?: string;\n  room?: string;\n  coordinates?: {\n    lat: number;\n    lng: number;\n  };\n}\n\nexport interface EventOrganizer {\n  id: string;\n  name: string;\n  type: 'user' | 'space' | 'organization';\n  avatar?: string;\n}\n\n// ============================================\n// Notification Types\n// ============================================\n\nexport interface Notification {\n  id: string;\n  userId: string;\n  type: NotificationType;\n  title: string;\n  body?: string;\n  data?: Record<string, unknown>;\n  delivery?: Record<string, unknown>;\n  read: boolean;\n  createdAt: Timestamp | Date;\n  expiresAt?: Timestamp | Date;\n}\n\nexport type NotificationType =\n  | 'like'\n  | 'comment'\n  | 'follow'\n  | 'mention'\n  | 'post'\n  | 'event'\n  | 'announcement'\n  | 'system'\n  | 'space_event'\n  | 'tool_update'\n  | 'system_announcement'\n  | 'message_reaction'\n  | 'space_invitation'\n  | 'tool_deployment';\n\n// ============================================\n// Analytics Types\n// ============================================\n\nexport interface AnalyticsEvent {\n  name: string;\n  category: string;\n  action: string;\n  label?: string;\n  value?: number;\n  userId?: string;\n  sessionId?: string;\n  timestamp: Date;\n  properties?: Record<string, unknown>;\n}\n\nexport interface AnalyticsMetrics {\n  pageViews: number;\n  uniqueVisitors: number;\n  sessionDuration: number;\n  bounceRate: number;\n  conversionRate?: number;\n}\n\n// ============================================\n// Error Types\n// ============================================\n\nexport interface AppError extends Error {\n  code: string;\n  statusCode: number;\n  context?: Record<string, unknown>;\n  cause?: any;\n  toJSON(): object;\n}\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n  code?: string;\n  value?: any;\n}\n\n// ============================================\n// Utility Types\n// ============================================\n\nexport type Nullable<T> = T | null;\nexport type Optional<T> = T | undefined;\nexport type Maybe<T> = T | null | undefined;\n\nexport type PartialBy<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;\nexport type RequiredBy<T, K extends keyof T> = Omit<T, K> & Required<Pick<T, K>>;\n\nexport type AsyncFunction<T = void, R = void> = (arg: T) => Promise<R>;\nexport type SyncFunction<T = void, R = void> = (arg: T) => R;\n\nexport type DeepPartial<T> = {\n  [P in keyof T]?: T[P] extends (infer U)[]\n    ? DeepPartial<U>[]\n    : T[P] extends object\n    ? DeepPartial<T[P]>\n    : T[P];\n};\n\n// ============================================\n// Component Props Types\n// ============================================\n\nexport interface BaseComponentProps {\n  className?: string;\n  style?: React.CSSProperties;\n  children?: React.ReactNode;\n  id?: string;\n  testId?: string;\n}\n\nexport interface ModalProps extends BaseComponentProps {\n  isOpen: boolean;\n  onClose: () => void;\n  title?: string;\n  size?: 'sm' | 'md' | 'lg' | 'xl';\n  closeOnOverlayClick?: boolean;\n}\n\nexport interface ButtonProps extends BaseComponentProps {\n  variant?: 'primary' | 'secondary' | 'danger' | 'ghost' | 'link';\n  size?: 'sm' | 'md' | 'lg';\n  disabled?: boolean;\n  loading?: boolean;\n  fullWidth?: boolean;\n  onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  type?: 'button' | 'submit' | 'reset';\n}\n\nexport interface InputProps extends BaseComponentProps {\n  value?: string;\n  defaultValue?: string;\n  placeholder?: string;\n  type?: string;\n  disabled?: boolean;\n  error?: string;\n  onChange?: (event: React.ChangeEvent<HTMLInputElement>) => void;\n  onBlur?: (event: React.FocusEvent<HTMLInputElement>) => void;\n}\n\n// ============================================\n// Hook Return Types\n// ============================================\n\nexport interface UseAuthReturn {\n  user: HiveUser | null;\n  loading: boolean;\n  error: any | null;\n  signIn: (email: string, password: string) => Promise<void>;\n  signOut: () => Promise<void>;\n  isAuthenticated: boolean;\n}\n\nexport interface UseFeedReturn {\n  posts: Post[];\n  loading: boolean;\n  error: any | null;\n  hasMore: boolean;\n  loadMore: () => Promise<void>;\n  refresh: () => Promise<void>;\n}\n\nexport interface UseSpaceReturn {\n  space: Space | null;\n  loading: boolean;\n  error: any | null;\n  members: HiveUser[];\n  posts: Post[];\n  joinSpace: () => Promise<void>;\n  leaveSpace: () => Promise<void>;\n}\n\n// ============================================\n// State Management Types\n// ============================================\n\nexport interface AppState {\n  auth: AuthState;\n  ui: UIState;\n  feed: FeedState;\n  spaces: SpacesState;\n  notifications: NotificationsState;\n}\n\nexport interface AuthState {\n  user: HiveUser | null;\n  token: string | null;\n  isAuthenticated: boolean;\n  loading: boolean;\n  error: any | null;\n}\n\nexport interface UIState {\n  theme: 'light' | 'dark' | 'auto';\n  sidebarOpen: boolean;\n  modalStack: string[];\n  toasts: Toast[];\n}\n\nexport interface FeedState {\n  posts: Post[];\n  loading: boolean;\n  error: any | null;\n  cursor?: string;\n  hasMore: boolean;\n}\n\nexport interface SpacesState {\n  activeSpace: Space | null;\n  userSpaces: Space[];\n  recommendedSpaces: Space[];\n  loading: boolean;\n  error: any | null;\n}\n\nexport interface NotificationsState {\n  items: Notification[];\n  unreadCount: number;\n  loading: boolean;\n  error: any | null;\n}\n\nexport interface Toast {\n  id: string;\n  type: 'success' | 'error' | 'warning' | 'info';\n  title: string;\n  description?: string;\n  duration?: number;\n}\n\n// ============================================\n// Logger Types\n// ============================================\n\nexport interface LogEntry {\n  level: 'error' | 'warn' | 'info' | 'debug';\n  message: string;\n  timestamp: string;\n  context?: Record<string, unknown>;\n  error?: any;\n  userId?: string;\n  requestId?: string;\n}\n\nexport interface LoggerConfig {\n  level: 'error' | 'warn' | 'info' | 'debug';\n  enableConsole: boolean;\n  enableRemote: boolean;\n  remoteUrl?: string;\n  format?: 'json' | 'text';\n}\n\n// ============================================\n// Export all types\n// ============================================\n\nexport type * from './global';\n","usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/test-import.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/laneyfraass/hive_ui/apps/web/tests/navigation-verification.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]